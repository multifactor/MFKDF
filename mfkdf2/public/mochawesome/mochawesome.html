<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:76,&quot;tests&quot;:268,&quot;passes&quot;:268,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-09-13T20:27:17.058Z&quot;,&quot;end&quot;:&quot;2025-09-13T20:27:36.130Z&quot;,&quot;duration&quot;:19072,&quot;testsRegistered&quot;:268,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;342fcd7c-4415-44d7-a86a-3cce1a73f6d8&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;title&quot;:&quot;aes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\aes.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\aes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;encrypt throws on invalid inputs&quot;,&quot;fullTitle&quot;:&quot;aes encrypt throws on invalid inputs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt;\n  crypt.encrypt(&#x27;not a buffer&#x27;, crypto.randomBytes(32))).should.throw();\n(() =&gt;\n  crypt.encrypt(\n    crypto.randomBytes(16),\n    crypto.randomBytes(32)\n  )).should.throw();\n(() =&gt;\n  crypt.encrypt(crypto.randomBytes(32), &#x27;not a buffer&#x27;)).should.throw();\n(() =&gt;\n  crypt.encrypt(\n    crypto.randomBytes(32),\n    crypto.randomBytes(16)\n  )).should.throw()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a22bedc-eab4-4571-8317-3d97b3619a3c&quot;,&quot;parentUUID&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypt throws on invalid inputs&quot;,&quot;fullTitle&quot;:&quot;aes decrypt throws on invalid inputs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt;\n  crypt.decrypt(&#x27;not a buffer&#x27;, crypto.randomBytes(32))).should.throw();\n(() =&gt;\n  crypt.decrypt(\n    crypto.randomBytes(16),\n    crypto.randomBytes(32)\n  )).should.throw();\n(() =&gt;\n  crypt.decrypt(crypto.randomBytes(32), &#x27;not a buffer&#x27;)).should.throw();\n(() =&gt;\n  crypt.decrypt(\n    crypto.randomBytes(32),\n    crypto.randomBytes(16)\n  )).should.throw()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c5b6b63c-8271-43c2-aa5f-af2f52067a6b&quot;,&quot;parentUUID&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypts and decrypts correctly&quot;,&quot;fullTitle&quot;:&quot;aes encrypts and decrypts correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nconst decrypted = crypt.decrypt(encrypted, key)\ndecrypted.equals(data).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10bb9a1a-e7e2-417f-b01d-cfead757797f&quot;,&quot;parentUUID&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypting with wrong key fails&quot;,&quot;fullTitle&quot;:&quot;aes decrypting with wrong key fails&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst wrongKey = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nconst decrypted = crypt.decrypt(encrypted, wrongKey)\ndecrypted.equals(data).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af62f027-3be6-4648-a164-15ea98cbd195&quot;,&quot;parentUUID&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypting modified data fails&quot;,&quot;fullTitle&quot;:&quot;aes decrypting modified data fails&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\n// Modify the encrypted data\nencrypted[0] ^= 0xff\nconst decrypted = crypt.decrypt(encrypted, key)\ndecrypted.equals(data).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bc8f37f-2e4b-430d-a849-1497e5d88686&quot;,&quot;parentUUID&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ciphertext length equals plaintext length&quot;,&quot;fullTitle&quot;:&quot;aes ciphertext length equals plaintext length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nencrypted.length.should.equal(data.length)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0de5b362-40dc-4959-b71f-4521f2cdf57e&quot;,&quot;parentUUID&quot;:&quot;3b898dbb-0a17-47a9-a5a8-b9ab7ba737d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0a22bedc-eab4-4571-8317-3d97b3619a3c&quot;,&quot;c5b6b63c-8271-43c2-aa5f-af2f52067a6b&quot;,&quot;10bb9a1a-e7e2-417f-b01d-cfead757797f&quot;,&quot;af62f027-3be6-4648-a164-15ea98cbd195&quot;,&quot;5bc8f37f-2e4b-430d-a849-1497e5d88686&quot;,&quot;0de5b362-40dc-4959-b71f-4521f2cdf57e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;805e07ff-1acd-46bb-8df3-8300bf99625d&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a0157620-b9b5-448d-be6f-6b6952c59457&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    id: &#x27;uuid1&#x27;,\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey()\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a1da5e62-108e-476a-87b2-f8963c7ba28f&quot;,&quot;parentUUID&quot;:&quot;a0157620-b9b5-448d-be6f-6b6952c59457&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a1da5e62-108e-476a-87b2-f8963c7ba28f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:23,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c194a029-b246-4f5d-a70f-30b533486127&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;71afd4bc-a2a4-454a-ab39-52584c923f23&quot;,&quot;parentUUID&quot;:&quot;c194a029-b246-4f5d-a70f-30b533486127&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5683863d-ef16-4abb-bd1b-0d8784e83e37&quot;,&quot;parentUUID&quot;:&quot;c194a029-b246-4f5d-a70f-30b533486127&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;71afd4bc-a2a4-454a-ab39-52584c923f23&quot;,&quot;5683863d-ef16-4abb-bd1b-0d8784e83e37&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2c0c35c9-7ff2-47c8-9810-dec9466429d1&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b0d5d9a3-6756-4e56-81dd-c3c45e3b8d24&quot;,&quot;parentUUID&quot;:&quot;2c0c35c9-7ff2-47c8-9810-dec9466429d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8ef38a9-e449-4e2f-96d5-2755b29db2cb&quot;,&quot;parentUUID&quot;:&quot;2c0c35c9-7ff2-47c8-9810-dec9466429d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b0d5d9a3-6756-4e56-81dd-c3c45e3b8d24&quot;,&quot;a8ef38a9-e449-4e2f-96d5-2755b29db2cb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;10f52bba-40cd-40df-b0fc-886e083ec7a8&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hkdf&quot;,&quot;fullTitle&quot;:&quot;derive/key hkdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:61,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6888e4e-d102-4371-b232-471471b1148f&quot;,&quot;parentUUID&quot;:&quot;10f52bba-40cd-40df-b0fc-886e083ec7a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:138,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67050e65-5f82-4a4c-bf83-1847384f58db&quot;,&quot;parentUUID&quot;:&quot;10f52bba-40cd-40df-b0fc-886e083ec7a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:135,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2, integrity: false }\n)\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nconst derive4 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0b153aa-4785-48c8-b137-7867cece05e2&quot;,&quot;parentUUID&quot;:&quot;10f52bba-40cd-40df-b0fc-886e083ec7a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nawait mfkdf.derive\n  .key(setup.policy, {\n    password: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    )\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6aff924-fc8f-45c7-b760-d4ddaed582de&quot;,&quot;parentUUID&quot;:&quot;10f52bba-40cd-40df-b0fc-886e083ec7a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6e04bd3e-6e82-48dc-8864-0944d625bf30&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ef9510c-6805-4c37-8751-0ce26a63a573&quot;,&quot;parentUUID&quot;:&quot;6e04bd3e-6e82-48dc-8864-0944d625bf30&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7ef9510c-6805-4c37-8751-0ce26a63a573&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:104,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;76eec636-25f4-42cb-a7f5-6f33ad69144a&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;284da224-1a37-41e8-9063-fbbab5d1145e&quot;,&quot;parentUUID&quot;:&quot;76eec636-25f4-42cb-a7f5-6f33ad69144a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa894d9e-cd2a-47cd-a0e9-290df0ce5f62&quot;,&quot;parentUUID&quot;:&quot;76eec636-25f4-42cb-a7f5-6f33ad69144a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;284da224-1a37-41e8-9063-fbbab5d1145e&quot;,&quot;aa894d9e-cd2a-47cd-a0e9-290df0ce5f62&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:55,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;b6888e4e-d102-4371-b232-471471b1148f&quot;,&quot;67050e65-5f82-4a4c-bf83-1847384f58db&quot;,&quot;d0b153aa-4785-48c8-b137-7867cece05e2&quot;,&quot;a6aff924-fc8f-45c7-b760-d4ddaed582de&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:362,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;title&quot;:&quot;derive/outputs&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\outputs.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\outputs.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;derive/outputs stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    })\n  ]),\n  await mfkdf.setup.factors.uuid({\n    id: &#x27;uuid3&#x27;,\n    uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n  })\n])\ndelete setup.outputs.stack.entropyBits\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    )\n  }),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;290f29dc-0080-4470-b33f-0a90bb1f77df&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;derive/outputs hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.hmacsha1()])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.outputs.should.not.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba022fa7-d578-48ff-80dd-75273a241496&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;derive/outputs uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;975691a7-2889-401c-8b7f-4e375137c0e3&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;derive/outputs question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.outputs.question.strength.calc_time = null\nderive.outputs.question.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41fbf036-fe21-47ea-b143-563ff6d9e340&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;derive/outputs ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:95,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7bf9147a-e562-4ccb-8c3c-c0638d4f221b&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;derive/outputs password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.outputs.password.strength.calc_time = null\nderive.outputs.password.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e98c2c91-d4cf-485f-a9f9-c5689f65b985&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;multiple&quot;,&quot;fullTitle&quot;:&quot;derive/outputs multiple&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nderive.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dca80288-91f8-45eb-8959-dc99236634c4&quot;,&quot;parentUUID&quot;:&quot;06439fe7-c301-4e52-878e-4af071d4ccd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;290f29dc-0080-4470-b33f-0a90bb1f77df&quot;,&quot;ba022fa7-d578-48ff-80dd-75273a241496&quot;,&quot;975691a7-2889-401c-8b7f-4e375137c0e3&quot;,&quot;41fbf036-fe21-47ea-b143-563ff6d9e340&quot;,&quot;7bf9147a-e562-4ccb-8c3c-c0638d4f221b&quot;,&quot;e98c2c91-d4cf-485f-a9f9-c5689f65b985&quot;,&quot;dca80288-91f8-45eb-8959-dc99236634c4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:385,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9b85ad11-5a4f-4f05-ace3-4084582bc4a1&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setup/derive fast&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;recovery&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db87e5d4-ed75-49a9-a1d6-3d690658c623&quot;,&quot;parentUUID&quot;:&quot;9b85ad11-5a4f-4f05-ace3-4084582bc4a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;recovery&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d5a71559-b5de-4b39-8dfc-ff0903a01554&quot;,&quot;parentUUID&quot;:&quot;9b85ad11-5a4f-4f05-ace3-4084582bc4a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:58,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n      id: &#x27;password2&#x27;\n    })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;871d22ad-39e3-4802-9e83-a4b05758e449&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4735b2e-7791-4e96-a7ef-dd99feb73538&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:491,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c445e9f0-0a0f-4fbd-a012-82abd4a42745&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;060d8e48-981b-4a32-ab69-09b66df3615b&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9fd6951b-baa8-45a4-a539-a7070905bd82&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;examples factors question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with security question factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n])\n// derive key with security question factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ff6128e-2146-4cc6-b974-ffd677ae65f7&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;examples factors ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:146,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup RSA key pair (on out-of-band server)\nconst keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\n// setup key with out-of-band authentication factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\n// decrypt and send code (on out-of-band server)\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\n// derive key with out-of-band factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba1bf1de-0a3a-40ca-9557-723bcfda3b78&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86916601-0421-4aa2-87ae-8b8d066718d8&quot;,&quot;parentUUID&quot;:&quot;68cdbaa1-7f66-4184-992f-252d85890cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;871d22ad-39e3-4802-9e83-a4b05758e449&quot;,&quot;d4735b2e-7791-4e96-a7ef-dd99feb73538&quot;,&quot;c445e9f0-0a0f-4fbd-a012-82abd4a42745&quot;,&quot;060d8e48-981b-4a32-ab69-09b66df3615b&quot;,&quot;9fd6951b-baa8-45a4-a539-a7070905bd82&quot;,&quot;4ff6128e-2146-4cc6-b974-ffd677ae65f7&quot;,&quot;ba1bf1de-0a3a-40ca-9557-723bcfda3b78&quot;,&quot;86916601-0421-4aa2-87ae-8b8d066718d8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:924,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b52ccdf8-4365-4fdf-9ab3-6d9556b0232c&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n  2,\n  3\n) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d85b5c8c-fb0d-44f4-a1c1-524a40c521f2&quot;,&quot;parentUUID&quot;:&quot;b52ccdf8-4365-4fdf-9ab3-6d9556b0232c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d85b5c8c-fb0d-44f4-a1c1-524a40c521f2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6fa5a69-1a0f-436f-8645-6e63c8ea0a59&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25661b5b-e578-4076-bafe-42d8044c5086&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [\n  &#x27;passwordA&#x27;,\n  &#x27;passwordC&#x27;\n]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [\n  &#x27;passwordB&#x27;,\n  &#x27;passwordC&#x27;\n]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7d28b63-a8fa-4c0f-a9e3-a8cc5e01862c&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:65,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;245a058b-7843-483e-bbee-c6d880fbebdd&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d4c2e58-5b1a-4563-bc56-640b38a9f8a4&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;88f46554-c524-498d-a11e-fa3931a86db9&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10e3fc22-5ffb-4319-aec9-84cfa982ae77&quot;,&quot;parentUUID&quot;:&quot;53ffb45c-5a58-4e92-8da4-a1b8d364269e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a6fa5a69-1a0f-436f-8645-6e63c8ea0a59&quot;,&quot;25661b5b-e578-4076-bafe-42d8044c5086&quot;,&quot;c7d28b63-a8fa-4c0f-a9e3-a8cc5e01862c&quot;,&quot;245a058b-7843-483e-bbee-c6d880fbebdd&quot;,&quot;1d4c2e58-5b1a-4563-bc56-640b38a9f8a4&quot;,&quot;88f46554-c524-498d-a11e-fa3931a86db9&quot;,&quot;10e3fc22-5ffb-4319-aec9-84cfa982ae77&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:281,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;221346ad-e791-4602-9157-8837c5deddd6&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6a0e337-05df-423a-afd3-32ca5b8662f6&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 1 }\n)\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ed59860-36b5-4b30-a4cd-735a9fd136e5&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3853d784-ea2b-4a9e-bf5e-93a50d97e59f&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6dc08c5c-08db-4bd3-9421-bd6728851c1f&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b8c7fd9c-c603-4411-9e7b-6b1c9cbc9047&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ee54487-7c0a-45f6-b776-22173cdbe7e4&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bbdcbf16-c6c3-41b9-995c-f4656ccd561a&quot;,&quot;parentUUID&quot;:&quot;05ca5ab8-7f1e-4da5-9af8-4648d0de9810&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;221346ad-e791-4602-9157-8837c5deddd6&quot;,&quot;f6a0e337-05df-423a-afd3-32ca5b8662f6&quot;,&quot;4ed59860-36b5-4b30-a4cd-735a9fd136e5&quot;,&quot;3853d784-ea2b-4a9e-bf5e-93a50d97e59f&quot;,&quot;6dc08c5c-08db-4bd3-9421-bd6728851c1f&quot;,&quot;b8c7fd9c-c603-4411-9e7b-6b1c9cbc9047&quot;,&quot;0ee54487-7c0a-45f6-b776-22173cdbe7e4&quot;,&quot;bbdcbf16-c6c3-41b9-995c-f4656ccd561a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:394,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5ec426d0-5d6b-42e8-9c36-ffac2c0f2a8b&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e06b03b-6d9a-4dc3-b247-2f0ee0e8320a&quot;,&quot;parentUUID&quot;:&quot;5ec426d0-5d6b-42e8-9c36-ffac2c0f2a8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0e06b03b-6d9a-4dc3-b247-2f0ee0e8320a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:50,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2c13248c-9ce1-466f-aebc-a5f25a626024&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\n// get sub-key for \&quot;eth\&quot;\nconst subkey = key.getSubkey(&#x27;eth&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 97cb…bac5&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;03c972c4-98ca-4d9a-8a13-75e44f48feb1&quot;,&quot;parentUUID&quot;:&quot;2c13248c-9ce1-466f-aebc-a5f25a626024&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;03c972c4-98ca-4d9a-8a13-75e44f48feb1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:20,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;db87e5d4-ed75-49a9-a1d6-3d690658c623&quot;,&quot;d5a71559-b5de-4b39-8dfc-ff0903a01554&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:95,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f1564199-0044-46c7-a1e2-e673bb9c02f7&quot;,&quot;title&quot;:&quot;site&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\site.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\site.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Go beyond passwords&quot;,&quot;fullTitle&quot;:&quot;site Go beyond passwords&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify(\n  (\n    await mfkdf.setup.key(\n      [\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n        await mfkdf.setup.factors.hotp({\n          secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n        }),\n        await mfkdf.setup.factors.uuid({\n          id: &#x27;recovery&#x27;,\n          uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n        })\n      ],\n      { threshold: 2, pbkdf2rounds: 1 }\n    )\n  ).policy\n)\nconst derivedKey = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  password: mfkdf.derive.factors.password(&#x27;Tr0ub4dour&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  recovery: mfkdf.derive.factors.uuid(\n    &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  )\n})\nderivedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0a43bb5-f6a2-4107-a20c-1dba9d5d89b0&quot;,&quot;parentUUID&quot;:&quot;f1564199-0044-46c7-a1e2-e673bb9c02f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Increased key entropy&quot;,&quot;fullTitle&quot;:&quot;site Increased key entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;Math.floor(\n  (\n    await mfkdf.setup.key([\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n    ])\n  ).entropyBits.real\n).should.equal(16)\nMath.floor(\n  (\n    await mfkdf.setup.key([\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.hotp(),\n      await mfkdf.setup.factors.hmacsha1()\n    ])\n  ).entropyBits.real\n).should.equal(196)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;496d6987-3126-4a9c-b65b-53f5dc9a8903&quot;,&quot;parentUUID&quot;:&quot;f1564199-0044-46c7-a1e2-e673bb9c02f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enforce advanced policies&quot;,&quot;fullTitle&quot;:&quot;site Enforce advanced policies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:359,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policyBasedKey = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.totp()\n    )\n  )\n)\npolicyBasedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f67bd5d4-b3f9-48bf-8b1e-96034c329e76&quot;,&quot;parentUUID&quot;:&quot;f1564199-0044-46c7-a1e2-e673bb9c02f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Self-service factor recovery&quot;,&quot;fullTitle&quot;:&quot;site Self-service factor recovery&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify(\n  (\n    await mfkdf.setup.key(\n      [\n        await mfkdf.setup.factors.password(&#x27;password&#x27;),\n        await mfkdf.setup.factors.hotp({\n          secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n        }),\n        await mfkdf.setup.factors.uuid({\n          id: &#x27;recoveryCode&#x27;,\n          uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n        })\n      ],\n      { threshold: 2, pbkdf2rounds: 1 }\n    )\n  ).policy\n)\nconst key = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  hotp: mfkdf.derive.factors.hotp(241063),\n  recoveryCode: mfkdf.derive.factors.uuid(\n    &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  )\n})\nawait key.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;myNewPassword&#x27;, { id: &#x27;password&#x27; })\n) // modify key to use new password factor&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;309e0b45-e06b-4888-b4f2-5bdef4af061a&quot;,&quot;parentUUID&quot;:&quot;f1564199-0044-46c7-a1e2-e673bb9c02f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a0a43bb5-f6a2-4107-a20c-1dba9d5d89b0&quot;,&quot;496d6987-3126-4a9c-b65b-53f5dc9a8903&quot;,&quot;f67bd5d4-b3f9-48bf-8b1e-96034c329e76&quot;,&quot;309e0b45-e06b-4888-b4f2-5bdef4af061a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:505,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8286879c-a48c-464e-9cd8-3bc516f49eba&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  }),\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// reconstitute key to change password\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword&#x27;)\n)\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ffb323f-3c7f-4c13-89b1-98f34be5c5c9&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.stack([\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ]),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 1 }\n)\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5b51927-0caf-49dd-ac33-be009800afa9&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c93874e4-abf8-41ff-b2e2-c75b7e65ff6a&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bcc26215-efef-437a-9680-4454538b7397&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:134,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n])\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n])\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n])\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n])\nconst threshold = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.uuid(),\n    await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9fcef908-f720-47f5-9156-fa52f3773987&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  }),\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d457287-77c2-413b-9625-2528c4d6f700&quot;,&quot;parentUUID&quot;:&quot;5ca846dc-8a26-40af-8dfe-3443753409f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8286879c-a48c-464e-9cd8-3bc516f49eba&quot;,&quot;7ffb323f-3c7f-4c13-89b1-98f34be5c5c9&quot;,&quot;b5b51927-0caf-49dd-ac33-be009800afa9&quot;,&quot;c93874e4-abf8-41ff-b2e2-c75b7e65ff6a&quot;,&quot;bcc26215-efef-437a-9680-4454538b7397&quot;,&quot;9fcef908-f720-47f5-9156-fa52f3773987&quot;,&quot;0d457287-77c2-413b-9625-2528c4d6f700&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:443,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;65e2e0df-c870-416e-92e9-9ceaebe88006&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key).update(challenge).digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1cae437e-462d-4fff-8398-ae51f03b5265&quot;,&quot;parentUUID&quot;:&quot;65e2e0df-c870-416e-92e9-9ceaebe88006&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:70,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.hmacsha1()])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response1 = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(\n  derive1.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response2 = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec9dfce9-446b-4186-a79a-fb066c1a5b63&quot;,&quot;parentUUID&quot;:&quot;65e2e0df-c870-416e-92e9-9ceaebe88006&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(\n  JSON.parse(setup),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nderive.key\n  .toString(&#x27;hex&#x27;)\n  .should.equal(\n    &#x27;2747ebf65219aee6630a758e40fd05ccbb39ab465745ea1c9a6c5adb6673d2d3&#x27;\n  )&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21096d4b-b1ba-4fdb-9762-d030d775be13&quot;,&quot;parentUUID&quot;:&quot;65e2e0df-c870-416e-92e9-9ceaebe88006&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;wrong-salt&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 wrong-salt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PlS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(\n  JSON.parse(setup),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nconst setup2 =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive2 = await mfkdf.derive.key(\n  JSON.parse(setup2),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nderive.key\n  .toString(&#x27;hex&#x27;)\n  .should.not.equal(\n    &#x27;64393334663330303639356134323533393937376561636234363262373662316562616564393838663531393337303563666432633265373130636663666230&#x27;\n  )\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e5daae2-e3b2-4f10-b97a-1ec87fd4a88d&quot;,&quot;parentUUID&quot;:&quot;65e2e0df-c870-416e-92e9-9ceaebe88006&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;714152dd-644e-4950-b734-253d9c45c244&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc6ec0b3-de03-435a-bc20-a97640eee186&quot;,&quot;parentUUID&quot;:&quot;714152dd-644e-4950-b734-253d9c45c244&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e038e24f-57ca-4146-aada-4fe192c0846f&quot;,&quot;parentUUID&quot;:&quot;714152dd-644e-4950-b734-253d9c45c244&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ secret: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;285d37bd-aae9-489d-b6d3-60e71a004df7&quot;,&quot;parentUUID&quot;:&quot;714152dd-644e-4950-b734-253d9c45c244&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01bc2a6c-2710-4da0-b557-71c3474f4fc8&quot;,&quot;parentUUID&quot;:&quot;714152dd-644e-4950-b734-253d9c45c244&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df964a43-fe1f-4f8c-bc59-97cc785d63a7&quot;,&quot;parentUUID&quot;:&quot;714152dd-644e-4950-b734-253d9c45c244&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dc6ec0b3-de03-435a-bc20-a97640eee186&quot;,&quot;e038e24f-57ca-4146-aada-4fe192c0846f&quot;,&quot;285d37bd-aae9-489d-b6d3-60e71a004df7&quot;,&quot;01bc2a6c-2710-4da0-b557-71c3474f4fc8&quot;,&quot;df964a43-fe1f-4f8c-bc59-97cc785d63a7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;1cae437e-462d-4fff-8398-ae51f03b5265&quot;,&quot;ec9dfce9-446b-4186-a79a-fb066c1a5b63&quot;,&quot;21096d4b-b1ba-4fdb-9762-d030d775be13&quot;,&quot;6e5daae2-e3b2-4f10-b97a-1ec87fd4a88d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:142,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ee248cfc-f7ea-4e76-9c58-681d06736969&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;size&quot;,&quot;fullTitle&quot;:&quot;factors/hotp size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2e18cc18-49a2-4e65-bba7-cec3a9367e78&quot;,&quot;parentUUID&quot;:&quot;ee248cfc-f7ea-4e76-9c58-681d06736969&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:99,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(361687)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(979122)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0700710-c772-4b83-aae9-9b06f03b6e13&quot;,&quot;parentUUID&quot;:&quot;ee248cfc-f7ea-4e76-9c58-681d06736969&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([await mfkdf.setup.factors.hotp()])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d8cd484a-4d91-4c30-8a17-d6c3a126cf74&quot;,&quot;parentUUID&quot;:&quot;ee248cfc-f7ea-4e76-9c58-681d06736969&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6952af2-1082-4ba5-b7ea-ba250522cb89&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de7e4296-04ee-4544-a9d6-fd2979e594c6&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe55da33-396f-4ac1-9b20-2420608173d3&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40b7fa94-67d2-4445-bcd7-d6ff7363ed63&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 4\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81d4fe3c-94b9-4f5c-bfa4-3007b0bbfc4d&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 9\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24193cfa-e457-43e3-bce6-33f9c59445f0&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    hash: &#x27;sha123&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;94f85512-8ca3-4692-a7c6-bc9ab9d28fd9&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a05a0de3-e58b-46fd-8938-67acde2dac89&quot;,&quot;parentUUID&quot;:&quot;56f1baa0-425d-447d-9803-a892870a71d3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b6952af2-1082-4ba5-b7ea-ba250522cb89&quot;,&quot;de7e4296-04ee-4544-a9d6-fd2979e594c6&quot;,&quot;fe55da33-396f-4ac1-9b20-2420608173d3&quot;,&quot;40b7fa94-67d2-4445-bcd7-d6ff7363ed63&quot;,&quot;81d4fe3c-94b9-4f5c-bfa4-3007b0bbfc4d&quot;,&quot;24193cfa-e457-43e3-bce6-33f9c59445f0&quot;,&quot;94f85512-8ca3-4692-a7c6-bc9ab9d28fd9&quot;,&quot;a05a0de3-e58b-46fd-8938-67acde2dac89&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2e18cc18-49a2-4e65-bba7-cec3a9367e78&quot;,&quot;d0700710-c772-4b83-aae9-9b06f03b6e13&quot;,&quot;d8cd484a-4d91-4c30-8a17-d6c3a126cf74&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:120,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a76d481f-61b2-4cf6-a927-93136cb6859b&quot;,&quot;title&quot;:&quot;factors/ooba&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;factors/ooba full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:176,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: {\n      email: &#x27;test@mfkdf.com&#x27;\n    }\n  })\n])\nlet next = setup.policy.factors[0].params.next\nlet decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nlet json = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\nlet code = json.code\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nnext = derive1.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toLowerCase())\n})\nnext = derive2.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toUpperCase())\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e4db323-c1a5-46c3-99ca-7e51cf154690&quot;,&quot;parentUUID&quot;:&quot;a76d481f-61b2-4cf6-a927-93136cb6859b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;049a858e-db14-48ed-a225-0304106cc4f2&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.ooba(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4a67e98-9af5-4d4b-9343-b048ce529203&quot;,&quot;parentUUID&quot;:&quot;049a858e-db14-48ed-a225-0304106cc4f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nawait mfkdf.setup.factors\n  .ooba({\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: &#x27;foo&#x27;\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: 0\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: 100\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    key: &#x27;12345&#x27;\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    key: keyPair.publicKey,\n    params: &#x27;12345&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b3f4408-f2cf-4105-ad9c-67a5a4030cf2&quot;,&quot;parentUUID&quot;:&quot;049a858e-db14-48ed-a225-0304106cc4f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e4a67e98-9af5-4d4b-9343-b048ce529203&quot;,&quot;0b3f4408-f2cf-4105-ad9c-67a5a4030cf2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:52,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;0e4db323-c1a5-46c3-99ca-7e51cf154690&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:176,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;01c9898b-9a76-4ec2-8249-e6e702a32de5&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;700bc20e-86d6-4576-a89d-90dfc8368179&quot;,&quot;parentUUID&quot;:&quot;01c9898b-9a76-4ec2-8249-e6e702a32de5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f7697ca5-2c8f-44e5-be0d-1e8188190492&quot;,&quot;parentUUID&quot;:&quot;01c9898b-9a76-4ec2-8249-e6e702a32de5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;700bc20e-86d6-4576-a89d-90dfc8368179&quot;,&quot;f7697ca5-2c8f-44e5-be0d-1e8188190492&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;21a52d88-262b-46b2-8b7f-038f88c9b216&quot;,&quot;title&quot;:&quot;factors/question&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/question valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27; Fido-&#x27;, {\n    question: &#x27;What is the name of your first pet?&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;-f_i%d#o ? &#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df84a8d4-3fd2-4483-ba5a-580652538fc6&quot;,&quot;parentUUID&quot;:&quot;21a52d88-262b-46b2-8b7f-038f88c9b216&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/question invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;, {\n    question: &#x27;What is the name of your first pet?&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    question: mfkdf.derive.factors.question(&#x27;Rex&#x27;)\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ac28b55-00f8-47c8-87af-ee91540c79c1&quot;,&quot;parentUUID&quot;:&quot;21a52d88-262b-46b2-8b7f-038f88c9b216&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f04804ce-1722-4bda-beef-42c451e84dfa&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/question errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.question(123)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.question(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67d2edfa-8f67-41f2-8141-3d7850cb7d44&quot;,&quot;parentUUID&quot;:&quot;f04804ce-1722-4bda-beef-42c451e84dfa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/question errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .question(12345)\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors.question(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { id: 12345 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { question: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa498e3f-9376-4ff2-9f4c-4b39a0a09d4c&quot;,&quot;parentUUID&quot;:&quot;f04804ce-1722-4bda-beef-42c451e84dfa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;67d2edfa-8f67-41f2-8141-3d7850cb7d44&quot;,&quot;aa498e3f-9376-4ff2-9f4c-4b39a0a09d4c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;df84a8d4-3fd2-4483-ba5a-580652538fc6&quot;,&quot;3ac28b55-00f8-47c8-87af-ee91540c79c1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:91,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4948dd71-6783-4871-ae68-f4651e82719a&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors\n  .stack(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ],\n    { id: 12345 }\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fdca149b-71c5-43f6-8816-e0d29a083fb2&quot;,&quot;parentUUID&quot;:&quot;4948dd71-6783-4871-ae68-f4651e82719a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors\n  .stack(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ],\n    { id: &#x27;&#x27; }\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c63f86bd-4548-47b4-bf9e-28463a42e28b&quot;,&quot;parentUUID&quot;:&quot;4948dd71-6783-4871-ae68-f4651e82719a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:81,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.stack(\n      [\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ],\n      { id: &#x27;stack1&#x27; }\n    ),\n    await mfkdf.setup.factors.stack(\n      [\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        })\n      ],\n      { id: &#x27;stack2&#x27; }\n    )\n  ],\n  { threshold: 1 }\n)\nsetup.policy.factors[0].params.should.not.have.property(&#x27;hmac&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b131f25d-e14b-4fcb-968a-428d8ebf925e&quot;,&quot;parentUUID&quot;:&quot;4948dd71-6783-4871-ae68-f4651e82719a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fdca149b-71c5-43f6-8816-e0d29a083fb2&quot;,&quot;c63f86bd-4548-47b4-bf9e-28463a42e28b&quot;,&quot;b131f25d-e14b-4fcb-968a-428d8ebf925e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:82,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1169faef-7978-4aee-b4c8-4617d0b084b8&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;size&quot;,&quot;fullTitle&quot;:&quot;factors/totp size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c4de018d-0bd9-4caf-8a26-9db954155eff&quot;,&quot;parentUUID&quot;:&quot;1169faef-7978-4aee-b4c8-4617d0b084b8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:457,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.totp()])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ed81d37-e47e-4671-835d-9ce325eed7a7&quot;,&quot;parentUUID&quot;:&quot;1169faef-7978-4aee-b4c8-4617d0b084b8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:441,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, { time: 30001 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, { time: 60001 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dbae7394-192a-46d2-b093-79c7e77f9a3e&quot;,&quot;parentUUID&quot;:&quot;1169faef-7978-4aee-b4c8-4617d0b084b8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:359,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([await mfkdf.setup.factors.totp()])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35177ed4-9728-408f-908c-1655ba686156&quot;,&quot;parentUUID&quot;:&quot;1169faef-7978-4aee-b4c8-4617d0b084b8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;58c409a5-e9dd-4cec-9674-1fdbcc90b2b4&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:365,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597\n  })\n])\nawait mfkdf.derive\n  .key(setup.policy, {\n    totp: mfkdf.derive.factors.totp(953265, { time: 1750430943604 })\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e74aa27f-1112-440c-932a-31b93790caee&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;579ce694-5130-4048-b86e-9c27573b2768&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f59a1a6-fc9c-4684-b9f1-05665c7c1565&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e850d145-cf1d-4591-9319-c8477370e212&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5181df76-143b-47be-a595-6ec09b348663&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9eae1d1f-0b4f-4aef-95fd-86636029e24c&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 4\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;06e16173-dc30-49bf-b0c3-81368441bda2&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 9\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;06b03a85-bf89-4c30-aeec-950611ea0f0a&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    hash: &#x27;sha123&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d65ff50c-cf12-4393-aaaf-3004a0538062&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b849b7d6-7dcd-4b87-a0e8-c2f720e533ca&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    time: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9539a5b0-0d48-4d70-b786-497ebc0883d4&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    time: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d6674e4-fdf2-4be0-be39-35cf51ecca2c&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    step: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de4fbdbb-32fb-4087-a9a2-b5072d3419d0&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    step: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c036f58-dd63-462e-ba1c-c4d98c337d8c&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    window: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d539c29d-1522-4088-a924-edc12ef12786&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    window: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0beff885-fe50-4283-b807-b84a83e9c5e2&quot;,&quot;parentUUID&quot;:&quot;a3c5b601-9528-4ded-8fe0-26fcba36fcd8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;58c409a5-e9dd-4cec-9674-1fdbcc90b2b4&quot;,&quot;e74aa27f-1112-440c-932a-31b93790caee&quot;,&quot;579ce694-5130-4048-b86e-9c27573b2768&quot;,&quot;0f59a1a6-fc9c-4684-b9f1-05665c7c1565&quot;,&quot;e850d145-cf1d-4591-9319-c8477370e212&quot;,&quot;5181df76-143b-47be-a595-6ec09b348663&quot;,&quot;9eae1d1f-0b4f-4aef-95fd-86636029e24c&quot;,&quot;06e16173-dc30-49bf-b0c3-81368441bda2&quot;,&quot;06b03a85-bf89-4c30-aeec-950611ea0f0a&quot;,&quot;d65ff50c-cf12-4393-aaaf-3004a0538062&quot;,&quot;b849b7d6-7dcd-4b87-a0e8-c2f720e533ca&quot;,&quot;9539a5b0-0d48-4d70-b786-497ebc0883d4&quot;,&quot;5d6674e4-fdf2-4be0-be39-35cf51ecca2c&quot;,&quot;de4fbdbb-32fb-4087-a9a2-b5072d3419d0&quot;,&quot;6c036f58-dd63-462e-ba1c-c4d98c337d8c&quot;,&quot;d539c29d-1522-4088-a924-edc12ef12786&quot;,&quot;0beff885-fe50-4283-b807-b84a83e9c5e2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:367,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;c4de018d-0bd9-4caf-8a26-9db954155eff&quot;,&quot;6ed81d37-e47e-4671-835d-9ce325eed7a7&quot;,&quot;dbae7394-192a-46d2-b093-79c7e77f9a3e&quot;,&quot;35177ed4-9728-408f-908c-1655ba686156&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1257,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a2fd60fd-6033-4550-8935-65f2c8c4ae9a&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:127,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;628306ee-c79d-444f-bc6f-21ae9744f70e&quot;,&quot;parentUUID&quot;:&quot;a2fd60fd-6033-4550-8935-65f2c8c4ae9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:126,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    )\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;\n    )\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;\n    )\n  },\n  false\n)\nconst derive4 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    )\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da5a8dfb-4bfd-4785-a172-f540025048cc&quot;,&quot;parentUUID&quot;:&quot;a2fd60fd-6033-4550-8935-65f2c8c4ae9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;628306ee-c79d-444f-bc6f-21ae9744f70e&quot;,&quot;da5a8dfb-4bfd-4785-a172-f540025048cc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:253,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42ece878-18a3-453c-a1fa-adc942ac39e0&quot;,&quot;parentUUID&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:26,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec56fc38-305b-486a-bb40-8e7a197f55f3&quot;,&quot;parentUUID&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c283b2f-1aae-4b0b-b31a-b71bfb0ef597&quot;,&quot;parentUUID&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7eb59939-de64-4337-b4a2-e8b5790714f2&quot;,&quot;parentUUID&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:357,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;929b9ef7-bc83-4965-9dd1-487d3077c8ea&quot;,&quot;parentUUID&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:355,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;521d81f9-c579-4283-a23d-f8d5030ebf2d&quot;,&quot;parentUUID&quot;:&quot;9658cc16-24ed-431c-830c-fdca5df14f03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;42ece878-18a3-453c-a1fa-adc942ac39e0&quot;,&quot;ec56fc38-305b-486a-bb40-8e7a197f55f3&quot;,&quot;1c283b2f-1aae-4b0b-b31a-b71bfb0ef597&quot;,&quot;7eb59939-de64-4337-b4a2-e8b5790714f2&quot;,&quot;929b9ef7-bc83-4965-9dd1-487d3077c8ea&quot;,&quot;521d81f9-c579-4283-a23d-f8d5030ebf2d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:802,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;title&quot;:&quot;integrity&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\integrity.js&quot;,&quot;file&quot;:&quot;\\test\\features\\integrity.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;disabled&quot;,&quot;fullTitle&quot;:&quot;integrity disabled&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  false\n)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9eb73946-5e1c-423b-b050-03f9bccb33b7&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;safety&quot;,&quot;fullTitle&quot;:&quot;integrity safety&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:84,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n      password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n      password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7bb5afa9-4ff1-441e-8dd0-c302241babb6&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;liveness&quot;,&quot;fullTitle&quot;:&quot;integrity liveness&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  true\n)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26025ae6-6ea9-4bbe-828f-b2b9624ec555&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;$id&quot;,&quot;fullTitle&quot;:&quot;integrity $id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.$id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7cb9c7e2-1e8c-4401-977c-fb596ee3cc3f&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold&quot;,&quot;fullTitle&quot;:&quot;integrity threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.threshold += 1\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;03cb685e-ca3a-45b2-a749-221f54ae48cb&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;salt&quot;,&quot;fullTitle&quot;:&quot;integrity salt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.salt = &#x27;Ny9+L9LQHOKh1x3Acqy7pMb9JaEIfNfxU/TsDON+Ht4=&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af7824c2-726f-45cd-a00e-78f1de59f1c2&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id&quot;,&quot;fullTitle&quot;:&quot;integrity factor/id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;434b84d6-cd6f-4d49-84a8-b98f0b263ad3&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;integrity derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:81,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  true\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\n// Tamper with policy\nderive.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    derive.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n      password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n      password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9905f3a2-d1ce-4d9e-b2a8-2e6da3beed6e&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullTitle&quot;:&quot;integrity reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2, integrity: true }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  })\n)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n  },\n  true\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fbe4ae71-bcf0-4433-a315-f17c2576996a&quot;,&quot;parentUUID&quot;:&quot;ed32d30b-6691-4863-ae66-3054810729ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9eb73946-5e1c-423b-b050-03f9bccb33b7&quot;,&quot;7bb5afa9-4ff1-441e-8dd0-c302241babb6&quot;,&quot;26025ae6-6ea9-4bbe-828f-b2b9624ec555&quot;,&quot;7cb9c7e2-1e8c-4401-977c-fb596ee3cc3f&quot;,&quot;03cb685e-ca3a-45b2-a749-221f54ae48cb&quot;,&quot;af7824c2-726f-45cd-a00e-78f1de59f1c2&quot;,&quot;434b84d6-cd6f-4d49-84a8-b98f0b263ad3&quot;,&quot;9905f3a2-d1ce-4d9e-b2a8-2e6da3beed6e&quot;,&quot;fbe4ae71-bcf0-4433-a315-f17c2576996a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:527,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a9c34fdd-cce6-4496-af02-2a0dd6999bf6&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;beb4b88f-c394-4ffe-a9ae-2e2d2d039908&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20d442ad-9b75-4f3d-bbf6-227fa2c30d4b&quot;,&quot;parentUUID&quot;:&quot;beb4b88f-c394-4ffe-a9ae-2e2d2d039908&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.policy\n  .setup(\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      )\n    )\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4b056ed-a4a4-4bc3-9b54-ccb7a58d16dc&quot;,&quot;parentUUID&quot;:&quot;beb4b88f-c394-4ffe-a9ae-2e2d2d039908&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;20d442ad-9b75-4f3d-bbf6-227fa2c30d4b&quot;,&quot;e4b056ed-a4a4-4bc3-9b54-ccb7a58d16dc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:44,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9926e907-1332-47a7-95e6-ec5a4dbb3fe2&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be\n  .true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01f9e7c8-132d-4f1a-b824-21ab03212619&quot;,&quot;parentUUID&quot;:&quot;9926e907-1332-47a7-95e6-ec5a4dbb3fe2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be\n  .false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b50eb11a-0ffe-4097-a3ae-a9af190e3ada&quot;,&quot;parentUUID&quot;:&quot;9926e907-1332-47a7-95e6-ec5a4dbb3fe2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;01f9e7c8-132d-4f1a-b824-21ab03212619&quot;,&quot;b50eb11a-0ffe-4097-a3ae-a9af190e3ada&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:45,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c8fbfa1-4a38-4289-a717-a080867da6fc&quot;,&quot;parentUUID&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f6a2367-931f-48c2-a100-71afd545fb62&quot;,&quot;parentUUID&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;49963554-9533-4251-b038-03de3c6bdace&quot;,&quot;parentUUID&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:167,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aefd728e-db9e-4df1-bd64-bfc80ff2ad13&quot;,&quot;parentUUID&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:88,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;39b653e3-b51d-4f10-8fd6-39709fdfe2b2&quot;,&quot;parentUUID&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:66,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0d4d356-b53d-4aa0-a1d1-fb2208070f0d&quot;,&quot;parentUUID&quot;:&quot;52f7c56a-5b57-425f-bc5e-117b2fe30694&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3c8fbfa1-4a38-4289-a717-a080867da6fc&quot;,&quot;5f6a2367-931f-48c2-a100-71afd545fb62&quot;,&quot;49963554-9533-4251-b038-03de3c6bdace&quot;,&quot;aefd728e-db9e-4df1-bd64-bfc80ff2ad13&quot;,&quot;39b653e3-b51d-4f10-8fd6-39709fdfe2b2&quot;,&quot;f0d4d356-b53d-4aa0-a1d1-fb2208070f0d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:478,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;543338f7-92de-448a-8c9d-40ec6a38e5f2&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n])\nawait mfkdf.policy\n  .derive(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n    password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2357efa-24b8-4129-858a-03cf460e727b&quot;,&quot;parentUUID&quot;:&quot;543338f7-92de-448a-8c9d-40ec6a38e5f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\nawait mfkdf.policy\n  .derive(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92988826-0375-4bbd-bf9c-3b92a7260226&quot;,&quot;parentUUID&quot;:&quot;543338f7-92de-448a-8c9d-40ec6a38e5f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c2357efa-24b8-4129-858a-03cf460e727b&quot;,&quot;92988826-0375-4bbd-bf9c-3b92a7260226&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:47,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ],\n  { threshold: 3, integrity: false }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    false\n  )\n  .should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b9e6ce8-7b12-4e1b-8e13-79316ca62942&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)\nawait derive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait mfkdf.derive\n  .key(derive2.policy, {\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d4f5094-a8d9-4524-863d-0a54c7bec627&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4cfe223-69bb-469e-92d4-4c12a92b3742&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;95a70ce5-8cc3-4ae6-92db-abcd606fa3be&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99eb82ce-cc59-4373-89fb-411f27f28241&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  })\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;15135a4a-b462-4f58-9f90-a01724bcb4c6&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01778b5f-586f-4302-9aff-9f73f252c0b9&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute(\n  [&#x27;password1&#x27;],\n  [\n    await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n      id: &#x27;password2&#x27;\n    })\n  ],\n  2\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6501270-d0ed-4764-806f-756025f5ac89&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a62fe36d-1774-40c0-809b-4b97d11c405e&quot;,&quot;parentUUID&quot;:&quot;de577200-dcb4-4be5-a5bc-4d171fed3189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [12345],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99658a8a-3b27-4f81-80d4-2753d5707e5e&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [&#x27;password4&#x27;],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b42c3f4-a188-48c5-80d0-9713829c33ef&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nawait setup\n  .reconstitute(\n    [&#x27;password3&#x27;],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc7a3fa3-8305-4f4a-94d9-ea51bb4940b2&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    &#x27;hello&#x27;,\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a984b7e1-b49f-4c5e-aa74-f65817dfa6cf&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute([], &#x27;12345&#x27;, 2)\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9714109f-575c-4bca-a8aa-15fed02d55a8&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute([], [], &#x27;12345&#x27;)\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3262d984-440a-4adb-a439-a9417f742931&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19810f4c-b1ef-4946-9aa0-fbafb9a333e3&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: 12345,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;736fc7ba-479b-453c-bc30-19deb78e21ea&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9315db01-7b2a-4fbd-8006-0b6be97ad83e&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: 12345,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75a137e6-9553-4121-b0ee-c7c80acdd12b&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e20378da-d451-42bd-a8d3-80ba839f92d0&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: 12345,\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b10339a-6a40-4ad3-887e-bb3d9c29fb98&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ebbfc6c2-0616-42da-86dd-5a9ff4240be4&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;),\n        params: 12345,\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac716c59-410c-48bc-8b9c-2a078eca44d2&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: 12345\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;57526091-d4d6-428c-8102-264581ad479d&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c5571ad7-6c64-4dd6-9698-7af502ce29f6&quot;,&quot;parentUUID&quot;:&quot;16062896-1ccc-47c7-a65b-3c4dace1be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99658a8a-3b27-4f81-80d4-2753d5707e5e&quot;,&quot;2b42c3f4-a188-48c5-80d0-9713829c33ef&quot;,&quot;dc7a3fa3-8305-4f4a-94d9-ea51bb4940b2&quot;,&quot;a984b7e1-b49f-4c5e-aa74-f65817dfa6cf&quot;,&quot;9714109f-575c-4bca-a8aa-15fed02d55a8&quot;,&quot;3262d984-440a-4adb-a439-a9417f742931&quot;,&quot;19810f4c-b1ef-4946-9aa0-fbafb9a333e3&quot;,&quot;736fc7ba-479b-453c-bc30-19deb78e21ea&quot;,&quot;9315db01-7b2a-4fbd-8006-0b6be97ad83e&quot;,&quot;75a137e6-9553-4121-b0ee-c7c80acdd12b&quot;,&quot;e20378da-d451-42bd-a8d3-80ba839f92d0&quot;,&quot;2b10339a-6a40-4ad3-887e-bb3d9c29fb98&quot;,&quot;ebbfc6c2-0616-42da-86dd-5a9ff4240be4&quot;,&quot;ac716c59-410c-48bc-8b9c-2a078eca44d2&quot;,&quot;57526091-d4d6-428c-8102-264581ad479d&quot;,&quot;c5571ad7-6c64-4dd6-9698-7af502ce29f6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:342,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;6b9e6ce8-7b12-4e1b-8e13-79316ca62942&quot;,&quot;1d4f5094-a8d9-4524-863d-0a54c7bec627&quot;,&quot;e4cfe223-69bb-469e-92d4-4c12a92b3742&quot;,&quot;95a70ce5-8cc3-4ae6-92db-abcd606fa3be&quot;,&quot;99eb82ce-cc59-4373-89fb-411f27f28241&quot;,&quot;15135a4a-b462-4f58-9f90-a01724bcb4c6&quot;,&quot;01778b5f-586f-4302-9aff-9f73f252c0b9&quot;,&quot;f6501270-d0ed-4764-806f-756025f5ac89&quot;,&quot;a62fe36d-1774-40c0-809b-4b97d11c405e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:565,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5276cce4-1f55-48e2-b110-87b042d578e8&quot;,&quot;title&quot;:&quot;stage&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\stage.js&quot;,&quot;file&quot;:&quot;\\test\\features\\stage.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic&quot;,&quot;fullTitle&quot;:&quot;stage basic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const passwordSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.password(&#x27;password&#x27;)\n)\nconst setup = await mfkdf.setup.key([passwordSetup])\nconst passwordDerive = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.password(&#x27;password&#x27;),\n  setup.policy.factors[0].params\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: passwordDerive\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4679720b-7597-40bb-90ed-3252cd621281&quot;,&quot;parentUUID&quot;:&quot;5276cce4-1f55-48e2-b110-87b042d578e8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;stage full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:576,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst init = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst passwordSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.password(&#x27;password&#x27;),\n  init.key\n)\nconst hmacsha1Setup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.hmacsha1(),\n  init.key\n)\nconst hotpSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;) }),\n  init.key\n)\nconst oobaSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.ooba({ key: keyPair.publicKey, params: {} }),\n  init.key\n)\nconst questionSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.question(&#x27;fido&#x27;),\n  init.key\n)\nconst totpSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  }),\n  init.key\n)\nconst uuidSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  }),\n  init.key\n)\nconst setup = await mfkdf.setup.key([\n  passwordSetup,\n  hmacsha1Setup,\n  hotpSetup,\n  oobaSetup,\n  questionSetup,\n  totpSetup,\n  uuidSetup\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[1].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\nconst next = setup.policy.factors[3].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst json = JSON.parse(Buffer.from(decrypted).toString())\nconst code = json.code\nconst password = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.password(&#x27;password&#x27;),\n  setup.policy.factors[0].params,\n  setup.key\n)\nconst hmacsha1 = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.hmacsha1(response),\n  setup.policy.factors[1].params,\n  setup.key\n)\nconst hotp = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.hotp(241063),\n  setup.policy.factors[2].params,\n  setup.key\n)\nconst ooba = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.ooba(code),\n  setup.policy.factors[3].params,\n  setup.key\n)\nconst question = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.question(&#x27;fido&#x27;),\n  setup.policy.factors[4].params,\n  setup.key\n)\nconst totp = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.totp(953265, { time: 1 }),\n  setup.policy.factors[5].params,\n  setup.key\n)\nconst uuid = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  setup.policy.factors[6].params,\n  setup.key\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password,\n  hmacsha1,\n  hotp,\n  ooba,\n  question,\n  totp,\n  uuid\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3de57c3f-4c8d-46f0-84df-54087a22a9f1&quot;,&quot;parentUUID&quot;:&quot;5276cce4-1f55-48e2-b110-87b042d578e8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4679720b-7597-40bb-90ed-3252cd621281&quot;,&quot;3de57c3f-4c8d-46f0-84df-54087a22a9f1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:625,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;82af0908-a4c0-48d9-8eed-d8526a38aede&quot;,&quot;title&quot;:&quot;mfkdf2/changes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a97e3150-ae58-44ee-aeb2-5605682d297f&quot;,&quot;title&quot;:&quot;key-size-256&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes key-size-256 default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f88eede-0216-43f8-971f-c43651170d4f&quot;,&quot;parentUUID&quot;:&quot;a97e3150-ae58-44ee-aeb2-5605682d297f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes key-size-256 override&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b252f78a-0d41-473e-aca1-d1e60c6686b0&quot;,&quot;parentUUID&quot;:&quot;a97e3150-ae58-44ee-aeb2-5605682d297f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8f88eede-0216-43f8-971f-c43651170d4f&quot;,&quot;b252f78a-0d41-473e-aca1-d1e60c6686b0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:89,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;707fd2a1-292b-4f16-99a3-f70448d62811&quot;,&quot;title&quot;:&quot;kdf-argon2id&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74954861-eafc-4b52-8f75-dd424cc40205&quot;,&quot;parentUUID&quot;:&quot;707fd2a1-292b-4f16-99a3-f70448d62811&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/mismatch/time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/mismatch/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:154,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 3 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nsetup.policy.time = 4\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12fa90bb-1f95-44d9-88b5-76b0c7b4f9b4&quot;,&quot;parentUUID&quot;:&quot;707fd2a1-292b-4f16-99a3-f70448d62811&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/mismatch/memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/mismatch/memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:74,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 1024 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nsetup.policy.memory = 2048\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52fb9668-3a59-4d36-aae8-67bc88ad3d94&quot;,&quot;parentUUID&quot;:&quot;707fd2a1-292b-4f16-99a3-f70448d62811&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/matching&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/matching&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:442,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 65536, time: 3 }\n)\nsetup.policy.memory.should.equal(65536)\nsetup.policy.time.should.equal(3)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8608ecdd-1c9b-46b5-ad81-d90f5f68b87e&quot;,&quot;parentUUID&quot;:&quot;707fd2a1-292b-4f16-99a3-f70448d62811&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;74954861-eafc-4b52-8f75-dd424cc40205&quot;,&quot;12fa90bb-1f95-44d9-88b5-76b0c7b4f9b4&quot;,&quot;52fb9668-3a59-4d36-aae8-67bc88ad3d94&quot;,&quot;8608ecdd-1c9b-46b5-ad81-d90f5f68b87e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:716,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ba1fb44e-2240-4d77-91f3-29ed182b2869&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;aes-256-ecb&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes encryption aes-256-ecb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const stretched = await crypto.randomBytes(32)\nconst share = await crypto.randomBytes(32)\nconst cipher = crypto.createCipheriv(&#x27;AES-256-ECB&#x27;, stretched, null)\ncipher.setAutoPadding(false)\nconst pad = Buffer.concat([cipher.update(share), cipher.final()])\nconst decipher = crypto.createDecipheriv(&#x27;AES-256-ECB&#x27;, stretched, null)\ndecipher.setAutoPadding(false)\nconst share2 = Buffer.concat([decipher.update(pad), decipher.final()])\nshare2.toString(&#x27;hex&#x27;).should.equal(share.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bbab4b39-324a-4e14-afdf-2e5cf8b67ce6&quot;,&quot;parentUUID&quot;:&quot;ba1fb44e-2240-4d77-91f3-29ed182b2869&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bbab4b39-324a-4e14-afdf-2e5cf8b67ce6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;02ff481f-1fc0-4589-abf0-9c2c6c466f47&quot;,&quot;title&quot;:&quot;mfkdf2/hints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\hints.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\hints.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getHint&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints getHint&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:73,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst hint = setup.getHint(&#x27;password1&#x27;, 7)\nhint.should.be.a(&#x27;string&#x27;)\nhint.length.should.equal(7)\nconst hinta = setup.getHint(&#x27;password1&#x27;, 24)\nhinta.should.be.a(&#x27;string&#x27;)\nhinta.length.should.equal(24)\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst hint2 = derived.getHint(&#x27;password1&#x27;, 7)\nhint2.should.equal(hint)\nconst hinta2 = derived.getHint(&#x27;password1&#x27;, 24)\nhinta2.should.equal(hinta)\nconst derived2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;wrongpassword&#x27;)\n  },\n  false\n)\nconst hinta3 = derived2.getHint(&#x27;password1&#x27;, 24)\nhinta3.should.not.equal(hinta)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;413e4180-ec8d-450e-80ea-1404587d3c4c&quot;,&quot;parentUUID&quot;:&quot;02ff481f-1fc0-4589-abf0-9c2c6c466f47&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addHint&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints addHint&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  {\n    integrity: false\n  }\n)\nsetup.addHint(&#x27;password1&#x27;)\nsetup.policy.factors[0].hint.should.be.a(&#x27;string&#x27;)\nsetup.policy.factors[0].hint.length.should.equal(7)\nsetup.addHint(&#x27;password1&#x27;, 24)\nsetup.policy.factors[0].hint.should.be.a(&#x27;string&#x27;)\nsetup.policy.factors[0].hint.length.should.equal(24)\nawait mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    false\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;51629a46-8f2a-4dfa-b5b6-c4c6125cbdff&quot;,&quot;parentUUID&quot;:&quot;02ff481f-1fc0-4589-abf0-9c2c6c466f47&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;coverage&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints coverage&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  {\n    integrity: false\n  }\n);\n(() =&gt; setup.getHint()).should.throw(TypeError);\n(() =&gt; setup.getHint(123)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;unknown&#x27;)).should.throw(RangeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, &#x27;string&#x27;)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, 0)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, 300)).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55f3d8ea-bf17-43d7-9c03-791786e73301&quot;,&quot;parentUUID&quot;:&quot;02ff481f-1fc0-4589-abf0-9c2c6c466f47&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;413e4180-ec8d-450e-80ea-1404587d3c4c&quot;,&quot;51629a46-8f2a-4dfa-b5b6-c4c6125cbdff&quot;,&quot;55f3d8ea-bf17-43d7-9c03-791786e73301&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:145,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e77777fb-ca0a-48a3-a216-7c9e22e27220&quot;,&quot;title&quot;:&quot;mfkdf2/mfdpg2&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a37b226a-bb5d-4fd9-87fc-064fa4cf4ffa&quot;,&quot;title&quot;:&quot;basics&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;portability&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 basics portability&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password = setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.length.should.be.above(5)\npassword.length.should.be.below(11);\n/[a-zA-Z]{6,10}/.test(password).should.be.true\nconst password2 = setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.should.equal(password2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst password3 = derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.should.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8017b626-997f-4b16-b967-9c780f16f28b&quot;,&quot;parentUUID&quot;:&quot;a37b226a-bb5d-4fd9-87fc-064fa4cf4ffa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-example&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 basics full-example&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst policy = /([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*/\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  policy\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password3 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  policy\n)\npassword1.should.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ccd49fde-b510-4f1a-8a2c-1f48b4d9900c&quot;,&quot;parentUUID&quot;:&quot;a37b226a-bb5d-4fd9-87fc-064fa4cf4ffa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8017b626-997f-4b16-b967-9c780f16f28b&quot;,&quot;ccd49fde-b510-4f1a-8a2c-1f48b4d9900c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:102,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;961aaa02-e4f9-4cd7-9688-e634aee50189&quot;,&quot;title&quot;:&quot;correctness&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 correctness basic-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst password2 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af994576-42fc-4dd5-ae9b-a06564cede6b&quot;,&quot;parentUUID&quot;:&quot;961aaa02-e4f9-4cd7-9688-e634aee50189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 correctness full-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password2 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;326e8d77-dc82-49cc-9b14-f8a8947ab88f&quot;,&quot;parentUUID&quot;:&quot;961aaa02-e4f9-4cd7-9688-e634aee50189&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;af994576-42fc-4dd5-ae9b-a06564cede6b&quot;,&quot;326e8d77-dc82-49cc-9b14-f8a8947ab88f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:70,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;26dc4671-deaf-47de-b7e9-b7283a619243&quot;,&quot;title&quot;:&quot;safety&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 safety basic-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:41,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst setup2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup1.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst password2 = await setup2.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.not.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f38919d-65f9-439d-b0be-111db5d22e8c&quot;,&quot;parentUUID&quot;:&quot;26dc4671-deaf-47de-b7e9-b7283a619243&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 safety full-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password2 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nconst password3 = await derive2.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.not.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;830c6c12-ea41-4d73-bc45-a4a0b8eda94d&quot;,&quot;parentUUID&quot;:&quot;26dc4671-deaf-47de-b7e9-b7283a619243&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9f38919d-65f9-439d-b0be-111db5d22e8c&quot;,&quot;830c6c12-ea41-4d73-bc45-a4a0b8eda94d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:117,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;460cfaf3-9a91-4d04-bf3e-5aa4de681adb&quot;,&quot;title&quot;:&quot;compatibility&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-policy&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 compatibility basic-policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.length.should.be.above(5)\npassword.length.should.be.below(11)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1a0ee4c-0825-451e-a728-a039d9a336e1&quot;,&quot;parentUUID&quot;:&quot;460cfaf3-9a91-4d04-bf3e-5aa4de681adb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;custom-policy&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 compatibility custom-policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst regex = /([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*/\nconst password = await setup.derivePassword(&#x27;example.com&#x27;, &#x27;salt&#x27;, regex)\nregex.test(password).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d77ebc4-ca92-4240-9983-e110f50c11fa&quot;,&quot;parentUUID&quot;:&quot;460cfaf3-9a91-4d04-bf3e-5aa4de681adb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c1a0ee4c-0825-451e-a728-a039d9a336e1&quot;,&quot;1d77ebc4-ca92-4240-9983-e110f50c11fa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;84f51385-73b9-4b9c-95cb-34595d79dab8&quot;,&quot;title&quot;:&quot;mfkdf2/passkeys&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\passkeys.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\passkeys.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;liveness&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys liveness&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const prf = await crypto.randomBytes(32)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.passkey(prf)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  passkey: mfkdf.derive.factors.passkey(prf)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;34b8936b-ec9b-4c38-b3de-53fc71620add&quot;,&quot;parentUUID&quot;:&quot;84f51385-73b9-4b9c-95cb-34595d79dab8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;safety&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys safety&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const prf = await crypto.randomBytes(32)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.passkey(prf)\n])\nconst prf2 = await crypto.randomBytes(32)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    passkey: mfkdf.derive.factors.passkey(prf2)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bbb6510f-3132-4ae1-aeea-b998a3fc53c5&quot;,&quot;parentUUID&quot;:&quot;84f51385-73b9-4b9c-95cb-34595d79dab8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;coverage&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys coverage&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .passkey(&#x27;hello&#x27;)\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .passkey(crypto.randomBytes(32), { id: 123 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .passkey(crypto.randomBytes(32), { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .passkey(Buffer.from(&#x27;hello&#x27;))\n  .should.be.rejectedWith(RangeError);\n(() =&gt; {\n  mfkdf.derive.factors.passkey(&#x27;hello&#x27;)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.passkey(Buffer.from(&#x27;hello&#x27;))\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76da9cad-a9d3-4fea-9ad7-815582c20e7e&quot;,&quot;parentUUID&quot;:&quot;84f51385-73b9-4b9c-95cb-34595d79dab8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;34b8936b-ec9b-4c38-b3de-53fc71620add&quot;,&quot;bbb6510f-3132-4ae1-aeea-b998a3fc53c5&quot;,&quot;76da9cad-a9d3-4fea-9ad7-815582c20e7e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:93,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;77266af8-fbba-4045-9f63-f610aacbc3ca&quot;,&quot;title&quot;:&quot;mfkdf2/security&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:381,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst recover = xor(\n  Buffer.from(setup.policy.factors[0].params.pad, &#x27;base64&#x27;),\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n).toString(&#x27;hex&#x27;)\nconst key = setup.key.toString(&#x27;hex&#x27;).slice(0, recover.length)\nrecover.should.not.equal(key)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bbac158b-6284-44c7-8bfa-a72264db8153&quot;,&quot;parentUUID&quot;:&quot;77266af8-fbba-4045-9f63-f610aacbc3ca&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;eaab00ce-7a55-4cbb-aabd-c062d3a0b629&quot;,&quot;title&quot;:&quot;factor-fungibility&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-fungibility correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6dc118c4-258c-40db-a4aa-077eb28f1f4c&quot;,&quot;parentUUID&quot;:&quot;eaab00ce-7a55-4cbb-aabd-c062d3a0b629&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-fungibility incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  )\n)\nconst derive = await mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4171ee0a-6d4c-403c-9a4f-f3a9154ee5b6&quot;,&quot;parentUUID&quot;:&quot;eaab00ce-7a55-4cbb-aabd-c062d3a0b629&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6dc118c4-258c-40db-a4aa-077eb28f1f4c&quot;,&quot;4171ee0a-6d4c-403c-9a4f-f3a9154ee5b6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:103,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8327aa66-8a84-4c54-8670-01931d6d87f9&quot;,&quot;title&quot;:&quot;share-indistinguishability&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;share-size&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security share-indistinguishability share-size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const secret = crypto.randomBytes(32)\nconst shares1 = mfkdf.secrets.share(secret, 1, 3)\nshares1.should.have.length(3)\nfor (const share of shares1) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares1.slice(0, 1).concat([null, null]), 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nmfkdf.secrets\n  .combine([null, null].concat(shares1.slice(2, 3)), 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nconst shares2 = mfkdf.secrets.share(secret, 2, 3)\nshares2.should.have.length(3)\nfor (const share of shares2) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares2.slice(0, 2).concat([null]), 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nmfkdf.secrets\n  .combine([null].concat(shares2.slice(1, 3)), 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nconst shares3 = mfkdf.secrets.share(secret, 3, 3)\nshares3.should.have.length(3)\nfor (const share of shares3) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares3.slice(0, 3), 3, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79978387-0845-41e8-a7f4-993080e06182&quot;,&quot;parentUUID&quot;:&quot;8327aa66-8a84-4c54-8670-01931d6d87f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;79978387-0845-41e8-a7f4-993080e06182&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;27746588-6ae4-4eb2-8b00-859ce70ec0e4&quot;,&quot;title&quot;:&quot;share-encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security share-encryption correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:130,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst materialp1 = await mfkdf.derive.factors.password(&#x27;password1&#x27;)(\n  setup.policy.factors[0].params\n)\nconst padp1 = Buffer.from(setup.policy.factors[0].pad, &#x27;base64&#x27;)\nconst stretchedp1 = Buffer.from(\n  hkdfSync(\n    &#x27;sha256&#x27;,\n    materialp1.data,\n    setup.policy.factors[0].salt,\n    &#x27;&#x27;,\n    32\n  )\n)\nconst sharep1 = xor(padp1, stretchedp1)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword1&#x27;, { id: &#x27;password1&#x27; })\n)\nconst derive2f = await mfkdf.policy.derive(\n  derive.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nderive2f.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;newPassword1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst materialp3 = await mfkdf.derive.factors.password(&#x27;newPassword1&#x27;)(\n  derive.policy.factors[0].params\n)\nconst padp3 = Buffer.from(derive.policy.factors[0].pad, &#x27;base64&#x27;)\nconst stretchedp3 = Buffer.from(\n  hkdfSync(\n    &#x27;sha256&#x27;,\n    materialp3.data,\n    derive.policy.factors[0].salt,\n    &#x27;&#x27;,\n    32\n  )\n)\nconst sharep3 = xor(padp3, stretchedp3)\nawait derive2.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password1&#x27; })\n)\nconst derive3 = await mfkdf.policy.derive(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsharep1.should.not.equal(sharep3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c6bfdf62-abf5-43c9-913d-502e08073a32&quot;,&quot;parentUUID&quot;:&quot;27746588-6ae4-4eb2-8b00-859ce70ec0e4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c6bfdf62-abf5-43c9-913d-502e08073a32&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:130,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1203a3da-1b68-4a32-835b-60d559d33371&quot;,&quot;title&quot;:&quot;factor-secret-encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-secret-encryption hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\nconst recover = xor(\n  Buffer.from(setup.policy.factors[0].params.pad, &#x27;base64&#x27;),\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n).toString(&#x27;hex&#x27;)\nconst key = setup.key.toString(&#x27;hex&#x27;).slice(0, recover.length)\nrecover.should.not.equal(key)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;61c99893-ec0e-4684-8317-b9ed97eb8d6b&quot;,&quot;parentUUID&quot;:&quot;1203a3da-1b68-4a32-835b-60d559d33371&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;61c99893-ec0e-4684-8317-b9ed97eb8d6b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:48,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;22c9cd89-3b38-47b7-9f43-f1c719919d02&quot;,&quot;title&quot;:&quot;timing-oracle&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b291e43c-0e53-4f4e-83a5-e152a9d4af39&quot;,&quot;title&quot;:&quot;totp/dynamic&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;no-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic no-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:439,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.totp()])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba94c24e-5bb6-46da-acfc-0e33a07104b0&quot;,&quot;parentUUID&quot;:&quot;b291e43c-0e53-4f4e-83a5-e152a9d4af39&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic valid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:518,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9486abd9-7af0-488e-be47-fd1e65e58467&quot;,&quot;parentUUID&quot;:&quot;b291e43c-0e53-4f4e-83a5-e152a9d4af39&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic invalid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:556,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst oracle2 = {}\ndate = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive2.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;be348499-1cd9-4ee5-aa74-f4c81e186a9c&quot;,&quot;parentUUID&quot;:&quot;b291e43c-0e53-4f4e-83a5-e152a9d4af39&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic valid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:513,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;def2052e-5e26-4f2e-940f-2d90900823d7&quot;,&quot;parentUUID&quot;:&quot;b291e43c-0e53-4f4e-83a5-e152a9d4af39&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic invalid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:550,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst oracle2 = {}\ndate = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive2.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;80d7ff8b-365c-403b-ac5e-2da5899356a8&quot;,&quot;parentUUID&quot;:&quot;b291e43c-0e53-4f4e-83a5-e152a9d4af39&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ba94c24e-5bb6-46da-acfc-0e33a07104b0&quot;,&quot;9486abd9-7af0-488e-be47-fd1e65e58467&quot;,&quot;be348499-1cd9-4ee5-aa74-f4c81e186a9c&quot;,&quot;def2052e-5e26-4f2e-940f-2d90900823d7&quot;,&quot;80d7ff8b-365c-403b-ac5e-2da5899356a8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2576,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;972742b5-6a3d-4f51-b49f-febfac0a93aa&quot;,&quot;title&quot;:&quot;totp/static&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;no-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static no-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:443,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, { time: 30001 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, { time: 60001 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e141e739-08f9-4eba-8743-6d434dce2b6e&quot;,&quot;parentUUID&quot;:&quot;972742b5-6a3d-4f51-b49f-febfac0a93aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static valid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:469,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, {\n    time: 1,\n    oracle\n  })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, {\n    time: 30001,\n    oracle\n  })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, {\n    time: 60001,\n    oracle\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32a0d76b-f6f5-4978-9cc9-19cbc28cb31f&quot;,&quot;parentUUID&quot;:&quot;972742b5-6a3d-4f51-b49f-febfac0a93aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static invalid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:540,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst oracle2 = {}\ndate = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(528258, {\n      time: 1650430943604,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(99922, {\n      time: 1650430991083,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(398884, {\n      time: 1650431018392,\n      oracle: oracle2\n    })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44e078ab-6ffb-449e-9911-739c6def84d9&quot;,&quot;parentUUID&quot;:&quot;972742b5-6a3d-4f51-b49f-febfac0a93aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static valid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:468,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, {\n    time: 1,\n    oracle\n  })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, {\n    time: 30001,\n    oracle\n  })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, {\n    time: 60001,\n    oracle\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abb6193b-88d6-4166-afa0-39afde8c4dd0&quot;,&quot;parentUUID&quot;:&quot;972742b5-6a3d-4f51-b49f-febfac0a93aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static invalid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:538,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst oracle2 = {}\ndate = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(528258, {\n      time: 1650430943604,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(99922, {\n      time: 1650430991083,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(398884, {\n      time: 1650431018392,\n      oracle: oracle2\n    })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b0bee2a-e0b9-4870-89bf-45bc8c3ec7ac&quot;,&quot;parentUUID&quot;:&quot;972742b5-6a3d-4f51-b49f-febfac0a93aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e141e739-08f9-4eba-8743-6d434dce2b6e&quot;,&quot;32a0d76b-f6f5-4978-9cc9-19cbc28cb31f&quot;,&quot;44e078ab-6ffb-449e-9911-739c6def84d9&quot;,&quot;abb6193b-88d6-4166-afa0-39afde8c4dd0&quot;,&quot;0b0bee2a-e0b9-4870-89bf-45bc8c3ec7ac&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2458,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;21b91c13-16a9-4ebc-a31d-8b979d8c556a&quot;,&quot;title&quot;:&quot;policy-integrity&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security policy-integrity correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6e91407-8341-4ea7-b26d-5accfd5a236d&quot;,&quot;parentUUID&quot;:&quot;21b91c13-16a9-4ebc-a31d-8b979d8c556a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/$id&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security policy-integrity invalid/$id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nsetup.policy.$id = &#x27;invalid-id&#x27;\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    {},\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c1641d4-d8d7-478e-a09b-8b13794656af&quot;,&quot;parentUUID&quot;:&quot;21b91c13-16a9-4ebc-a31d-8b979d8c556a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a6e91407-8341-4ea7-b26d-5accfd5a236d&quot;,&quot;1c1641d4-d8d7-478e-a09b-8b13794656af&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:82,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;bbac158b-6284-44c7-8bfa-a72264db8153&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:381,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;12459996-ec7c-4658-9037-5ef8336e5f64&quot;,&quot;title&quot;:&quot;mfkdf2/strengthening&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;strengthening-throws&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-throws&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nawait derive\n  .strenthen(-1, 0)\n  .should.be.rejectedWith(TypeError, &#x27;time must be a non-negative integer&#x27;)\nawait derive\n  .strenthen(1.5, 0)\n  .should.be.rejectedWith(TypeError, &#x27;time must be a non-negative integer&#x27;)\nawait derive\n  .strenthen(0, -1)\n  .should.be.rejectedWith(\n    TypeError,\n    &#x27;memory must be a non-negative integer&#x27;\n  )\nawait derive\n  .strenthen(0, 1.5)\n  .should.be.rejectedWith(\n    TypeError,\n    &#x27;memory must be a non-negative integer&#x27;\n  )&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8dbdad04-4b0f-4bee-a6e1-70ffdfc77b1d&quot;,&quot;parentUUID&quot;:&quot;12459996-ec7c-4658-9037-5ef8336e5f64&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-works-multiple-times&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-works-multiple-times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:391,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive.policy.time = 0\nderive.policy.memory = 0\nawait mfkdf.derive\n  .key(derive.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(Error)\nawait derive2.strenthen(3, 16384)\nderive2.policy.time.should.equal(3)\nderive2.policy.memory.should.equal(16384)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive3.policy.time.should.equal(3)\nderive3.policy.memory.should.equal(16384)\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.policy.time = 0\nderive2.policy.memory = 0\nawait mfkdf.derive\n  .key(derive2.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(Error)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;66ef8d2c-c09e-4e69-a32b-456b3e636129&quot;,&quot;parentUUID&quot;:&quot;12459996-ec7c-4658-9037-5ef8336e5f64&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-with-other-factors&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-with-other-factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:204,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n    id: &#x27;password2&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive2.strenthen()\nderive2.policy.time.should.equal(0)\nderive2.policy.memory.should.equal(0)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive3.policy.time.should.equal(0)\nderive3.policy.memory.should.equal(0)\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e122af1e-87df-47d1-946f-7d93da9f5667&quot;,&quot;parentUUID&quot;:&quot;12459996-ec7c-4658-9037-5ef8336e5f64&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-with-reconstitution&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-with-reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:160,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n    id: &#x27;password2&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nawait derive.setThreshold(1)\nawait derive.removeFactor(&#x27;password2&#x27;)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2eb378e4-dc52-45ed-b32b-bed233a75367&quot;,&quot;parentUUID&quot;:&quot;12459996-ec7c-4658-9037-5ef8336e5f64&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0650966e-bf7f-45e4-8b84-7a46ecc3e3b3&quot;,&quot;title&quot;:&quot;setup&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:134,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 5 }\n)\nsetup.policy.time.should.equal(5)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(5)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a33dec0-b5e3-4bb4-a9f9-e016c580c671&quot;,&quot;parentUUID&quot;:&quot;0650966e-bf7f-45e4-8b84-7a46ecc3e3b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:125,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 32768 }\n)\nsetup.policy.memory.should.equal(32768)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.memory.should.equal(32768)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e91f5efe-0a2f-4844-b94d-35d90c1a37b4&quot;,&quot;parentUUID&quot;:&quot;0650966e-bf7f-45e4-8b84-7a46ecc3e3b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time-and-memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup time-and-memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:183,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 3, memory: 16384 }\n)\nsetup.policy.time.should.equal(3)\nsetup.policy.memory.should.equal(16384)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(3)\nderive.policy.memory.should.equal(16384)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b5c3876-3838-4b27-af0b-60aa238d0110&quot;,&quot;parentUUID&quot;:&quot;0650966e-bf7f-45e4-8b84-7a46ecc3e3b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;throws&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup throws&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { time: -1 }\n  )\n  .should.be.rejectedWith(RangeError, &#x27;time must be non-negative&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { time: 1.5 }\n  )\n  .should.be.rejectedWith(TypeError, &#x27;time must be an integer&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { memory: -1 }\n  )\n  .should.be.rejectedWith(RangeError, &#x27;memory must be non-negative&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { memory: 1.5 }\n  )\n  .should.be.rejectedWith(TypeError, &#x27;memory must be an integer&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;852d934d-454b-41e3-998c-860767d406bf&quot;,&quot;parentUUID&quot;:&quot;0650966e-bf7f-45e4-8b84-7a46ecc3e3b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6a33dec0-b5e3-4bb4-a9f9-e016c580c671&quot;,&quot;e91f5efe-0a2f-4844-b94d-35d90c1a37b4&quot;,&quot;0b5c3876-3838-4b27-af0b-60aa238d0110&quot;,&quot;852d934d-454b-41e3-998c-860767d406bf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:443,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5a80a0fc-53a0-4add-97e0-4ff2ce65f080&quot;,&quot;title&quot;:&quot;strengthening&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:178,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.time.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(5, 0)\nderive.policy.time.should.equal(5)\nderive.policy.memory.should.equal(0)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(5)\nderive2.policy.memory.should.equal(0)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13b4653f-c591-492e-b019-d36003daf4b1&quot;,&quot;parentUUID&quot;:&quot;5a80a0fc-53a0-4add-97e0-4ff2ce65f080&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:167,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.memory.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.memory.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(0, 32768)\nderive.policy.time.should.equal(0)\nderive.policy.memory.should.equal(32768)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(0)\nderive2.policy.memory.should.equal(32768)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cdd3b8f7-bf0b-4439-a022-682dc53e2488&quot;,&quot;parentUUID&quot;:&quot;5a80a0fc-53a0-4add-97e0-4ff2ce65f080&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time-and-memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening time-and-memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:231,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.time.should.equal(0)\nsetup.policy.memory.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(0)\nderive.policy.memory.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(3, 16384)\nderive.policy.time.should.equal(3)\nderive.policy.memory.should.equal(16384)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(3)\nderive2.policy.memory.should.equal(16384)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b9263bf1-5d7a-44dd-ba02-37ff14e2c9ec&quot;,&quot;parentUUID&quot;:&quot;5a80a0fc-53a0-4add-97e0-4ff2ce65f080&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13b4653f-c591-492e-b019-d36003daf4b1&quot;,&quot;cdd3b8f7-bf0b-4439-a022-682dc53e2488&quot;,&quot;b9263bf1-5d7a-44dd-ba02-37ff14e2c9ec&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:576,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;8dbdad04-4b0f-4bee-a6e1-70ffdfc77b1d&quot;,&quot;66ef8d2c-c09e-4e69-a32b-456b3e636129&quot;,&quot;e122af1e-87df-47d1-946f-7d93da9f5667&quot;,&quot;2eb378e4-dc52-45ed-b32b-bed233a75367&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:805,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;04657cdc-0b8f-4fcb-946e-428eb04e92fc&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;763aa793-6fc5-4ac1-8519-a9bdece0c6c0&quot;,&quot;parentUUID&quot;:&quot;04657cdc-0b8f-4fcb-946e-428eb04e92fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;587cf7dd-b95f-42d3-adcf-a2c2af81ef64&quot;,&quot;parentUUID&quot;:&quot;04657cdc-0b8f-4fcb-946e-428eb04e92fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e8889d1e-265d-4e34-bb3e-210a9f40a032&quot;,&quot;parentUUID&quot;:&quot;04657cdc-0b8f-4fcb-946e-428eb04e92fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;763aa793-6fc5-4ac1-8519-a9bdece0c6c0&quot;,&quot;587cf7dd-b95f-42d3-adcf-a2c2af81ef64&quot;,&quot;e8889d1e-265d-4e34-bb3e-210a9f40a032&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d60493f-dd55-4a9e-b79f-5700b012f629&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine(\n  [shares[0], shares[1], shares[2]],\n  1,\n  5\n)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64ff1d28-cf12-4183-909a-9d2af93fd067&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine(\n  [shares[0], shares[1], shares[2]],\n  2,\n  3\n)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;82e7aa08-d010-4159-a6f7-aeb4435c0601&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;),\n  5,\n  255\n)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ecbd43a-8c07-4f10-8240-7691085a4753&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;),\n  5,\n  255\n)\nshares.should.be.an(&#x27;array&#x27;).of.length(255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 250; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 255)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[251] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0cac610-2a75-4fee-ac90-e2fcafa915e6&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d045a06-af8a-45d0-87d0-69a186e0736f&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1504b29d-d7c0-4399-81a3-01b789fc9fff&quot;,&quot;parentUUID&quot;:&quot;dc6cf7af-4a14-453e-ab59-7c4e3c321e78&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6d60493f-dd55-4a9e-b79f-5700b012f629&quot;,&quot;64ff1d28-cf12-4183-909a-9d2af93fd067&quot;,&quot;82e7aa08-d010-4159-a6f7-aeb4435c0601&quot;,&quot;8ecbd43a-8c07-4f10-8240-7691085a4753&quot;,&quot;e0cac610-2a75-4fee-ac90-e2fcafa915e6&quot;,&quot;6d045a06-af8a-45d0-87d0-69a186e0736f&quot;,&quot;1504b29d-d7c0-4399-81a3-01b789fc9fff&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6d9241d5-1d06-4156-b735-8e93106f3abe&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\new.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\new.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;share-size&quot;,&quot;fullTitle&quot;:&quot;secrets share-size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let secret = crypto.randomBytes(32)\nlet shares = mfkdf.secrets.share(secret, 1, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[0].should.equal(secret)\nshares[1].length.should.equal(32)\nshares[1].should.equal(secret)\nshares[2].length.should.equal(32)\nshares[2].should.equal(secret)\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[1] = null\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[2] = null\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nsecret = crypto.randomBytes(32)\nshares = mfkdf.secrets.share(secret, 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[1].length.should.equal(32)\nshares[2].length.should.equal(32)\nmfkdf.secrets\n  .combine(shares, 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[1] = null\nmfkdf.secrets\n  .combine(shares, 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nsecret = crypto.randomBytes(32)\nshares = mfkdf.secrets.share(secret, 3, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[1].length.should.equal(32)\nshares[2].length.should.equal(32)\nmfkdf.secrets\n  .combine(shares, 3, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;081e667c-f85b-4f7a-9810-4e48625bad21&quot;,&quot;parentUUID&quot;:&quot;6d9241d5-1d06-4156-b735-8e93106f3abe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;081e667c-f85b-4f7a-9810-4e48625bad21&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f662b90d-87b2-4eda-a585-0ac7ed66e237&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d6f09e10-6a6a-47b7-94ef-897904a61585&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3acac63d-9f42-453c-ab22-bc01d3d00534&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff21c6de-6c2e-4185-8833-3c7423e28f37&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f414d75-dc67-446d-be87-3c3439911365&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;615a0b14-9dc3-4c83-9e50-7bba89f8b984&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ebe19a8d-2f14-46c0-84b1-adef9fc9f295&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;87c8603a-8710-4f81-a96f-f85bb96baef4&quot;,&quot;parentUUID&quot;:&quot;9cc30414-7847-4103-b974-461c13fecd2d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f662b90d-87b2-4eda-a585-0ac7ed66e237&quot;,&quot;d6f09e10-6a6a-47b7-94ef-897904a61585&quot;,&quot;3acac63d-9f42-453c-ab22-bc01d3d00534&quot;,&quot;ff21c6de-6c2e-4185-8833-3c7423e28f37&quot;,&quot;8f414d75-dc67-446d-be87-3c3439911365&quot;,&quot;615a0b14-9dc3-4c83-9e50-7bba89f8b984&quot;,&quot;ebe19a8d-2f14-46c0-84b1-adef9fc9f295&quot;,&quot;87c8603a-8710-4f81-a96f-f85bb96baef4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5cd2e7f4-e0dc-480f-ac74-71a90c04655b&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bcf3268b-545c-4333-a2ed-f5c6370355aa&quot;,&quot;parentUUID&quot;:&quot;5cd2e7f4-e0dc-480f-ac74-71a90c04655b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;633083dc-cd13-47c9-b5cc-6af0f2fa2d06&quot;,&quot;parentUUID&quot;:&quot;5cd2e7f4-e0dc-480f-ac74-71a90c04655b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;717a4ff7-e0b2-44cb-9d19-2f72ba11455e&quot;,&quot;parentUUID&quot;:&quot;5cd2e7f4-e0dc-480f-ac74-71a90c04655b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bcf3268b-545c-4333-a2ed-f5c6370355aa&quot;,&quot;633083dc-cd13-47c9-b5cc-6af0f2fa2d06&quot;,&quot;717a4ff7-e0b2-44cb-9d19-2f72ba11455e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;07c4cb0a-d4f1-4d43-bad6-5a26c915b20e&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .password(&#x27;password&#x27;, { id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24d97c07-f2a7-429f-bc3a-6a472bb5598b&quot;,&quot;parentUUID&quot;:&quot;07c4cb0a-d4f1-4d43-bad6-5a26c915b20e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .password(&#x27;password&#x27;, { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a52025a-923e-4e91-8138-01e6988b1f74&quot;,&quot;parentUUID&quot;:&quot;07c4cb0a-d4f1-4d43-bad6-5a26c915b20e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e56dc2e-d85f-4463-bafe-dfbcd3aa7792&quot;,&quot;parentUUID&quot;:&quot;07c4cb0a-d4f1-4d43-bad6-5a26c915b20e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;24d97c07-f2a7-429f-bc3a-6a472bb5598b&quot;,&quot;7a52025a-923e-4e91-8138-01e6988b1f74&quot;,&quot;0e56dc2e-d85f-4463-bafe-dfbcd3aa7792&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5911cbf9-4cf4-4b71-ba13-dbbc805d482d&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .uuid({ uuid: 12345 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .uuid({ uuid: &#x27;hello&#x27; })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .uuid({ id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b9023e5-0f11-404c-b8d1-121eded321b6&quot;,&quot;parentUUID&quot;:&quot;5911cbf9-4cf4-4b71-ba13-dbbc805d482d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .uuid({ id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fbb2eea4-e431-4e43-b873-8a71a8b3c7da&quot;,&quot;parentUUID&quot;:&quot;5911cbf9-4cf4-4b71-ba13-dbbc805d482d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({\n  uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data\n  .toString(&#x27;hex&#x27;)\n  .should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7490e44d-c554-408f-af36-62c6ce66d457&quot;,&quot;parentUUID&quot;:&quot;5911cbf9-4cf4-4b71-ba13-dbbc805d482d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee6b26bc-d594-4f63-825f-11f12e91927a&quot;,&quot;parentUUID&quot;:&quot;5911cbf9-4cf4-4b71-ba13-dbbc805d482d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1b9023e5-0f11-404c-b8d1-121eded321b6&quot;,&quot;fbb2eea4-e431-4e43-b873-8a71a8b3c7da&quot;,&quot;7490e44d-c554-408f-af36-62c6ce66d457&quot;,&quot;ee6b26bc-d594-4f63-825f-11f12e91927a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b418ff22-4de0-45bd-a27c-adaaa7410b67&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:26,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d97b0c90-9045-4611-ba70-09924102b38b&quot;,&quot;parentUUID&quot;:&quot;b418ff22-4de0-45bd-a27c-adaaa7410b67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4520d400-cfff-494b-9fc2-8ace38df5526&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;241a7ccc-acb1-4682-a098-769d1e1959fe&quot;,&quot;parentUUID&quot;:&quot;4520d400-cfff-494b-9fc2-8ace38df5526&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [await mfkdf.setup.factors.password(&#x27;hello&#x27;)],\n  { id: &#x27;hello-world&#x27; }\n)\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19d98271-a6cf-4fc0-a0d3-5d9c5887cd0f&quot;,&quot;parentUUID&quot;:&quot;4520d400-cfff-494b-9fc2-8ace38df5526&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9500ffa8-cbee-4813-ad52-9a9789ef9b0c&quot;,&quot;parentUUID&quot;:&quot;4520d400-cfff-494b-9fc2-8ace38df5526&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;05f5c5bc-dddd-4aa7-b094-e035a4e04d18&quot;,&quot;parentUUID&quot;:&quot;4520d400-cfff-494b-9fc2-8ace38df5526&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;241a7ccc-acb1-4682-a098-769d1e1959fe&quot;,&quot;19d98271-a6cf-4fc0-a0d3-5d9c5887cd0f&quot;,&quot;9500ffa8-cbee-4813-ad52-9a9789ef9b0c&quot;,&quot;05f5c5bc-dddd-4aa7-b094-e035a4e04d18&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:42,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b2fa3108-40ca-41c5-8e4e-606d7634d49f&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f927c6c-07d8-4c01-90dc-00997265ffb5&quot;,&quot;parentUUID&quot;:&quot;b2fa3108-40ca-41c5-8e4e-606d7634d49f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 1 }\n)\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14cacd10-aa1d-47fd-b125-b1628073b927&quot;,&quot;parentUUID&quot;:&quot;b2fa3108-40ca-41c5-8e4e-606d7634d49f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], {\n    threshold: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b42d1b28-f051-4b25-b588-7946d81e858c&quot;,&quot;parentUUID&quot;:&quot;b2fa3108-40ca-41c5-8e4e-606d7634d49f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { threshold: 0 })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { threshold: 2 })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c29c656-9a8c-4461-afcf-052940136be6&quot;,&quot;parentUUID&quot;:&quot;b2fa3108-40ca-41c5-8e4e-606d7634d49f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8f927c6c-07d8-4c01-90dc-00997265ffb5&quot;,&quot;14cacd10-aa1d-47fd-b125-b1628073b927&quot;,&quot;b42d1b28-f051-4b25-b588-7946d81e858c&quot;,&quot;2c29c656-9a8c-4461-afcf-052940136be6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:42,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6cefd93a-7ff6-4243-9617-f885531ccdcb&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cfda0efc-e7bf-43e6-b56a-aa3613fe903c&quot;,&quot;parentUUID&quot;:&quot;6cefd93a-7ff6-4243-9617-f885531ccdcb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [await mfkdf.setup.factors.password(&#x27;hello&#x27;)],\n  { salt: Buffer.from(&#x27;1234567812345678&#x27;, &#x27;base64&#x27;) }\n)\npolicy.salt.should.equal(&#x27;1234567812345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;424f7849-0eae-4464-a35f-58577247288b&quot;,&quot;parentUUID&quot;:&quot;6cefd93a-7ff6-4243-9617-f885531ccdcb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { salt: &#x27;hello&#x27; })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;027bce25-4606-4c7c-ac8b-491f2eddbe1b&quot;,&quot;parentUUID&quot;:&quot;6cefd93a-7ff6-4243-9617-f885531ccdcb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cfda0efc-e7bf-43e6-b56a-aa3613fe903c&quot;,&quot;424f7849-0eae-4464-a35f-58577247288b&quot;,&quot;027bce25-4606-4c7c-ac8b-491f2eddbe1b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:39,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;75c1d914-f3e9-4ba5-99f1-8e6959e3f9fd&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d5110bb-1171-4cfd-9b1d-3f9e9908253e&quot;,&quot;parentUUID&quot;:&quot;75c1d914-f3e9-4ba5-99f1-8e6959e3f9fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n  ])\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f261467-b81e-4a22-8b2d-55fa188bf362&quot;,&quot;parentUUID&quot;:&quot;75c1d914-f3e9-4ba5-99f1-8e6959e3f9fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: 12345,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: 12345,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: 12345,\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: 12345\n    }\n  ])\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e2df0b3-dba9-40cb-8ff5-efe039fe9cf1&quot;,&quot;parentUUID&quot;:&quot;75c1d914-f3e9-4ba5-99f1-8e6959e3f9fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([]).should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2323d51d-5995-4873-b5bd-8c92e36a48bd&quot;,&quot;parentUUID&quot;:&quot;75c1d914-f3e9-4ba5-99f1-8e6959e3f9fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5d5110bb-1171-4cfd-9b1d-3f9e9908253e&quot;,&quot;8f261467-b81e-4a22-8b2d-55fa188bf362&quot;,&quot;8e2df0b3-dba9-40cb-8ff5-efe039fe9cf1&quot;,&quot;2323d51d-5995-4873-b5bd-8c92e36a48bd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:24,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;d97b0c90-9045-4611-ba70-09924102b38b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:26,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mfkdf2/public/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mfkdf2/public/mochawesome&quot;,&quot;reportTitle&quot;:&quot;mfkdf&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mfkdf2\\public\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\site\\mfkdf2\\public\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\site\\mfkdf2\\public\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>