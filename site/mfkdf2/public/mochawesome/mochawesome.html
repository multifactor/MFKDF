<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:76,&quot;tests&quot;:268,&quot;passes&quot;:268,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-09-13T18:29:03.901Z&quot;,&quot;end&quot;:&quot;2025-09-13T18:29:22.929Z&quot;,&quot;duration&quot;:19028,&quot;testsRegistered&quot;:268,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;aeee5bcc-ccc2-445f-9543-834e00904a21&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;title&quot;:&quot;aes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\aes.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\aes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;encrypt throws on invalid inputs&quot;,&quot;fullTitle&quot;:&quot;aes encrypt throws on invalid inputs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt;\n  crypt.encrypt(&#x27;not a buffer&#x27;, crypto.randomBytes(32))).should.throw();\n(() =&gt;\n  crypt.encrypt(\n    crypto.randomBytes(16),\n    crypto.randomBytes(32)\n  )).should.throw();\n(() =&gt;\n  crypt.encrypt(crypto.randomBytes(32), &#x27;not a buffer&#x27;)).should.throw();\n(() =&gt;\n  crypt.encrypt(\n    crypto.randomBytes(32),\n    crypto.randomBytes(16)\n  )).should.throw()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08d01861-8c7d-4bd4-90d0-35e4eb1dcf80&quot;,&quot;parentUUID&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypt throws on invalid inputs&quot;,&quot;fullTitle&quot;:&quot;aes decrypt throws on invalid inputs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt;\n  crypt.decrypt(&#x27;not a buffer&#x27;, crypto.randomBytes(32))).should.throw();\n(() =&gt;\n  crypt.decrypt(\n    crypto.randomBytes(16),\n    crypto.randomBytes(32)\n  )).should.throw();\n(() =&gt;\n  crypt.decrypt(crypto.randomBytes(32), &#x27;not a buffer&#x27;)).should.throw();\n(() =&gt;\n  crypt.decrypt(\n    crypto.randomBytes(32),\n    crypto.randomBytes(16)\n  )).should.throw()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b525d12e-bfcd-4501-bbdc-696f49b0e122&quot;,&quot;parentUUID&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypts and decrypts correctly&quot;,&quot;fullTitle&quot;:&quot;aes encrypts and decrypts correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nconst decrypted = crypt.decrypt(encrypted, key)\ndecrypted.equals(data).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7aa998c6-1df0-4143-93cf-95e90020f86b&quot;,&quot;parentUUID&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypting with wrong key fails&quot;,&quot;fullTitle&quot;:&quot;aes decrypting with wrong key fails&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst wrongKey = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nconst decrypted = crypt.decrypt(encrypted, wrongKey)\ndecrypted.equals(data).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e8b1f5a4-471c-47fc-aa58-989e5b2a91d7&quot;,&quot;parentUUID&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypting modified data fails&quot;,&quot;fullTitle&quot;:&quot;aes decrypting modified data fails&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\n// Modify the encrypted data\nencrypted[0] ^= 0xff\nconst decrypted = crypt.decrypt(encrypted, key)\ndecrypted.equals(data).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba05cd83-8721-4e8c-86bd-ef279a2ee9b2&quot;,&quot;parentUUID&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ciphertext length equals plaintext length&quot;,&quot;fullTitle&quot;:&quot;aes ciphertext length equals plaintext length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nencrypted.length.should.equal(data.length)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec775eb4-772e-48b1-91c2-af809366c6c1&quot;,&quot;parentUUID&quot;:&quot;83c57733-3379-4266-93ff-775897610d40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;08d01861-8c7d-4bd4-90d0-35e4eb1dcf80&quot;,&quot;b525d12e-bfcd-4501-bbdc-696f49b0e122&quot;,&quot;7aa998c6-1df0-4143-93cf-95e90020f86b&quot;,&quot;e8b1f5a4-471c-47fc-aa58-989e5b2a91d7&quot;,&quot;ba05cd83-8721-4e8c-86bd-ef279a2ee9b2&quot;,&quot;ec775eb4-772e-48b1-91c2-af809366c6c1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2416085b-6c1d-45f6-8cb6-50c9f68f63e7&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0a0bc2f6-71af-484e-98d8-33093f227405&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    id: &#x27;uuid1&#x27;,\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey()\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3aae092b-9ebc-4cfd-8a2e-f297064db0e6&quot;,&quot;parentUUID&quot;:&quot;0a0bc2f6-71af-484e-98d8-33093f227405&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3aae092b-9ebc-4cfd-8a2e-f297064db0e6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:23,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8449594a-0a81-4360-a102-00ab37a5a8af&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;043c976c-3def-42ed-963e-9d9a714c793c&quot;,&quot;parentUUID&quot;:&quot;8449594a-0a81-4360-a102-00ab37a5a8af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98706c1a-e2a4-466a-b305-4ab944c19eae&quot;,&quot;parentUUID&quot;:&quot;8449594a-0a81-4360-a102-00ab37a5a8af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;043c976c-3def-42ed-963e-9d9a714c793c&quot;,&quot;98706c1a-e2a4-466a-b305-4ab944c19eae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bbeb3a58-c95a-4f43-a036-26f2824b38ea&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b748d4b2-39c4-4a1f-a1f6-4f5ff376feb8&quot;,&quot;parentUUID&quot;:&quot;bbeb3a58-c95a-4f43-a036-26f2824b38ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1078aa0b-1f73-4237-8fe1-23873f512e8c&quot;,&quot;parentUUID&quot;:&quot;bbeb3a58-c95a-4f43-a036-26f2824b38ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b748d4b2-39c4-4a1f-a1f6-4f5ff376feb8&quot;,&quot;1078aa0b-1f73-4237-8fe1-23873f512e8c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;43e565b2-1f65-4dac-9e8c-4931424fde5c&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hkdf&quot;,&quot;fullTitle&quot;:&quot;derive/key hkdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:61,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;87bd559e-94e1-4ff0-8a84-f87eaca4e743&quot;,&quot;parentUUID&quot;:&quot;43e565b2-1f65-4dac-9e8c-4931424fde5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:136,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c195738e-311b-413a-bd92-d98cb457a2dc&quot;,&quot;parentUUID&quot;:&quot;43e565b2-1f65-4dac-9e8c-4931424fde5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:133,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2, integrity: false }\n)\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nconst derive4 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e2b527e-e61d-4907-a701-fbb8795a9312&quot;,&quot;parentUUID&quot;:&quot;43e565b2-1f65-4dac-9e8c-4931424fde5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nawait mfkdf.derive\n  .key(setup.policy, {\n    password: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    )\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;378c42ed-0c35-4588-a181-cf0e75278fcb&quot;,&quot;parentUUID&quot;:&quot;43e565b2-1f65-4dac-9e8c-4931424fde5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c1b54569-42d9-44e8-879d-173bcbe6d990&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:100,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a98f26a-fb9d-4e49-9b9a-166d65ea2f49&quot;,&quot;parentUUID&quot;:&quot;c1b54569-42d9-44e8-879d-173bcbe6d990&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0a98f26a-fb9d-4e49-9b9a-166d65ea2f49&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:100,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;13e1f6ab-38cc-42e9-ad75-f63a0bb2bd04&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e8e38299-5636-4476-8fc3-08cf12931e9c&quot;,&quot;parentUUID&quot;:&quot;13e1f6ab-38cc-42e9-ad75-f63a0bb2bd04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c0b5d5e-50b2-4a65-9143-09856b4f3e84&quot;,&quot;parentUUID&quot;:&quot;13e1f6ab-38cc-42e9-ad75-f63a0bb2bd04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e8e38299-5636-4476-8fc3-08cf12931e9c&quot;,&quot;9c0b5d5e-50b2-4a65-9143-09856b4f3e84&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:52,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;87bd559e-94e1-4ff0-8a84-f87eaca4e743&quot;,&quot;c195738e-311b-413a-bd92-d98cb457a2dc&quot;,&quot;0e2b527e-e61d-4907-a701-fbb8795a9312&quot;,&quot;378c42ed-0c35-4588-a181-cf0e75278fcb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:358,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;title&quot;:&quot;derive/outputs&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\outputs.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\outputs.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;derive/outputs stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    })\n  ]),\n  await mfkdf.setup.factors.uuid({\n    id: &#x27;uuid3&#x27;,\n    uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n  })\n])\ndelete setup.outputs.stack.entropyBits\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    )\n  }),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1977b82-b4ac-4d10-8503-12246500fd19&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;derive/outputs hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.hmacsha1()])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.outputs.should.not.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc24553a-06b0-4074-aaec-8ee20d8c3913&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;derive/outputs uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b25d348-fdd2-4c24-acba-afd7eb671ffd&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;derive/outputs question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.outputs.question.strength.calc_time = null\nderive.outputs.question.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;922692fe-0e11-4c04-b0d4-a3b35b60612b&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;derive/outputs ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:161,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;971422c1-74df-472a-84a2-94b04aff9816&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;derive/outputs password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.outputs.password.strength.calc_time = null\nderive.outputs.password.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84032757-f0c4-4063-8bf2-534a41494e29&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;multiple&quot;,&quot;fullTitle&quot;:&quot;derive/outputs multiple&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nderive.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9eba83f4-db64-4234-be90-7623349d783d&quot;,&quot;parentUUID&quot;:&quot;81561736-8a6f-4f83-8f2d-2a5fae7157b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c1977b82-b4ac-4d10-8503-12246500fd19&quot;,&quot;fc24553a-06b0-4074-aaec-8ee20d8c3913&quot;,&quot;5b25d348-fdd2-4c24-acba-afd7eb671ffd&quot;,&quot;922692fe-0e11-4c04-b0d4-a3b35b60612b&quot;,&quot;971422c1-74df-472a-84a2-94b04aff9816&quot;,&quot;84032757-f0c4-4063-8bf2-534a41494e29&quot;,&quot;9eba83f4-db64-4234-be90-7623349d783d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:449,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;afc728ca-84e7-48c1-aa92-5fd19fc56b77&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setup/derive fast&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;recovery&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad041ab6-d168-4809-8844-357d30f50844&quot;,&quot;parentUUID&quot;:&quot;afc728ca-84e7-48c1-aa92-5fd19fc56b77&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;recovery&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c3d31b5-807c-4281-bf71-ca62b2e8913c&quot;,&quot;parentUUID&quot;:&quot;afc728ca-84e7-48c1-aa92-5fd19fc56b77&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n      id: &#x27;password2&#x27;\n    })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac4cf783-495d-4bf9-bb05-5fb3254abfe8&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bc22be80-3e86-4b57-ab7d-ee49daf161f9&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:473,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1c2a557-0b37-4992-a23c-aa411c4526a1&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9edba8f-5e2a-4124-9d37-914a2ba7fdd2&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d058d3c5-445c-4dcb-8120-3c45a185665a&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;examples factors question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with security question factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n])\n// derive key with security question factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24d8da23-3bbd-4642-95f9-0f276e6ed2fb&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;examples factors ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:168,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup RSA key pair (on out-of-band server)\nconst keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\n// setup key with out-of-band authentication factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\n// decrypt and send code (on out-of-band server)\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\n// derive key with out-of-band factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40210e42-7c4d-41dc-ad35-101ba78009c7&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41e233ce-17b9-43cf-b857-60f10de4c753&quot;,&quot;parentUUID&quot;:&quot;a4cc20f9-b0a6-4a4f-b3d2-d0404a2ed257&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ac4cf783-495d-4bf9-bb05-5fb3254abfe8&quot;,&quot;bc22be80-3e86-4b57-ab7d-ee49daf161f9&quot;,&quot;c1c2a557-0b37-4992-a23c-aa411c4526a1&quot;,&quot;c9edba8f-5e2a-4124-9d37-914a2ba7fdd2&quot;,&quot;d058d3c5-445c-4dcb-8120-3c45a185665a&quot;,&quot;24d8da23-3bbd-4642-95f9-0f276e6ed2fb&quot;,&quot;40210e42-7c4d-41dc-ad35-101ba78009c7&quot;,&quot;41e233ce-17b9-43cf-b857-60f10de4c753&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:934,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;674ef066-656d-4b6e-904d-7b3c67475d6c&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n  2,\n  3\n) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc08367c-fc5e-4d52-bcef-c738efc746df&quot;,&quot;parentUUID&quot;:&quot;674ef066-656d-4b6e-904d-7b3c67475d6c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fc08367c-fc5e-4d52-bcef-c738efc746df&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50b9c5c2-30c5-440b-b609-eb1db9016961&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b0b6e38e-0b31-4d2c-b936-2343f019ccf4&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [\n  &#x27;passwordA&#x27;,\n  &#x27;passwordC&#x27;\n]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [\n  &#x27;passwordB&#x27;,\n  &#x27;passwordC&#x27;\n]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09f934d1-a13a-4dca-89f3-510bd2a5730e&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:58,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e408e35e-c10f-409a-a9aa-0bae264ecaac&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d82c456a-4343-4571-8600-fc50e30377f3&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17fa9c0f-2e6c-4712-8c8a-fee97960ff24&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:55,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4a03fa9-8655-41a2-af2e-6adcb6068e72&quot;,&quot;parentUUID&quot;:&quot;733cc69d-c6ba-4906-91f8-a2b6c4f7d40a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;50b9c5c2-30c5-440b-b609-eb1db9016961&quot;,&quot;b0b6e38e-0b31-4d2c-b936-2343f019ccf4&quot;,&quot;09f934d1-a13a-4dca-89f3-510bd2a5730e&quot;,&quot;e408e35e-c10f-409a-a9aa-0bae264ecaac&quot;,&quot;d82c456a-4343-4571-8600-fc50e30377f3&quot;,&quot;17fa9c0f-2e6c-4712-8c8a-fee97960ff24&quot;,&quot;a4a03fa9-8655-41a2-af2e-6adcb6068e72&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:274,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35025129-c557-4167-a8e2-8a931a824700&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dff4d305-8898-4c7d-8df0-5d87b5ef2da5&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 1 }\n)\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;099b74c6-4479-418f-8206-5386540edcb2&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e1be4ff0-d247-460a-a94d-4f5b9d3b2dfc&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;766fb56a-a3b6-4d7b-88f6-f921405e3fc0&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d8876dd-c349-474f-83ae-8b4b507d21e7&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2daac002-2836-4771-8c11-66d685e738aa&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6512f949-ada1-4729-a439-855c8203003d&quot;,&quot;parentUUID&quot;:&quot;54c84f60-9522-4fab-bb2d-c69f0565d553&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;35025129-c557-4167-a8e2-8a931a824700&quot;,&quot;dff4d305-8898-4c7d-8df0-5d87b5ef2da5&quot;,&quot;099b74c6-4479-418f-8206-5386540edcb2&quot;,&quot;e1be4ff0-d247-460a-a94d-4f5b9d3b2dfc&quot;,&quot;766fb56a-a3b6-4d7b-88f6-f921405e3fc0&quot;,&quot;6d8876dd-c349-474f-83ae-8b4b507d21e7&quot;,&quot;2daac002-2836-4771-8c11-66d685e738aa&quot;,&quot;6512f949-ada1-4729-a439-855c8203003d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:381,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8bf5c4fc-5bf5-4eeb-87df-1b2efc0af0b2&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;589cf277-eff7-48f9-8ce1-227fe6398501&quot;,&quot;parentUUID&quot;:&quot;8bf5c4fc-5bf5-4eeb-87df-1b2efc0af0b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;589cf277-eff7-48f9-8ce1-227fe6398501&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6212f4ed-c4b2-48c2-be7d-3159cfbed9f6&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\n// get sub-key for \&quot;eth\&quot;\nconst subkey = key.getSubkey(&#x27;eth&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 97cb…bac5&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;51671234-f510-48ba-8aea-321b3a56491c&quot;,&quot;parentUUID&quot;:&quot;6212f4ed-c4b2-48c2-be7d-3159cfbed9f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;51671234-f510-48ba-8aea-321b3a56491c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:20,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;ad041ab6-d168-4809-8844-357d30f50844&quot;,&quot;5c3d31b5-807c-4281-bf71-ca62b2e8913c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:95,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6c6a8b58-b892-480e-8926-512be2064e01&quot;,&quot;title&quot;:&quot;site&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\site.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\site.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Go beyond passwords&quot;,&quot;fullTitle&quot;:&quot;site Go beyond passwords&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify(\n  (\n    await mfkdf.setup.key(\n      [\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n        await mfkdf.setup.factors.hotp({\n          secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n        }),\n        await mfkdf.setup.factors.uuid({\n          id: &#x27;recovery&#x27;,\n          uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n        })\n      ],\n      { threshold: 2, pbkdf2rounds: 1 }\n    )\n  ).policy\n)\nconst derivedKey = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  password: mfkdf.derive.factors.password(&#x27;Tr0ub4dour&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  recovery: mfkdf.derive.factors.uuid(\n    &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  )\n})\nderivedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;321cc03f-4933-4fe8-b5f3-c293e040f369&quot;,&quot;parentUUID&quot;:&quot;6c6a8b58-b892-480e-8926-512be2064e01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Increased key entropy&quot;,&quot;fullTitle&quot;:&quot;site Increased key entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:41,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;Math.floor(\n  (\n    await mfkdf.setup.key([\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n    ])\n  ).entropyBits.real\n).should.equal(16)\nMath.floor(\n  (\n    await mfkdf.setup.key([\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.hotp(),\n      await mfkdf.setup.factors.hmacsha1()\n    ])\n  ).entropyBits.real\n).should.equal(196)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d17d1a8b-20b7-4dab-a768-83196e1277ea&quot;,&quot;parentUUID&quot;:&quot;6c6a8b58-b892-480e-8926-512be2064e01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enforce advanced policies&quot;,&quot;fullTitle&quot;:&quot;site Enforce advanced policies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:361,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policyBasedKey = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.totp()\n    )\n  )\n)\npolicyBasedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4871e301-6c62-4f44-a0ab-da673ff56136&quot;,&quot;parentUUID&quot;:&quot;6c6a8b58-b892-480e-8926-512be2064e01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Self-service factor recovery&quot;,&quot;fullTitle&quot;:&quot;site Self-service factor recovery&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify(\n  (\n    await mfkdf.setup.key(\n      [\n        await mfkdf.setup.factors.password(&#x27;password&#x27;),\n        await mfkdf.setup.factors.hotp({\n          secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n        }),\n        await mfkdf.setup.factors.uuid({\n          id: &#x27;recoveryCode&#x27;,\n          uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n        })\n      ],\n      { threshold: 2, pbkdf2rounds: 1 }\n    )\n  ).policy\n)\nconst key = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  hotp: mfkdf.derive.factors.hotp(241063),\n  recoveryCode: mfkdf.derive.factors.uuid(\n    &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  )\n})\nawait key.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;myNewPassword&#x27;, { id: &#x27;password&#x27; })\n) // modify key to use new password factor&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c3dbd16-166f-4139-b6fc-c6ce0f1d87d6&quot;,&quot;parentUUID&quot;:&quot;6c6a8b58-b892-480e-8926-512be2064e01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;321cc03f-4933-4fe8-b5f3-c293e040f369&quot;,&quot;d17d1a8b-20b7-4dab-a768-83196e1277ea&quot;,&quot;4871e301-6c62-4f44-a0ab-da673ff56136&quot;,&quot;9c3dbd16-166f-4139-b6fc-c6ce0f1d87d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:500,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;51a0dfae-15bc-48e8-b93d-87958e4d00f3&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  }),\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// reconstitute key to change password\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword&#x27;)\n)\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac3315e6-fc8a-4ede-84d5-45f331fed9c3&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.stack([\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ]),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 1 }\n)\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;70d874ed-c414-4044-ae63-a502942a5ffd&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25ebfb04-4619-4ba8-ab2a-a7287e404f05&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;05b78f3f-3eb8-40ac-a3d6-400b01013a94&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:128,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n])\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n])\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n])\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n])\nconst threshold = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.uuid(),\n    await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a596a2c9-d9f5-436b-9b82-519455fa9d9c&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  }),\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1bb3192-3fb0-4fad-a6f3-97c8fc343f26&quot;,&quot;parentUUID&quot;:&quot;07494515-4f46-4e9f-a0d7-e5fdf99193bc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;51a0dfae-15bc-48e8-b93d-87958e4d00f3&quot;,&quot;ac3315e6-fc8a-4ede-84d5-45f331fed9c3&quot;,&quot;70d874ed-c414-4044-ae63-a502942a5ffd&quot;,&quot;25ebfb04-4619-4ba8-ab2a-a7287e404f05&quot;,&quot;05b78f3f-3eb8-40ac-a3d6-400b01013a94&quot;,&quot;a596a2c9-d9f5-436b-9b82-519455fa9d9c&quot;,&quot;c1bb3192-3fb0-4fad-a6f3-97c8fc343f26&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:426,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3cf4e270-76a3-4fa4-8c90-6a8ceef95119&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key).update(challenge).digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d602894-0811-44ab-905b-361441015653&quot;,&quot;parentUUID&quot;:&quot;3cf4e270-76a3-4fa4-8c90-6a8ceef95119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:71,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.hmacsha1()])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response1 = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(\n  derive1.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response2 = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9d8d2dde-1fc9-4bae-b4a2-168921477b30&quot;,&quot;parentUUID&quot;:&quot;3cf4e270-76a3-4fa4-8c90-6a8ceef95119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(\n  JSON.parse(setup),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nderive.key\n  .toString(&#x27;hex&#x27;)\n  .should.equal(\n    &#x27;2747ebf65219aee6630a758e40fd05ccbb39ab465745ea1c9a6c5adb6673d2d3&#x27;\n  )&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb2e9e93-d033-41d1-afec-fde9eeb0f756&quot;,&quot;parentUUID&quot;:&quot;3cf4e270-76a3-4fa4-8c90-6a8ceef95119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;wrong-salt&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 wrong-salt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PlS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(\n  JSON.parse(setup),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nconst setup2 =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive2 = await mfkdf.derive.key(\n  JSON.parse(setup2),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nderive.key\n  .toString(&#x27;hex&#x27;)\n  .should.not.equal(\n    &#x27;64393334663330303639356134323533393937376561636234363262373662316562616564393838663531393337303563666432633265373130636663666230&#x27;\n  )\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c847f5c5-dc15-46ca-9599-4a79cb2009c6&quot;,&quot;parentUUID&quot;:&quot;3cf4e270-76a3-4fa4-8c90-6a8ceef95119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;9a218e12-e2dc-4c91-8099-65a14f5a0459&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b20657dd-4f35-4554-b272-e5ddec485020&quot;,&quot;parentUUID&quot;:&quot;9a218e12-e2dc-4c91-8099-65a14f5a0459&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36410d13-142e-4da9-8557-23530c5b3910&quot;,&quot;parentUUID&quot;:&quot;9a218e12-e2dc-4c91-8099-65a14f5a0459&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ secret: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13b4054d-731f-4115-a4ca-931ddcc8acf6&quot;,&quot;parentUUID&quot;:&quot;9a218e12-e2dc-4c91-8099-65a14f5a0459&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26a9b336-4eec-4d46-bcde-f8b6845bded2&quot;,&quot;parentUUID&quot;:&quot;9a218e12-e2dc-4c91-8099-65a14f5a0459&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba16dd09-cad1-4366-a972-1c572afe8fc2&quot;,&quot;parentUUID&quot;:&quot;9a218e12-e2dc-4c91-8099-65a14f5a0459&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b20657dd-4f35-4554-b272-e5ddec485020&quot;,&quot;36410d13-142e-4da9-8557-23530c5b3910&quot;,&quot;13b4054d-731f-4115-a4ca-931ddcc8acf6&quot;,&quot;26a9b336-4eec-4d46-bcde-f8b6845bded2&quot;,&quot;ba16dd09-cad1-4366-a972-1c572afe8fc2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;4d602894-0811-44ab-905b-361441015653&quot;,&quot;9d8d2dde-1fc9-4bae-b4a2-168921477b30&quot;,&quot;eb2e9e93-d033-41d1-afec-fde9eeb0f756&quot;,&quot;c847f5c5-dc15-46ca-9599-4a79cb2009c6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:140,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;974269d8-750c-41ab-9de8-9fbbe6cee71c&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;size&quot;,&quot;fullTitle&quot;:&quot;factors/hotp size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96134686-66fc-488f-ae5f-a64fa2d802dc&quot;,&quot;parentUUID&quot;:&quot;974269d8-750c-41ab-9de8-9fbbe6cee71c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:91,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(361687)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(979122)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e23e447f-053a-4212-968f-aab4ec3d0e30&quot;,&quot;parentUUID&quot;:&quot;974269d8-750c-41ab-9de8-9fbbe6cee71c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([await mfkdf.setup.factors.hotp()])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ad4b1d6-05eb-40c0-9ed4-4ddcd23505a0&quot;,&quot;parentUUID&quot;:&quot;974269d8-750c-41ab-9de8-9fbbe6cee71c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a201d76-abdc-41cf-87af-a0c37e76e984&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cb6f8746-a463-4142-b793-a99879173307&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8210a9f2-9be9-4788-9955-aac358290652&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50b63013-b21d-4aa9-9ddb-e773d6b18a42&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 4\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2f6c69c-04dd-4287-9ddf-ec20df79ee25&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 9\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a365d8c5-05a1-43dc-a8c3-907bc3e7ebaf&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    hash: &#x27;sha123&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;39154473-ae0c-4fb8-b564-0e8c7eb21f2d&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec950395-5485-438d-b40d-2a6df94a1f0b&quot;,&quot;parentUUID&quot;:&quot;685a18f9-f8fe-42a5-90d4-9a00052ea102&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3a201d76-abdc-41cf-87af-a0c37e76e984&quot;,&quot;cb6f8746-a463-4142-b793-a99879173307&quot;,&quot;8210a9f2-9be9-4788-9955-aac358290652&quot;,&quot;50b63013-b21d-4aa9-9ddb-e773d6b18a42&quot;,&quot;a2f6c69c-04dd-4287-9ddf-ec20df79ee25&quot;,&quot;a365d8c5-05a1-43dc-a8c3-907bc3e7ebaf&quot;,&quot;39154473-ae0c-4fb8-b564-0e8c7eb21f2d&quot;,&quot;ec950395-5485-438d-b40d-2a6df94a1f0b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;96134686-66fc-488f-ae5f-a64fa2d802dc&quot;,&quot;e23e447f-053a-4212-968f-aab4ec3d0e30&quot;,&quot;7ad4b1d6-05eb-40c0-9ed4-4ddcd23505a0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:111,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;97ddc078-17c1-4f18-b330-c1165010efea&quot;,&quot;title&quot;:&quot;factors/ooba&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;factors/ooba full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:188,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: {\n      email: &#x27;test@mfkdf.com&#x27;\n    }\n  })\n])\nlet next = setup.policy.factors[0].params.next\nlet decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nlet json = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\nlet code = json.code\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nnext = derive1.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toLowerCase())\n})\nnext = derive2.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toUpperCase())\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42cd9da2-e73c-4312-87f1-3d8da2816e88&quot;,&quot;parentUUID&quot;:&quot;97ddc078-17c1-4f18-b330-c1165010efea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c82facd0-88b1-409c-b347-278911fe3b71&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.ooba(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb099cd3-53c9-4af8-a717-eb5e2a6651c8&quot;,&quot;parentUUID&quot;:&quot;c82facd0-88b1-409c-b347-278911fe3b71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:239,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nawait mfkdf.setup.factors\n  .ooba({\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: &#x27;foo&#x27;\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: 0\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: 100\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    key: &#x27;12345&#x27;\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    key: keyPair.publicKey,\n    params: &#x27;12345&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9480eb35-bee4-4e4e-8d3e-29f04c38df49&quot;,&quot;parentUUID&quot;:&quot;c82facd0-88b1-409c-b347-278911fe3b71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eb099cd3-53c9-4af8-a717-eb5e2a6651c8&quot;,&quot;9480eb35-bee4-4e4e-8d3e-29f04c38df49&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:240,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;42cd9da2-e73c-4312-87f1-3d8da2816e88&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:188,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;83766cb0-a862-43f9-91c2-91cdf01f6164&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2e8e3aa9-f08b-4879-b872-fa7ae5f70b65&quot;,&quot;parentUUID&quot;:&quot;83766cb0-a862-43f9-91c2-91cdf01f6164&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8c056549-29a8-46ae-a303-fa911b44d97a&quot;,&quot;parentUUID&quot;:&quot;83766cb0-a862-43f9-91c2-91cdf01f6164&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2e8e3aa9-f08b-4879-b872-fa7ae5f70b65&quot;,&quot;8c056549-29a8-46ae-a303-fa911b44d97a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3854b8dd-ea99-45f2-932c-862955323c22&quot;,&quot;title&quot;:&quot;factors/question&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/question valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27; Fido-&#x27;, {\n    question: &#x27;What is the name of your first pet?&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;-f_i%d#o ? &#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1c4a05d-2308-4b35-a542-26252737f247&quot;,&quot;parentUUID&quot;:&quot;3854b8dd-ea99-45f2-932c-862955323c22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/question invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;, {\n    question: &#x27;What is the name of your first pet?&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    question: mfkdf.derive.factors.question(&#x27;Rex&#x27;)\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;012dca20-12ca-428a-bd06-bdcc9bde1bf2&quot;,&quot;parentUUID&quot;:&quot;3854b8dd-ea99-45f2-932c-862955323c22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;64a45b9c-04e1-4c84-8ba3-912f01332790&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/question errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.question(123)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.question(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a45a19a4-bf2f-4e2e-9dbc-bda61c9c0c24&quot;,&quot;parentUUID&quot;:&quot;64a45b9c-04e1-4c84-8ba3-912f01332790&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/question errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .question(12345)\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors.question(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { id: 12345 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { question: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd4556c7-a7d2-41f3-ac14-8ca97470dda8&quot;,&quot;parentUUID&quot;:&quot;64a45b9c-04e1-4c84-8ba3-912f01332790&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a45a19a4-bf2f-4e2e-9dbc-bda61c9c0c24&quot;,&quot;fd4556c7-a7d2-41f3-ac14-8ca97470dda8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;c1c4a05d-2308-4b35-a542-26252737f247&quot;,&quot;012dca20-12ca-428a-bd06-bdcc9bde1bf2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:91,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;081c40e8-8a97-4d38-9537-46ab5302303b&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors\n  .stack(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ],\n    { id: 12345 }\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21e07fa7-fab2-46f2-a90d-1043bf2383ac&quot;,&quot;parentUUID&quot;:&quot;081c40e8-8a97-4d38-9537-46ab5302303b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors\n  .stack(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ],\n    { id: &#x27;&#x27; }\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;398bb1c9-1d9a-4929-aa15-2b414efcb1f5&quot;,&quot;parentUUID&quot;:&quot;081c40e8-8a97-4d38-9537-46ab5302303b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:83,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.stack(\n      [\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ],\n      { id: &#x27;stack1&#x27; }\n    ),\n    await mfkdf.setup.factors.stack(\n      [\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        })\n      ],\n      { id: &#x27;stack2&#x27; }\n    )\n  ],\n  { threshold: 1 }\n)\nsetup.policy.factors[0].params.should.not.have.property(&#x27;hmac&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1dd1d106-10e2-4e70-a199-813a485547d0&quot;,&quot;parentUUID&quot;:&quot;081c40e8-8a97-4d38-9537-46ab5302303b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;21e07fa7-fab2-46f2-a90d-1043bf2383ac&quot;,&quot;398bb1c9-1d9a-4929-aa15-2b414efcb1f5&quot;,&quot;1dd1d106-10e2-4e70-a199-813a485547d0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:83,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;47992924-7446-4221-84c8-399a0965bca6&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;size&quot;,&quot;fullTitle&quot;:&quot;factors/totp size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8fe7107e-33bb-4e1e-8a3c-2f23e5d40645&quot;,&quot;parentUUID&quot;:&quot;47992924-7446-4221-84c8-399a0965bca6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:443,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.totp()])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d806ebdb-3ffe-427b-83fb-379f278b6949&quot;,&quot;parentUUID&quot;:&quot;47992924-7446-4221-84c8-399a0965bca6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:434,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, { time: 30001 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, { time: 60001 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f02bbd0-4fb3-4732-b9c0-374d4448408d&quot;,&quot;parentUUID&quot;:&quot;47992924-7446-4221-84c8-399a0965bca6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:356,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([await mfkdf.setup.factors.totp()])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e627ad91-e7cf-4837-a5bf-c5f202c50bd7&quot;,&quot;parentUUID&quot;:&quot;47992924-7446-4221-84c8-399a0965bca6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6064e6f1-cf96-405b-a29e-f6713df15dc4&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:359,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597\n  })\n])\nawait mfkdf.derive\n  .key(setup.policy, {\n    totp: mfkdf.derive.factors.totp(953265, { time: 1750430943604 })\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c97f1a5-6792-41d4-a482-dfa4b2e7dd80&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;633cc002-0e54-4ec1-8441-a2ea2a256222&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;211041cc-5dc9-45ca-bc1f-d5d359df8f75&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc3a4a5a-eec7-4f29-992f-de9ba0e4efa3&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;968c2f66-3ce5-422a-b844-48d89d8b407f&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a99b83fc-c33c-4c3c-bf52-0049aee22c99&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 4\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6629f805-56c3-4c7d-b82d-fe3e5c5d1bbc&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 9\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d4a825b-2d2b-4ab8-bf86-200ac1a2b160&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    hash: &#x27;sha123&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e91bcc7-eaba-4610-9971-a7b432404716&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12fbc68d-388d-4bba-8c7a-813411400943&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    time: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;57c51e58-e838-4e0e-9a56-771773767510&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    time: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d071771d-0410-4bda-bb8b-c73f5af6bffa&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    step: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a535458-b944-45c4-b611-018a6259188e&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    step: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9168ff92-b03e-4802-a298-23fefbd998fc&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    window: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75d6b851-3f32-4b41-8fed-8914b3b8ca08&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    window: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ddbbf151-3958-4655-a8e6-025c684a6eea&quot;,&quot;parentUUID&quot;:&quot;e6b444e7-e3b8-4cd9-9591-b3204b6da595&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6064e6f1-cf96-405b-a29e-f6713df15dc4&quot;,&quot;5c97f1a5-6792-41d4-a482-dfa4b2e7dd80&quot;,&quot;633cc002-0e54-4ec1-8441-a2ea2a256222&quot;,&quot;211041cc-5dc9-45ca-bc1f-d5d359df8f75&quot;,&quot;fc3a4a5a-eec7-4f29-992f-de9ba0e4efa3&quot;,&quot;968c2f66-3ce5-422a-b844-48d89d8b407f&quot;,&quot;a99b83fc-c33c-4c3c-bf52-0049aee22c99&quot;,&quot;6629f805-56c3-4c7d-b82d-fe3e5c5d1bbc&quot;,&quot;6d4a825b-2d2b-4ab8-bf86-200ac1a2b160&quot;,&quot;9e91bcc7-eaba-4610-9971-a7b432404716&quot;,&quot;12fbc68d-388d-4bba-8c7a-813411400943&quot;,&quot;57c51e58-e838-4e0e-9a56-771773767510&quot;,&quot;d071771d-0410-4bda-bb8b-c73f5af6bffa&quot;,&quot;8a535458-b944-45c4-b611-018a6259188e&quot;,&quot;9168ff92-b03e-4802-a298-23fefbd998fc&quot;,&quot;75d6b851-3f32-4b41-8fed-8914b3b8ca08&quot;,&quot;ddbbf151-3958-4655-a8e6-025c684a6eea&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:363,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;8fe7107e-33bb-4e1e-8a3c-2f23e5d40645&quot;,&quot;d806ebdb-3ffe-427b-83fb-379f278b6949&quot;,&quot;8f02bbd0-4fb3-4732-b9c0-374d4448408d&quot;,&quot;e627ad91-e7cf-4837-a5bf-c5f202c50bd7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1233,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c7d6cf9a-0935-4d43-9b56-f90a6e02a002&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:125,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a035281-ac98-4676-8dea-088437188b06&quot;,&quot;parentUUID&quot;:&quot;c7d6cf9a-0935-4d43-9b56-f90a6e02a002&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:121,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    )\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;\n    )\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;\n    )\n  },\n  false\n)\nconst derive4 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    )\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;300e7070-db2d-47b0-9107-0f33dd2266fb&quot;,&quot;parentUUID&quot;:&quot;c7d6cf9a-0935-4d43-9b56-f90a6e02a002&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9a035281-ac98-4676-8dea-088437188b06&quot;,&quot;300e7070-db2d-47b0-9107-0f33dd2266fb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:246,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a396d58f-bcf3-4209-9302-baec9a7d6fa4&quot;,&quot;parentUUID&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a0193a2-22ad-4eac-bfe2-2b5959038db6&quot;,&quot;parentUUID&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b60d6b9-ff73-48dc-ad73-df8d1d40f4be&quot;,&quot;parentUUID&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a4eacc8-2dcc-4000-9620-f2daf4364acf&quot;,&quot;parentUUID&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:354,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9d42cfd7-8a54-476b-ba59-3625bd4dd5fe&quot;,&quot;parentUUID&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:353,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;550b8dec-5a11-4656-a553-8788828adfc3&quot;,&quot;parentUUID&quot;:&quot;04887229-dafb-46b9-ac0a-f3564d0d825c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a396d58f-bcf3-4209-9302-baec9a7d6fa4&quot;,&quot;0a0193a2-22ad-4eac-bfe2-2b5959038db6&quot;,&quot;6b60d6b9-ff73-48dc-ad73-df8d1d40f4be&quot;,&quot;3a4eacc8-2dcc-4000-9620-f2daf4364acf&quot;,&quot;9d42cfd7-8a54-476b-ba59-3625bd4dd5fe&quot;,&quot;550b8dec-5a11-4656-a553-8788828adfc3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:794,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;title&quot;:&quot;integrity&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\integrity.js&quot;,&quot;file&quot;:&quot;\\test\\features\\integrity.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;disabled&quot;,&quot;fullTitle&quot;:&quot;integrity disabled&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:55,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  false\n)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d6991a3-0bba-4408-bf0d-d7003f1b93ee&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;safety&quot;,&quot;fullTitle&quot;:&quot;integrity safety&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:82,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n      password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n      password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;249ec025-e29e-4251-a1b3-ccce8a3cd582&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;liveness&quot;,&quot;fullTitle&quot;:&quot;integrity liveness&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:83,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  true\n)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0b03867-46ce-4a60-aaab-4c2d1f3e37a2&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;$id&quot;,&quot;fullTitle&quot;:&quot;integrity $id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.$id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;354b2b6f-b50d-4ffb-ae9c-f2691c3e6ff2&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold&quot;,&quot;fullTitle&quot;:&quot;integrity threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.threshold += 1\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7920e958-cd25-4418-97e4-e496d40d92ee&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;salt&quot;,&quot;fullTitle&quot;:&quot;integrity salt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.salt = &#x27;Ny9+L9LQHOKh1x3Acqy7pMb9JaEIfNfxU/TsDON+Ht4=&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d1f09f97-38e5-483c-9dba-f83980eba44e&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id&quot;,&quot;fullTitle&quot;:&quot;integrity factor/id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e280573d-8bd3-445d-af98-2c67e786eee1&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;integrity derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:84,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  true\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\n// Tamper with policy\nderive.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    derive.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n      password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n      password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b8b4657b-ff9b-4634-b122-cd527e19080c&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullTitle&quot;:&quot;integrity reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2, integrity: true }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  })\n)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n  },\n  true\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;310481ab-a725-4fc1-bb11-402df90688f0&quot;,&quot;parentUUID&quot;:&quot;075ea9b7-fb11-43df-920d-f4a0ac4b88c7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6d6991a3-0bba-4408-bf0d-d7003f1b93ee&quot;,&quot;249ec025-e29e-4251-a1b3-ccce8a3cd582&quot;,&quot;f0b03867-46ce-4a60-aaab-4c2d1f3e37a2&quot;,&quot;354b2b6f-b50d-4ffb-ae9c-f2691c3e6ff2&quot;,&quot;7920e958-cd25-4418-97e4-e496d40d92ee&quot;,&quot;d1f09f97-38e5-483c-9dba-f83980eba44e&quot;,&quot;e280573d-8bd3-445d-af98-2c67e786eee1&quot;,&quot;b8b4657b-ff9b-4634-b122-cd527e19080c&quot;,&quot;310481ab-a725-4fc1-bb11-402df90688f0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:528,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b37aa657-7dc1-4234-99c8-68736b392187&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1d004f3b-f228-48d5-b69c-851957ace9c2&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b9da9780-7fac-4484-97af-aed5a4406d85&quot;,&quot;parentUUID&quot;:&quot;1d004f3b-f228-48d5-b69c-851957ace9c2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.policy\n  .setup(\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      )\n    )\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8debf0f-3807-4a28-ad65-fdcd0cf30918&quot;,&quot;parentUUID&quot;:&quot;1d004f3b-f228-48d5-b69c-851957ace9c2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b9da9780-7fac-4484-97af-aed5a4406d85&quot;,&quot;c8debf0f-3807-4a28-ad65-fdcd0cf30918&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:44,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;336b9ba5-278b-41b4-a983-3ed03b6c33de&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be\n  .true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08e8be94-9593-4a19-9ee6-38321c00889e&quot;,&quot;parentUUID&quot;:&quot;336b9ba5-278b-41b4-a983-3ed03b6c33de&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be\n  .false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f3b2e286-3d8b-431c-8560-1d365b36074c&quot;,&quot;parentUUID&quot;:&quot;336b9ba5-278b-41b4-a983-3ed03b6c33de&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;08e8be94-9593-4a19-9ee6-38321c00889e&quot;,&quot;f3b2e286-3d8b-431c-8560-1d365b36074c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:46,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb74803d-88a6-40e3-8b2f-4137239aace4&quot;,&quot;parentUUID&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7fb514d-51a2-42e4-a5bb-5aeb0f80f809&quot;,&quot;parentUUID&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe883a9c-3f18-46d2-a249-fb5a8dd6d4fe&quot;,&quot;parentUUID&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:159,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62b3aeb4-ed9e-40d6-941a-cd6b7cc01e28&quot;,&quot;parentUUID&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:89,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ff58987-ccb3-4c69-89f1-c75923d1ae58&quot;,&quot;parentUUID&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:63,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f73b3d85-91d0-4030-88ab-a64a5879f8fb&quot;,&quot;parentUUID&quot;:&quot;5cf00e94-2bfd-42ad-bf34-e478d23e9bb2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eb74803d-88a6-40e3-8b2f-4137239aace4&quot;,&quot;a7fb514d-51a2-42e4-a5bb-5aeb0f80f809&quot;,&quot;fe883a9c-3f18-46d2-a249-fb5a8dd6d4fe&quot;,&quot;62b3aeb4-ed9e-40d6-941a-cd6b7cc01e28&quot;,&quot;8ff58987-ccb3-4c69-89f1-c75923d1ae58&quot;,&quot;f73b3d85-91d0-4030-88ab-a64a5879f8fb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:467,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;aac329bc-7fe5-4741-9e53-28459fd59e0c&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n])\nawait mfkdf.policy\n  .derive(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n    password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01514468-46db-4d67-9e2b-d2b34c835fc5&quot;,&quot;parentUUID&quot;:&quot;aac329bc-7fe5-4741-9e53-28459fd59e0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\nawait mfkdf.policy\n  .derive(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac8c22f6-6346-4d3a-9416-c28bbe67bd65&quot;,&quot;parentUUID&quot;:&quot;aac329bc-7fe5-4741-9e53-28459fd59e0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;01514468-46db-4d67-9e2b-d2b34c835fc5&quot;,&quot;ac8c22f6-6346-4d3a-9416-c28bbe67bd65&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:47,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ],\n  { threshold: 3, integrity: false }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    false\n  )\n  .should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24ceff35-8fe3-42a9-840d-8c8564f23faf&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)\nawait derive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait mfkdf.derive\n  .key(derive2.policy, {\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;638bcb0d-4cf1-4856-88a5-f7d8052a6144&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:100,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b00dea1e-540b-4358-bd2b-72f0fc5c2b1b&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;316f0af8-de33-406d-bf34-f2f43292b6e2&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;387f1785-722d-42bf-8038-1759ea90cfed&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  })\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b0fd6839-441d-41b6-b7e5-a8d74ec296bf&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2c0013a-2477-42ef-bc36-0457c20e2b7b&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute(\n  [&#x27;password1&#x27;],\n  [\n    await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n      id: &#x27;password2&#x27;\n    })\n  ],\n  2\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6fae0479-f860-4f99-bfa8-b06ae5dbeba5&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a5c14ff-f64f-4d26-affa-0bcf29b80f5d&quot;,&quot;parentUUID&quot;:&quot;238e3cb1-2fed-4cde-aa1e-a9e6be2793eb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [12345],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;91897903-1807-43de-a9a8-a6b3e6082570&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [&#x27;password4&#x27;],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8149c875-a939-4a94-b627-2603d612705e&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nawait setup\n  .reconstitute(\n    [&#x27;password3&#x27;],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c524c5bb-a54e-4a03-a21c-9b85d3a83425&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    &#x27;hello&#x27;,\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d00c09bd-0de4-4293-b1a9-e866b75d1028&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute([], &#x27;12345&#x27;, 2)\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec5f588e-2709-46ad-a3b3-7fe8094ebebb&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute([], [], &#x27;12345&#x27;)\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;842f97b9-9ebd-4dfa-92c6-852c672813c9&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bade9ecc-4e12-41fc-9a61-b67114cce065&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: 12345,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7fa445a-7052-49f2-a8b3-f617f945eb2c&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6320ec1-0233-483f-ac49-86196640124a&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: 12345,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47c1cdd0-f012-417b-9c7c-9ecdd2ebf712&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1886ff81-c667-4167-b6dd-fc38110b8ad8&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: 12345,\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c9d5dfd-e68f-4f33-b6f6-cd02525fd745&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d52251ea-5146-419d-aece-772cdb13b84a&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;),\n        params: 12345,\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3090dc0d-55c9-4332-afac-8bc7dc076d8b&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: 12345\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6cb60cc-b7e0-415d-ae31-34621cbde744&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74f8500c-ebc9-4fee-9ce5-289e38f29625&quot;,&quot;parentUUID&quot;:&quot;86b9f0f9-38c3-4295-86df-3f24dc7e3650&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;91897903-1807-43de-a9a8-a6b3e6082570&quot;,&quot;8149c875-a939-4a94-b627-2603d612705e&quot;,&quot;c524c5bb-a54e-4a03-a21c-9b85d3a83425&quot;,&quot;d00c09bd-0de4-4293-b1a9-e866b75d1028&quot;,&quot;ec5f588e-2709-46ad-a3b3-7fe8094ebebb&quot;,&quot;842f97b9-9ebd-4dfa-92c6-852c672813c9&quot;,&quot;bade9ecc-4e12-41fc-9a61-b67114cce065&quot;,&quot;e7fa445a-7052-49f2-a8b3-f617f945eb2c&quot;,&quot;a6320ec1-0233-483f-ac49-86196640124a&quot;,&quot;47c1cdd0-f012-417b-9c7c-9ecdd2ebf712&quot;,&quot;1886ff81-c667-4167-b6dd-fc38110b8ad8&quot;,&quot;6c9d5dfd-e68f-4f33-b6f6-cd02525fd745&quot;,&quot;d52251ea-5146-419d-aece-772cdb13b84a&quot;,&quot;3090dc0d-55c9-4332-afac-8bc7dc076d8b&quot;,&quot;b6cb60cc-b7e0-415d-ae31-34621cbde744&quot;,&quot;74f8500c-ebc9-4fee-9ce5-289e38f29625&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:337,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;24ceff35-8fe3-42a9-840d-8c8564f23faf&quot;,&quot;638bcb0d-4cf1-4856-88a5-f7d8052a6144&quot;,&quot;b00dea1e-540b-4358-bd2b-72f0fc5c2b1b&quot;,&quot;316f0af8-de33-406d-bf34-f2f43292b6e2&quot;,&quot;387f1785-722d-42bf-8038-1759ea90cfed&quot;,&quot;b0fd6839-441d-41b6-b7e5-a8d74ec296bf&quot;,&quot;e2c0013a-2477-42ef-bc36-0457c20e2b7b&quot;,&quot;6fae0479-f860-4f99-bfa8-b06ae5dbeba5&quot;,&quot;5a5c14ff-f64f-4d26-affa-0bcf29b80f5d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:546,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a1ce6ee4-8152-458a-9db9-609c7c2ef1cc&quot;,&quot;title&quot;:&quot;stage&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\stage.js&quot;,&quot;file&quot;:&quot;\\test\\features\\stage.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic&quot;,&quot;fullTitle&quot;:&quot;stage basic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const passwordSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.password(&#x27;password&#x27;)\n)\nconst setup = await mfkdf.setup.key([passwordSetup])\nconst passwordDerive = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.password(&#x27;password&#x27;),\n  setup.policy.factors[0].params\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: passwordDerive\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca64442f-da5c-452c-9173-48120c6885b1&quot;,&quot;parentUUID&quot;:&quot;a1ce6ee4-8152-458a-9db9-609c7c2ef1cc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;stage full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:478,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst init = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst passwordSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.password(&#x27;password&#x27;),\n  init.key\n)\nconst hmacsha1Setup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.hmacsha1(),\n  init.key\n)\nconst hotpSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;) }),\n  init.key\n)\nconst oobaSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.ooba({ key: keyPair.publicKey, params: {} }),\n  init.key\n)\nconst questionSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.question(&#x27;fido&#x27;),\n  init.key\n)\nconst totpSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  }),\n  init.key\n)\nconst uuidSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  }),\n  init.key\n)\nconst setup = await mfkdf.setup.key([\n  passwordSetup,\n  hmacsha1Setup,\n  hotpSetup,\n  oobaSetup,\n  questionSetup,\n  totpSetup,\n  uuidSetup\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[1].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\nconst next = setup.policy.factors[3].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst json = JSON.parse(Buffer.from(decrypted).toString())\nconst code = json.code\nconst password = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.password(&#x27;password&#x27;),\n  setup.policy.factors[0].params,\n  setup.key\n)\nconst hmacsha1 = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.hmacsha1(response),\n  setup.policy.factors[1].params,\n  setup.key\n)\nconst hotp = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.hotp(241063),\n  setup.policy.factors[2].params,\n  setup.key\n)\nconst ooba = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.ooba(code),\n  setup.policy.factors[3].params,\n  setup.key\n)\nconst question = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.question(&#x27;fido&#x27;),\n  setup.policy.factors[4].params,\n  setup.key\n)\nconst totp = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.totp(953265, { time: 1 }),\n  setup.policy.factors[5].params,\n  setup.key\n)\nconst uuid = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  setup.policy.factors[6].params,\n  setup.key\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password,\n  hmacsha1,\n  hotp,\n  ooba,\n  question,\n  totp,\n  uuid\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c9d28bf-76d2-4aaf-ad28-6eb275fc8d63&quot;,&quot;parentUUID&quot;:&quot;a1ce6ee4-8152-458a-9db9-609c7c2ef1cc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ca64442f-da5c-452c-9173-48120c6885b1&quot;,&quot;4c9d28bf-76d2-4aaf-ad28-6eb275fc8d63&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:528,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;23bd2fa2-546c-4900-bd15-140d085ee16a&quot;,&quot;title&quot;:&quot;mfkdf2/changes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d275e9a1-7ac8-4571-83f1-da88db4fa28c&quot;,&quot;title&quot;:&quot;key-size-256&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes key-size-256 default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e5e23a0-1274-40d6-8403-a44cdd5392ea&quot;,&quot;parentUUID&quot;:&quot;d275e9a1-7ac8-4571-83f1-da88db4fa28c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes key-size-256 override&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;982f6e38-4680-42f5-8b2b-6409e6eadd3f&quot;,&quot;parentUUID&quot;:&quot;d275e9a1-7ac8-4571-83f1-da88db4fa28c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8e5e23a0-1274-40d6-8403-a44cdd5392ea&quot;,&quot;982f6e38-4680-42f5-8b2b-6409e6eadd3f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:99,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e9fadfe4-0c75-4f72-a40c-f0cf06da956a&quot;,&quot;title&quot;:&quot;kdf-argon2id&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99464b09-67fb-479e-b413-c0842a19eb0a&quot;,&quot;parentUUID&quot;:&quot;e9fadfe4-0c75-4f72-a40c-f0cf06da956a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/mismatch/time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/mismatch/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:148,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 3 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nsetup.policy.time = 4\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a588c9af-95ef-46d1-9004-8f545afcb96a&quot;,&quot;parentUUID&quot;:&quot;e9fadfe4-0c75-4f72-a40c-f0cf06da956a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/mismatch/memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/mismatch/memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:75,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 1024 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nsetup.policy.memory = 2048\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c3d270e-5884-4f53-a6f6-c6915bf27131&quot;,&quot;parentUUID&quot;:&quot;e9fadfe4-0c75-4f72-a40c-f0cf06da956a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/matching&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/matching&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:423,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 65536, time: 3 }\n)\nsetup.policy.memory.should.equal(65536)\nsetup.policy.time.should.equal(3)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec96db96-1de0-4c92-9c53-8cd82e2fb639&quot;,&quot;parentUUID&quot;:&quot;e9fadfe4-0c75-4f72-a40c-f0cf06da956a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99464b09-67fb-479e-b413-c0842a19eb0a&quot;,&quot;a588c9af-95ef-46d1-9004-8f545afcb96a&quot;,&quot;4c3d270e-5884-4f53-a6f6-c6915bf27131&quot;,&quot;ec96db96-1de0-4c92-9c53-8cd82e2fb639&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:691,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ca9fb918-47d6-4745-ab99-aa67524fcd0d&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;aes-256-ecb&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes encryption aes-256-ecb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const stretched = await crypto.randomBytes(32)\nconst share = await crypto.randomBytes(32)\nconst cipher = crypto.createCipheriv(&#x27;AES-256-ECB&#x27;, stretched, null)\ncipher.setAutoPadding(false)\nconst pad = Buffer.concat([cipher.update(share), cipher.final()])\nconst decipher = crypto.createDecipheriv(&#x27;AES-256-ECB&#x27;, stretched, null)\ndecipher.setAutoPadding(false)\nconst share2 = Buffer.concat([decipher.update(pad), decipher.final()])\nshare2.toString(&#x27;hex&#x27;).should.equal(share.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;02ccb7e8-72c3-4ac3-a588-5b3cb188beae&quot;,&quot;parentUUID&quot;:&quot;ca9fb918-47d6-4745-ab99-aa67524fcd0d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;02ccb7e8-72c3-4ac3-a588-5b3cb188beae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2c6c0da8-2cfe-4089-ac5b-b2fbb8321d22&quot;,&quot;title&quot;:&quot;mfkdf2/hints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\hints.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\hints.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getHint&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints getHint&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:72,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst hint = setup.getHint(&#x27;password1&#x27;, 7)\nhint.should.be.a(&#x27;string&#x27;)\nhint.length.should.equal(7)\nconst hinta = setup.getHint(&#x27;password1&#x27;, 24)\nhinta.should.be.a(&#x27;string&#x27;)\nhinta.length.should.equal(24)\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst hint2 = derived.getHint(&#x27;password1&#x27;, 7)\nhint2.should.equal(hint)\nconst hinta2 = derived.getHint(&#x27;password1&#x27;, 24)\nhinta2.should.equal(hinta)\nconst derived2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;wrongpassword&#x27;)\n  },\n  false\n)\nconst hinta3 = derived2.getHint(&#x27;password1&#x27;, 24)\nhinta3.should.not.equal(hinta)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a91df7ce-3ab9-4a97-aa72-9884255bdb9b&quot;,&quot;parentUUID&quot;:&quot;2c6c0da8-2cfe-4089-ac5b-b2fbb8321d22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addHint&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints addHint&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  {\n    integrity: false\n  }\n)\nsetup.addHint(&#x27;password1&#x27;)\nsetup.policy.factors[0].hint.should.be.a(&#x27;string&#x27;)\nsetup.policy.factors[0].hint.length.should.equal(7)\nsetup.addHint(&#x27;password1&#x27;, 24)\nsetup.policy.factors[0].hint.should.be.a(&#x27;string&#x27;)\nsetup.policy.factors[0].hint.length.should.equal(24)\nawait mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    false\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f32dfe4-e4bc-4673-b269-aa19e1d79be7&quot;,&quot;parentUUID&quot;:&quot;2c6c0da8-2cfe-4089-ac5b-b2fbb8321d22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;coverage&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints coverage&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  {\n    integrity: false\n  }\n);\n(() =&gt; setup.getHint()).should.throw(TypeError);\n(() =&gt; setup.getHint(123)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;unknown&#x27;)).should.throw(RangeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, &#x27;string&#x27;)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, 0)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, 300)).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19271e88-de05-462b-b8c1-06f82eb625db&quot;,&quot;parentUUID&quot;:&quot;2c6c0da8-2cfe-4089-ac5b-b2fbb8321d22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a91df7ce-3ab9-4a97-aa72-9884255bdb9b&quot;,&quot;9f32dfe4-e4bc-4673-b269-aa19e1d79be7&quot;,&quot;19271e88-de05-462b-b8c1-06f82eb625db&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:146,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;610980d0-3172-4af6-a073-73a51f5e1853&quot;,&quot;title&quot;:&quot;mfkdf2/mfdpg2&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8af05320-455a-4f25-8d5c-416537eb5546&quot;,&quot;title&quot;:&quot;basics&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;portability&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 basics portability&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password = setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.length.should.be.above(5)\npassword.length.should.be.below(11);\n/[a-zA-Z]{6,10}/.test(password).should.be.true\nconst password2 = setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.should.equal(password2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst password3 = derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.should.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;077fa992-efb2-44fe-8d02-46851df9fb55&quot;,&quot;parentUUID&quot;:&quot;8af05320-455a-4f25-8d5c-416537eb5546&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-example&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 basics full-example&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst policy = /([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*/\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  policy\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password3 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  policy\n)\npassword1.should.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac677bea-25d9-4b66-8352-564bcce80211&quot;,&quot;parentUUID&quot;:&quot;8af05320-455a-4f25-8d5c-416537eb5546&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;077fa992-efb2-44fe-8d02-46851df9fb55&quot;,&quot;ac677bea-25d9-4b66-8352-564bcce80211&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:102,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2682f431-c0f3-4e29-8947-7ee4f0a10231&quot;,&quot;title&quot;:&quot;correctness&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 correctness basic-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst password2 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8201e13-d155-4f05-b9b4-1409f7df7d41&quot;,&quot;parentUUID&quot;:&quot;2682f431-c0f3-4e29-8947-7ee4f0a10231&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 correctness full-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password2 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a4476c3-86f6-44d7-8d12-96dfde99e23e&quot;,&quot;parentUUID&quot;:&quot;2682f431-c0f3-4e29-8947-7ee4f0a10231&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f8201e13-d155-4f05-b9b4-1409f7df7d41&quot;,&quot;3a4476c3-86f6-44d7-8d12-96dfde99e23e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:66,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e327855f-5cca-4c4c-9ae3-4a0e0033e10c&quot;,&quot;title&quot;:&quot;safety&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 safety basic-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst setup2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup1.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst password2 = await setup2.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.not.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5e8f435-ca66-404b-8e13-7b5881d603fa&quot;,&quot;parentUUID&quot;:&quot;e327855f-5cca-4c4c-9ae3-4a0e0033e10c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 safety full-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:75,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password2 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nconst password3 = await derive2.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.not.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;146b3cb1-1a29-4849-ab65-e36723af89a6&quot;,&quot;parentUUID&quot;:&quot;e327855f-5cca-4c4c-9ae3-4a0e0033e10c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b5e8f435-ca66-404b-8e13-7b5881d603fa&quot;,&quot;146b3cb1-1a29-4849-ab65-e36723af89a6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:114,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a52f23db-8eb4-45d7-b68f-7f1be17cbd7a&quot;,&quot;title&quot;:&quot;compatibility&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-policy&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 compatibility basic-policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.length.should.be.above(5)\npassword.length.should.be.below(11)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d7776bb5-c1f5-44ff-a728-ebfbf3caf304&quot;,&quot;parentUUID&quot;:&quot;a52f23db-8eb4-45d7-b68f-7f1be17cbd7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;custom-policy&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 compatibility custom-policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst regex = /([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*/\nconst password = await setup.derivePassword(&#x27;example.com&#x27;, &#x27;salt&#x27;, regex)\nregex.test(password).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90306920-a5e6-4e17-91e3-a28598fa769e&quot;,&quot;parentUUID&quot;:&quot;a52f23db-8eb4-45d7-b68f-7f1be17cbd7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d7776bb5-c1f5-44ff-a728-ebfbf3caf304&quot;,&quot;90306920-a5e6-4e17-91e3-a28598fa769e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:42,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6eb2f7d4-335a-402d-8fb2-051fac6a7716&quot;,&quot;title&quot;:&quot;mfkdf2/passkeys&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\passkeys.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\passkeys.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;liveness&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys liveness&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const prf = await crypto.randomBytes(32)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.passkey(prf)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  passkey: mfkdf.derive.factors.passkey(prf)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;806229ae-259d-4348-8833-656bf233cc12&quot;,&quot;parentUUID&quot;:&quot;6eb2f7d4-335a-402d-8fb2-051fac6a7716&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;safety&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys safety&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:42,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const prf = await crypto.randomBytes(32)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.passkey(prf)\n])\nconst prf2 = await crypto.randomBytes(32)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    passkey: mfkdf.derive.factors.passkey(prf2)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3e93985-b165-41f3-a483-b58a5a7f14c3&quot;,&quot;parentUUID&quot;:&quot;6eb2f7d4-335a-402d-8fb2-051fac6a7716&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;coverage&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys coverage&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .passkey(&#x27;hello&#x27;)\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .passkey(crypto.randomBytes(32), { id: 123 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .passkey(crypto.randomBytes(32), { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .passkey(Buffer.from(&#x27;hello&#x27;))\n  .should.be.rejectedWith(RangeError);\n(() =&gt; {\n  mfkdf.derive.factors.passkey(&#x27;hello&#x27;)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.passkey(Buffer.from(&#x27;hello&#x27;))\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3e204a0f-1270-45ad-9801-e7eea9a9b834&quot;,&quot;parentUUID&quot;:&quot;6eb2f7d4-335a-402d-8fb2-051fac6a7716&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;806229ae-259d-4348-8833-656bf233cc12&quot;,&quot;e3e93985-b165-41f3-a483-b58a5a7f14c3&quot;,&quot;3e204a0f-1270-45ad-9801-e7eea9a9b834&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:88,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;457b45ab-a0eb-40e6-9e78-1e37af75d119&quot;,&quot;title&quot;:&quot;mfkdf2/security&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:391,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst recover = xor(\n  Buffer.from(setup.policy.factors[0].params.pad, &#x27;base64&#x27;),\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n).toString(&#x27;hex&#x27;)\nconst key = setup.key.toString(&#x27;hex&#x27;).slice(0, recover.length)\nrecover.should.not.equal(key)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7f1edfa-6109-4e15-82d7-cf6a5520dd79&quot;,&quot;parentUUID&quot;:&quot;457b45ab-a0eb-40e6-9e78-1e37af75d119&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;fe58bc48-3e35-4b79-aaad-ecb5a79c738b&quot;,&quot;title&quot;:&quot;factor-fungibility&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-fungibility correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:59,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a77a5472-ac71-48ac-b834-ae350e54c7b0&quot;,&quot;parentUUID&quot;:&quot;fe58bc48-3e35-4b79-aaad-ecb5a79c738b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-fungibility incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  )\n)\nconst derive = await mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b850c9f9-548b-499f-82fa-e0d686fea967&quot;,&quot;parentUUID&quot;:&quot;fe58bc48-3e35-4b79-aaad-ecb5a79c738b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a77a5472-ac71-48ac-b834-ae350e54c7b0&quot;,&quot;b850c9f9-548b-499f-82fa-e0d686fea967&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:108,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6508abe5-3e09-4511-9632-9fa516380a72&quot;,&quot;title&quot;:&quot;share-indistinguishability&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;share-size&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security share-indistinguishability share-size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const secret = crypto.randomBytes(32)\nconst shares1 = mfkdf.secrets.share(secret, 1, 3)\nshares1.should.have.length(3)\nfor (const share of shares1) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares1.slice(0, 1).concat([null, null]), 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nmfkdf.secrets\n  .combine([null, null].concat(shares1.slice(2, 3)), 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nconst shares2 = mfkdf.secrets.share(secret, 2, 3)\nshares2.should.have.length(3)\nfor (const share of shares2) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares2.slice(0, 2).concat([null]), 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nmfkdf.secrets\n  .combine([null].concat(shares2.slice(1, 3)), 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nconst shares3 = mfkdf.secrets.share(secret, 3, 3)\nshares3.should.have.length(3)\nfor (const share of shares3) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares3.slice(0, 3), 3, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3fdaa851-df8b-4e9c-885c-8539d5398277&quot;,&quot;parentUUID&quot;:&quot;6508abe5-3e09-4511-9632-9fa516380a72&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3fdaa851-df8b-4e9c-885c-8539d5398277&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b2197146-17bc-46ba-a48b-94e6f90caf32&quot;,&quot;title&quot;:&quot;share-encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security share-encryption correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:128,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst materialp1 = await mfkdf.derive.factors.password(&#x27;password1&#x27;)(\n  setup.policy.factors[0].params\n)\nconst padp1 = Buffer.from(setup.policy.factors[0].pad, &#x27;base64&#x27;)\nconst stretchedp1 = Buffer.from(\n  hkdfSync(\n    &#x27;sha256&#x27;,\n    materialp1.data,\n    setup.policy.factors[0].salt,\n    &#x27;&#x27;,\n    32\n  )\n)\nconst sharep1 = xor(padp1, stretchedp1)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword1&#x27;, { id: &#x27;password1&#x27; })\n)\nconst derive2f = await mfkdf.policy.derive(\n  derive.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nderive2f.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;newPassword1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst materialp3 = await mfkdf.derive.factors.password(&#x27;newPassword1&#x27;)(\n  derive.policy.factors[0].params\n)\nconst padp3 = Buffer.from(derive.policy.factors[0].pad, &#x27;base64&#x27;)\nconst stretchedp3 = Buffer.from(\n  hkdfSync(\n    &#x27;sha256&#x27;,\n    materialp3.data,\n    derive.policy.factors[0].salt,\n    &#x27;&#x27;,\n    32\n  )\n)\nconst sharep3 = xor(padp3, stretchedp3)\nawait derive2.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password1&#x27; })\n)\nconst derive3 = await mfkdf.policy.derive(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsharep1.should.not.equal(sharep3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1bb0dab-0d4e-4208-833a-f3c3f8d235e6&quot;,&quot;parentUUID&quot;:&quot;b2197146-17bc-46ba-a48b-94e6f90caf32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c1bb0dab-0d4e-4208-833a-f3c3f8d235e6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:128,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;21ad7c91-b00f-4aa1-a101-7dc6adcd3c3e&quot;,&quot;title&quot;:&quot;factor-secret-encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-secret-encryption hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\nconst recover = xor(\n  Buffer.from(setup.policy.factors[0].params.pad, &#x27;base64&#x27;),\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n).toString(&#x27;hex&#x27;)\nconst key = setup.key.toString(&#x27;hex&#x27;).slice(0, recover.length)\nrecover.should.not.equal(key)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c4a6e5b0-272a-4d15-b861-ea816caf4e0a&quot;,&quot;parentUUID&quot;:&quot;21ad7c91-b00f-4aa1-a101-7dc6adcd3c3e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c4a6e5b0-272a-4d15-b861-ea816caf4e0a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:48,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5b59abc8-9d6d-436a-84bd-a15a890beb6a&quot;,&quot;title&quot;:&quot;timing-oracle&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6c1a0671-bd52-4ec5-90c8-30e470fc901f&quot;,&quot;title&quot;:&quot;totp/dynamic&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;no-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic no-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:438,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.totp()])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ccfb69f4-1c24-4790-ab23-ee648b240ad3&quot;,&quot;parentUUID&quot;:&quot;6c1a0671-bd52-4ec5-90c8-30e470fc901f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic valid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:509,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d6878f1-edf7-4fe3-9e67-28f2e706c829&quot;,&quot;parentUUID&quot;:&quot;6c1a0671-bd52-4ec5-90c8-30e470fc901f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic invalid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:541,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst oracle2 = {}\ndate = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive2.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ef5cb93-fd7a-43d3-b909-8cccb5cdd839&quot;,&quot;parentUUID&quot;:&quot;6c1a0671-bd52-4ec5-90c8-30e470fc901f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic valid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:514,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;274d600e-b3c5-42c6-86b1-e7dec31d0d5e&quot;,&quot;parentUUID&quot;:&quot;6c1a0671-bd52-4ec5-90c8-30e470fc901f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic invalid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:543,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst oracle2 = {}\ndate = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive2.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8886540c-3fb8-4019-a00b-ba209b7397a3&quot;,&quot;parentUUID&quot;:&quot;6c1a0671-bd52-4ec5-90c8-30e470fc901f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ccfb69f4-1c24-4790-ab23-ee648b240ad3&quot;,&quot;8d6878f1-edf7-4fe3-9e67-28f2e706c829&quot;,&quot;7ef5cb93-fd7a-43d3-b909-8cccb5cdd839&quot;,&quot;274d600e-b3c5-42c6-86b1-e7dec31d0d5e&quot;,&quot;8886540c-3fb8-4019-a00b-ba209b7397a3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2545,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;81bfda52-fd44-4152-a6d0-baf95da0f2f4&quot;,&quot;title&quot;:&quot;totp/static&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;no-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static no-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:443,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, { time: 30001 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, { time: 60001 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4f6fc6b-3fd7-4da0-a050-f6937c9c143b&quot;,&quot;parentUUID&quot;:&quot;81bfda52-fd44-4152-a6d0-baf95da0f2f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static valid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:460,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, {\n    time: 1,\n    oracle\n  })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, {\n    time: 30001,\n    oracle\n  })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, {\n    time: 60001,\n    oracle\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4df5d60-2bba-442a-be81-266fe02badcd&quot;,&quot;parentUUID&quot;:&quot;81bfda52-fd44-4152-a6d0-baf95da0f2f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static invalid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:543,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst oracle2 = {}\ndate = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(528258, {\n      time: 1650430943604,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(99922, {\n      time: 1650430991083,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(398884, {\n      time: 1650431018392,\n      oracle: oracle2\n    })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1c2094c-1ca4-433b-a085-2fa8222eb64b&quot;,&quot;parentUUID&quot;:&quot;81bfda52-fd44-4152-a6d0-baf95da0f2f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static valid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:462,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, {\n    time: 1,\n    oracle\n  })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, {\n    time: 30001,\n    oracle\n  })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, {\n    time: 60001,\n    oracle\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f7c578b-5270-4bd3-865c-188876076a81&quot;,&quot;parentUUID&quot;:&quot;81bfda52-fd44-4152-a6d0-baf95da0f2f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static invalid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:546,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst oracle2 = {}\ndate = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(528258, {\n      time: 1650430943604,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(99922, {\n      time: 1650430991083,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(398884, {\n      time: 1650431018392,\n      oracle: oracle2\n    })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73af0497-162b-46c1-a6f6-8cd2a4f9a25c&quot;,&quot;parentUUID&quot;:&quot;81bfda52-fd44-4152-a6d0-baf95da0f2f4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a4f6fc6b-3fd7-4da0-a050-f6937c9c143b&quot;,&quot;e4df5d60-2bba-442a-be81-266fe02badcd&quot;,&quot;f1c2094c-1ca4-433b-a085-2fa8222eb64b&quot;,&quot;9f7c578b-5270-4bd3-865c-188876076a81&quot;,&quot;73af0497-162b-46c1-a6f6-8cd2a4f9a25c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2454,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b7c12931-f765-4988-b192-71f50c54dcd4&quot;,&quot;title&quot;:&quot;policy-integrity&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security policy-integrity correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b065819-5f72-4c3a-a91c-49264a340cb7&quot;,&quot;parentUUID&quot;:&quot;b7c12931-f765-4988-b192-71f50c54dcd4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/$id&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security policy-integrity invalid/$id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nsetup.policy.$id = &#x27;invalid-id&#x27;\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    {},\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;966d3d03-140d-4941-a7ec-b24366e6bf2f&quot;,&quot;parentUUID&quot;:&quot;b7c12931-f765-4988-b192-71f50c54dcd4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0b065819-5f72-4c3a-a91c-49264a340cb7&quot;,&quot;966d3d03-140d-4941-a7ec-b24366e6bf2f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:81,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;a7f1edfa-6109-4e15-82d7-cf6a5520dd79&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:391,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;24f3eb4d-6277-46d0-9c3e-6580f695e07b&quot;,&quot;title&quot;:&quot;mfkdf2/strengthening&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;strengthening-throws&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-throws&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nawait derive\n  .strenthen(-1, 0)\n  .should.be.rejectedWith(TypeError, &#x27;time must be a non-negative integer&#x27;)\nawait derive\n  .strenthen(1.5, 0)\n  .should.be.rejectedWith(TypeError, &#x27;time must be a non-negative integer&#x27;)\nawait derive\n  .strenthen(0, -1)\n  .should.be.rejectedWith(\n    TypeError,\n    &#x27;memory must be a non-negative integer&#x27;\n  )\nawait derive\n  .strenthen(0, 1.5)\n  .should.be.rejectedWith(\n    TypeError,\n    &#x27;memory must be a non-negative integer&#x27;\n  )&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2cce9006-66df-4530-b55d-0541dee696b4&quot;,&quot;parentUUID&quot;:&quot;24f3eb4d-6277-46d0-9c3e-6580f695e07b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-works-multiple-times&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-works-multiple-times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:376,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive.policy.time = 0\nderive.policy.memory = 0\nawait mfkdf.derive\n  .key(derive.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(Error)\nawait derive2.strenthen(3, 16384)\nderive2.policy.time.should.equal(3)\nderive2.policy.memory.should.equal(16384)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive3.policy.time.should.equal(3)\nderive3.policy.memory.should.equal(16384)\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.policy.time = 0\nderive2.policy.memory = 0\nawait mfkdf.derive\n  .key(derive2.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(Error)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b644894d-7a51-4201-9582-22d63b0b02f3&quot;,&quot;parentUUID&quot;:&quot;24f3eb4d-6277-46d0-9c3e-6580f695e07b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-with-other-factors&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-with-other-factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:200,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n    id: &#x27;password2&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive2.strenthen()\nderive2.policy.time.should.equal(0)\nderive2.policy.memory.should.equal(0)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive3.policy.time.should.equal(0)\nderive3.policy.memory.should.equal(0)\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ee25d5c-2c0d-4f9c-b136-587d9f7d9662&quot;,&quot;parentUUID&quot;:&quot;24f3eb4d-6277-46d0-9c3e-6580f695e07b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-with-reconstitution&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-with-reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:156,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n    id: &#x27;password2&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nawait derive.setThreshold(1)\nawait derive.removeFactor(&#x27;password2&#x27;)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c721d5f-02b0-48cc-8ee0-4e8dc8b9fa1f&quot;,&quot;parentUUID&quot;:&quot;24f3eb4d-6277-46d0-9c3e-6580f695e07b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;27b44099-967a-4d56-9eac-9924a5d87460&quot;,&quot;title&quot;:&quot;setup&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:129,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 5 }\n)\nsetup.policy.time.should.equal(5)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(5)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50407c8d-7679-4438-b8e9-72c90d2cea26&quot;,&quot;parentUUID&quot;:&quot;27b44099-967a-4d56-9eac-9924a5d87460&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:120,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 32768 }\n)\nsetup.policy.memory.should.equal(32768)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.memory.should.equal(32768)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;040476cd-bfb4-4687-9b8d-1200ad3ba7c3&quot;,&quot;parentUUID&quot;:&quot;27b44099-967a-4d56-9eac-9924a5d87460&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time-and-memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup time-and-memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:175,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 3, memory: 16384 }\n)\nsetup.policy.time.should.equal(3)\nsetup.policy.memory.should.equal(16384)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(3)\nderive.policy.memory.should.equal(16384)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c7536ea-7b1f-4537-be33-3caacedfd71a&quot;,&quot;parentUUID&quot;:&quot;27b44099-967a-4d56-9eac-9924a5d87460&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;throws&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup throws&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { time: -1 }\n  )\n  .should.be.rejectedWith(RangeError, &#x27;time must be non-negative&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { time: 1.5 }\n  )\n  .should.be.rejectedWith(TypeError, &#x27;time must be an integer&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { memory: -1 }\n  )\n  .should.be.rejectedWith(RangeError, &#x27;memory must be non-negative&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { memory: 1.5 }\n  )\n  .should.be.rejectedWith(TypeError, &#x27;memory must be an integer&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1046aed3-da30-462b-947c-827a36003e7b&quot;,&quot;parentUUID&quot;:&quot;27b44099-967a-4d56-9eac-9924a5d87460&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;50407c8d-7679-4438-b8e9-72c90d2cea26&quot;,&quot;040476cd-bfb4-4687-9b8d-1200ad3ba7c3&quot;,&quot;1c7536ea-7b1f-4537-be33-3caacedfd71a&quot;,&quot;1046aed3-da30-462b-947c-827a36003e7b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:425,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b5ae848d-1d18-42fc-b0cc-af5b8259dfff&quot;,&quot;title&quot;:&quot;strengthening&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:170,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.time.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(5, 0)\nderive.policy.time.should.equal(5)\nderive.policy.memory.should.equal(0)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(5)\nderive2.policy.memory.should.equal(0)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fbc9aa60-1af0-4460-bddc-d7759bc2a46f&quot;,&quot;parentUUID&quot;:&quot;b5ae848d-1d18-42fc-b0cc-af5b8259dfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:161,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.memory.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.memory.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(0, 32768)\nderive.policy.time.should.equal(0)\nderive.policy.memory.should.equal(32768)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(0)\nderive2.policy.memory.should.equal(32768)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81b83261-118a-4891-bd65-5d1aa3a9c894&quot;,&quot;parentUUID&quot;:&quot;b5ae848d-1d18-42fc-b0cc-af5b8259dfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time-and-memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening time-and-memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.time.should.equal(0)\nsetup.policy.memory.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(0)\nderive.policy.memory.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(3, 16384)\nderive.policy.time.should.equal(3)\nderive.policy.memory.should.equal(16384)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(3)\nderive2.policy.memory.should.equal(16384)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df396c96-01a3-4a3b-84c2-6e66e8a00f0b&quot;,&quot;parentUUID&quot;:&quot;b5ae848d-1d18-42fc-b0cc-af5b8259dfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fbc9aa60-1af0-4460-bddc-d7759bc2a46f&quot;,&quot;81b83261-118a-4891-bd65-5d1aa3a9c894&quot;,&quot;df396c96-01a3-4a3b-84c2-6e66e8a00f0b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:550,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2cce9006-66df-4530-b55d-0541dee696b4&quot;,&quot;b644894d-7a51-4201-9582-22d63b0b02f3&quot;,&quot;8ee25d5c-2c0d-4f9c-b136-587d9f7d9662&quot;,&quot;0c721d5f-02b0-48cc-8ee0-4e8dc8b9fa1f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:779,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3e08e058-7a31-44fa-935e-6226e0890af9&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a36664e-68c1-4a9f-bba6-6ac7b8f9e09b&quot;,&quot;parentUUID&quot;:&quot;3e08e058-7a31-44fa-935e-6226e0890af9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4592599e-2b24-4c43-b5b0-4adf5dc5d0b7&quot;,&quot;parentUUID&quot;:&quot;3e08e058-7a31-44fa-935e-6226e0890af9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d8887f43-16f3-4632-a737-7f77a12ec38a&quot;,&quot;parentUUID&quot;:&quot;3e08e058-7a31-44fa-935e-6226e0890af9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5a36664e-68c1-4a9f-bba6-6ac7b8f9e09b&quot;,&quot;4592599e-2b24-4c43-b5b0-4adf5dc5d0b7&quot;,&quot;d8887f43-16f3-4632-a737-7f77a12ec38a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf5a079c-e6cf-4ac7-a1d0-b930e4b96ed0&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine(\n  [shares[0], shares[1], shares[2]],\n  1,\n  5\n)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a555cc65-578a-41c4-936d-dbb68b48353e&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine(\n  [shares[0], shares[1], shares[2]],\n  2,\n  3\n)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9572c8c7-fbbe-4907-810f-7ffc1555f722&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;),\n  5,\n  255\n)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64d475de-26b2-45bc-b924-83a27015fd11&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;),\n  5,\n  255\n)\nshares.should.be.an(&#x27;array&#x27;).of.length(255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 250; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 255)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[251] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;727ba8be-eae5-4493-99ae-6ef5c3aeacb1&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22189195-177b-4952-b94c-1dd3a0b10c18&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2ecf38cf-7125-468f-8ef7-4ab0a103fff1&quot;,&quot;parentUUID&quot;:&quot;6a84494a-f78b-4a46-af3b-9a2a62f45051&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cf5a079c-e6cf-4ac7-a1d0-b930e4b96ed0&quot;,&quot;a555cc65-578a-41c4-936d-dbb68b48353e&quot;,&quot;9572c8c7-fbbe-4907-810f-7ffc1555f722&quot;,&quot;64d475de-26b2-45bc-b924-83a27015fd11&quot;,&quot;727ba8be-eae5-4493-99ae-6ef5c3aeacb1&quot;,&quot;22189195-177b-4952-b94c-1dd3a0b10c18&quot;,&quot;2ecf38cf-7125-468f-8ef7-4ab0a103fff1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;24c028a6-69ec-45d5-9136-9691068d9c9f&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\new.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\new.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;share-size&quot;,&quot;fullTitle&quot;:&quot;secrets share-size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let secret = crypto.randomBytes(32)\nlet shares = mfkdf.secrets.share(secret, 1, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[0].should.equal(secret)\nshares[1].length.should.equal(32)\nshares[1].should.equal(secret)\nshares[2].length.should.equal(32)\nshares[2].should.equal(secret)\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[1] = null\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[2] = null\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nsecret = crypto.randomBytes(32)\nshares = mfkdf.secrets.share(secret, 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[1].length.should.equal(32)\nshares[2].length.should.equal(32)\nmfkdf.secrets\n  .combine(shares, 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[1] = null\nmfkdf.secrets\n  .combine(shares, 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nsecret = crypto.randomBytes(32)\nshares = mfkdf.secrets.share(secret, 3, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[1].length.should.equal(32)\nshares[2].length.should.equal(32)\nmfkdf.secrets\n  .combine(shares, 3, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13a51d76-46af-4593-95bc-9637607d711c&quot;,&quot;parentUUID&quot;:&quot;24c028a6-69ec-45d5-9136-9691068d9c9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13a51d76-46af-4593-95bc-9637607d711c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1979f213-6361-4595-b603-c6f1315920d5&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ba9247e-11bc-4a49-b853-303e2fea4014&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8beae29-c495-4b87-a986-2ddf9ecb9089&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;378a7c1a-af1f-4ceb-aa31-b8f5c7853325&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9ed5389-fa40-435f-96fd-0969f2f32d3f&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86d02b12-3e9f-45c8-88ac-b0d96d2f64e7&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;37bebaf2-b9cd-4676-b909-e2c971fd25ef&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d41bdc9f-c732-44d9-a4ad-17fc369875a4&quot;,&quot;parentUUID&quot;:&quot;09f6e4a3-6988-4ffa-b5da-6a518cde27b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1979f213-6361-4595-b603-c6f1315920d5&quot;,&quot;3ba9247e-11bc-4a49-b853-303e2fea4014&quot;,&quot;a8beae29-c495-4b87-a986-2ddf9ecb9089&quot;,&quot;378a7c1a-af1f-4ceb-aa31-b8f5c7853325&quot;,&quot;d9ed5389-fa40-435f-96fd-0969f2f32d3f&quot;,&quot;86d02b12-3e9f-45c8-88ac-b0d96d2f64e7&quot;,&quot;37bebaf2-b9cd-4676-b909-e2c971fd25ef&quot;,&quot;d41bdc9f-c732-44d9-a4ad-17fc369875a4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bb9f1fac-21b5-4485-accb-269081a518b3&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5eab04d8-8203-4a74-932f-db54056f5b18&quot;,&quot;parentUUID&quot;:&quot;bb9f1fac-21b5-4485-accb-269081a518b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5dbeaefa-3315-4601-b7f7-fd50aae07232&quot;,&quot;parentUUID&quot;:&quot;bb9f1fac-21b5-4485-accb-269081a518b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8193bc3-ec1a-48ff-8d95-b284948723bc&quot;,&quot;parentUUID&quot;:&quot;bb9f1fac-21b5-4485-accb-269081a518b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5eab04d8-8203-4a74-932f-db54056f5b18&quot;,&quot;5dbeaefa-3315-4601-b7f7-fd50aae07232&quot;,&quot;f8193bc3-ec1a-48ff-8d95-b284948723bc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;cc73fc36-55ec-4f18-933e-4087b91367d9&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .password(&#x27;password&#x27;, { id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b55100d6-6545-4ec7-b49f-c59782d14d16&quot;,&quot;parentUUID&quot;:&quot;cc73fc36-55ec-4f18-933e-4087b91367d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .password(&#x27;password&#x27;, { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;224f9365-bc6d-4e6c-be44-2e3844597e14&quot;,&quot;parentUUID&quot;:&quot;cc73fc36-55ec-4f18-933e-4087b91367d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ce5bc729-4044-44dc-bfc9-a69e3830440d&quot;,&quot;parentUUID&quot;:&quot;cc73fc36-55ec-4f18-933e-4087b91367d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b55100d6-6545-4ec7-b49f-c59782d14d16&quot;,&quot;224f9365-bc6d-4e6c-be44-2e3844597e14&quot;,&quot;ce5bc729-4044-44dc-bfc9-a69e3830440d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;133a8ceb-7419-48a5-926a-b7d685610366&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .uuid({ uuid: 12345 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .uuid({ uuid: &#x27;hello&#x27; })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .uuid({ id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ffd142c-3b04-454d-9092-1a47d1479ad4&quot;,&quot;parentUUID&quot;:&quot;133a8ceb-7419-48a5-926a-b7d685610366&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .uuid({ id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ddaf117f-464a-40ad-acaa-7fcd0f8d0dcc&quot;,&quot;parentUUID&quot;:&quot;133a8ceb-7419-48a5-926a-b7d685610366&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({\n  uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data\n  .toString(&#x27;hex&#x27;)\n  .should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;876a6446-3502-43e3-9447-b25618e37bfc&quot;,&quot;parentUUID&quot;:&quot;133a8ceb-7419-48a5-926a-b7d685610366&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b719491-0993-4e4f-a841-ff6bc54fc5c8&quot;,&quot;parentUUID&quot;:&quot;133a8ceb-7419-48a5-926a-b7d685610366&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ffd142c-3b04-454d-9092-1a47d1479ad4&quot;,&quot;ddaf117f-464a-40ad-acaa-7fcd0f8d0dcc&quot;,&quot;876a6446-3502-43e3-9447-b25618e37bfc&quot;,&quot;3b719491-0993-4e4f-a841-ff6bc54fc5c8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c6812e85-623b-4bbc-98ed-d5980b9c48b6&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26a2c11a-a7ac-4200-b3d6-2d696445153d&quot;,&quot;parentUUID&quot;:&quot;c6812e85-623b-4bbc-98ed-d5980b9c48b6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;12b0de10-6538-4b31-97c4-2642b4c5ccd6&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b2910e49-cf16-4d97-b26b-57427fffa5db&quot;,&quot;parentUUID&quot;:&quot;12b0de10-6538-4b31-97c4-2642b4c5ccd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [await mfkdf.setup.factors.password(&#x27;hello&#x27;)],\n  { id: &#x27;hello-world&#x27; }\n)\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;97b96a29-1c3b-452c-b605-a7aa4fad1c27&quot;,&quot;parentUUID&quot;:&quot;12b0de10-6538-4b31-97c4-2642b4c5ccd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98c08476-b343-4bb3-b4ac-ffe0276a6461&quot;,&quot;parentUUID&quot;:&quot;12b0de10-6538-4b31-97c4-2642b4c5ccd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52a36264-bbcb-4652-b2f5-85dd93219fe7&quot;,&quot;parentUUID&quot;:&quot;12b0de10-6538-4b31-97c4-2642b4c5ccd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b2910e49-cf16-4d97-b26b-57427fffa5db&quot;,&quot;97b96a29-1c3b-452c-b605-a7aa4fad1c27&quot;,&quot;98c08476-b343-4bb3-b4ac-ffe0276a6461&quot;,&quot;52a36264-bbcb-4652-b2f5-85dd93219fe7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:44,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f036fc7b-5941-474a-8e7e-5bbd4327dafa&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b885c6a7-9cd0-43a1-a41d-24606fbe55d7&quot;,&quot;parentUUID&quot;:&quot;f036fc7b-5941-474a-8e7e-5bbd4327dafa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 1 }\n)\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b9aae0a-6d73-4d26-be58-54c785aab484&quot;,&quot;parentUUID&quot;:&quot;f036fc7b-5941-474a-8e7e-5bbd4327dafa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], {\n    threshold: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1b8afad-33f8-4a51-98d8-0860d6b4d648&quot;,&quot;parentUUID&quot;:&quot;f036fc7b-5941-474a-8e7e-5bbd4327dafa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { threshold: 0 })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { threshold: 2 })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c82023d-ccee-4777-8d92-8a8bbac9a1fa&quot;,&quot;parentUUID&quot;:&quot;f036fc7b-5941-474a-8e7e-5bbd4327dafa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b885c6a7-9cd0-43a1-a41d-24606fbe55d7&quot;,&quot;5b9aae0a-6d73-4d26-be58-54c785aab484&quot;,&quot;b1b8afad-33f8-4a51-98d8-0860d6b4d648&quot;,&quot;6c82023d-ccee-4777-8d92-8a8bbac9a1fa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:48,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a3e8bf2a-f538-48b9-bb6c-216a1793f0d6&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b72568ca-953c-4935-bf59-7bdb97a1eddf&quot;,&quot;parentUUID&quot;:&quot;a3e8bf2a-f538-48b9-bb6c-216a1793f0d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [await mfkdf.setup.factors.password(&#x27;hello&#x27;)],\n  { salt: Buffer.from(&#x27;1234567812345678&#x27;, &#x27;base64&#x27;) }\n)\npolicy.salt.should.equal(&#x27;1234567812345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2d5b93a-67d6-40b3-baac-6153fd307ebb&quot;,&quot;parentUUID&quot;:&quot;a3e8bf2a-f538-48b9-bb6c-216a1793f0d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { salt: &#x27;hello&#x27; })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f520dc6-46f6-44ae-b378-67bf0ab8cd45&quot;,&quot;parentUUID&quot;:&quot;a3e8bf2a-f538-48b9-bb6c-216a1793f0d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b72568ca-953c-4935-bf59-7bdb97a1eddf&quot;,&quot;c2d5b93a-67d6-40b3-baac-6153fd307ebb&quot;,&quot;4f520dc6-46f6-44ae-b378-67bf0ab8cd45&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:39,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8acc7d3f-c617-4add-80a5-7c23992f6f4c&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eeac0425-355e-45bf-8a4e-3bf44fd00ff7&quot;,&quot;parentUUID&quot;:&quot;8acc7d3f-c617-4add-80a5-7c23992f6f4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n  ])\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;601f2d92-e039-4b07-a5f0-88a6b44b8695&quot;,&quot;parentUUID&quot;:&quot;8acc7d3f-c617-4add-80a5-7c23992f6f4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: 12345,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: 12345,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: 12345,\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: 12345\n    }\n  ])\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7761fc14-6d40-42d4-b38e-ccb9061f7020&quot;,&quot;parentUUID&quot;:&quot;8acc7d3f-c617-4add-80a5-7c23992f6f4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([]).should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;529e6cff-10b3-4fc4-a41c-5e6910aff3ee&quot;,&quot;parentUUID&quot;:&quot;8acc7d3f-c617-4add-80a5-7c23992f6f4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eeac0425-355e-45bf-8a4e-3bf44fd00ff7&quot;,&quot;601f2d92-e039-4b07-a5f0-88a6b44b8695&quot;,&quot;7761fc14-6d40-42d4-b38e-ccb9061f7020&quot;,&quot;529e6cff-10b3-4fc4-a41c-5e6910aff3ee&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:22,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;26a2c11a-a7ac-4200-b3d6-2d696445153d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:24,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mfkdf2/public/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mfkdf2/public/mochawesome&quot;,&quot;reportTitle&quot;:&quot;mfkdf&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mfkdf2\\public\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\site\\mfkdf2\\public\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\site\\mfkdf2\\public\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>