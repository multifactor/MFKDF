<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:51,&quot;tests&quot;:211,&quot;passes&quot;:211,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2022-04-21T22:37:26.980Z&quot;,&quot;end&quot;:&quot;2022-04-21T22:38:21.406Z&quot;,&quot;duration&quot;:54426,&quot;testsRegistered&quot;:211,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;54655455-67bc-4b6f-a769-9d7dc2a2f847&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;44b9525c-2591-4569-b0c0-5486a14c27f3&quot;,&quot;title&quot;:&quot;asymmetric&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0ae267de-7b92-4ed2-b8f6-d716517162fa&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:365,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa1024&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0dbf6d37-8930-4673-baec-9d261e3fd59e&quot;,&quot;parentUUID&quot;:&quot;0ae267de-7b92-4ed2-b8f6-d716517162fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2040,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa2048&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74092142-1c4d-46a9-b6f3-c407db74cfa4&quot;,&quot;parentUUID&quot;:&quot;0ae267de-7b92-4ed2-b8f6-d716517162fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0dbf6d37-8930-4673-baec-9d261e3fd59e&quot;,&quot;74092142-1c4d-46a9-b6f3-c407db74cfa4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2405,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;title&quot;:&quot;signatures&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:358,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cb22986c-e02f-4e21-89fd-cbc503765c40&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5039,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa2048&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2f1ea7a0-45e2-4860-b966-dca6819f6a7e&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa3072&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa3072&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6980,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa3072&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa3072&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;923c2912-9dce-4f62-b808-f65b190254b9&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11391,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature)\nvalidity.should.be.true\nawait setup.getAsymmetricKeyPair()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8bcf22ec-3d41-4130-baaa-037dffdf716b&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ed25519&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures ed25519&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:119,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nawait setup.getAsymmetricKeyPair(&#x27;ed25519&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a29da5b8-7c84-475b-a133-3b5f3982fd7d&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;unknown&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures unknown&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.getAsymmetricKeyPair(&#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73aba8e0-50ac-4d64-8e45-9a0e5c09cdfc&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8133,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.sign(12345, &#x27;rsa1024&#x27;).should.be.rejectedWith(TypeError)\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nsetup.verify(12345, signature).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b48106a-d31c-43d7-8af6-0e656818529b&quot;,&quot;parentUUID&quot;:&quot;c660f426-e861-4b2b-81c9-415100f3efa0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cb22986c-e02f-4e21-89fd-cbc503765c40&quot;,&quot;2f1ea7a0-45e2-4860-b966-dca6819f6a7e&quot;,&quot;923c2912-9dce-4f62-b808-f65b190254b9&quot;,&quot;8bcf22ec-3d41-4130-baaa-037dffdf716b&quot;,&quot;a29da5b8-7c84-475b-a133-3b5f3982fd7d&quot;,&quot;73aba8e0-50ac-4d64-8e45-9a0e5c09cdfc&quot;,&quot;6b48106a-d31c-43d7-8af6-0e656818529b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:32124,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;encrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:239,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;480dc2db-ab91-4d18-8014-71b663b4cf40&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62081971-d855-42b7-9d58-24ce1b14833b&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9ffe0a0e-b4c5-4172-ab5c-1146c64a5de8&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3b408a9-8078-4983-911c-134eba5af0db&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae892343-ee12-4b76-8e30-aecea7c9c107&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec385aab-102f-4003-9fb1-6d70234e7673&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;93d8a235-2086-4e78-ae12-4b66c6de4200&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7cf1261-c82f-43fe-8f5d-cea747572d27&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c3e73f85-cd2f-43bd-b2d9-76dd668c48cb&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40b56820-7e89-4193-882c-184fe7d0f81a&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42bfed5b-8a69-44df-9d77-f4575834d0bf&quot;,&quot;parentUUID&quot;:&quot;cc537833-6368-46bb-99b0-11f8b51be522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ba95966d-ff55-4f58-b34e-3f813967ede5&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSubkey(32, &#x27;AES256&#x27;, &#x27;sha256&#x27;)\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey(32, &#x27;&#x27;, &#x27;sha512&#x27;)\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b30b974a-04a2-4abd-9995-8b34c588d4fc&quot;,&quot;parentUUID&quot;:&quot;ba95966d-ff55-4f58-b34e-3f813967ede5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;symmetric key&quot;,&quot;fullTitle&quot;:&quot;encrypt utils symmetric key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSymmetricKey()\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47fbf4b0-fbf9-4411-9be6-aaaa8ed7150a&quot;,&quot;parentUUID&quot;:&quot;ba95966d-ff55-4f58-b34e-3f813967ede5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b30b974a-04a2-4abd-9995-8b34c588d4fc&quot;,&quot;47fbf4b0-fbf9-4411-9be6-aaaa8ed7150a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:211,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;eafff9cc-b85c-491e-aec4-cb69dff4bf88&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid key&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(&#x27;hello world&#x27;, &#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ffb7d74-4804-49c7-b633-f5383c2d3bc1&quot;,&quot;parentUUID&quot;:&quot;eafff9cc-b85c-491e-aec4-cb69dff4bf88&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid message&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59e9b2be-006b-4cf2-a4f8-3fa3e8c50869&quot;,&quot;parentUUID&quot;:&quot;eafff9cc-b85c-491e-aec4-cb69dff4bf88&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid ciphertext&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid ciphertext&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.decrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;626ef69a-54dd-4851-a796-2e9e22d900ab&quot;,&quot;parentUUID&quot;:&quot;eafff9cc-b85c-491e-aec4-cb69dff4bf88&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0ffb7d74-4804-49c7-b633-f5383c2d3bc1&quot;,&quot;59e9b2be-006b-4cf2-a4f8-3fa3e8c50869&quot;,&quot;626ef69a-54dd-4851-a796-2e9e22d900ab&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:315,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;480dc2db-ab91-4d18-8014-71b663b4cf40&quot;,&quot;62081971-d855-42b7-9d58-24ce1b14833b&quot;,&quot;9ffe0a0e-b4c5-4172-ab5c-1146c64a5de8&quot;,&quot;d3b408a9-8078-4983-911c-134eba5af0db&quot;,&quot;ae892343-ee12-4b76-8e30-aecea7c9c107&quot;,&quot;ec385aab-102f-4003-9fb1-6d70234e7673&quot;,&quot;93d8a235-2086-4e78-ae12-4b66c6de4200&quot;,&quot;c7cf1261-c82f-43fe-8f5d-cea747572d27&quot;,&quot;c3e73f85-cd2f-43bd-b2d9-76dd668c48cb&quot;,&quot;40b56820-7e89-4193-882c-184fe7d0f81a&quot;,&quot;42bfed5b-8a69-44df-9d77-f4575834d0bf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2448,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fec5cd6e-87c0-4442-8ddf-63611cab1f8a&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4458b7d-2360-41c4-ba71-8e0e29445781&quot;,&quot;parentUUID&quot;:&quot;fec5cd6e-87c0-4442-8ddf-63611cab1f8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64f0d8f1-9672-46db-ad2e-dea76a9f9eae&quot;,&quot;parentUUID&quot;:&quot;fec5cd6e-87c0-4442-8ddf-63611cab1f8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d4458b7d-2360-41c4-ba71-8e0e29445781&quot;,&quot;64f0d8f1-9672-46db-ad2e-dea76a9f9eae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;98395925-ab8f-4ab5-b4b0-4ba6b85f5207&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41b96fbe-8c7c-4ca3-b070-eecd926632f0&quot;,&quot;parentUUID&quot;:&quot;98395925-ab8f-4ab5-b4b0-4ba6b85f5207&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;72ccce59-24b5-40b1-9e8a-0333af79c84b&quot;,&quot;parentUUID&quot;:&quot;98395925-ab8f-4ab5-b4b0-4ba6b85f5207&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;41b96fbe-8c7c-4ca3-b070-eecd926632f0&quot;,&quot;72ccce59-24b5-40b1-9e8a-0333af79c84b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ac603261-9bac-4dfb-ac10-39a9c9485b2c&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:563,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bddf4af-d188-4033-b6d7-8c69c825bd6a&quot;,&quot;parentUUID&quot;:&quot;ac603261-9bac-4dfb-ac10-39a9c9485b2c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:560,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4dbb8a0-92e9-4946-b724-d301c47d4d98&quot;,&quot;parentUUID&quot;:&quot;ac603261-9bac-4dfb-ac10-39a9c9485b2c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nmfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d36372c2-0589-4a02-a688-07367b545e44&quot;,&quot;parentUUID&quot;:&quot;ac603261-9bac-4dfb-ac10-39a9c9485b2c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;180c8cee-5428-404d-9376-6f5e5d1172b7&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:451,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b0da8d6c-6c67-4a9f-9eb8-e02528778803&quot;,&quot;parentUUID&quot;:&quot;180c8cee-5428-404d-9376-6f5e5d1172b7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b0da8d6c-6c67-4a9f-9eb8-e02528778803&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:451,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f0097b98-e28f-48c1-88bd-fb7520f3e2e5&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8bfe25a8-537a-4773-9218-2fd0c5e58857&quot;,&quot;parentUUID&quot;:&quot;f0097b98-e28f-48c1-88bd-fb7520f3e2e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b035d4c0-2b70-4e17-ac38-252ab6bc45d4&quot;,&quot;parentUUID&quot;:&quot;f0097b98-e28f-48c1-88bd-fb7520f3e2e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8bfe25a8-537a-4773-9218-2fd0c5e58857&quot;,&quot;b035d4c0-2b70-4e17-ac38-252ab6bc45d4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:223,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;5bddf4af-d188-4033-b6d7-8c69c825bd6a&quot;,&quot;d4dbb8a0-92e9-4946-b724-d301c47d4d98&quot;,&quot;d36372c2-0589-4a02-a688-07367b545e44&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1235,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5ac2635c-c55c-4df3-b034-4bbb7305624a&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:446,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(891649)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(795484)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3d9651c2-29cd-4f36-a115-ccaeb40b1f2a&quot;,&quot;parentUUID&quot;:&quot;5ac2635c-c55c-4df3-b034-4bbb7305624a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0ca5624-7f16-40c3-aa52-91f6ac125fc9&quot;,&quot;parentUUID&quot;:&quot;5ac2635c-c55c-4df3-b034-4bbb7305624a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5be1bdf7-7843-4aa4-9482-fe595b6c341b&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f0cc9ea-11e0-4363-9ac7-d09ead3f78bd&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f7b2b17-b2cf-41fc-8009-b800f1a0564e&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ddcafb36-83a1-44aa-bee8-a8e9d296183a&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3746434-9af1-47ab-b3f1-e2646d98dcc5&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad8264dd-6f32-48a3-bd83-29f044f983e3&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44d41a70-a43c-4d5a-806e-e4d932746043&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fdd8f1c5-e24e-448a-bacd-045a4ebbc806&quot;,&quot;parentUUID&quot;:&quot;4a8e6a6c-fb78-43c7-8326-4cefab2c22fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5be1bdf7-7843-4aa4-9482-fe595b6c341b&quot;,&quot;4f0cc9ea-11e0-4363-9ac7-d09ead3f78bd&quot;,&quot;8f7b2b17-b2cf-41fc-8009-b800f1a0564e&quot;,&quot;ddcafb36-83a1-44aa-bee8-a8e9d296183a&quot;,&quot;e3746434-9af1-47ab-b3f1-e2646d98dcc5&quot;,&quot;ad8264dd-6f32-48a3-bd83-29f044f983e3&quot;,&quot;44d41a70-a43c-4d5a-806e-e4d932746043&quot;,&quot;fdd8f1c5-e24e-448a-bacd-045a4ebbc806&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;3d9651c2-29cd-4f36-a115-ccaeb40b1f2a&quot;,&quot;e0ca5624-7f16-40c3-aa52-91f6ac125fc9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:553,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2b521faf-3e19-4c6d-b8dd-6968bbbd61f8&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dab9fe09-5c18-4f4f-9cd2-29294060dca2&quot;,&quot;parentUUID&quot;:&quot;2b521faf-3e19-4c6d-b8dd-6968bbbd61f8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0ab418a-1e07-4b4c-bebe-33b3c6b679b1&quot;,&quot;parentUUID&quot;:&quot;2b521faf-3e19-4c6d-b8dd-6968bbbd61f8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:338,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ], { id: &#x27;stack1&#x27; }),\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ], { id: &#x27;stack2&#x27; })\n], { threshold: 1 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f02fa430-2f04-4bfc-a65d-078e77e1c7d9&quot;,&quot;parentUUID&quot;:&quot;2b521faf-3e19-4c6d-b8dd-6968bbbd61f8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dab9fe09-5c18-4f4f-9cd2-29294060dca2&quot;,&quot;a0ab418a-1e07-4b4c-bebe-33b3c6b679b1&quot;,&quot;f02fa430-2f04-4bfc-a65d-078e77e1c7d9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:338,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4ca74f38-61a9-4259-9065-c38a3f7127f9&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1074,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])\nconst code = parseInt(speakeasy.totp({\n  secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n  encoding: &#x27;hex&#x27;,\n  step: setup.outputs.totp.period,\n  algorithm: setup.outputs.totp.algorithm,\n  digits: setup.outputs.totp.digits\n}))\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;65f44591-0d17-4720-b7d2-40938b2ae51f&quot;,&quot;parentUUID&quot;:&quot;4ca74f38-61a9-4259-9065-c38a3f7127f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:796,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(99922, { time: 1650430991083 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(398884, { time: 1650431018392 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;783aa04e-3375-4dc6-8a5a-1c0d4286b670&quot;,&quot;parentUUID&quot;:&quot;4ca74f38-61a9-4259-9065-c38a3f7127f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:431,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b409b5f-e22e-402f-970a-7a48033e4f5e&quot;,&quot;parentUUID&quot;:&quot;4ca74f38-61a9-4259-9065-c38a3f7127f9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9e80008-572d-47c1-ae8c-395083f2d808&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:436,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nmfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1750430943604 })\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6602000-2b4d-4e55-b068-f75e37ad52ec&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7084a77-204c-44b0-8a74-b90df09e3747&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;65f4f89e-f381-46c5-94b3-83ff874434c8&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e6e6c605-4028-467b-a06f-d5566903af5d&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c68e34d-d1e7-4034-a794-12304926a640&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da1bb15a-e7c9-45c0-8dbf-8761970e36eb&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfd04eee-ce15-4469-8810-eb316aaadf27&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2af4df25-4b2c-4bd6-af5e-030dd7080b29&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;daba006c-2e5f-4c10-820b-1148d0924999&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6648655f-6257-43d9-b985-004dc3457ee0&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de16de95-d6eb-4261-945c-d0db43d16155&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4488c9fa-3e87-4237-b046-e1394597d129&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;540c3de4-4c40-40ef-8753-3cbf2c6ae12b&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81921e49-d9e9-4401-986a-f92783441a05&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df466227-db7f-4ca8-8123-fddf17ce0b9c&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c239bf8e-50e7-497f-b8a4-7a627cd42d2a&quot;,&quot;parentUUID&quot;:&quot;4996c768-4e30-48ab-8256-5701425b62df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d9e80008-572d-47c1-ae8c-395083f2d808&quot;,&quot;f6602000-2b4d-4e55-b068-f75e37ad52ec&quot;,&quot;c7084a77-204c-44b0-8a74-b90df09e3747&quot;,&quot;65f4f89e-f381-46c5-94b3-83ff874434c8&quot;,&quot;e6e6c605-4028-467b-a06f-d5566903af5d&quot;,&quot;4c68e34d-d1e7-4034-a794-12304926a640&quot;,&quot;da1bb15a-e7c9-45c0-8dbf-8761970e36eb&quot;,&quot;dfd04eee-ce15-4469-8810-eb316aaadf27&quot;,&quot;2af4df25-4b2c-4bd6-af5e-030dd7080b29&quot;,&quot;daba006c-2e5f-4c10-820b-1148d0924999&quot;,&quot;6648655f-6257-43d9-b985-004dc3457ee0&quot;,&quot;de16de95-d6eb-4261-945c-d0db43d16155&quot;,&quot;4488c9fa-3e87-4237-b046-e1394597d129&quot;,&quot;540c3de4-4c40-40ef-8753-3cbf2c6ae12b&quot;,&quot;81921e49-d9e9-4401-986a-f92783441a05&quot;,&quot;df466227-db7f-4ca8-8123-fddf17ce0b9c&quot;,&quot;c239bf8e-50e7-497f-b8a4-7a627cd42d2a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:437,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;65f44591-0d17-4720-b7d2-40938b2ae51f&quot;,&quot;783aa04e-3375-4dc6-8a5a-1c0d4286b670&quot;,&quot;3b409b5f-e22e-402f-970a-7a48033e4f5e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2301,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;95fa8ea5-9492-406e-a5a8-7b764e5c30a0&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:579,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca5e82f5-ffc8-48ac-aa8d-5b33d311ae4e&quot;,&quot;parentUUID&quot;:&quot;95fa8ea5-9492-406e-a5a8-7b764e5c30a0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:559,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a930f986-0a1a-4e98-b6f3-b934f31db62b&quot;,&quot;parentUUID&quot;:&quot;95fa8ea5-9492-406e-a5a8-7b764e5c30a0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ca5e82f5-ffc8-48ac-aa8d-5b33d311ae4e&quot;,&quot;a930f986-0a1a-4e98-b6f3-b934f31db62b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1138,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;title&quot;:&quot;kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;types&quot;,&quot;fullTitle&quot;:&quot;kdf types&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:429,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const pbkdf2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst bcrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst scrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nconst argon2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nBuffer.isBuffer(pbkdf2).should.be.true\nBuffer.isBuffer(bcrypt).should.be.true\nBuffer.isBuffer(scrypt).should.be.true\nBuffer.isBuffer(argon2).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfd4c3fc-6fc5-42b8-b7ab-bb387c6f976e&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha1&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 25555,\n    digest: &#x27;sha1&#x27;\n  }\n})\nBuffer.isBuffer(key).should.be.true\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;8ee4a527b20aa8feeb78d70447d84e20&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfa2601b-fc7f-47a3-bb43-8a1bbd73e6e0&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha512&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha512&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:41,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secret&#x27;, &#x27;salt&#x27;, 64, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha512&#x27;\n  }\n})\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;3745e482c6e0ade35da10139e797157f4a5da669dad7d5da88ef87e47471cc47ed941c7ad618e827304f083f8707f12b7cfdd5f489b782f10cc269e3c08d59ae&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a5b7025f-80ac-4785-8486-a7931bafd6bf&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/default&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3e23ecb2-5e11-4654-b4c5-53856b2b3974&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/same&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/same&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0610a1d4-01eb-4977-9b2b-67210bdc1d81&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/inputdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/inputdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password2&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;94274952-6fb3-4c8c-9e98-1ff0ce456a10&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/saltdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/saltdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:118,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c5d8d5f-2928-47ab-9933-9e5f4913ba42&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/rounddiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/rounddiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:171,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 10 } })\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 11 } })\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f65ab5fa-ca6f-4eca-ac43-83216264e43e&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/length&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:170,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key16 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key16).should.equal(16)\nconst key32 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key32).should.equal(32)\nconst key64 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key64).should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e5ec7d1b-7e51-4d09-a400-2433c342d16d&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/known&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/known&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;cb36d3d02d502acdf10dfc2d022bf3c024f16a368ba2df4456fbf97291f64334&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e1d638ba-7fef-4c8d-b2e4-f7d8bc4b4b13&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/fast&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:188,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 16384, scryptblocksize: 8, scryptparallelism: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;745731af4484f323968969eda289aeee005b5903ac561e64a5aca121797bf7734ef9fd58422e2e22183bcacba9ec87ba0c83b7a2e788f03ce0da06463433cda6&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c6b60755-ff05-4250-9c4d-fd85277ca29f&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/defaults&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:193,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;9009fca57ef2b8c342bdad6b9247e4a1b5bd85628152116513ad44e93cf1b0e2&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9d99955-9bc5-4185-8a3d-12238cd3d663&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/N&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/N&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ceb6a6bf4f4afeb3d1806714474d4f00ca97c2ad76a641269192d11444e13a6b&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;998d72bc-da56-424b-a626-ac868f3bcb85&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/R&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/R&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptblocksize: 16 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;a63de1de715f95bebd9f6d58d78ff11028a8412c1fcf71673544373c67095836&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;015e353f-3af6-4469-b306-870539ad01c4&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/P&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/P&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptparallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ef224277727457992dc05983b1fd1208bae35b100c853ba4bb11f1ba7ca4c436&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0147e07f-c9b3-4f47-9946-6eccfc68998b&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2i&quot;,&quot;fullTitle&quot;:&quot;kdf argon2i&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2i&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;7357892df510f136a0688ceab37bbaf7ba695de590065072717fa6728961c92a&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a6a91d6-6f9e-448d-84a9-84531fc6251b&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2d&quot;,&quot;fullTitle&quot;:&quot;kdf argon2d&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2d&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;423b0dcc7bbfe16fa8ee7a2e2ebd8891873d726f9dfe70890a7197a5503a2848&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2485b54c-a014-409d-8508-b316675cbdb8&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f129e852-c2c2-4e31-84ea-92a644f2d9fa&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/mem&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/mem&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:70,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2mem: 16384 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;e043f979311b14ff8378b785469974e899a08f05509323a04b2ca29ef63ff3af&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2cae4f5e-165a-4b27-89ab-df2933378c1f&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/time&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2time: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;bf6b1773bdae362ecea04b889079b6628d1f35d96a2be9f2a5481c2d1236e8d7&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9628712-f3c5-4792-99dc-351862d6df36&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/parallelism&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/parallelism&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2parallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5c12c6873b938cd8467b677d23e525389e3ff7ed62b4ad9e285e1191244f40ca&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f84e001f-cae7-43bb-9d89-c42f0878516a&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;kdf default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({}))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b8b7c4d-edfb-498f-88f9-042f4bec533a&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;kdf invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;invalid&#x27;, params: { } }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ce279d2-f869-40bf-9e54-1e81693c240b&quot;,&quot;parentUUID&quot;:&quot;a13cc66c-c6de-47a3-8c5e-ff41b81b186d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dfd4c3fc-6fc5-42b8-b7ab-bb387c6f976e&quot;,&quot;dfa2601b-fc7f-47a3-bb43-8a1bbd73e6e0&quot;,&quot;a5b7025f-80ac-4785-8486-a7931bafd6bf&quot;,&quot;3e23ecb2-5e11-4654-b4c5-53856b2b3974&quot;,&quot;0610a1d4-01eb-4977-9b2b-67210bdc1d81&quot;,&quot;94274952-6fb3-4c8c-9e98-1ff0ce456a10&quot;,&quot;2c5d8d5f-2928-47ab-9933-9e5f4913ba42&quot;,&quot;f65ab5fa-ca6f-4eca-ac43-83216264e43e&quot;,&quot;e5ec7d1b-7e51-4d09-a400-2433c342d16d&quot;,&quot;e1d638ba-7fef-4c8d-b2e4-f7d8bc4b4b13&quot;,&quot;c6b60755-ff05-4250-9c4d-fd85277ca29f&quot;,&quot;f9d99955-9bc5-4185-8a3d-12238cd3d663&quot;,&quot;998d72bc-da56-424b-a626-ac868f3bcb85&quot;,&quot;015e353f-3af6-4469-b306-870539ad01c4&quot;,&quot;0147e07f-c9b3-4f47-9946-6eccfc68998b&quot;,&quot;5a6a91d6-6f9e-448d-84a9-84531fc6251b&quot;,&quot;2485b54c-a014-409d-8508-b316675cbdb8&quot;,&quot;f129e852-c2c2-4e31-84ea-92a644f2d9fa&quot;,&quot;2cae4f5e-165a-4b27-89ab-df2933378c1f&quot;,&quot;d9628712-f3c5-4792-99dc-351862d6df36&quot;,&quot;f84e001f-cae7-43bb-9d89-c42f0878516a&quot;,&quot;5b8b7c4d-edfb-498f-88f9-042f4bec533a&quot;,&quot;0ce279d2-f869-40bf-9e54-1e81693c240b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2413,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;07c93673-68dd-468e-a5dd-58cb0d5a9737&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b95f4027-10bc-4e5e-b6b3-ab347fda127e&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e70004a5-7cc5-46ee-9df2-75088f5d3b1a&quot;,&quot;parentUUID&quot;:&quot;b95f4027-10bc-4e5e-b6b3-ab347fda127e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password2&#x27; })\n    )\n  )\n).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4680d607-7bc7-407d-ba93-aea0c7d28cba&quot;,&quot;parentUUID&quot;:&quot;b95f4027-10bc-4e5e-b6b3-ab347fda127e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e70004a5-7cc5-46ee-9df2-75088f5d3b1a&quot;,&quot;4680d607-7bc7-407d-ba93-aea0c7d28cba&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:217,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;66c1d3f1-0015-49aa-bf5d-2cbf99bae00a&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4542c2aa-cf20-4fe6-9006-86944426fe6f&quot;,&quot;parentUUID&quot;:&quot;66c1d3f1-0015-49aa-bf5d-2cbf99bae00a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76be6e83-081a-48de-b7b4-4f0394eb1dce&quot;,&quot;parentUUID&quot;:&quot;66c1d3f1-0015-49aa-bf5d-2cbf99bae00a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4542c2aa-cf20-4fe6-9006-86944426fe6f&quot;,&quot;76be6e83-081a-48de-b7b4-4f0394eb1dce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:212,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe5de405-acdf-47ee-affe-3857375b3e9f&quot;,&quot;parentUUID&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8aaac2a0-eca3-4de2-8f16-ef24a38317ae&quot;,&quot;parentUUID&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59544343-d469-45fa-bb92-626e2e4cc3ff&quot;,&quot;parentUUID&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:616,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;71b17c1a-1135-4475-9a95-dc2066bccffc&quot;,&quot;parentUUID&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:349,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81a36738-ad22-49bb-b3ac-569a9eea7026&quot;,&quot;parentUUID&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:247,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;865a271c-bc17-4e7c-9605-45eb747a13d6&quot;,&quot;parentUUID&quot;:&quot;77556fc6-53c2-486f-874f-b870b347c43f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fe5de405-acdf-47ee-affe-3857375b3e9f&quot;,&quot;8aaac2a0-eca3-4de2-8f16-ef24a38317ae&quot;,&quot;59544343-d469-45fa-bb92-626e2e4cc3ff&quot;,&quot;71b17c1a-1135-4475-9a95-dc2066bccffc&quot;,&quot;81a36738-ad22-49bb-b3ac-569a9eea7026&quot;,&quot;865a271c-bc17-4e7c-9605-45eb747a13d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1884,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9c98fefa-a3ee-487e-ae46-d7a7e8996fad&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n])\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;579b784b-67a4-4391-81ad-686c1306d405&quot;,&quot;parentUUID&quot;:&quot;9c98fefa-a3ee-487e-ae46-d7a7e8996fad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8cbd6177-eef0-4de8-aca6-166585af448e&quot;,&quot;parentUUID&quot;:&quot;9c98fefa-a3ee-487e-ae46-d7a7e8996fad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;579b784b-67a4-4391-81ad-686c1306d405&quot;,&quot;8cbd6177-eef0-4de8-aca6-166585af448e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:214,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;03225f39-5572-493f-b05c-4dec8ca57393&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:445,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nderive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(derive2.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae3c78c1-d116-424e-b9f8-aacba7cebd53&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:445,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;432cc6f0-5385-4d81-8be1-c1fe6cf42390&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a62819fc-55c6-4dd9-868f-8b432b86c083&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e55a7a3b-7e86-460f-beb3-df3213df714a&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b6ea71e-922e-4c0b-8082-71f156034f19&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5dd1e9b0-cab2-4dac-9f45-15e62720484f&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute([&#x27;password1&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;921ff46a-736b-4555-ac59-c5dfdc46785f&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55edc0a7-80f4-46b2-af43-9b0cf212aea9&quot;,&quot;parentUUID&quot;:&quot;90a644fa-94ea-4e2f-9f80-eb357ed4b8b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([12345], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b99dd998-07a6-4aad-b941-25cf2c9451b1&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([&#x27;password4&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;231e91c6-9b39-431c-9ca1-5f015a2b3497&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.reconstitute([&#x27;password3&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c827e40-607b-4311-935e-e9a10d6b1f40&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute(&#x27;hello&#x27;, [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2ac75130-9eea-4c63-8361-1ad2c22fa788&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], &#x27;12345&#x27;, 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3fb66a1c-ca61-4d23-b455-97208b9ff5e8&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], &#x27;12345&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3ec42e6-22d3-435d-9211-70cf56acfcc7&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5292806d-68d9-4efc-8271-109912bc1968&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: 12345,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;608d0711-8daf-491d-8953-a6dcde10db4b&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f60795f-0bd4-43fb-8b93-2539cfdd55e6&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6da53eb6-2fdb-4d9b-bf1e-528e81bdd988&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae83b77d-5220-4a75-aeb9-96be54acca8a&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;949adfa0-52db-4ec5-b99e-bf05e640e860&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9ccc144b-fa5f-4dfe-9554-900aca636cbe&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: 12345,\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aabf5334-38ed-4177-8ab7-1a70a07c6e7e&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: 12345\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee2bfd75-facd-4b7a-be51-a1bb484cb080&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5c16b1d-c790-4339-8eb5-66a62e388604&quot;,&quot;parentUUID&quot;:&quot;5fe3643f-aca9-4c9a-8cb5-666080dedf7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b99dd998-07a6-4aad-b941-25cf2c9451b1&quot;,&quot;231e91c6-9b39-431c-9ca1-5f015a2b3497&quot;,&quot;4c827e40-607b-4311-935e-e9a10d6b1f40&quot;,&quot;2ac75130-9eea-4c63-8361-1ad2c22fa788&quot;,&quot;3fb66a1c-ca61-4d23-b455-97208b9ff5e8&quot;,&quot;e3ec42e6-22d3-435d-9211-70cf56acfcc7&quot;,&quot;5292806d-68d9-4efc-8271-109912bc1968&quot;,&quot;608d0711-8daf-491d-8953-a6dcde10db4b&quot;,&quot;5f60795f-0bd4-43fb-8b93-2539cfdd55e6&quot;,&quot;6da53eb6-2fdb-4d9b-bf1e-528e81bdd988&quot;,&quot;ae83b77d-5220-4a75-aeb9-96be54acca8a&quot;,&quot;949adfa0-52db-4ec5-b99e-bf05e640e860&quot;,&quot;9ccc144b-fa5f-4dfe-9554-900aca636cbe&quot;,&quot;aabf5334-38ed-4177-8ab7-1a70a07c6e7e&quot;,&quot;ee2bfd75-facd-4b7a-be51-a1bb484cb080&quot;,&quot;f5c16b1d-c790-4339-8eb5-66a62e388604&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1673,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;03225f39-5572-493f-b05c-4dec8ca57393&quot;,&quot;ae3c78c1-d116-424e-b9f8-aacba7cebd53&quot;,&quot;432cc6f0-5385-4d81-8be1-c1fe6cf42390&quot;,&quot;a62819fc-55c6-4dd9-868f-8b432b86c083&quot;,&quot;e55a7a3b-7e86-460f-beb3-df3213df714a&quot;,&quot;0b6ea71e-922e-4c0b-8082-71f156034f19&quot;,&quot;5dd1e9b0-cab2-4dac-9f45-15e62720484f&quot;,&quot;921ff46a-736b-4555-ac59-c5dfdc46785f&quot;,&quot;55edc0a7-80f4-46b2-af43-9b0cf212aea9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2422,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d81a80f1-d5ac-4871-b5a5-67234b2cb7fd&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8bdb57bb-3d26-454a-bd33-4434467b43bc&quot;,&quot;parentUUID&quot;:&quot;d81a80f1-d5ac-4871-b5a5-67234b2cb7fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b2192f21-0de9-46ae-8745-e6a60b80e2bc&quot;,&quot;parentUUID&quot;:&quot;d81a80f1-d5ac-4871-b5a5-67234b2cb7fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52583a65-0e8a-45e4-b7c4-dae986a83e4e&quot;,&quot;parentUUID&quot;:&quot;d81a80f1-d5ac-4871-b5a5-67234b2cb7fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8bdb57bb-3d26-454a-bd33-4434467b43bc&quot;,&quot;b2192f21-0de9-46ae-8745-e6a60b80e2bc&quot;,&quot;52583a65-0e8a-45e4-b7c4-dae986a83e4e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf23bf00-8857-4b2c-9e25-9e09c63137c1&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 1, 5)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5aa0d713-a5bb-4d60-99fb-0da0586ef5f6&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 2, 3)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96bdf89d-b0cd-4856-a455-4fa7b3276374&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7813652-7a77-453f-900b-9e59b34eaa0d&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:84,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 1024)\nshares.should.be.an(&#x27;array&#x27;).of.length(1024)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 1020; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[1023] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f10eec6e-85bf-4286-b233-0f4c665b4fcb&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)\nxor(shares[0], shares[1]).toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44580dc4-bd21-4369-948e-b1c2fdeed849&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7db1613-2207-4a10-848f-583f502f3e93&quot;,&quot;parentUUID&quot;:&quot;d014feaa-1d17-4758-9240-57fdf7cb7e42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cf23bf00-8857-4b2c-9e25-9e09c63137c1&quot;,&quot;5aa0d713-a5bb-4d60-99fb-0da0586ef5f6&quot;,&quot;96bdf89d-b0cd-4856-a455-4fa7b3276374&quot;,&quot;e7813652-7a77-453f-900b-9e59b34eaa0d&quot;,&quot;f10eec6e-85bf-4286-b233-0f4c665b4fcb&quot;,&quot;44580dc4-bd21-4369-948e-b1c2fdeed849&quot;,&quot;e7db1613-2207-4a10-848f-583f502f3e93&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:96,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44cde941-f542-4673-9542-34810f6a0d18&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a609f646-97f6-49d0-ad30-3b025c413219&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0b0c8a4-1be1-4018-8737-dec38e6ae96e&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ba99453-1606-46b0-86cb-ea0b9d3482e9&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a79c95d-9a0d-4a4d-b488-95340926e5bf&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fce0b977-6dfc-405e-b2ad-a161efc44f1e&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5956d3bd-d836-4d2e-a7d0-825a2c1bc93b&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff2baca5-d2d2-41de-a87d-ed6d0d52bef4&quot;,&quot;parentUUID&quot;:&quot;20bf5223-589a-48b7-a46c-e2731ebc7129&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;44cde941-f542-4673-9542-34810f6a0d18&quot;,&quot;a609f646-97f6-49d0-ad30-3b025c413219&quot;,&quot;d0b0c8a4-1be1-4018-8737-dec38e6ae96e&quot;,&quot;7ba99453-1606-46b0-86cb-ea0b9d3482e9&quot;,&quot;9a79c95d-9a0d-4a4d-b488-95340926e5bf&quot;,&quot;fce0b977-6dfc-405e-b2ad-a161efc44f1e&quot;,&quot;5956d3bd-d836-4d2e-a7d0-825a2c1bc93b&quot;,&quot;ff2baca5-d2d2-41de-a87d-ed6d0d52bef4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4933085c-a36a-42be-8c6f-560c4eeb1dce&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c61112b2-5ae4-4e01-8911-62975c61610d&quot;,&quot;parentUUID&quot;:&quot;4933085c-a36a-42be-8c6f-560c4eeb1dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25ac4b3f-5e11-41ef-916d-c78034a37ff7&quot;,&quot;parentUUID&quot;:&quot;4933085c-a36a-42be-8c6f-560c4eeb1dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e407bc2-8659-4f76-b0a0-d8f4c0cbb017&quot;,&quot;parentUUID&quot;:&quot;4933085c-a36a-42be-8c6f-560c4eeb1dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c61112b2-5ae4-4e01-8911-62975c61610d&quot;,&quot;25ac4b3f-5e11-41ef-916d-c78034a37ff7&quot;,&quot;5e407bc2-8659-4f76-b0a0-d8f4c0cbb017&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bc2e7c58-6eb9-4a34-ae15-edd05ecbcc76&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22ef2603-c56a-4a83-8a2c-a1cacf637364&quot;,&quot;parentUUID&quot;:&quot;bc2e7c58-6eb9-4a34-ae15-edd05ecbcc76&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2b82930-12c8-4dfa-82a1-6ebd8751381f&quot;,&quot;parentUUID&quot;:&quot;bc2e7c58-6eb9-4a34-ae15-edd05ecbcc76&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7fce410d-f633-4076-986b-3c65f80f20e0&quot;,&quot;parentUUID&quot;:&quot;bc2e7c58-6eb9-4a34-ae15-edd05ecbcc76&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;22ef2603-c56a-4a83-8a2c-a1cacf637364&quot;,&quot;a2b82930-12c8-4dfa-82a1-6ebd8751381f&quot;,&quot;7fce410d-f633-4076-986b-3c65f80f20e0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ea6f465f-e65d-426c-8078-481bb86057aa&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ uuid: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ uuid: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;320c08f8-d55e-4bf4-983e-5684b7c58224&quot;,&quot;parentUUID&quot;:&quot;ea6f465f-e65d-426c-8078-481bb86057aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e721487-f4d8-40c9-bfed-797341c89d54&quot;,&quot;parentUUID&quot;:&quot;ea6f465f-e65d-426c-8078-481bb86057aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({ uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7033e81a-a0fc-4ca8-9861-1bb1324f8c3a&quot;,&quot;parentUUID&quot;:&quot;ea6f465f-e65d-426c-8078-481bb86057aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90c2b6d1-6938-49c5-8f6e-ea5d8609037a&quot;,&quot;parentUUID&quot;:&quot;ea6f465f-e65d-426c-8078-481bb86057aa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;320c08f8-d55e-4bf4-983e-5684b7c58224&quot;,&quot;9e721487-f4d8-40c9-bfed-797341c89d54&quot;,&quot;7033e81a-a0fc-4ca8-9861-1bb1324f8c3a&quot;,&quot;90c2b6d1-6938-49c5-8f6e-ea5d8609037a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ab001b1d-be4b-4293-beb5-a2119ef802cc&quot;,&quot;title&quot;:&quot;setup/kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;bd678880-5aba-4bd3-9e72-d1ab40a45b14&quot;,&quot;title&quot;:&quot;pbkdf2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d34d62f2-d0ad-4381-8a8f-1cfb46418947&quot;,&quot;parentUUID&quot;:&quot;bd678880-5aba-4bd3-9e72-d1ab40a45b14&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;fec3956d-dbc1-41a4-bd60-3c20ddeaaaf8&quot;,&quot;title&quot;:&quot;pbkdf2rounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6075769a-b70f-43e6-b3c4-7829fb316f51&quot;,&quot;parentUUID&quot;:&quot;fec3956d-dbc1-41a4-bd60-3c20ddeaaaf8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;604ba055-ce5f-4a0c-bf3f-6cd0e957ef21&quot;,&quot;parentUUID&quot;:&quot;fec3956d-dbc1-41a4-bd60-3c20ddeaaaf8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d4e923b-df80-4c42-bd9b-edc566e26a35&quot;,&quot;parentUUID&quot;:&quot;fec3956d-dbc1-41a4-bd60-3c20ddeaaaf8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6075769a-b70f-43e6-b3c4-7829fb316f51&quot;,&quot;604ba055-ce5f-4a0c-bf3f-6cd0e957ef21&quot;,&quot;7d4e923b-df80-4c42-bd9b-edc566e26a35&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f91d9a2d-076a-4133-9a0a-b6ec642b5781&quot;,&quot;title&quot;:&quot;pbkdf2digest&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: 0\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01a9670c-8cb6-4346-9a95-c757b1605c66&quot;,&quot;parentUUID&quot;:&quot;f91d9a2d-076a-4133-9a0a-b6ec642b5781&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b97eb21-d0cc-4f90-809f-a09a6f5b06a7&quot;,&quot;parentUUID&quot;:&quot;f91d9a2d-076a-4133-9a0a-b6ec642b5781&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2digest: &#x27;sha512&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha512&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b4079a5-f482-43f4-8830-c584f96846ab&quot;,&quot;parentUUID&quot;:&quot;f91d9a2d-076a-4133-9a0a-b6ec642b5781&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;01a9670c-8cb6-4346-9a95-c757b1605c66&quot;,&quot;6b97eb21-d0cc-4f90-809f-a09a6f5b06a7&quot;,&quot;0b4079a5-f482-43f4-8830-c584f96846ab&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;d34d62f2-d0ad-4381-8a8f-1cfb46418947&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d15509f3-8ca7-4a40-832e-8dbe746fa200&quot;,&quot;title&quot;:&quot;bcrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 10\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cee32db4-91ff-4db2-9660-77f1a7e39bc2&quot;,&quot;parentUUID&quot;:&quot;d15509f3-8ca7-4a40-832e-8dbe746fa200&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0ecfd09c-0109-47bd-bf1a-019c470174e9&quot;,&quot;title&quot;:&quot;bcryptrounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89092bbb-b513-4cd4-99a5-9fb7819fb4c8&quot;,&quot;parentUUID&quot;:&quot;0ecfd09c-0109-47bd-bf1a-019c470174e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c5f0ac18-e223-42e3-b37c-2175c89a6961&quot;,&quot;parentUUID&quot;:&quot;0ecfd09c-0109-47bd-bf1a-019c470174e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;,\n  bcryptrounds: 25\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 25\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;11b6de80-10c1-47a4-b986-0cf655ccfba2&quot;,&quot;parentUUID&quot;:&quot;0ecfd09c-0109-47bd-bf1a-019c470174e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;89092bbb-b513-4cd4-99a5-9fb7819fb4c8&quot;,&quot;c5f0ac18-e223-42e3-b37c-2175c89a6961&quot;,&quot;11b6de80-10c1-47a4-b986-0cf655ccfba2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;cee32db4-91ff-4db2-9660-77f1a7e39bc2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b965ad76-5f62-47fd-a3d3-af5dae13fd54&quot;,&quot;title&quot;:&quot;scrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8cd769ec-2e1b-42d4-bc93-8de367fb76fb&quot;,&quot;parentUUID&quot;:&quot;b965ad76-5f62-47fd-a3d3-af5dae13fd54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f05103d1-1c0f-4922-ab63-39501e60b152&quot;,&quot;title&quot;:&quot;scryptcost&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7cc3a4f5-b3a0-47c8-acf5-3604bea4e360&quot;,&quot;parentUUID&quot;:&quot;f05103d1-1c0f-4922-ab63-39501e60b152&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;95136401-1d7b-4faa-8bb2-9f25fd9e7c1d&quot;,&quot;parentUUID&quot;:&quot;f05103d1-1c0f-4922-ab63-39501e60b152&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptcost: 12345\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 12345,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;97499bc4-d398-42e9-9981-886364f213d5&quot;,&quot;parentUUID&quot;:&quot;f05103d1-1c0f-4922-ab63-39501e60b152&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7cc3a4f5-b3a0-47c8-acf5-3604bea4e360&quot;,&quot;95136401-1d7b-4faa-8bb2-9f25fd9e7c1d&quot;,&quot;97499bc4-d398-42e9-9981-886364f213d5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1dc3b6c1-b15b-4fee-b403-d6a469e5b074&quot;,&quot;title&quot;:&quot;scryptblocksize&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1cd91e3-06ef-4434-8646-b9fac295429e&quot;,&quot;parentUUID&quot;:&quot;1dc3b6c1-b15b-4fee-b403-d6a469e5b074&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;029a85f1-d052-450b-b430-32177289c74d&quot;,&quot;parentUUID&quot;:&quot;1dc3b6c1-b15b-4fee-b403-d6a469e5b074&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptblocksize: 24\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 24,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e5ce20a-729f-446b-a366-e476236bb450&quot;,&quot;parentUUID&quot;:&quot;1dc3b6c1-b15b-4fee-b403-d6a469e5b074&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c1cd91e3-06ef-4434-8646-b9fac295429e&quot;,&quot;029a85f1-d052-450b-b430-32177289c74d&quot;,&quot;0e5ce20a-729f-446b-a366-e476236bb450&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bdbc54ce-be78-45a7-828e-344500a9f036&quot;,&quot;title&quot;:&quot;scryptparallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96643dff-2a62-4e9e-9cec-1b4fd743e5d0&quot;,&quot;parentUUID&quot;:&quot;bdbc54ce-be78-45a7-828e-344500a9f036&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2cdedc4-22eb-4172-b8be-59de5a1bac0a&quot;,&quot;parentUUID&quot;:&quot;bdbc54ce-be78-45a7-828e-344500a9f036&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptparallelism: 2\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3e0f2bad-65a9-4e8e-ae64-a7b11b10547f&quot;,&quot;parentUUID&quot;:&quot;bdbc54ce-be78-45a7-828e-344500a9f036&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;96643dff-2a62-4e9e-9cec-1b4fd743e5d0&quot;,&quot;a2cdedc4-22eb-4172-b8be-59de5a1bac0a&quot;,&quot;3e0f2bad-65a9-4e8e-ae64-a7b11b10547f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;8cd769ec-2e1b-42d4-bc93-8de367fb76fb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7a1bf3d8-cff7-4861-a054-5e9b7ebc9818&quot;,&quot;title&quot;:&quot;argon2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e22e0402-e2ed-44f6-b962-3aad31c26155&quot;,&quot;parentUUID&quot;:&quot;7a1bf3d8-cff7-4861-a054-5e9b7ebc9818&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: 123\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec06202b-6a00-4b7e-9b78-a21612372953&quot;,&quot;parentUUID&quot;:&quot;7a1bf3d8-cff7-4861-a054-5e9b7ebc9818&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e9199226-cd42-4232-806f-c6c53b15f622&quot;,&quot;parentUUID&quot;:&quot;7a1bf3d8-cff7-4861-a054-5e9b7ebc9818&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0569f451-d09b-49b9-9868-962dca0f9f24&quot;,&quot;title&quot;:&quot;argon2time&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a077b29e-300e-4a58-8b0e-5a7b42bd4568&quot;,&quot;parentUUID&quot;:&quot;0569f451-d09b-49b9-9868-962dca0f9f24&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e2e53ab-86a1-4b42-b65d-4cb6f436ad18&quot;,&quot;parentUUID&quot;:&quot;0569f451-d09b-49b9-9868-962dca0f9f24&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2d&#x27;,\n  argon2time: 10\n}).should.deep.equal({\n  type: &#x27;argon2d&#x27;,\n  params: {\n    rounds: 10,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e10bbd30-4afa-4ddf-817d-d237f873c461&quot;,&quot;parentUUID&quot;:&quot;0569f451-d09b-49b9-9868-962dca0f9f24&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a077b29e-300e-4a58-8b0e-5a7b42bd4568&quot;,&quot;9e2e53ab-86a1-4b42-b65d-4cb6f436ad18&quot;,&quot;e10bbd30-4afa-4ddf-817d-d237f873c461&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ca15da0c-beee-4d2f-8550-3da4acce463e&quot;,&quot;title&quot;:&quot;argon2mem&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa503cc0-6630-4023-bf04-4503d44e1785&quot;,&quot;parentUUID&quot;:&quot;ca15da0c-beee-4d2f-8550-3da4acce463e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14be2c2c-caf7-4d0e-a409-d8a506d4f82e&quot;,&quot;parentUUID&quot;:&quot;ca15da0c-beee-4d2f-8550-3da4acce463e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2i&#x27;,\n  argon2mem: 12345\n}).should.deep.equal({\n  type: &#x27;argon2i&#x27;,\n  params: {\n    rounds: 2,\n    memory: 12345,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e652d20d-952b-45c3-b07d-248211d141c9&quot;,&quot;parentUUID&quot;:&quot;ca15da0c-beee-4d2f-8550-3da4acce463e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fa503cc0-6630-4023-bf04-4503d44e1785&quot;,&quot;14be2c2c-caf7-4d0e-a409-d8a506d4f82e&quot;,&quot;e652d20d-952b-45c3-b07d-248211d141c9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1ebc727c-913c-4020-a04b-113b97aad74e&quot;,&quot;title&quot;:&quot;argon2parallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;355cbd08-ab48-4a8c-8b34-510dde435991&quot;,&quot;parentUUID&quot;:&quot;1ebc727c-913c-4020-a04b-113b97aad74e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e699960-3aec-4070-a3ab-3e405e13c534&quot;,&quot;parentUUID&quot;:&quot;1ebc727c-913c-4020-a04b-113b97aad74e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2id&#x27;,\n  argon2parallelism: 2\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81d846ae-4565-406f-909d-6e27c41f1b2d&quot;,&quot;parentUUID&quot;:&quot;1ebc727c-913c-4020-a04b-113b97aad74e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;355cbd08-ab48-4a8c-8b34-510dde435991&quot;,&quot;4e699960-3aec-4070-a3ab-3e405e13c534&quot;,&quot;81d846ae-4565-406f-909d-6e27c41f1b2d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e22e0402-e2ed-44f6-b962-3aad31c26155&quot;,&quot;ec06202b-6a00-4b7e-9b78-a21612372953&quot;,&quot;e9199226-cd42-4232-806f-c6c53b15f622&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e87f8a06-a393-4512-9915-d2419c589005&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2dde388-740e-4227-9471-c84227d59996&quot;,&quot;parentUUID&quot;:&quot;e87f8a06-a393-4512-9915-d2419c589005&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d62996e6-7854-4efd-ab0a-a3df90bd3fa8&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f97a134-c1b9-4fe6-8bf5-4fb3c4316b33&quot;,&quot;parentUUID&quot;:&quot;d62996e6-7854-4efd-ab0a-a3df90bd3fa8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;hello-world&#x27; })\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ae7cb91-08c6-45c8-ab38-10046156dd40&quot;,&quot;parentUUID&quot;:&quot;d62996e6-7854-4efd-ab0a-a3df90bd3fa8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ed2d97d-94c0-444a-817f-5380efdca74e&quot;,&quot;parentUUID&quot;:&quot;d62996e6-7854-4efd-ab0a-a3df90bd3fa8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35e89787-911a-4d1f-8e2e-f4ca4f186e6e&quot;,&quot;parentUUID&quot;:&quot;d62996e6-7854-4efd-ab0a-a3df90bd3fa8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7f97a134-c1b9-4fe6-8bf5-4fb3c4316b33&quot;,&quot;8ae7cb91-08c6-45c8-ab38-10046156dd40&quot;,&quot;4ed2d97d-94c0-444a-817f-5380efdca74e&quot;,&quot;35e89787-911a-4d1f-8e2e-f4ca4f186e6e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:212,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;33ce936a-5c05-4e8d-ba60-2ed9bf28dbab&quot;,&quot;title&quot;:&quot;size&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key size default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.size.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d82ee4d-a39f-4db6-b1ae-76563b2775fd&quot;,&quot;parentUUID&quot;:&quot;33ce936a-5c05-4e8d-ba60-2ed9bf28dbab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key size valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 64 })\npolicy.size.should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b73f1ed5-4cde-4da9-a635-c3b0e2ea12f7&quot;,&quot;parentUUID&quot;:&quot;33ce936a-5c05-4e8d-ba60-2ed9bf28dbab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b5cfc9b-c329-43d9-91e5-a12961e63dca&quot;,&quot;parentUUID&quot;:&quot;33ce936a-5c05-4e8d-ba60-2ed9bf28dbab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 0 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5008c788-8711-46ad-a952-28abba7e22c2&quot;,&quot;parentUUID&quot;:&quot;33ce936a-5c05-4e8d-ba60-2ed9bf28dbab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1d82ee4d-a39f-4db6-b1ae-76563b2775fd&quot;,&quot;b73f1ed5-4cde-4da9-a635-c3b0e2ea12f7&quot;,&quot;0b5cfc9b-c329-43d9-91e5-a12961e63dca&quot;,&quot;5008c788-8711-46ad-a952-28abba7e22c2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:208,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;df2fde53-4572-4ea5-82b7-3f2043695f97&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b04af9db-c4b0-4eb9-b2fb-38635c312ed9&quot;,&quot;parentUUID&quot;:&quot;df2fde53-4572-4ea5-82b7-3f2043695f97&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 1 })\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4a2add8-37b8-4790-a997-54eb2d04dffe&quot;,&quot;parentUUID&quot;:&quot;df2fde53-4572-4ea5-82b7-3f2043695f97&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e3a6384-dcc4-4575-ad75-c618858e3375&quot;,&quot;parentUUID&quot;:&quot;df2fde53-4572-4ea5-82b7-3f2043695f97&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 0 }).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 2 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bb4aa6db-99db-49ef-9f6a-b5cdc5eae906&quot;,&quot;parentUUID&quot;:&quot;df2fde53-4572-4ea5-82b7-3f2043695f97&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b04af9db-c4b0-4eb9-b2fb-38635c312ed9&quot;,&quot;d4a2add8-37b8-4790-a997-54eb2d04dffe&quot;,&quot;4e3a6384-dcc4-4575-ad75-c618858e3375&quot;,&quot;bb4aa6db-99db-49ef-9f6a-b5cdc5eae906&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:208,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bd34e2e3-b302-4c53-9a2b-c9bdf936e761&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 48 })\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(48)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;93925b69-fb34-4b30-b54a-db5036974c3e&quot;,&quot;parentUUID&quot;:&quot;bd34e2e3-b302-4c53-9a2b-c9bdf936e761&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: Buffer.from(&#x27;12345678&#x27;, &#x27;base64&#x27;) })\npolicy.salt.should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d334ac8-ab35-4543-b4a8-96083b13226a&quot;,&quot;parentUUID&quot;:&quot;bd34e2e3-b302-4c53-9a2b-c9bdf936e761&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84db40cf-90f8-4ad3-ac3e-ed9c51a18f33&quot;,&quot;parentUUID&quot;:&quot;bd34e2e3-b302-4c53-9a2b-c9bdf936e761&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;93925b69-fb34-4b30-b54a-db5036974c3e&quot;,&quot;6d334ac8-ab35-4543-b4a8-96083b13226a&quot;,&quot;84db40cf-90f8-4ad3-ac3e-ed9c51a18f33&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:206,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;24b9bbe4-fc1e-4342-821b-b5604d91bcab&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8909c163-b4b7-4306-8173-6efbcb433d8f&quot;,&quot;parentUUID&quot;:&quot;24b9bbe4-fc1e-4342-821b-b5604d91bcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d30d0695-17d8-4f23-8d0e-16ee43ce04e7&quot;,&quot;parentUUID&quot;:&quot;24b9bbe4-fc1e-4342-821b-b5604d91bcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: 12345,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: 12345\n  }\n]).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b71441b-1220-4636-b604-a090b2286141&quot;,&quot;parentUUID&quot;:&quot;24b9bbe4-fc1e-4342-821b-b5604d91bcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40d4abfd-5760-44d6-b82f-c5fb185deb26&quot;,&quot;parentUUID&quot;:&quot;24b9bbe4-fc1e-4342-821b-b5604d91bcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8909c163-b4b7-4306-8173-6efbcb433d8f&quot;,&quot;d30d0695-17d8-4f23-8d0e-16ee43ce04e7&quot;,&quot;3b71441b-1220-4636-b604-a090b2286141&quot;,&quot;40d4abfd-5760-44d6-b82f-c5fb185deb26&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:105,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;c2dde388-740e-4227-9471-c84227d59996&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:110,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;9.2.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/tests&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/tests&quot;,&quot;reportTitle&quot;:&quot;MFKDF&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\tests\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\tests\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\tests\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>