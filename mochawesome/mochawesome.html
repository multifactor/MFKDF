<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:80,&quot;tests&quot;:321,&quot;passes&quot;:321,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2022-06-09T04:29:58.551Z&quot;,&quot;end&quot;:&quot;2022-06-09T04:31:33.747Z&quot;,&quot;duration&quot;:95196,&quot;testsRegistered&quot;:321,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;0417fa93-fe31-4acf-9ae1-2d3335fb9db2&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b07f0ad3-af8b-4f84-b4c0-f21149932ce0&quot;,&quot;title&quot;:&quot;asymmetric&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1fd1adb7-5572-49b2-bfbe-b5b3387d485d&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:419,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa1024&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1130501f-0059-4371-af66-9d7db6fb1384&quot;,&quot;parentUUID&quot;:&quot;1fd1adb7-5572-49b2-bfbe-b5b3387d485d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:649,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa2048&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;611a0586-1e08-433c-9c34-1045051b3606&quot;,&quot;parentUUID&quot;:&quot;1fd1adb7-5572-49b2-bfbe-b5b3387d485d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1130501f-0059-4371-af66-9d7db6fb1384&quot;,&quot;611a0586-1e08-433c-9c34-1045051b3606&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1068,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;title&quot;:&quot;signatures&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:270,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c9c3819-cc88-495f-afb3-6e0b4c0cba84&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:446,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa2048&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8dbc1a44-5b89-4ca8-a4f5-826a8b125577&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa3072&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa3072&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25775,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa3072&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa3072&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40f96c6e-3aba-473b-ab1d-afb0c3a0bbf4&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14120,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature)\nvalidity.should.be.true\nawait setup.getAsymmetricKeyPair()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6147f5a3-a928-475a-b88e-ae06bab365a2&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ed25519&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures ed25519&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:120,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nawait setup.getAsymmetricKeyPair(&#x27;ed25519&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0730305b-fff1-4b36-82e8-20dbdd45e5d1&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;unknown&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures unknown&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.getAsymmetricKeyPair(&#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6439be4e-c4be-47d9-9a8a-77fee772f73d&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2868,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.sign(12345, &#x27;rsa1024&#x27;).should.be.rejectedWith(TypeError)\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nsetup.verify(12345, signature).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4fa40a61-93e5-48e4-9681-8f9cab174707&quot;,&quot;parentUUID&quot;:&quot;96f5f1ec-f82d-44a2-82b3-24dee8f5dc89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5c9c3819-cc88-495f-afb3-6e0b4c0cba84&quot;,&quot;8dbc1a44-5b89-4ca8-a4f5-826a8b125577&quot;,&quot;40f96c6e-3aba-473b-ab1d-afb0c3a0bbf4&quot;,&quot;6147f5a3-a928-475a-b88e-ae06bab365a2&quot;,&quot;0730305b-fff1-4b36-82e8-20dbdd45e5d1&quot;,&quot;6439be4e-c4be-47d9-9a8a-77fee772f73d&quot;,&quot;4fa40a61-93e5-48e4-9681-8f9cab174707&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:43704,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;encrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:250,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cfcf816f-e7a4-4226-8f33-6e34a6f8c752&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b85b9da-3cc1-4683-914e-2ed817b2db81&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35820546-1220-456c-8833-d1d89ed82448&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d31f3c2b-f0a6-40d0-a83f-ead7713bcf18&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cdf512b9-f8da-48e0-b3a6-ac0047e96c89&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;318b33ea-cc8d-4911-9d9a-c08c20156558&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eec1a3ae-5b5a-491a-b84e-232536569d98&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10bfc142-edab-4205-a421-94fe6ef7e8fe&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b36d93e-df91-4b7f-a746-20030f5db723&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fdd59b44-7cae-476f-9e36-58eea422235f&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f095095-587b-4fd9-a9f1-58082d633dcf&quot;,&quot;parentUUID&quot;:&quot;e034dc53-f539-4398-80e3-f34e8e1c213b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e8937050-9f58-4893-a8e4-0a23df068618&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSubkey(32, &#x27;AES256&#x27;, &#x27;sha256&#x27;)\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey(32, &#x27;&#x27;, &#x27;sha512&#x27;)\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77f7d6c5-1333-411b-adc4-65f41a7ee273&quot;,&quot;parentUUID&quot;:&quot;e8937050-9f58-4893-a8e4-0a23df068618&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;symmetric key&quot;,&quot;fullTitle&quot;:&quot;encrypt utils symmetric key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSymmetricKey()\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2739153-672b-43b1-85c0-d2709dcd5cf4&quot;,&quot;parentUUID&quot;:&quot;e8937050-9f58-4893-a8e4-0a23df068618&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;77f7d6c5-1333-411b-adc4-65f41a7ee273&quot;,&quot;f2739153-672b-43b1-85c0-d2709dcd5cf4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:210,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fc9b1891-f106-4c18-83b2-80a9fae79adc&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid key&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(&#x27;hello world&#x27;, &#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a4bab5a-658c-4adf-a655-fbb72eb2f285&quot;,&quot;parentUUID&quot;:&quot;fc9b1891-f106-4c18-83b2-80a9fae79adc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid message&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;33646a20-04b9-4ffe-b580-7903ae08e509&quot;,&quot;parentUUID&quot;:&quot;fc9b1891-f106-4c18-83b2-80a9fae79adc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid ciphertext&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid ciphertext&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.decrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b413283-9562-4348-af51-f1df68251efd&quot;,&quot;parentUUID&quot;:&quot;fc9b1891-f106-4c18-83b2-80a9fae79adc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2a4bab5a-658c-4adf-a655-fbb72eb2f285&quot;,&quot;33646a20-04b9-4ffe-b580-7903ae08e509&quot;,&quot;6b413283-9562-4348-af51-f1df68251efd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:316,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;cfcf816f-e7a4-4226-8f33-6e34a6f8c752&quot;,&quot;6b85b9da-3cc1-4683-914e-2ed817b2db81&quot;,&quot;35820546-1220-456c-8833-d1d89ed82448&quot;,&quot;d31f3c2b-f0a6-40d0-a83f-ead7713bcf18&quot;,&quot;cdf512b9-f8da-48e0-b3a6-ac0047e96c89&quot;,&quot;318b33ea-cc8d-4911-9d9a-c08c20156558&quot;,&quot;eec1a3ae-5b5a-491a-b84e-232536569d98&quot;,&quot;10bfc142-edab-4205-a421-94fe6ef7e8fe&quot;,&quot;4b36d93e-df91-4b7f-a746-20030f5db723&quot;,&quot;fdd59b44-7cae-476f-9e36-58eea422235f&quot;,&quot;0f095095-587b-4fd9-a9f1-58082d633dcf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2483,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ff2533f6-d77f-42cd-9b3b-6be52b754d91&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d710bf00-3817-4cd5-a631-905eb8f70b7b&quot;,&quot;parentUUID&quot;:&quot;ff2533f6-d77f-42cd-9b3b-6be52b754d91&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62b5066c-7a57-460b-a9af-f462a01e7c09&quot;,&quot;parentUUID&quot;:&quot;ff2533f6-d77f-42cd-9b3b-6be52b754d91&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d710bf00-3817-4cd5-a631-905eb8f70b7b&quot;,&quot;62b5066c-7a57-460b-a9af-f462a01e7c09&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b1ed4fce-acf4-4c92-b3e3-de71ab740d06&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2b0adac-8894-458e-8b1a-810c66c78d15&quot;,&quot;parentUUID&quot;:&quot;b1ed4fce-acf4-4c92-b3e3-de71ab740d06&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1707f84a-f22f-4189-ad12-2df45c962647&quot;,&quot;parentUUID&quot;:&quot;b1ed4fce-acf4-4c92-b3e3-de71ab740d06&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d2b0adac-8894-458e-8b1a-810c66c78d15&quot;,&quot;1707f84a-f22f-4189-ad12-2df45c962647&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;42c0da0f-59bb-4b96-a795-c53e0c1ac21f&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:585,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ef0cac6-a5ae-4b15-9175-e3bd122487df&quot;,&quot;parentUUID&quot;:&quot;42c0da0f-59bb-4b96-a795-c53e0c1ac21f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:579,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23186ae1-63a3-4955-bdf3-9e23d88e0a87&quot;,&quot;parentUUID&quot;:&quot;42c0da0f-59bb-4b96-a795-c53e0c1ac21f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nmfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10acdbf3-076d-492c-89b8-b80317f427fc&quot;,&quot;parentUUID&quot;:&quot;42c0da0f-59bb-4b96-a795-c53e0c1ac21f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;27e1b20e-a3f2-42a8-bb1f-59c1b93947d6&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:451,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d43cd23d-b9dc-43c0-954d-51a434d60793&quot;,&quot;parentUUID&quot;:&quot;27e1b20e-a3f2-42a8-bb1f-59c1b93947d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d43cd23d-b9dc-43c0-954d-51a434d60793&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:451,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7376ac1f-4c00-4820-ac2c-b8a1ddfdc28a&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:121,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d84fe96b-271c-4598-87d9-f9018e37f842&quot;,&quot;parentUUID&quot;:&quot;7376ac1f-4c00-4820-ac2c-b8a1ddfdc28a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:118,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20be8506-3e93-4cdd-bda3-c57ea677d764&quot;,&quot;parentUUID&quot;:&quot;7376ac1f-4c00-4820-ac2c-b8a1ddfdc28a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d84fe96b-271c-4598-87d9-f9018e37f842&quot;,&quot;20be8506-3e93-4cdd-bda3-c57ea677d764&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:239,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;5ef0cac6-a5ae-4b15-9175-e3bd122487df&quot;,&quot;23186ae1-63a3-4955-bdf3-9e23d88e0a87&quot;,&quot;10acdbf3-076d-492c-89b8-b80317f427fc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1274,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ba8f1f3d-8556-4e1a-8c89-3b8bbd2870c5&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;kdf&quot;,&quot;fullTitle&quot;:&quot;examples kdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup kdf configuration\nconst config = await mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000,\n  pbkdf2digest: &#x27;sha256&#x27;\n}) // -&gt; { type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } }\n// derive key\nconst key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 8, config)\nkey.toString(&#x27;hex&#x27;) // -&gt; 0394a2ede332c9a1\nconfig.should.deep.equal({ type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } })\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;0394a2ede332c9a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bddaf40b-ede8-4c3a-bf0a-3b4debff979b&quot;,&quot;parentUUID&quot;:&quot;ba8f1f3d-8556-4e1a-8c89-3b8bbd2870c5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive fast&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff2c4557-84be-4485-be96-4f0e488241d5&quot;,&quot;parentUUID&quot;:&quot;ba8f1f3d-8556-4e1a-8c89-3b8bbd2870c5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:236,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99665a79-c422-45d6-a8b0-f29d13b5731e&quot;,&quot;parentUUID&quot;:&quot;ba8f1f3d-8556-4e1a-8c89-3b8bbd2870c5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b8c8d03a-6cae-4fab-a582-eff3d308430f&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:230,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n], { size: 8 })\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response = crypto.createHmac(&#x27;sha1&#x27;, secret).update(challenge).digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b53c1de1-a16d-459b-8b48-ecd2f4c2cd71&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1165,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n], { size: 8 })\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5b9649d-b13c-427a-847e-3c79411bf34d&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) })\n], { size: 8 })\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c32ab4e-bbb4-4586-a454-b074e4fec7a0&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:210,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 8 })\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e9d44df9-d33b-4835-84cd-5d778ddfffba&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;examples factors question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with security question factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n], { size: 8 })\n// derive key with security question factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e856c34e-4416-4538-a9e2-fd3a3e4311fd&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;examples factors ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:252,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup RSA key pair (on out-of-band server)\nconst keyPair = await crypto.webcrypto.subtle.generateKey({ hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) }, true, [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;])\n// setup key with out-of-band authentication factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey, params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\n// decrypt and send code (on out-of-band server)\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\n// derive key with out-of-band factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;100a550f-0b46-434a-9e0c-ee00b513cafb&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n], { size: 8 })\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35100b49-ec40-4fc6-9dbf-c89b4b922c2e&quot;,&quot;parentUUID&quot;:&quot;a7b81c52-d133-4d86-975b-9633d3b57f9f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b8c8d03a-6cae-4fab-a582-eff3d308430f&quot;,&quot;b53c1de1-a16d-459b-8b48-ecd2f4c2cd71&quot;,&quot;b5b9649d-b13c-427a-847e-3c79411bf34d&quot;,&quot;7c32ab4e-bbb4-4586-a454-b074e4fec7a0&quot;,&quot;e9d44df9-d33b-4835-84cd-5d778ddfffba&quot;,&quot;e856c34e-4416-4538-a9e2-fd3a3e4311fd&quot;,&quot;100a550f-0b46-434a-9e0c-ee00b513cafb&quot;,&quot;35100b49-ec40-4fc6-9dbf-c89b4b922c2e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2725,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;474dcfb4-165e-46f5-a1e1-4411bc26ea12&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(Buffer.from(&#x27;hello world&#x27;), 2, 3) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a11e7e1-c022-4393-962d-37d9fab8b9ce&quot;,&quot;parentUUID&quot;:&quot;474dcfb4-165e-46f5-a1e1-4411bc26ea12&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1a11e7e1-c022-4393-962d-37d9fab8b9ce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9b6dd7e-3fea-4583-b7cc-5e177ca48e69&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1b97b7d-324d-49d8-9ed6-3f54c590b97c&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordA&#x27;, &#x27;passwordC&#x27;]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordB&#x27;, &#x27;passwordC&#x27;]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6cc5c494-b59c-44a4-98de-7259c9a3ea5a&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:232,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  ), { size: 8 }\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a27031e-25c7-4bdc-b703-306c64c07bb1&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a12e493-643b-4865-a4fc-519fe9e8e4f2&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75db0d2c-3eea-4588-ac35-59c398b3235e&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69a4290d-8c89-4ec0-8207-dd8345396114&quot;,&quot;parentUUID&quot;:&quot;f235bac9-f637-415b-992c-5c803eb5936d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d9b6dd7e-3fea-4583-b7cc-5e177ca48e69&quot;,&quot;f1b97b7d-324d-49d8-9ed6-3f54c590b97c&quot;,&quot;6cc5c494-b59c-44a4-98de-7259c9a3ea5a&quot;,&quot;7a27031e-25c7-4bdc-b703-306c64c07bb1&quot;,&quot;6a12e493-643b-4865-a4fc-519fe9e8e4f2&quot;,&quot;75db0d2c-3eea-4588-ac35-59c398b3235e&quot;,&quot;69a4290d-8c89-4ec0-8207-dd8345396114&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1211,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2707d24c-6964-45ee-80d5-bc0c6bf6b933&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb400c1c-44fd-438a-8ffd-197b9de17c99&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64f545e6-9231-4afb-b950-3f5eebd17aba&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26b5d405-b82e-4cbe-99cb-6bc450ebe0e2&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:213,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb04081c-f0b7-45dc-b5ac-16c4f84590c1&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca34bc72-46fe-412e-a7b6-da66fc69fc18&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bf17032a-8032-411b-a34d-991d4b7cff59&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;162fae8f-2a1c-45b7-bb3e-7a7c5eb259b6&quot;,&quot;parentUUID&quot;:&quot;c4ab2a2a-ce3c-4ed5-b65e-4ecbc28c2d75&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2707d24c-6964-45ee-80d5-bc0c6bf6b933&quot;,&quot;fb400c1c-44fd-438a-8ffd-197b9de17c99&quot;,&quot;64f545e6-9231-4afb-b950-3f5eebd17aba&quot;,&quot;26b5d405-b82e-4cbe-99cb-6bc450ebe0e2&quot;,&quot;eb04081c-f0b7-45dc-b5ac-16c4f84590c1&quot;,&quot;ca34bc72-46fe-412e-a7b6-da66fc69fc18&quot;,&quot;bf17032a-8032-411b-a34d-991d4b7cff59&quot;,&quot;162fae8f-2a1c-45b7-bb3e-7a7c5eb259b6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1739,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;63c1e02a-e30e-4143-8d0f-3c5ced853664&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;56e36aec-961b-4ac9-86cc-b0d17a7fa3e1&quot;,&quot;parentUUID&quot;:&quot;63c1e02a-e30e-4143-8d0f-3c5ced853664&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;56e36aec-961b-4ac9-86cc-b0d17a7fa3e1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:218,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2f9862fe-a4bf-4122-ac7c-566be2f20168&quot;,&quot;title&quot;:&quot;envelope&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;add/get secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;48c33a24-a447-42de-8cf5-0fa216a4d969&quot;,&quot;parentUUID&quot;:&quot;2f9862fe-a4bf-4122-ac7c-566be2f20168&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/check/remove secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/check/remove secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// check secret\nconst check1 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; true\n// remove secret\nderived.removeEnvelopedSecret(&#x27;mySecret&#x27;)\n// check secret\nconst check2 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; false\ncheck1.should.be.true\ncheck2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b97e38f3-aec8-4acc-bd29-066498d80356&quot;,&quot;parentUUID&quot;:&quot;2f9862fe-a4bf-4122-ac7c-566be2f20168&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/get key&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:237,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;090a05a0-4f7c-490e-b1f4-9544548488a8&quot;,&quot;parentUUID&quot;:&quot;2f9862fe-a4bf-4122-ac7c-566be2f20168&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;48c33a24-a447-42de-8cf5-0fa216a4d969&quot;,&quot;b97e38f3-aec8-4acc-bd29-066498d80356&quot;,&quot;090a05a0-4f7c-490e-b1f4-9544548488a8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:683,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1c8ed80d-d5c2-4ae9-8238-e08977b78c8c&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte sub-key for \&quot;eth\&quot; using hkdf/sha256\nconst subkey = await key.getSubkey(16, &#x27;eth&#x27;, &#x27;sha256&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 54ad9e5acbc1c33b08a15dd79126e9c9&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e534d216-2fcf-435d-a88a-7851de83c24e&quot;,&quot;parentUUID&quot;:&quot;1c8ed80d-d5c2-4ae9-8238-e08977b78c8c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getSymmetricKey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSymmetricKey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte AES128 sub-key\nconst subkey = await key.getSymmetricKey(&#x27;aes128&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; c985454e008e5ecc695e865d339cb2be&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bc105b72-3d95-4522-9d43-81c3baeeb591&quot;,&quot;parentUUID&quot;:&quot;1c8ed80d-d5c2-4ae9-8238-e08977b78c8c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getAsymmetricKeyPair&quot;,&quot;fullTitle&quot;:&quot;examples crypto getAsymmetricKeyPair&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:129,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte RSA1024 sub-key\nconst subkey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;) // -&gt; { privateKey: Uint8Array, publicKey: Uint8Array }\nsubkey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36485ed7-17ec-4626-b962-c5593c30b251&quot;,&quot;parentUUID&quot;:&quot;1c8ed80d-d5c2-4ae9-8238-e08977b78c8c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;sign/verify&quot;,&quot;fullTitle&quot;:&quot;examples crypto sign/verify&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:380,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// sign message using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature using RSA-1024\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81a5f3da-d91c-4dd4-9102-8ed9b72d57c3&quot;,&quot;parentUUID&quot;:&quot;1c8ed80d-d5c2-4ae9-8238-e08977b78c8c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypt/decrypt&quot;,&quot;fullTitle&quot;:&quot;examples crypto encrypt/decrypt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:117,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// encrypt message using 3DES\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\n// decrypt message using 3DES\nconst decrypted = await key.decrypt(encrypted, &#x27;3des&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2315a60-f457-444e-9adb-810b2288241b&quot;,&quot;parentUUID&quot;:&quot;1c8ed80d-d5c2-4ae9-8238-e08977b78c8c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e534d216-2fcf-435d-a88a-7851de83c24e&quot;,&quot;bc105b72-3d95-4522-9d43-81c3baeeb591&quot;,&quot;36485ed7-17ec-4626-b962-c5593c30b251&quot;,&quot;81a5f3da-d91c-4dd4-9102-8ed9b72d57c3&quot;,&quot;a2315a60-f457-444e-9adb-810b2288241b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:846,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;title&quot;:&quot;auth&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dea16182-c3ea-44ef-b62c-d8f7d1e4cd1b&quot;,&quot;parentUUID&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:189,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8c8e7826-1b50-4adf-9d5a-9f851850e02b&quot;,&quot;parentUUID&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;33e4fdfa-4b22-4033-b9eb-9496e4776fe1&quot;,&quot;parentUUID&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b80a709-8da0-4421-b206-b655d06a5395&quot;,&quot;parentUUID&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:178,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a931148-b7b9-45f1-88fe-f1d85ec4d293&quot;,&quot;parentUUID&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;37223f1b-8757-466d-b4ac-49c5e8c50d44&quot;,&quot;parentUUID&quot;:&quot;c1b2078e-96f7-4397-9c35-a9df261f0785&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dea16182-c3ea-44ef-b62c-d8f7d1e4cd1b&quot;,&quot;8c8e7826-1b50-4adf-9d5a-9f851850e02b&quot;,&quot;33e4fdfa-4b22-4033-b9eb-9496e4776fe1&quot;,&quot;7b80a709-8da0-4421-b206-b655d06a5395&quot;,&quot;6a931148-b7b9-45f1-88fe-f1d85ec4d293&quot;,&quot;37223f1b-8757-466d-b4ac-49c5e8c50d44&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:799,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;bddaf40b-ede8-4c3a-bf0a-3b4debff979b&quot;,&quot;ff2c4557-84be-4485-be96-4f0e488241d5&quot;,&quot;99665a79-c422-45d6-a8b0-f29d13b5731e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:267,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;621b39c2-2f4e-4a75-b912-5040e35398f6&quot;,&quot;title&quot;:&quot;site&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\site.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\site.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Go beyond passwords&quot;,&quot;fullTitle&quot;:&quot;site Go beyond passwords&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify((\n  await mfkdf.setup.key([\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n  ], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n).policy)\nconst derivedKey = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  password: mfkdf.derive.factors.password(&#x27;Tr0ub4dour&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  recovery: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderivedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1f620c3-57b5-48d7-9737-60855c9bd149&quot;,&quot;parentUUID&quot;:&quot;621b39c2-2f4e-4a75-b912-5040e35398f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Increased key entropy&quot;,&quot;fullTitle&quot;:&quot;site Increased key entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;Math.floor((await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n])).entropyBits.real).should.equal(16)\nMath.floor((await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.hmacsha1()\n])).entropyBits.real).should.equal(196)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2706316f-af36-45d5-ad97-0eebd758a669&quot;,&quot;parentUUID&quot;:&quot;621b39c2-2f4e-4a75-b912-5040e35398f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enforce advanced policies&quot;,&quot;fullTitle&quot;:&quot;site Enforce advanced policies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:778,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policyBasedKey = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.totp()\n    )\n  )\n)\npolicyBasedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90e41cac-d53a-49b4-9e66-6db5f370e5b0&quot;,&quot;parentUUID&quot;:&quot;621b39c2-2f4e-4a75-b912-5040e35398f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Self-service factor recovery&quot;,&quot;fullTitle&quot;:&quot;site Self-service factor recovery&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify((\n  await mfkdf.setup.key([\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n  ], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n).policy)\nconst key = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  recoveryCode: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nawait key.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;myNewPassword&#x27;, { id: &#x27;password&#x27; })\n) // modify key to use new password factor&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73f96979-e4bc-4448-a746-88c84620952a&quot;,&quot;parentUUID&quot;:&quot;621b39c2-2f4e-4a75-b912-5040e35398f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f1f620c3-57b5-48d7-9737-60855c9bd149&quot;,&quot;2706316f-af36-45d5-ad97-0eebd758a669&quot;,&quot;90e41cac-d53a-49b4-9e66-6db5f370e5b0&quot;,&quot;73f96979-e4bc-4448-a746-88c84620952a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1019,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Auth&quot;,&quot;fullTitle&quot;:&quot;tutorials Auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff57d1cd-130f-4405-963e-7f47dcbd2802&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloepd Key&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloepd Key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b34e2e13-f08e-41a7-973b-eda28351ab2c&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloped Secret&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloped Secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;032fd0ac-514f-4b9b-8122-bfc0beee173b&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0dff9afd-9ddd-4f1d-ba43-0e3f865dbcec&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Signing &amp; Verification&quot;,&quot;fullTitle&quot;:&quot;tutorials Signing &amp; Verification&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:155,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// sign message with derived key using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32fddeb1-1edb-4067-a75f-f5cf0e444c3c&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Encryption &amp; Decryption&quot;,&quot;fullTitle&quot;:&quot;tutorials Encryption &amp; Decryption&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// encrypt secret with derived key using AES-256\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;aes256&#x27;)\n// ... later, decrypt secret with derived key\nconst decrypted = await key.decrypt(encrypted, &#x27;aes256&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b048e1b5-bcc8-43ac-9045-5455cffac374&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// reconstitute key to change password\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;newPassword&#x27;))\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b38f0e6e-c8ea-4fb1-b785-dc3010954763&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4453478-71c7-4324-8cd9-fb24be01c3bc&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:244,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ea19d034-05fd-4b97-92d6-262d2f5c1ad3&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16, threshold: 2 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;85e796cb-799f-4352-b9a4-8aa4717dde48&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:636,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n], { size: 32 })\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n], { size: 32 })\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n], { size: 32 })\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32 })\nconst threshold = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32, threshold: 2 })\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ede2d4c2-8b76-4130-9f90-15558f872bde&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bf5495b3-26d0-4ea8-8493-94dd1421dbd5&quot;,&quot;parentUUID&quot;:&quot;c274cefe-3bb7-452b-9894-99fe6762a7cd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ff57d1cd-130f-4405-963e-7f47dcbd2802&quot;,&quot;b34e2e13-f08e-41a7-973b-eda28351ab2c&quot;,&quot;032fd0ac-514f-4b9b-8122-bfc0beee173b&quot;,&quot;0dff9afd-9ddd-4f1d-ba43-0e3f865dbcec&quot;,&quot;32fddeb1-1edb-4067-a75f-f5cf0e444c3c&quot;,&quot;b048e1b5-bcc8-43ac-9045-5455cffac374&quot;,&quot;b38f0e6e-c8ea-4fb1-b785-dc3010954763&quot;,&quot;a4453478-71c7-4324-8cd9-fb24be01c3bc&quot;,&quot;ea19d034-05fd-4b97-92d6-262d2f5c1ad3&quot;,&quot;85e796cb-799f-4352-b9a4-8aa4717dde48&quot;,&quot;ede2d4c2-8b76-4130-9f90-15558f872bde&quot;,&quot;bf5495b3-26d0-4ea8-8493-94dd1421dbd5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2675,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;46ff0e1c-f61d-40dd-bf96-4b1e95d4c480&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key)\n  .update(challenge)\n  .digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a55bd9f-6c8a-47cc-ba31-b1893cef3d4d&quot;,&quot;parentUUID&quot;:&quot;46ff0e1c-f61d-40dd-bf96-4b1e95d4c480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:326,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response1 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(derive1.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response2 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c37ca1e5-cda9-4c18-9ad0-05163fdefc29&quot;,&quot;parentUUID&quot;:&quot;46ff0e1c-f61d-40dd-bf96-4b1e95d4c480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:115,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v1.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;kdf\&quot;:{\&quot;type\&quot;:\&quot;argon2id\&quot;,\&quot;params\&quot;:{\&quot;rounds\&quot;:2,\&quot;memory\&quot;:24576,\&quot;parallelism\&quot;:1}},\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;f8d33204be0436f2629d5173e9bd3fc1953cf982\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(JSON.parse(setup), {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;))\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(&#x27;ca76d2b456be4e40ba6ef65a68fbfc71bf27a0ca3e0fa4481a2ddf29fb6b65d9&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f4bec20-8185-4183-8372-d812b3bc1cd2&quot;,&quot;parentUUID&quot;:&quot;46ff0e1c-f61d-40dd-bf96-4b1e95d4c480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ef895812-5201-4c49-83da-ed379937b258&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08d57ce4-8a2d-4292-bf81-11d892a1aeac&quot;,&quot;parentUUID&quot;:&quot;ef895812-5201-4c49-83da-ed379937b258&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b8ea283-b1aa-46ed-b800-5647981fa698&quot;,&quot;parentUUID&quot;:&quot;ef895812-5201-4c49-83da-ed379937b258&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;529153a4-9820-400d-b2c8-cf5342a0ba3d&quot;,&quot;parentUUID&quot;:&quot;ef895812-5201-4c49-83da-ed379937b258&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e403cbad-3474-4fa2-869e-6ba37e0179f3&quot;,&quot;parentUUID&quot;:&quot;ef895812-5201-4c49-83da-ed379937b258&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2724147-9a64-4a94-97c7-e40667bc8a71&quot;,&quot;parentUUID&quot;:&quot;ef895812-5201-4c49-83da-ed379937b258&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;08d57ce4-8a2d-4292-bf81-11d892a1aeac&quot;,&quot;1b8ea283-b1aa-46ed-b800-5647981fa698&quot;,&quot;529153a4-9820-400d-b2c8-cf5342a0ba3d&quot;,&quot;e403cbad-3474-4fa2-869e-6ba37e0179f3&quot;,&quot;a2724147-9a64-4a94-97c7-e40667bc8a71&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;9a55bd9f-6c8a-47cc-ba31-b1893cef3d4d&quot;,&quot;c37ca1e5-cda9-4c18-9ad0-05163fdefc29&quot;,&quot;8f4bec20-8185-4183-8372-d812b3bc1cd2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:441,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7c526e9e-5b41-4bc7-8933-780184478df8&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:441,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(891649)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(795484)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;234642ce-e353-43f1-bf00-21893a613766&quot;,&quot;parentUUID&quot;:&quot;7c526e9e-5b41-4bc7-8933-780184478df8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8eae54e0-2f27-4022-8f07-0c8fc89f98e4&quot;,&quot;parentUUID&quot;:&quot;7c526e9e-5b41-4bc7-8933-780184478df8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f4b08c4-c18d-43d1-91eb-a50a2d07408b&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0be406e2-aa6a-43cc-bd7d-ee346ba32f9d&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d20c159d-76b0-40a9-aaad-2a72d20dc013&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c536d740-717e-48d2-a78e-3e42786ff6d4&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8c9e4104-24ee-4a95-a7d7-ab7ee677f4be&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c29be0b2-c0cd-4a23-aa83-0b2f3c4ba02e&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c69d5d5-ec36-422f-8c10-cfef12db14dd&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f983781e-db19-4ccc-a175-367d5316011c&quot;,&quot;parentUUID&quot;:&quot;ebd76fda-fa7d-4a59-8003-13fc4ac759d7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6f4b08c4-c18d-43d1-91eb-a50a2d07408b&quot;,&quot;0be406e2-aa6a-43cc-bd7d-ee346ba32f9d&quot;,&quot;d20c159d-76b0-40a9-aaad-2a72d20dc013&quot;,&quot;c536d740-717e-48d2-a78e-3e42786ff6d4&quot;,&quot;8c9e4104-24ee-4a95-a7d7-ab7ee677f4be&quot;,&quot;c29be0b2-c0cd-4a23-aa83-0b2f3c4ba02e&quot;,&quot;6c69d5d5-ec36-422f-8c10-cfef12db14dd&quot;,&quot;f983781e-db19-4ccc-a175-367d5316011c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;234642ce-e353-43f1-bf00-21893a613766&quot;,&quot;8eae54e0-2f27-4022-8f07-0c8fc89f98e4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:547,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bec7de93-13ff-48c9-ab83-2fbdb675b36e&quot;,&quot;title&quot;:&quot;factors/ooba&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;factors/ooba full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:487,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  { hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: {\n      email: &#x27;test@mfkdf.com&#x27;\n    }\n  })\n])\nlet next = setup.policy.factors[0].params.next\nlet decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nlet json = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\nlet code = json.code\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nnext = derive1.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toLowerCase())\n})\nnext = derive2.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toUpperCase())\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d000944e-ca15-4b53-8880-3987fa0e0faa&quot;,&quot;parentUUID&quot;:&quot;bec7de93-13ff-48c9-ab83-2fbdb675b36e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d000944e-ca15-4b53-8880-3987fa0e0faa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:487,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;653890ef-dd65-4282-98a4-5648d2c4622c&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3baa6500-0476-4592-bb52-6c971ca62ef9&quot;,&quot;parentUUID&quot;:&quot;653890ef-dd65-4282-98a4-5648d2c4622c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2f17e03-cae7-4184-818d-6a12248046ce&quot;,&quot;parentUUID&quot;:&quot;653890ef-dd65-4282-98a4-5648d2c4622c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3baa6500-0476-4592-bb52-6c971ca62ef9&quot;,&quot;d2f17e03-cae7-4184-818d-6a12248046ce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:221,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;273771d3-13aa-4a67-b121-89e0ad3d38fa&quot;,&quot;title&quot;:&quot;factors/question&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/question valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27; Fido-&#x27;, { question: &#x27;What is the name of your first pet?&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;-f_i%d#o ? &#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9fbde7f2-5367-4b41-ab07-3460b0ace056&quot;,&quot;parentUUID&quot;:&quot;273771d3-13aa-4a67-b121-89e0ad3d38fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/question invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;, { question: &#x27;What is the name of your first pet?&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Rex&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed528407-a62b-4d13-9fa0-609c98c1306b&quot;,&quot;parentUUID&quot;:&quot;273771d3-13aa-4a67-b121-89e0ad3d38fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e1aeed62-1e5f-456c-98ff-d6373a31492c&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/question errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.question(123)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.question(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;613c59f1-638e-4498-9976-26135c0579fb&quot;,&quot;parentUUID&quot;:&quot;e1aeed62-1e5f-456c-98ff-d6373a31492c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/question errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.question(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.question(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { question: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c66fa20-8120-4576-90ac-21e3ce4f6336&quot;,&quot;parentUUID&quot;:&quot;e1aeed62-1e5f-456c-98ff-d6373a31492c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;613c59f1-638e-4498-9976-26135c0579fb&quot;,&quot;4c66fa20-8120-4576-90ac-21e3ce4f6336&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;9fbde7f2-5367-4b41-ab07-3460b0ace056&quot;,&quot;ed528407-a62b-4d13-9fa0-609c98c1306b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:440,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5fe3f064-cc2a-4160-a18b-8335d87211a7&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e38fcb69-ca17-4efe-bbb5-460f39008a9c&quot;,&quot;parentUUID&quot;:&quot;5fe3f064-cc2a-4160-a18b-8335d87211a7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;142bda58-5dd1-45ce-9abe-ff5f6cd09d90&quot;,&quot;parentUUID&quot;:&quot;5fe3f064-cc2a-4160-a18b-8335d87211a7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:336,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ], { id: &#x27;stack1&#x27; }),\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ], { id: &#x27;stack2&#x27; })\n], { threshold: 1 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0961e02c-eb4e-4948-8bcd-09ec73a82012&quot;,&quot;parentUUID&quot;:&quot;5fe3f064-cc2a-4160-a18b-8335d87211a7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e38fcb69-ca17-4efe-bbb5-460f39008a9c&quot;,&quot;142bda58-5dd1-45ce-9abe-ff5f6cd09d90&quot;,&quot;0961e02c-eb4e-4948-8bcd-09ec73a82012&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:338,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;99a130de-05c3-412f-bef4-abdfd65f80fe&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])\nconst code = parseInt(speakeasy.totp({\n  secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n  encoding: &#x27;hex&#x27;,\n  step: setup.outputs.totp.period,\n  algorithm: setup.outputs.totp.algorithm,\n  digits: setup.outputs.totp.digits\n}))\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b36a249f-9144-4908-a1c0-c6718be48a9a&quot;,&quot;parentUUID&quot;:&quot;99a130de-05c3-412f-bef4-abdfd65f80fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(99922, { time: 1650430991083 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(398884, { time: 1650431018392 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08d4c57a-5742-4cfe-91c9-539a715bf945&quot;,&quot;parentUUID&quot;:&quot;99a130de-05c3-412f-bef4-abdfd65f80fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:766,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50e8aa0d-d163-43e9-9282-7481c2338479&quot;,&quot;parentUUID&quot;:&quot;99a130de-05c3-412f-bef4-abdfd65f80fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ecc008c8-b642-4121-97bc-ad308eb38a1c&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:723,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nmfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1750430943604 })\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24b22712-7af8-438a-a1cf-65cee9e7b92f&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ee6abc1-a55f-47d2-8994-cbf53ba0cb99&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da94a30a-6454-4dd9-839d-c2f7cb449117&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c14ea8f-f7b8-4b44-b7b2-be4fc644f416&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8280cc49-9017-451f-9757-ea99113a17c3&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;303ac823-224c-4665-951e-ea5e44a0319e&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9a45782-137a-45e4-95d7-a99eefe92349&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7cdff5a-0d42-4037-b3e7-2ba6a9bcb826&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;708831cd-9185-4624-8f84-f7724f52015d&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c6133da4-aee6-40a3-bf23-9331ba98a0f1&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eca3318f-8474-432f-9ad0-99470b9fb32c&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f2f5b17-cb40-4591-99a3-cadd7104e2b5&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;779617ae-89f5-41c7-ae2c-9abbf4ff4721&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3593269d-1ac5-4d07-96b1-6db715dd2498&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5469353b-61cf-427e-80aa-6ac64dc552b3&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8509c2b1-03ba-4667-b594-19ab2919d0d0&quot;,&quot;parentUUID&quot;:&quot;9666499e-d364-4823-abc0-9f31be95dcab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ecc008c8-b642-4121-97bc-ad308eb38a1c&quot;,&quot;24b22712-7af8-438a-a1cf-65cee9e7b92f&quot;,&quot;6ee6abc1-a55f-47d2-8994-cbf53ba0cb99&quot;,&quot;da94a30a-6454-4dd9-839d-c2f7cb449117&quot;,&quot;2c14ea8f-f7b8-4b44-b7b2-be4fc644f416&quot;,&quot;8280cc49-9017-451f-9757-ea99113a17c3&quot;,&quot;303ac823-224c-4665-951e-ea5e44a0319e&quot;,&quot;f9a45782-137a-45e4-95d7-a99eefe92349&quot;,&quot;c7cdff5a-0d42-4037-b3e7-2ba6a9bcb826&quot;,&quot;708831cd-9185-4624-8f84-f7724f52015d&quot;,&quot;c6133da4-aee6-40a3-bf23-9331ba98a0f1&quot;,&quot;eca3318f-8474-432f-9ad0-99470b9fb32c&quot;,&quot;9f2f5b17-cb40-4591-99a3-cadd7104e2b5&quot;,&quot;779617ae-89f5-41c7-ae2c-9abbf4ff4721&quot;,&quot;3593269d-1ac5-4d07-96b1-6db715dd2498&quot;,&quot;5469353b-61cf-427e-80aa-6ac64dc552b3&quot;,&quot;8509c2b1-03ba-4667-b594-19ab2919d0d0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:727,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;b36a249f-9144-4908-a1c0-c6718be48a9a&quot;,&quot;08d4c57a-5742-4cfe-91c9-539a715bf945&quot;,&quot;50e8aa0d-d163-43e9-9282-7481c2338479&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2989,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d25bab00-2b7c-448b-979c-41bbafae4450&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:556,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfd50269-e311-4335-9959-da3840424df7&quot;,&quot;parentUUID&quot;:&quot;d25bab00-2b7c-448b-979c-41bbafae4450&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:548,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3e56ca3f-590b-48f9-802e-8e0d9b5a8e0f&quot;,&quot;parentUUID&quot;:&quot;d25bab00-2b7c-448b-979c-41bbafae4450&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dfd50269-e311-4335-9959-da3840424df7&quot;,&quot;3e56ca3f-590b-48f9-802e-8e0d9b5a8e0f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1104,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;42cd23ef-ba3b-404a-a9c9-9bf20f7fdb7b&quot;,&quot;title&quot;:&quot;authentication&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getKey/auth&quot;,&quot;fullTitle&quot;:&quot;authentication getKey/auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8575,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nlet authKey\nlet encKey\nauthKey = await key.getSymmetricKey(&#x27;des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;3des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;3des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes128&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes128&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes192&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes192&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes256&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes256&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b32d961-d1e5-4f5e-bbc8-816c87c1f092&quot;,&quot;parentUUID&quot;:&quot;42cd23ef-ba3b-404a-a9c9-9bf20f7fdb7b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;title&quot;:&quot;valid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3ef433f-49d9-4d22-88ed-89f0bf50155e&quot;,&quot;parentUUID&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:378,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ba838d4-e9f8-451b-90b3-863a3d0bd1e0&quot;,&quot;parentUUID&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e7c5e82-b8a6-4d8d-9a7e-c179e7eef7a0&quot;,&quot;parentUUID&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec774f50-b991-40e6-b2d6-570bf86a44f2&quot;,&quot;parentUUID&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:325,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74727367-aed2-48ac-bbe9-0e7d7bb2d082&quot;,&quot;parentUUID&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b16af89-1b8d-439f-b27c-caa3f058ca78&quot;,&quot;parentUUID&quot;:&quot;e1b4ccf5-d76b-4a5e-8407-8f90e95767e6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d3ef433f-49d9-4d22-88ed-89f0bf50155e&quot;,&quot;6ba838d4-e9f8-451b-90b3-863a3d0bd1e0&quot;,&quot;4e7c5e82-b8a6-4d8d-9a7e-c179e7eef7a0&quot;,&quot;ec774f50-b991-40e6-b2d6-570bf86a44f2&quot;,&quot;74727367-aed2-48ac-bbe9-0e7d7bb2d082&quot;,&quot;6b16af89-1b8d-439f-b27c-caa3f058ca78&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1123,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:206,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3cc22f2-4ae2-45dd-bae1-6a29f7c1bd94&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:288,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b33adb29-e649-4c56-a9bb-4d676f976e94&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:210,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73f739e3-80b5-4cf1-b04d-e9ea168f4c4d&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:207,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d71fea5-64dd-4d3a-935c-e14ba10adf8b&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:479,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b89c1eb2-8172-4a19-8559-8e2b013bccfc&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:207,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9b3dd6bc-e6d0-446b-b9ee-0eeb11d09994&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e70b5c3-f645-4403-bba1-f2989f673b31&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:242,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;973d66a2-738a-4f23-95ee-1cf28c7450ec&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;535dca7f-d071-4269-a13b-13ab63025bca&quot;,&quot;parentUUID&quot;:&quot;45d46288-113d-46e7-a6d6-8935aedcced6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d3cc22f2-4ae2-45dd-bae1-6a29f7c1bd94&quot;,&quot;b33adb29-e649-4c56-a9bb-4d676f976e94&quot;,&quot;73f739e3-80b5-4cf1-b04d-e9ea168f4c4d&quot;,&quot;4d71fea5-64dd-4d3a-935c-e14ba10adf8b&quot;,&quot;b89c1eb2-8172-4a19-8559-8e2b013bccfc&quot;,&quot;9b3dd6bc-e6d0-446b-b9ee-0eeb11d09994&quot;,&quot;6e70b5c3-f645-4403-bba1-f2989f673b31&quot;,&quot;973d66a2-738a-4f23-95ee-1cf28c7450ec&quot;,&quot;535dca7f-d071-4269-a13b-13ab63025bca&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2048,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2b32d961-d1e5-4f5e-bbc8-816c87c1f092&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8575,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d0992db-365b-47c2-842e-0df9ffe3956e&quot;,&quot;parentUUID&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98fe72b5-de4e-42fe-9130-f9368cd9549c&quot;,&quot;parentUUID&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76bf04a1-3411-4cd0-af4f-f986965a1871&quot;,&quot;parentUUID&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;05bc61ef-7392-4c9a-a1d1-d1aa68fe11e5&quot;,&quot;parentUUID&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:752,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ebf7c5bb-93d8-43cd-934c-2b9e00df20ad&quot;,&quot;parentUUID&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:733,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6e57628-b4ee-42eb-9c05-d5fa21dde2c0&quot;,&quot;parentUUID&quot;:&quot;cbe9e9da-cbe0-4890-bbca-c653f8fd8c4a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5d0992db-365b-47c2-842e-0df9ffe3956e&quot;,&quot;98fe72b5-de4e-42fe-9130-f9368cd9549c&quot;,&quot;76bf04a1-3411-4cd0-af4f-f986965a1871&quot;,&quot;05bc61ef-7392-4c9a-a1d1-d1aa68fe11e5&quot;,&quot;ebf7c5bb-93d8-43cd-934c-2b9e00df20ad&quot;,&quot;f6e57628-b4ee-42eb-9c05-d5fa21dde2c0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1922,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;45099218-8933-4adb-879c-18ab4814209e&quot;,&quot;title&quot;:&quot;enveloping&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;secrets&quot;,&quot;fullTitle&quot;:&quot;enveloping secrets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key2&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key3&#x27;, input)\nawait setup.removeEnvelopedSecret(&#x27;key2&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst output = await derive.getEnvelopedSecret(&#x27;key&#x27;)\noutput.toString(&#x27;hex&#x27;).should.equal(input.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;57c68164-10c4-4c69-addd-1d09246aaec4&quot;,&quot;parentUUID&quot;:&quot;45099218-8933-4adb-879c-18ab4814209e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;keys&quot;,&quot;fullTitle&quot;:&quot;enveloping keys&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nawait setup.addEnvelopedKey(&#x27;key1&#x27;)\nawait setup.addEnvelopedKey(&#x27;key2&#x27;, &#x27;rsa1024&#x27;)\nawait setup.addEnvelopedKey(&#x27;key3&#x27;, &#x27;rsa2048&#x27;)\nawait setup.addEnvelopedKey(&#x27;key4&#x27;, &#x27;ed25519&#x27;)\nconst key11 = await setup.getEnvelopedKey(&#x27;key1&#x27;)\nconst key12 = await setup.getEnvelopedKey(&#x27;key2&#x27;)\nconst key13 = await setup.getEnvelopedKey(&#x27;key3&#x27;)\nconst key14 = await setup.getEnvelopedKey(&#x27;key4&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst key21 = await derive.getEnvelopedKey(&#x27;key1&#x27;)\nconst key22 = await derive.getEnvelopedKey(&#x27;key2&#x27;)\nconst key23 = await derive.getEnvelopedKey(&#x27;key3&#x27;)\nconst key24 = await derive.getEnvelopedKey(&#x27;key4&#x27;)\nkey11.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key21.export({ format: &#x27;jwk&#x27; }))\nkey12.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key22.export({ format: &#x27;jwk&#x27; }))\nkey13.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key23.export({ format: &#x27;jwk&#x27; }))\nkey14.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key24.export({ format: &#x27;jwk&#x27; }))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ffb0419-3c83-4bee-bc0b-d426b90542cf&quot;,&quot;parentUUID&quot;:&quot;45099218-8933-4adb-879c-18ab4814209e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c52a9059-63b3-4589-bf51-197a1cdbf95d&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a6b55c58-88b7-4856-a34f-b2a3117f5e8b&quot;,&quot;title&quot;:&quot;addEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(12345, input).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb515cba-46f7-4a49-bc2d-073dc00b1b76&quot;,&quot;parentUUID&quot;:&quot;a6b55c58-88b7-4856-a34f-b2a3117f5e8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;value/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret value/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedSecret(&#x27;id&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0f0444d-7213-455d-9d30-4fe9a454aba3&quot;,&quot;parentUUID&quot;:&quot;a6b55c58-88b7-4856-a34f-b2a3117f5e8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(&#x27;id&#x27;, input, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e9852cfd-13d3-4c23-9f5a-e8b50387515d&quot;,&quot;parentUUID&quot;:&quot;a6b55c58-88b7-4856-a34f-b2a3117f5e8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/unique&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nsetup.addEnvelopedSecret(&#x27;key&#x27;, input).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ed18e11-2e2d-431a-ba89-4be6be49db9a&quot;,&quot;parentUUID&quot;:&quot;a6b55c58-88b7-4856-a34f-b2a3117f5e8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fb515cba-46f7-4a49-bc2d-073dc00b1b76&quot;,&quot;a0f0444d-7213-455d-9d30-4fe9a454aba3&quot;,&quot;e9852cfd-13d3-4c23-9f5a-e8b50387515d&quot;,&quot;7ed18e11-2e2d-431a-ba89-4be6be49db9a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:422,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5951f1aa-fa5c-429f-bdf2-87cda3efde28&quot;,&quot;title&quot;:&quot;removeEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99a1acce-8e9f-452a-b7fb-ae110ae4d729&quot;,&quot;parentUUID&quot;:&quot;5951f1aa-fa5c-429f-bdf2-87cda3efde28&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(&#x27;12345&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;34247946-28c6-490f-804a-44deb40309b5&quot;,&quot;parentUUID&quot;:&quot;5951f1aa-fa5c-429f-bdf2-87cda3efde28&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99a1acce-8e9f-452a-b7fb-ae110ae4d729&quot;,&quot;34247946-28c6-490f-804a-44deb40309b5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:219,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a3b4c5f1-445a-4d9b-8f4e-ca5a1f6ec22e&quot;,&quot;title&quot;:&quot;addEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7bc85e3b-5e6f-44e6-b230-1efa23078ca4&quot;,&quot;parentUUID&quot;:&quot;a3b4c5f1-445a-4d9b-8f4e-ca5a1f6ec22e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;28e30268-8cbc-461f-8208-723b280e67cf&quot;,&quot;parentUUID&quot;:&quot;a3b4c5f1-445a-4d9b-8f4e-ca5a1f6ec22e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, &#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ea250e1e-67aa-43cb-8863-e2af5a2e76d8&quot;,&quot;parentUUID&quot;:&quot;a3b4c5f1-445a-4d9b-8f4e-ca5a1f6ec22e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7bc85e3b-5e6f-44e6-b230-1efa23078ca4&quot;,&quot;28e30268-8cbc-461f-8208-723b280e67cf&quot;,&quot;ea250e1e-67aa-43cb-8863-e2af5a2e76d8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:326,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4b8105d6-5290-4d14-99fd-ffe611dc534e&quot;,&quot;title&quot;:&quot;getEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41a8a972-4502-4e43-93b2-ba5f1f8bd87f&quot;,&quot;parentUUID&quot;:&quot;4b8105d6-5290-4d14-99fd-ffe611dc534e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(&#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a67021d-50d3-46bf-ac59-37b695275cd3&quot;,&quot;parentUUID&quot;:&quot;4b8105d6-5290-4d14-99fd-ffe611dc534e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;41a8a972-4502-4e43-93b2-ba5f1f8bd87f&quot;,&quot;2a67021d-50d3-46bf-ac59-37b695275cd3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:219,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d6ca3780-5136-4d51-b672-9ab0e894b016&quot;,&quot;title&quot;:&quot;getEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;daa79509-7d81-4835-98a7-e19a11960370&quot;,&quot;parentUUID&quot;:&quot;d6ca3780-5136-4d51-b672-9ab0e894b016&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;daa79509-7d81-4835-98a7-e19a11960370&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:107,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;92deedb0-8295-4fa0-84f1-0dad08d7de90&quot;,&quot;title&quot;:&quot;hasEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors hasEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.hasEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;273c9c23-5088-4936-91fe-6b27582262f1&quot;,&quot;parentUUID&quot;:&quot;92deedb0-8295-4fa0-84f1-0dad08d7de90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;273c9c23-5088-4936-91fe-6b27582262f1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:108,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;57c68164-10c4-4c69-addd-1d09246aaec4&quot;,&quot;6ffb0419-3c83-4bee-bc0b-d426b90542cf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:484,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;title&quot;:&quot;kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\features\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;types&quot;,&quot;fullTitle&quot;:&quot;kdf types&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:428,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const pbkdf2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst bcrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst scrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nconst argon2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nBuffer.isBuffer(pbkdf2).should.be.true\nBuffer.isBuffer(bcrypt).should.be.true\nBuffer.isBuffer(scrypt).should.be.true\nBuffer.isBuffer(argon2).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9b569c79-4818-453e-b5df-2fe44bcc0ca5&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha1&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 25555,\n    digest: &#x27;sha1&#x27;\n  }\n})\nBuffer.isBuffer(key).should.be.true\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;8ee4a527b20aa8feeb78d70447d84e20&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9757ac0-6217-4874-8d09-f832d358170f&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha512&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha512&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secret&#x27;, &#x27;salt&#x27;, 64, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha512&#x27;\n  }\n})\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;3745e482c6e0ade35da10139e797157f4a5da669dad7d5da88ef87e47471cc47ed941c7ad618e827304f083f8707f12b7cfdd5f489b782f10cc269e3c08d59ae&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2d915434-4035-4f53-9676-936466d3ce88&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/default&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:126,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c5b5fbf0-6159-4fe1-8631-e2f7fbec25a0&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/same&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/same&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:142,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;83f2e7bb-97df-4936-b4a7-c3883cc7c711&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/inputdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/inputdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password2&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4057ec96-f539-4a8f-bbfd-91c2583ecec0&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/saltdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/saltdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:115,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;30b9c577-28aa-429c-9c46-826920574c55&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/rounddiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/rounddiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:171,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 10 } })\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 11 } })\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f54dcbff-ee44-4e75-b4c3-ece596c5b91d&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/length&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:178,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key16 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key16).should.equal(16)\nconst key32 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key32).should.equal(32)\nconst key64 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key64).should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;acc097f2-3ea9-4629-b24c-dca902b2fad1&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/known&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/known&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;cb36d3d02d502acdf10dfc2d022bf3c024f16a368ba2df4456fbf97291f64334&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ccee8b36-fd89-42bc-9a1f-4eecdec71cdb&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/fast&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:195,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 16384, scryptblocksize: 8, scryptparallelism: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;745731af4484f323968969eda289aeee005b5903ac561e64a5aca121797bf7734ef9fd58422e2e22183bcacba9ec87ba0c83b7a2e788f03ce0da06463433cda6&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c817ad1-fe3a-4e5c-b4b0-96406ac32c51&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/defaults&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:201,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;9009fca57ef2b8c342bdad6b9247e4a1b5bd85628152116513ad44e93cf1b0e2&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86f8d9e7-bfdd-4705-9110-e36029072eaf&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/N&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/N&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ceb6a6bf4f4afeb3d1806714474d4f00ca97c2ad76a641269192d11444e13a6b&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8721bad-e60e-4008-8cde-824f88e66386&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/R&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/R&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptblocksize: 16 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;a63de1de715f95bebd9f6d58d78ff11028a8412c1fcf71673544373c67095836&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a94dac93-c3ec-4e53-86d3-e092726a2caa&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/P&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/P&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptparallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ef224277727457992dc05983b1fd1208bae35b100c853ba4bb11f1ba7ca4c436&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1291b54b-9aa9-4981-b258-567412e26514&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2i&quot;,&quot;fullTitle&quot;:&quot;kdf argon2i&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2i&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;7357892df510f136a0688ceab37bbaf7ba695de590065072717fa6728961c92a&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7984c32d-8e45-40df-9e36-0e53aa8d9091&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2d&quot;,&quot;fullTitle&quot;:&quot;kdf argon2d&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2d&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;423b0dcc7bbfe16fa8ee7a2e2ebd8891873d726f9dfe70890a7197a5503a2848&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;acb8a83c-0a9d-4e57-8adc-deb9e8596823&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9afb44f1-b2de-46d9-bfe7-3edc08b50da1&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/mem&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/mem&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:67,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2mem: 16384 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;e043f979311b14ff8378b785469974e899a08f05509323a04b2ca29ef63ff3af&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa01fb2f-99e2-4605-a8dd-c52c1ef7ad93&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/time&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2time: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;bf6b1773bdae362ecea04b889079b6628d1f35d96a2be9f2a5481c2d1236e8d7&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;68b57b7e-4b77-4c55-999b-f4b567b4de37&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/parallelism&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/parallelism&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2parallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5c12c6873b938cd8467b677d23e525389e3ff7ed62b4ad9e285e1191244f40ca&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3d28ef8-ca18-4947-a35e-8c88156fa8b1&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;kdf default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({}))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b50ec63e-1b34-40ba-b693-dbfb21312168&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;kdf invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;invalid&#x27;, params: { } }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cee27516-9789-44f1-a165-359ab081ac21&quot;,&quot;parentUUID&quot;:&quot;89665d59-4822-43e5-8814-ec93e540f6e0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9b569c79-4818-453e-b5df-2fe44bcc0ca5&quot;,&quot;f9757ac0-6217-4874-8d09-f832d358170f&quot;,&quot;2d915434-4035-4f53-9676-936466d3ce88&quot;,&quot;c5b5fbf0-6159-4fe1-8631-e2f7fbec25a0&quot;,&quot;83f2e7bb-97df-4936-b4a7-c3883cc7c711&quot;,&quot;4057ec96-f539-4a8f-bbfd-91c2583ecec0&quot;,&quot;30b9c577-28aa-429c-9c46-826920574c55&quot;,&quot;f54dcbff-ee44-4e75-b4c3-ece596c5b91d&quot;,&quot;acc097f2-3ea9-4629-b24c-dca902b2fad1&quot;,&quot;ccee8b36-fd89-42bc-9a1f-4eecdec71cdb&quot;,&quot;2c817ad1-fe3a-4e5c-b4b0-96406ac32c51&quot;,&quot;86f8d9e7-bfdd-4705-9110-e36029072eaf&quot;,&quot;a8721bad-e60e-4008-8cde-824f88e66386&quot;,&quot;a94dac93-c3ec-4e53-86d3-e092726a2caa&quot;,&quot;1291b54b-9aa9-4981-b258-567412e26514&quot;,&quot;7984c32d-8e45-40df-9e36-0e53aa8d9091&quot;,&quot;acb8a83c-0a9d-4e57-8adc-deb9e8596823&quot;,&quot;9afb44f1-b2de-46d9-bfe7-3edc08b50da1&quot;,&quot;fa01fb2f-99e2-4605-a8dd-c52c1ef7ad93&quot;,&quot;68b57b7e-4b77-4c55-999b-f4b567b4de37&quot;,&quot;d3d28ef8-ca18-4947-a35e-8c88156fa8b1&quot;,&quot;b50ec63e-1b34-40ba-b693-dbfb21312168&quot;,&quot;cee27516-9789-44f1-a165-359ab081ac21&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2468,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7c205755-9ac0-4c08-bbba-f46d1fa518c5&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d92558aa-6b2a-43fb-9372-01659f0c8850&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;04d4ad73-b0a4-4643-afd0-c2e228ba2bcb&quot;,&quot;parentUUID&quot;:&quot;d92558aa-6b2a-43fb-9372-01659f0c8850&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password2&#x27; })\n    )\n  )\n).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a90e5f6c-05e0-4baf-b941-72b34b80a43d&quot;,&quot;parentUUID&quot;:&quot;d92558aa-6b2a-43fb-9372-01659f0c8850&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;04d4ad73-b0a4-4643-afd0-c2e228ba2bcb&quot;,&quot;a90e5f6c-05e0-4baf-b941-72b34b80a43d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:217,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;983e1464-c569-4079-9271-a88227988314&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e914950e-f187-4639-914a-4c15f8f67d2f&quot;,&quot;parentUUID&quot;:&quot;983e1464-c569-4079-9271-a88227988314&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;787a0482-796d-481a-a5a6-e93f6234a0a7&quot;,&quot;parentUUID&quot;:&quot;983e1464-c569-4079-9271-a88227988314&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e914950e-f187-4639-914a-4c15f8f67d2f&quot;,&quot;787a0482-796d-481a-a5a6-e93f6234a0a7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:214,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41156f5b-b4a9-4797-a042-93f2c39cda83&quot;,&quot;parentUUID&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47517e1f-4bbe-42a7-b86e-beb67dd7924a&quot;,&quot;parentUUID&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3dc5bd5d-adcf-451f-b2d1-86777c7fba0c&quot;,&quot;parentUUID&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:615,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0772edc-fa17-4efa-9ff5-9055bddebff9&quot;,&quot;parentUUID&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:390,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63c82d24-31dc-40bb-85b5-6e779080dd0b&quot;,&quot;parentUUID&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:248,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;785ddace-5ef2-4488-9150-c8338b04bff3&quot;,&quot;parentUUID&quot;:&quot;27e559df-38fe-4a4a-8266-ec06fe1d3055&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;41156f5b-b4a9-4797-a042-93f2c39cda83&quot;,&quot;47517e1f-4bbe-42a7-b86e-beb67dd7924a&quot;,&quot;3dc5bd5d-adcf-451f-b2d1-86777c7fba0c&quot;,&quot;c0772edc-fa17-4efa-9ff5-9055bddebff9&quot;,&quot;63c82d24-31dc-40bb-85b5-6e779080dd0b&quot;,&quot;785ddace-5ef2-4488-9150-c8338b04bff3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1931,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;149457cb-30d2-431f-abef-95901632f67b&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:115,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n])\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ababc711-f2c6-4dd3-a186-a722fe00076a&quot;,&quot;parentUUID&quot;:&quot;149457cb-30d2-431f-abef-95901632f67b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31b54aad-2ece-4dc4-bb8f-ac0a0f3d68b6&quot;,&quot;parentUUID&quot;:&quot;149457cb-30d2-431f-abef-95901632f67b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ababc711-f2c6-4dd3-a186-a722fe00076a&quot;,&quot;31b54aad-2ece-4dc4-bb8f-ac0a0f3d68b6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:226,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c18b2200-61ba-43d2-9a9c-b4fb0dd8857d&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:454,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nderive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(derive2.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f597a455-2ed5-47df-8bb1-5d89f5881012&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:443,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c9ad632-04b9-466e-adba-ff7cf7714a07&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6681d6b6-c9c0-40e4-a824-9ca4090d9509&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b962a8d-e0b9-4fd3-a9a3-80490cd61203&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f612bb5-37d4-46db-a1a4-2f14b5976465&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63468745-e552-4e33-9646-0810ea075e2d&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute([&#x27;password1&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f4a6130-b4e9-4844-9b82-7ce97efb2087&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9527a68-70b8-4df9-989b-fd956809b574&quot;,&quot;parentUUID&quot;:&quot;f95d1ba2-cd5a-4dfd-b0e5-a0da65e3aca9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([12345], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc024d53-659d-4302-a7f4-df2ea644e67b&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([&#x27;password4&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;294b7192-a1b8-4ca6-b74e-764994f9fc15&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.reconstitute([&#x27;password3&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a4a097b-4e28-47f0-ab14-00f39dadc0b5&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute(&#x27;hello&#x27;, [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2795a08-619f-4a93-a549-4426b725772d&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], &#x27;12345&#x27;, 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9278bc85-059c-420d-be1a-5a65c4ea078e&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], &#x27;12345&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13cbb8e1-527a-4a1b-bbb4-9a07ebe8db7d&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;06654bf2-f4cd-489f-8d13-abc53e9c6b4d&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: 12345,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a7a7862-7221-41b6-9d4c-d69605097948&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cbf42e08-a150-4f60-a3cb-5187306fc4da&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2b8d8e2-8c0a-4919-9eca-956700429b6b&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e10aea28-1c91-47db-9963-7afc866cac52&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7533fb8-73fd-48d5-b7ac-353373407711&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01880a25-2c29-4d55-851c-2e6ca929583d&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: 12345,\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;28865252-6159-4f3b-82c2-6cad390c5680&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: 12345\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;083e98e9-8f3a-4897-8581-5d6d84914cf2&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78f36ce8-fb76-4e7c-8949-4bc87326e40e&quot;,&quot;parentUUID&quot;:&quot;f29996cb-efe4-456b-8da8-f60571d9267c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fc024d53-659d-4302-a7f4-df2ea644e67b&quot;,&quot;294b7192-a1b8-4ca6-b74e-764994f9fc15&quot;,&quot;3a4a097b-4e28-47f0-ab14-00f39dadc0b5&quot;,&quot;f2795a08-619f-4a93-a549-4426b725772d&quot;,&quot;9278bc85-059c-420d-be1a-5a65c4ea078e&quot;,&quot;13cbb8e1-527a-4a1b-bbb4-9a07ebe8db7d&quot;,&quot;06654bf2-f4cd-489f-8d13-abc53e9c6b4d&quot;,&quot;8a7a7862-7221-41b6-9d4c-d69605097948&quot;,&quot;cbf42e08-a150-4f60-a3cb-5187306fc4da&quot;,&quot;f2b8d8e2-8c0a-4919-9eca-956700429b6b&quot;,&quot;e10aea28-1c91-47db-9963-7afc866cac52&quot;,&quot;a7533fb8-73fd-48d5-b7ac-353373407711&quot;,&quot;01880a25-2c29-4d55-851c-2e6ca929583d&quot;,&quot;28865252-6159-4f3b-82c2-6cad390c5680&quot;,&quot;083e98e9-8f3a-4897-8581-5d6d84914cf2&quot;,&quot;78f36ce8-fb76-4e7c-8949-4bc87326e40e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1708,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;c18b2200-61ba-43d2-9a9c-b4fb0dd8857d&quot;,&quot;f597a455-2ed5-47df-8bb1-5d89f5881012&quot;,&quot;0c9ad632-04b9-466e-adba-ff7cf7714a07&quot;,&quot;6681d6b6-c9c0-40e4-a824-9ca4090d9509&quot;,&quot;0b962a8d-e0b9-4fd3-a9a3-80490cd61203&quot;,&quot;8f612bb5-37d4-46db-a1a4-2f14b5976465&quot;,&quot;63468745-e552-4e33-9646-0810ea075e2d&quot;,&quot;7f4a6130-b4e9-4844-9b82-7ce97efb2087&quot;,&quot;c9527a68-70b8-4df9-989b-fd956809b574&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2449,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;377dd473-c50a-4661-a8cf-fa8d28e8c088&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb134dbb-c745-47a1-880d-46c66fef25f0&quot;,&quot;parentUUID&quot;:&quot;377dd473-c50a-4661-a8cf-fa8d28e8c088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1814dd1b-bab8-49b4-bb75-67ed4bc6ff55&quot;,&quot;parentUUID&quot;:&quot;377dd473-c50a-4661-a8cf-fa8d28e8c088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4bbbe8a4-c6fa-4fb9-ba5d-0775983bb7da&quot;,&quot;parentUUID&quot;:&quot;377dd473-c50a-4661-a8cf-fa8d28e8c088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eb134dbb-c745-47a1-880d-46c66fef25f0&quot;,&quot;1814dd1b-bab8-49b4-bb75-67ed4bc6ff55&quot;,&quot;4bbbe8a4-c6fa-4fb9-ba5d-0775983bb7da&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd1aa794-839c-433b-af19-8f7b4dbff8af&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 1, 5)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c81ef5ae-38f9-40df-88fd-4245c96a2983&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 2, 3)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa36419f-97f7-448e-a494-eed668dec507&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d59f18c-ae2c-4f89-afdf-6249079b8118&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:66,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 1024)\nshares.should.be.an(&#x27;array&#x27;).of.length(1024)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 1020; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[1023] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7771fd3f-7343-44ed-9101-e5a702b2eb62&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)\nxor(shares[0], shares[1]).toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a1413ba-a0dd-46d6-8a74-7f066067c9a1&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dabf2f55-624a-49f5-b8f5-1a02e182deab&quot;,&quot;parentUUID&quot;:&quot;bce71986-1c33-422b-a59a-c9b932ac5ac7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bd1aa794-839c-433b-af19-8f7b4dbff8af&quot;,&quot;c81ef5ae-38f9-40df-88fd-4245c96a2983&quot;,&quot;fa36419f-97f7-448e-a494-eed668dec507&quot;,&quot;6d59f18c-ae2c-4f89-afdf-6249079b8118&quot;,&quot;7771fd3f-7343-44ed-9101-e5a702b2eb62&quot;,&quot;5a1413ba-a0dd-46d6-8a74-7f066067c9a1&quot;,&quot;dabf2f55-624a-49f5-b8f5-1a02e182deab&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:78,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;200f7802-0f19-44f9-ac39-84bad3139794&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a185cc4-7690-46ed-b29d-157adf272975&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;33364c36-6d86-4da6-9e89-27694423fe17&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ba61329-d8bc-49c0-8851-6251215f8d54&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6318dc9b-23f1-4b1c-981d-c7c4d835cc4a&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;70eb4a51-0d44-4d7a-93bc-d5bb876edf72&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;977396fb-71dc-479f-8ec4-e095f2052b4c&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cc588942-4850-4b9d-b2ac-9cf7820855fb&quot;,&quot;parentUUID&quot;:&quot;8305e931-33be-44f3-b61d-9a54ebc6bf63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;200f7802-0f19-44f9-ac39-84bad3139794&quot;,&quot;8a185cc4-7690-46ed-b29d-157adf272975&quot;,&quot;33364c36-6d86-4da6-9e89-27694423fe17&quot;,&quot;0ba61329-d8bc-49c0-8851-6251215f8d54&quot;,&quot;6318dc9b-23f1-4b1c-981d-c7c4d835cc4a&quot;,&quot;70eb4a51-0d44-4d7a-93bc-d5bb876edf72&quot;,&quot;977396fb-71dc-479f-8ec4-e095f2052b4c&quot;,&quot;cc588942-4850-4b9d-b2ac-9cf7820855fb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;97bb89ef-dacd-49b6-88dc-5a8506f5048a&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;80522859-0f26-4b10-a92f-2d3bddeaace2&quot;,&quot;parentUUID&quot;:&quot;97bb89ef-dacd-49b6-88dc-5a8506f5048a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;703eb9ae-0168-4f61-a780-ce0b941379da&quot;,&quot;parentUUID&quot;:&quot;97bb89ef-dacd-49b6-88dc-5a8506f5048a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f6aae40-dcce-48a6-bfe2-19848edfcc25&quot;,&quot;parentUUID&quot;:&quot;97bb89ef-dacd-49b6-88dc-5a8506f5048a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;80522859-0f26-4b10-a92f-2d3bddeaace2&quot;,&quot;703eb9ae-0168-4f61-a780-ce0b941379da&quot;,&quot;7f6aae40-dcce-48a6-bfe2-19848edfcc25&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8d85ec54-5311-4c0d-853e-d4fc96f3cdcf&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe2d013e-8f42-498c-ac89-3f9856776a31&quot;,&quot;parentUUID&quot;:&quot;8d85ec54-5311-4c0d-853e-d4fc96f3cdcf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;adf0dc66-54af-4b4d-9acf-ad6ffe667f9d&quot;,&quot;parentUUID&quot;:&quot;8d85ec54-5311-4c0d-853e-d4fc96f3cdcf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ff392fd-b21c-4374-9a49-4b45fcc91fd8&quot;,&quot;parentUUID&quot;:&quot;8d85ec54-5311-4c0d-853e-d4fc96f3cdcf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fe2d013e-8f42-498c-ac89-3f9856776a31&quot;,&quot;adf0dc66-54af-4b4d-9acf-ad6ffe667f9d&quot;,&quot;0ff392fd-b21c-4374-9a49-4b45fcc91fd8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;694c472e-6a63-4ad2-8940-371bba05fe13&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ uuid: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ uuid: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fed39e88-f89b-43e3-aa04-f797b72cd7db&quot;,&quot;parentUUID&quot;:&quot;694c472e-6a63-4ad2-8940-371bba05fe13&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e8a5d7b-5f25-4795-b888-b42d7efbaebd&quot;,&quot;parentUUID&quot;:&quot;694c472e-6a63-4ad2-8940-371bba05fe13&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({ uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c6a8a4b-0ea0-440f-8bac-611f08b53113&quot;,&quot;parentUUID&quot;:&quot;694c472e-6a63-4ad2-8940-371bba05fe13&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d831b53-b251-478f-bfea-4b1c9cf10432&quot;,&quot;parentUUID&quot;:&quot;694c472e-6a63-4ad2-8940-371bba05fe13&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fed39e88-f89b-43e3-aa04-f797b72cd7db&quot;,&quot;8e8a5d7b-5f25-4795-b888-b42d7efbaebd&quot;,&quot;2c6a8a4b-0ea0-440f-8bac-611f08b53113&quot;,&quot;8d831b53-b251-478f-bfea-4b1c9cf10432&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0ea99304-8ff2-4c24-a80c-8c8b440c8718&quot;,&quot;title&quot;:&quot;setup/kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;639700a9-f4ac-4852-9ab5-8ed9e13e3688&quot;,&quot;title&quot;:&quot;pbkdf2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23a1e018-28f7-4295-afb6-b19f12d01c64&quot;,&quot;parentUUID&quot;:&quot;639700a9-f4ac-4852-9ab5-8ed9e13e3688&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;dd24681b-620e-48d2-9d97-6799cd9b4b62&quot;,&quot;title&quot;:&quot;pbkdf2rounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;45772d8c-c82f-43cc-9379-eeed65e02b60&quot;,&quot;parentUUID&quot;:&quot;dd24681b-620e-48d2-9d97-6799cd9b4b62&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c7096ff-db94-4aa4-a301-e8c0ba79ae24&quot;,&quot;parentUUID&quot;:&quot;dd24681b-620e-48d2-9d97-6799cd9b4b62&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;788b6707-ed4c-4bc0-af5a-9d4beec5016f&quot;,&quot;parentUUID&quot;:&quot;dd24681b-620e-48d2-9d97-6799cd9b4b62&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;45772d8c-c82f-43cc-9379-eeed65e02b60&quot;,&quot;0c7096ff-db94-4aa4-a301-e8c0ba79ae24&quot;,&quot;788b6707-ed4c-4bc0-af5a-9d4beec5016f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c43c9557-9830-4ab6-9270-8e6733e2352c&quot;,&quot;title&quot;:&quot;pbkdf2digest&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: 0\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;630b7847-bac0-4322-90ac-b30d1553cd1e&quot;,&quot;parentUUID&quot;:&quot;c43c9557-9830-4ab6-9270-8e6733e2352c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9bcfd55a-68c9-4ea9-a115-a6f303ed3864&quot;,&quot;parentUUID&quot;:&quot;c43c9557-9830-4ab6-9270-8e6733e2352c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2digest: &#x27;sha512&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha512&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;024c24d5-5d1a-4092-9d93-c3d7ad5db72d&quot;,&quot;parentUUID&quot;:&quot;c43c9557-9830-4ab6-9270-8e6733e2352c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;630b7847-bac0-4322-90ac-b30d1553cd1e&quot;,&quot;9bcfd55a-68c9-4ea9-a115-a6f303ed3864&quot;,&quot;024c24d5-5d1a-4092-9d93-c3d7ad5db72d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;23a1e018-28f7-4295-afb6-b19f12d01c64&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;df967773-e31f-4389-893f-8ce455931970&quot;,&quot;title&quot;:&quot;bcrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 10\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99c2de35-588a-438f-ae1f-3aa12e326783&quot;,&quot;parentUUID&quot;:&quot;df967773-e31f-4389-893f-8ce455931970&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6e0afe13-0ab2-4fa9-8ce6-aba267fb632e&quot;,&quot;title&quot;:&quot;bcryptrounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1af1ac43-fd7c-45f7-8dd4-385f27d8b90a&quot;,&quot;parentUUID&quot;:&quot;6e0afe13-0ab2-4fa9-8ce6-aba267fb632e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;415667e6-48c2-4a93-9f2c-f0e573195307&quot;,&quot;parentUUID&quot;:&quot;6e0afe13-0ab2-4fa9-8ce6-aba267fb632e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;,\n  bcryptrounds: 25\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 25\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77bb32eb-1844-4cc9-b1bb-48009d1d8cb2&quot;,&quot;parentUUID&quot;:&quot;6e0afe13-0ab2-4fa9-8ce6-aba267fb632e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1af1ac43-fd7c-45f7-8dd4-385f27d8b90a&quot;,&quot;415667e6-48c2-4a93-9f2c-f0e573195307&quot;,&quot;77bb32eb-1844-4cc9-b1bb-48009d1d8cb2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;99c2de35-588a-438f-ae1f-3aa12e326783&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fb030bab-0e14-43a7-aaed-2b653116e745&quot;,&quot;title&quot;:&quot;scrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a03cdc5e-83e7-484d-ab45-812e64cdd3c2&quot;,&quot;parentUUID&quot;:&quot;fb030bab-0e14-43a7-aaed-2b653116e745&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3816c058-9081-4186-813b-25912b7212ef&quot;,&quot;title&quot;:&quot;scryptcost&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8b95f8a6-88c0-4661-8d91-5c3f9a626c87&quot;,&quot;parentUUID&quot;:&quot;3816c058-9081-4186-813b-25912b7212ef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b3acd21e-4a82-4049-9df5-6bff3d1200c6&quot;,&quot;parentUUID&quot;:&quot;3816c058-9081-4186-813b-25912b7212ef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptcost: 12345\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 12345,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d915618b-1b99-4cae-b2fc-03fc619284ae&quot;,&quot;parentUUID&quot;:&quot;3816c058-9081-4186-813b-25912b7212ef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8b95f8a6-88c0-4661-8d91-5c3f9a626c87&quot;,&quot;b3acd21e-4a82-4049-9df5-6bff3d1200c6&quot;,&quot;d915618b-1b99-4cae-b2fc-03fc619284ae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6877c4bc-789c-49b8-93f2-181d2e55615d&quot;,&quot;title&quot;:&quot;scryptblocksize&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8eb756c-6b20-4f38-8426-6249f089843a&quot;,&quot;parentUUID&quot;:&quot;6877c4bc-789c-49b8-93f2-181d2e55615d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef8889ff-2825-4650-b56e-ab3eb7c4a062&quot;,&quot;parentUUID&quot;:&quot;6877c4bc-789c-49b8-93f2-181d2e55615d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptblocksize: 24\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 24,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c3fe174d-db04-4a08-a989-7ea6e7047d88&quot;,&quot;parentUUID&quot;:&quot;6877c4bc-789c-49b8-93f2-181d2e55615d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f8eb756c-6b20-4f38-8426-6249f089843a&quot;,&quot;ef8889ff-2825-4650-b56e-ab3eb7c4a062&quot;,&quot;c3fe174d-db04-4a08-a989-7ea6e7047d88&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5cee72b1-940d-43af-8d7f-ece74b2d06a8&quot;,&quot;title&quot;:&quot;scryptparallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;320c5e1e-1d59-4ac3-8df1-5c6277b7fc94&quot;,&quot;parentUUID&quot;:&quot;5cee72b1-940d-43af-8d7f-ece74b2d06a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2514198-2915-4ee2-837d-f66ff7ee95b3&quot;,&quot;parentUUID&quot;:&quot;5cee72b1-940d-43af-8d7f-ece74b2d06a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptparallelism: 2\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;39a96795-15c2-4a1f-b957-f445e0ef2cd0&quot;,&quot;parentUUID&quot;:&quot;5cee72b1-940d-43af-8d7f-ece74b2d06a8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;320c5e1e-1d59-4ac3-8df1-5c6277b7fc94&quot;,&quot;f2514198-2915-4ee2-837d-f66ff7ee95b3&quot;,&quot;39a96795-15c2-4a1f-b957-f445e0ef2cd0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;a03cdc5e-83e7-484d-ab45-812e64cdd3c2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5bd27448-7c5b-40cc-95ae-90327a75de5f&quot;,&quot;title&quot;:&quot;argon2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ed309a6-3941-4745-bbc3-29b2a26198fc&quot;,&quot;parentUUID&quot;:&quot;5bd27448-7c5b-40cc-95ae-90327a75de5f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: 123\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1ce83a9a-d3b1-41a0-9c7a-1015b57fd923&quot;,&quot;parentUUID&quot;:&quot;5bd27448-7c5b-40cc-95ae-90327a75de5f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bb6997b-8f63-4ba1-9cad-baaf8b5a8ea6&quot;,&quot;parentUUID&quot;:&quot;5bd27448-7c5b-40cc-95ae-90327a75de5f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5f49b4c4-0d6b-4cbe-91f4-0506b4b7fa6d&quot;,&quot;title&quot;:&quot;argon2time&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9631fbc3-12b3-431c-a95e-c96f9a5142aa&quot;,&quot;parentUUID&quot;:&quot;5f49b4c4-0d6b-4cbe-91f4-0506b4b7fa6d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff42f8c6-8a7f-4a9a-b63f-1145eaf8982f&quot;,&quot;parentUUID&quot;:&quot;5f49b4c4-0d6b-4cbe-91f4-0506b4b7fa6d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2d&#x27;,\n  argon2time: 10\n}).should.deep.equal({\n  type: &#x27;argon2d&#x27;,\n  params: {\n    rounds: 10,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9360e8f-3db3-42e4-9a8f-b835d1263f9b&quot;,&quot;parentUUID&quot;:&quot;5f49b4c4-0d6b-4cbe-91f4-0506b4b7fa6d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9631fbc3-12b3-431c-a95e-c96f9a5142aa&quot;,&quot;ff42f8c6-8a7f-4a9a-b63f-1145eaf8982f&quot;,&quot;a9360e8f-3db3-42e4-9a8f-b835d1263f9b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f3064ede-d7aa-4346-80df-7df4355d6f07&quot;,&quot;title&quot;:&quot;argon2mem&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d3e8dbc-6f0c-45dd-aa7d-26f5471f503e&quot;,&quot;parentUUID&quot;:&quot;f3064ede-d7aa-4346-80df-7df4355d6f07&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dcfc0e88-16f9-49e9-83c2-4403159fab94&quot;,&quot;parentUUID&quot;:&quot;f3064ede-d7aa-4346-80df-7df4355d6f07&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2i&#x27;,\n  argon2mem: 12345\n}).should.deep.equal({\n  type: &#x27;argon2i&#x27;,\n  params: {\n    rounds: 2,\n    memory: 12345,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ab7aa823-9666-44c8-813e-1d537ddac784&quot;,&quot;parentUUID&quot;:&quot;f3064ede-d7aa-4346-80df-7df4355d6f07&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4d3e8dbc-6f0c-45dd-aa7d-26f5471f503e&quot;,&quot;dcfc0e88-16f9-49e9-83c2-4403159fab94&quot;,&quot;ab7aa823-9666-44c8-813e-1d537ddac784&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;959ca000-6ec8-4618-9c98-5ded4f8c1ca4&quot;,&quot;title&quot;:&quot;argon2parallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79a9c820-345b-4bd7-8ff0-9f07387d4f13&quot;,&quot;parentUUID&quot;:&quot;959ca000-6ec8-4618-9c98-5ded4f8c1ca4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c073f804-b9e0-4971-8e3d-5bc050683740&quot;,&quot;parentUUID&quot;:&quot;959ca000-6ec8-4618-9c98-5ded4f8c1ca4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2id&#x27;,\n  argon2parallelism: 2\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a315441-3461-49e6-aaae-d703adebb552&quot;,&quot;parentUUID&quot;:&quot;959ca000-6ec8-4618-9c98-5ded4f8c1ca4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;79a9c820-345b-4bd7-8ff0-9f07387d4f13&quot;,&quot;c073f804-b9e0-4971-8e3d-5bc050683740&quot;,&quot;4a315441-3461-49e6-aaae-d703adebb552&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;6ed309a6-3941-4745-bbc3-29b2a26198fc&quot;,&quot;1ce83a9a-d3b1-41a0-9c7a-1015b57fd923&quot;,&quot;5bb6997b-8f63-4ba1-9cad-baaf8b5a8ea6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;58378f5b-d8e8-4b42-b521-7b7c35ef28d8&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20a7761d-997e-40a9-9303-b3898984a5b5&quot;,&quot;parentUUID&quot;:&quot;58378f5b-d8e8-4b42-b521-7b7c35ef28d8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;bd3e4435-6e92-4d4f-b7b3-9489cfc07cd3&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed04d6cb-5630-475c-b0ca-49c2e23d4f48&quot;,&quot;parentUUID&quot;:&quot;bd3e4435-6e92-4d4f-b7b3-9489cfc07cd3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;hello-world&#x27; })\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50d88436-65b2-4a62-aaed-aefea5a5bbe9&quot;,&quot;parentUUID&quot;:&quot;bd3e4435-6e92-4d4f-b7b3-9489cfc07cd3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a424e21-2029-4851-b305-b4e5513dae16&quot;,&quot;parentUUID&quot;:&quot;bd3e4435-6e92-4d4f-b7b3-9489cfc07cd3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f5d4f4b-0e62-4aab-85dd-9323d2034060&quot;,&quot;parentUUID&quot;:&quot;bd3e4435-6e92-4d4f-b7b3-9489cfc07cd3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ed04d6cb-5630-475c-b0ca-49c2e23d4f48&quot;,&quot;50d88436-65b2-4a62-aaed-aefea5a5bbe9&quot;,&quot;7a424e21-2029-4851-b305-b4e5513dae16&quot;,&quot;8f5d4f4b-0e62-4aab-85dd-9323d2034060&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:211,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;dd98cc25-9315-4868-b53f-bb8514ecae16&quot;,&quot;title&quot;:&quot;size&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key size default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.size.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0324a32-142b-4ae9-9fa6-c7833cb96373&quot;,&quot;parentUUID&quot;:&quot;dd98cc25-9315-4868-b53f-bb8514ecae16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key size valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 64 })\npolicy.size.should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2db37b7a-c4e2-47de-890b-7359342cff79&quot;,&quot;parentUUID&quot;:&quot;dd98cc25-9315-4868-b53f-bb8514ecae16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aaaba756-835f-4539-82f1-0b0c765eaee9&quot;,&quot;parentUUID&quot;:&quot;dd98cc25-9315-4868-b53f-bb8514ecae16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 0 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8414c96b-96fa-47d3-99fe-6b974cc06589&quot;,&quot;parentUUID&quot;:&quot;dd98cc25-9315-4868-b53f-bb8514ecae16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a0324a32-142b-4ae9-9fa6-c7833cb96373&quot;,&quot;2db37b7a-c4e2-47de-890b-7359342cff79&quot;,&quot;aaaba756-835f-4539-82f1-0b0c765eaee9&quot;,&quot;8414c96b-96fa-47d3-99fe-6b974cc06589&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:214,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;511a9639-66f9-4b61-9080-79944bb1433e&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47d703a7-26fd-4f95-aa65-cff8fd79a18e&quot;,&quot;parentUUID&quot;:&quot;511a9639-66f9-4b61-9080-79944bb1433e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 1 })\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8bc24d0-6c8b-41f8-a60c-f8b9e094ddb8&quot;,&quot;parentUUID&quot;:&quot;511a9639-66f9-4b61-9080-79944bb1433e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4aaa811f-c926-482a-a990-a1ebb3dcd5ea&quot;,&quot;parentUUID&quot;:&quot;511a9639-66f9-4b61-9080-79944bb1433e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 0 }).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 2 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;139f71ef-2cb8-4543-87a7-e346b1730220&quot;,&quot;parentUUID&quot;:&quot;511a9639-66f9-4b61-9080-79944bb1433e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;47d703a7-26fd-4f95-aa65-cff8fd79a18e&quot;,&quot;a8bc24d0-6c8b-41f8-a60c-f8b9e094ddb8&quot;,&quot;4aaa811f-c926-482a-a990-a1ebb3dcd5ea&quot;,&quot;139f71ef-2cb8-4543-87a7-e346b1730220&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:208,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;083814f5-3855-42d2-9f0f-7620cd0dea10&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 48 })\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(48)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ba15e34-c5fe-44e7-9258-1f37739b71fd&quot;,&quot;parentUUID&quot;:&quot;083814f5-3855-42d2-9f0f-7620cd0dea10&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: Buffer.from(&#x27;12345678&#x27;, &#x27;base64&#x27;) })\npolicy.salt.should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2488e33-5dc6-4a59-8dbb-4a379e218831&quot;,&quot;parentUUID&quot;:&quot;083814f5-3855-42d2-9f0f-7620cd0dea10&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed177023-eb3d-4d31-ad3c-7133df2bf11c&quot;,&quot;parentUUID&quot;:&quot;083814f5-3855-42d2-9f0f-7620cd0dea10&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6ba15e34-c5fe-44e7-9258-1f37739b71fd&quot;,&quot;c2488e33-5dc6-4a59-8dbb-4a379e218831&quot;,&quot;ed177023-eb3d-4d31-ad3c-7133df2bf11c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:209,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9384d740-cb4d-4b9b-8b2e-01b87b498bbe&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;298dc42e-f074-4f73-b480-66733f7c51a6&quot;,&quot;parentUUID&quot;:&quot;9384d740-cb4d-4b9b-8b2e-01b87b498bbe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9b415f6-9597-48f2-b602-b86a17a9d49b&quot;,&quot;parentUUID&quot;:&quot;9384d740-cb4d-4b9b-8b2e-01b87b498bbe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: 12345,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: 12345\n  }\n]).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;130b1263-59bf-4d85-b890-8bdbdf07299f&quot;,&quot;parentUUID&quot;:&quot;9384d740-cb4d-4b9b-8b2e-01b87b498bbe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ab718048-55d2-4ee4-a976-8ede12cc468b&quot;,&quot;parentUUID&quot;:&quot;9384d740-cb4d-4b9b-8b2e-01b87b498bbe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;298dc42e-f074-4f73-b480-66733f7c51a6&quot;,&quot;a9b415f6-9597-48f2-b602-b86a17a9d49b&quot;,&quot;130b1263-59bf-4d85-b890-8bdbdf07299f&quot;,&quot;ab718048-55d2-4ee4-a976-8ede12cc468b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:105,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;20a7761d-997e-40a9-9303-b3898984a5b5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:109,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;9.2.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mochawesome&quot;,&quot;reportTitle&quot;:&quot;MFKDF&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>