<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:76,&quot;tests&quot;:268,&quot;passes&quot;:268,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-09-12T21:34:13.127Z&quot;,&quot;end&quot;:&quot;2025-09-12T21:34:34.059Z&quot;,&quot;duration&quot;:20932,&quot;testsRegistered&quot;:268,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;b6e6c0ce-66f4-4132-9efa-5e7bbaad7f42&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;title&quot;:&quot;aes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\aes.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\aes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;encrypt throws on invalid inputs&quot;,&quot;fullTitle&quot;:&quot;aes encrypt throws on invalid inputs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt;\n  crypt.encrypt(&#x27;not a buffer&#x27;, crypto.randomBytes(32))).should.throw();\n(() =&gt;\n  crypt.encrypt(\n    crypto.randomBytes(16),\n    crypto.randomBytes(32)\n  )).should.throw();\n(() =&gt;\n  crypt.encrypt(crypto.randomBytes(32), &#x27;not a buffer&#x27;)).should.throw();\n(() =&gt;\n  crypt.encrypt(\n    crypto.randomBytes(32),\n    crypto.randomBytes(16)\n  )).should.throw()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a4edc5e-627e-4be2-a1e1-e2767c1e0c67&quot;,&quot;parentUUID&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypt throws on invalid inputs&quot;,&quot;fullTitle&quot;:&quot;aes decrypt throws on invalid inputs&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt;\n  crypt.decrypt(&#x27;not a buffer&#x27;, crypto.randomBytes(32))).should.throw();\n(() =&gt;\n  crypt.decrypt(\n    crypto.randomBytes(16),\n    crypto.randomBytes(32)\n  )).should.throw();\n(() =&gt;\n  crypt.decrypt(crypto.randomBytes(32), &#x27;not a buffer&#x27;)).should.throw();\n(() =&gt;\n  crypt.decrypt(\n    crypto.randomBytes(32),\n    crypto.randomBytes(16)\n  )).should.throw()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ab50b2a5-c549-44e0-bcd8-18d841374a3c&quot;,&quot;parentUUID&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypts and decrypts correctly&quot;,&quot;fullTitle&quot;:&quot;aes encrypts and decrypts correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nconst decrypted = crypt.decrypt(encrypted, key)\ndecrypted.equals(data).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;559e5711-6e4c-4b9a-a784-f089bcd669ce&quot;,&quot;parentUUID&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypting with wrong key fails&quot;,&quot;fullTitle&quot;:&quot;aes decrypting with wrong key fails&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst wrongKey = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nconst decrypted = crypt.decrypt(encrypted, wrongKey)\ndecrypted.equals(data).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ec99de0-1136-4a1e-bbe3-c1e6c4d5ed20&quot;,&quot;parentUUID&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;decrypting modified data fails&quot;,&quot;fullTitle&quot;:&quot;aes decrypting modified data fails&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\n// Modify the encrypted data\nencrypted[0] ^= 0xff\nconst decrypted = crypt.decrypt(encrypted, key)\ndecrypted.equals(data).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e68d5d7b-247c-4d2a-97d1-a29b4e58f828&quot;,&quot;parentUUID&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ciphertext length equals plaintext length&quot;,&quot;fullTitle&quot;:&quot;aes ciphertext length equals plaintext length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = crypto.randomBytes(32)\nconst data = crypto.randomBytes(32)\nconst encrypted = crypt.encrypt(data, key)\nencrypted.length.should.equal(data.length)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa82dbde-e2e8-4e83-aa53-efe762cfebef&quot;,&quot;parentUUID&quot;:&quot;fa86c6f3-c772-4e4b-a039-84ab081fe6bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3a4edc5e-627e-4be2-a1e1-e2767c1e0c67&quot;,&quot;ab50b2a5-c549-44e0-bcd8-18d841374a3c&quot;,&quot;559e5711-6e4c-4b9a-a784-f089bcd669ce&quot;,&quot;0ec99de0-1136-4a1e-bbe3-c1e6c4d5ed20&quot;,&quot;e68d5d7b-247c-4d2a-97d1-a29b4e58f828&quot;,&quot;fa82dbde-e2e8-4e83-aa53-efe762cfebef&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1fc77ea6-e84f-416d-85a1-be8d092c9c33&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;08e6b7f7-5276-40f3-b0f0-ff89eb756c66&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    id: &#x27;uuid1&#x27;,\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey()\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;56355ee0-ba3b-42e5-87c1-f950c8928c5d&quot;,&quot;parentUUID&quot;:&quot;08e6b7f7-5276-40f3-b0f0-ff89eb756c66&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;56355ee0-ba3b-42e5-87c1-f950c8928c5d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:23,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2c762018-5d35-4249-985f-cd1aa44809b3&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a97932c-0126-4f57-b59a-882fa292d68a&quot;,&quot;parentUUID&quot;:&quot;2c762018-5d35-4249-985f-cd1aa44809b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8d73b11-8a8a-4773-a162-8cca14d58484&quot;,&quot;parentUUID&quot;:&quot;2c762018-5d35-4249-985f-cd1aa44809b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4a97932c-0126-4f57-b59a-882fa292d68a&quot;,&quot;a8d73b11-8a8a-4773-a162-8cca14d58484&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;137b0415-3c42-42b7-b04d-131a4f32b260&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b75036c-a195-46d2-8a21-5d4edfe85502&quot;,&quot;parentUUID&quot;:&quot;137b0415-3c42-42b7-b04d-131a4f32b260&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;68514e55-a0ca-4486-9018-5e22037b3d93&quot;,&quot;parentUUID&quot;:&quot;137b0415-3c42-42b7-b04d-131a4f32b260&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5b75036c-a195-46d2-8a21-5d4edfe85502&quot;,&quot;68514e55-a0ca-4486-9018-5e22037b3d93&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;22ed84c5-9e51-481c-bff0-0570e2262735&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hkdf&quot;,&quot;fullTitle&quot;:&quot;derive/key hkdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:60,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50ebe3aa-3046-4b3c-8f17-88f7519b2db0&quot;,&quot;parentUUID&quot;:&quot;22ed84c5-9e51-481c-bff0-0570e2262735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:135,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;012cd7a2-0cf0-4c1d-866c-330ce446a5e5&quot;,&quot;parentUUID&quot;:&quot;22ed84c5-9e51-481c-bff0-0570e2262735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:135,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2, integrity: false }\n)\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nconst derive4 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a165c7b-9642-4a98-938e-c9721f83d558&quot;,&quot;parentUUID&quot;:&quot;22ed84c5-9e51-481c-bff0-0570e2262735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nawait mfkdf.derive\n  .key(setup.policy, {\n    password: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    )\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e7cfca3-1ffd-4ee7-8d9b-633070b13df3&quot;,&quot;parentUUID&quot;:&quot;22ed84c5-9e51-481c-bff0-0570e2262735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0887d0e3-7c22-4097-8668-2838dcab4f98&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;03522391-d1f4-4185-9493-a0740c6f8d8c&quot;,&quot;parentUUID&quot;:&quot;0887d0e3-7c22-4097-8668-2838dcab4f98&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;03522391-d1f4-4185-9493-a0740c6f8d8c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:102,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1275a37d-e51a-40f6-85a5-08775aaf85ff&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4fa2256f-5794-47f0-91a3-11119ba98ef8&quot;,&quot;parentUUID&quot;:&quot;1275a37d-e51a-40f6-85a5-08775aaf85ff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;68e2a01c-da90-455a-b555-c8cd2cb82efe&quot;,&quot;parentUUID&quot;:&quot;1275a37d-e51a-40f6-85a5-08775aaf85ff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4fa2256f-5794-47f0-91a3-11119ba98ef8&quot;,&quot;68e2a01c-da90-455a-b555-c8cd2cb82efe&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:53,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;50ebe3aa-3046-4b3c-8f17-88f7519b2db0&quot;,&quot;012cd7a2-0cf0-4c1d-866c-330ce446a5e5&quot;,&quot;0a165c7b-9642-4a98-938e-c9721f83d558&quot;,&quot;5e7cfca3-1ffd-4ee7-8d9b-633070b13df3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:359,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;title&quot;:&quot;derive/outputs&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\derive\\outputs.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\outputs.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;derive/outputs stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    })\n  ]),\n  await mfkdf.setup.factors.uuid({\n    id: &#x27;uuid3&#x27;,\n    uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n  })\n])\ndelete setup.outputs.stack.entropyBits\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    )\n  }),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b981e34-7362-43ba-bfcf-e6a793b382e7&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;derive/outputs hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.hmacsha1()])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.outputs.should.not.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8d3c630-f92e-4c4a-a9a9-e1cd9a7cad1c&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;derive/outputs uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8179e613-cdee-4941-8512-d927d6835eb5&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;derive/outputs question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.outputs.question.strength.calc_time = null\nderive.outputs.question.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf17cc60-b7ab-45ba-97a4-bcf28abbbd75&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;derive/outputs ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:145,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;962912e1-acb3-49a8-b7a9-b7bd0deaa784&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;derive/outputs password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.outputs.password.strength.calc_time = null\nderive.outputs.password.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef9df3ab-ec79-46d8-9ba1-acdad7ccd459&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;multiple&quot;,&quot;fullTitle&quot;:&quot;derive/outputs multiple&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nderive.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e77fd65-3855-47a4-84e5-7557c57d998f&quot;,&quot;parentUUID&quot;:&quot;02065e70-ea78-4812-8df5-e34cc164ec9a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6b981e34-7362-43ba-bfcf-e6a793b382e7&quot;,&quot;c8d3c630-f92e-4c4a-a9a9-e1cd9a7cad1c&quot;,&quot;8179e613-cdee-4941-8512-d927d6835eb5&quot;,&quot;cf17cc60-b7ab-45ba-97a4-bcf28abbbd75&quot;,&quot;962912e1-acb3-49a8-b7a9-b7bd0deaa784&quot;,&quot;ef9df3ab-ec79-46d8-9ba1-acdad7ccd459&quot;,&quot;6e77fd65-3855-47a4-84e5-7557c57d998f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:422,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5084835e-d0ac-451c-a53e-a82439871ad1&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setup/derive fast&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;recovery&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;410b7803-9555-457d-962f-265473dc1c65&quot;,&quot;parentUUID&quot;:&quot;5084835e-d0ac-451c-a53e-a82439871ad1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;recovery&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca978c7c-39d5-4565-b3b5-c9625d628b1f&quot;,&quot;parentUUID&quot;:&quot;5084835e-d0ac-451c-a53e-a82439871ad1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n      id: &#x27;password2&#x27;\n    })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e583b1b-37a3-4c52-9c4e-d8127f09c3d1&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9979d198-f8b6-4f61-93f0-c641633efde5&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:489,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a3de563-0645-4f18-b849-9748cda63b81&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;633e4fbe-4c80-4521-9e24-e4c895a1e5d2&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42e975d4-1797-4e1b-97e1-3defc698b07f&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;examples factors question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with security question factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n])\n// derive key with security question factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19e1238d-5375-4fe8-95ea-3abf3c2c4c52&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;examples factors ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:196,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup RSA key pair (on out-of-band server)\nconst keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\n// setup key with out-of-band authentication factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\n// decrypt and send code (on out-of-band server)\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\n// derive key with out-of-band factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a6c5751-bc5f-443d-a399-430437faf77d&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;49907c2c-ceb0-4f55-beb4-55f72b849746&quot;,&quot;parentUUID&quot;:&quot;095e4c9e-78ed-4744-bb5b-d5b063353b09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1e583b1b-37a3-4c52-9c4e-d8127f09c3d1&quot;,&quot;9979d198-f8b6-4f61-93f0-c641633efde5&quot;,&quot;4a3de563-0645-4f18-b849-9748cda63b81&quot;,&quot;633e4fbe-4c80-4521-9e24-e4c895a1e5d2&quot;,&quot;42e975d4-1797-4e1b-97e1-3defc698b07f&quot;,&quot;19e1238d-5375-4fe8-95ea-3abf3c2c4c52&quot;,&quot;1a6c5751-bc5f-443d-a399-430437faf77d&quot;,&quot;49907c2c-ceb0-4f55-beb4-55f72b849746&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:982,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5478bbf7-4bd0-473c-b692-91d00af427ca&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n  2,\n  3\n) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6464ba59-e698-4574-83b6-fe2f75fc97c4&quot;,&quot;parentUUID&quot;:&quot;5478bbf7-4bd0-473c-b692-91d00af427ca&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6464ba59-e698-4574-83b6-fe2f75fc97c4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c55bba3e-122d-41e7-8e9e-5860085ac107&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b8e1a091-77ac-4036-9835-642ae3a582e0&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [\n  &#x27;passwordA&#x27;,\n  &#x27;passwordC&#x27;\n]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [\n  &#x27;passwordB&#x27;,\n  &#x27;passwordC&#x27;\n]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;11eb8dbf-8ba7-4e03-9147-96ccb233ec6e&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:60,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, {\n        id: &#x27;passwordB&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ff8f87b-494d-4524-b770-7de7f795e9c0&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4fa72db-7508-4e13-8ccf-cfcb9ed105fc&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e450d13-8daa-4e98-87c0-a1e097359d4c&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:55,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ])\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a…5263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14707d87-3f70-46c2-9660-4e907f6ac455&quot;,&quot;parentUUID&quot;:&quot;717a8c4b-0732-4b09-94ca-948e451ca217&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c55bba3e-122d-41e7-8e9e-5860085ac107&quot;,&quot;b8e1a091-77ac-4036-9835-642ae3a582e0&quot;,&quot;11eb8dbf-8ba7-4e03-9147-96ccb233ec6e&quot;,&quot;3ff8f87b-494d-4524-b770-7de7f795e9c0&quot;,&quot;d4fa72db-7508-4e13-8ccf-cfcb9ed105fc&quot;,&quot;8e450d13-8daa-4e98-87c0-a1e097359d4c&quot;,&quot;14707d87-3f70-46c2-9660-4e907f6ac455&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:275,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08a9467e-77e4-4cf3-8a71-16cec90ad253&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8dce1ee9-d8c6-4daa-a94d-af56afd211c4&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 1 }\n)\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8686d53-6aa0-455b-9639-283627d792af&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44db4146-b094-47ce-bdf0-d5e68fec6322&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d0f0bf9-959a-4dd8-9c98-32d61250d5f4&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31ddfb52-4122-4074-9893-2b90978041ce&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;167c82ce-ea66-40e1-97c2-80b406807512&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c437786-dd2c-4ef1-b95e-68f84ce98974&quot;,&quot;parentUUID&quot;:&quot;de8cca04-dea9-4ea4-86c9-f40b373fdcfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;08a9467e-77e4-4cf3-8a71-16cec90ad253&quot;,&quot;8dce1ee9-d8c6-4daa-a94d-af56afd211c4&quot;,&quot;c8686d53-6aa0-455b-9639-283627d792af&quot;,&quot;44db4146-b094-47ce-bdf0-d5e68fec6322&quot;,&quot;7d0f0bf9-959a-4dd8-9c98-32d61250d5f4&quot;,&quot;31ddfb52-4122-4074-9893-2b90978041ce&quot;,&quot;167c82ce-ea66-40e1-97c2-80b406807512&quot;,&quot;1c437786-dd2c-4ef1-b95e-68f84ce98974&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:383,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;87414abe-4211-412e-afb2-ce974002508e&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1b78aa7-29c6-488a-8f82-8e4d05bdb5e5&quot;,&quot;parentUUID&quot;:&quot;87414abe-4211-412e-afb2-ce974002508e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b1b78aa7-29c6-488a-8f82-8e4d05bdb5e5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:45,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9661f2d5-eaf8-4e1d-a18e-0eba8ecd7d10&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\n// get sub-key for \&quot;eth\&quot;\nconst subkey = key.getSubkey(&#x27;eth&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 97cb…bac5&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c49da071-9c27-460b-8ccb-af34dbb4d56f&quot;,&quot;parentUUID&quot;:&quot;9661f2d5-eaf8-4e1d-a18e-0eba8ecd7d10&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c49da071-9c27-460b-8ccb-af34dbb4d56f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:21,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;410b7803-9555-457d-962f-265473dc1c65&quot;,&quot;ca978c7c-39d5-4565-b3b5-c9625d628b1f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:90,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;727bc3f8-cc35-483f-88c6-71c142ef3bfd&quot;,&quot;title&quot;:&quot;site&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\site.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\site.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Go beyond passwords&quot;,&quot;fullTitle&quot;:&quot;site Go beyond passwords&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify(\n  (\n    await mfkdf.setup.key(\n      [\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n        await mfkdf.setup.factors.hotp({\n          secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n        }),\n        await mfkdf.setup.factors.uuid({\n          id: &#x27;recovery&#x27;,\n          uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n        })\n      ],\n      { threshold: 2, pbkdf2rounds: 1 }\n    )\n  ).policy\n)\nconst derivedKey = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  password: mfkdf.derive.factors.password(&#x27;Tr0ub4dour&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  recovery: mfkdf.derive.factors.uuid(\n    &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  )\n})\nderivedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75838183-3ce3-4d1d-8f85-7ceea6ba3410&quot;,&quot;parentUUID&quot;:&quot;727bc3f8-cc35-483f-88c6-71c142ef3bfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Increased key entropy&quot;,&quot;fullTitle&quot;:&quot;site Increased key entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;Math.floor(\n  (\n    await mfkdf.setup.key([\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n    ])\n  ).entropyBits.real\n).should.equal(16)\nMath.floor(\n  (\n    await mfkdf.setup.key([\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.hotp(),\n      await mfkdf.setup.factors.hmacsha1()\n    ])\n  ).entropyBits.real\n).should.equal(196)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0baa2ea-2b13-4ee6-9708-af28e9d55b49&quot;,&quot;parentUUID&quot;:&quot;727bc3f8-cc35-483f-88c6-71c142ef3bfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enforce advanced policies&quot;,&quot;fullTitle&quot;:&quot;site Enforce advanced policies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:363,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policyBasedKey = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.totp()\n    )\n  )\n)\npolicyBasedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74343838-b9a4-4c47-a649-e05fa44273b5&quot;,&quot;parentUUID&quot;:&quot;727bc3f8-cc35-483f-88c6-71c142ef3bfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Self-service factor recovery&quot;,&quot;fullTitle&quot;:&quot;site Self-service factor recovery&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify(\n  (\n    await mfkdf.setup.key(\n      [\n        await mfkdf.setup.factors.password(&#x27;password&#x27;),\n        await mfkdf.setup.factors.hotp({\n          secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n        }),\n        await mfkdf.setup.factors.uuid({\n          id: &#x27;recoveryCode&#x27;,\n          uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n        })\n      ],\n      { threshold: 2, pbkdf2rounds: 1 }\n    )\n  ).policy\n)\nconst key = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  hotp: mfkdf.derive.factors.hotp(241063),\n  recoveryCode: mfkdf.derive.factors.uuid(\n    &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  )\n})\nawait key.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;myNewPassword&#x27;, { id: &#x27;password&#x27; })\n) // modify key to use new password factor&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b4597e12-edf8-42c6-9491-b8e248dd57da&quot;,&quot;parentUUID&quot;:&quot;727bc3f8-cc35-483f-88c6-71c142ef3bfd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;75838183-3ce3-4d1d-8f85-7ceea6ba3410&quot;,&quot;c0baa2ea-2b13-4ee6-9708-af28e9d55b49&quot;,&quot;74343838-b9a4-4c47-a649-e05fa44273b5&quot;,&quot;b4597e12-edf8-42c6-9491-b8e248dd57da&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:500,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 6458…dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23deff72-40a6-4b0c-8057-8f3e7f2e60b0&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  }),\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// reconstitute key to change password\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword&#x27;)\n)\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b5d832b-9f28-41b0-8e04-7fbb30edd865&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.stack([\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ]),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 1 }\n)\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0…2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa0ae9e0-63d6-4f14-be42-710fa9ab0971&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:55,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0cac3d73-3bbf-4e84-8346-775395f68747&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({\n      secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n    }),\n    await mfkdf.setup.factors.uuid({\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf56f43c-e93a-44b1-8d15-84f65a74cc85&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:129,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n])\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n])\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n])\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n])\nconst threshold = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.uuid(),\n    await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4969216-284f-4dac-b8f5-a39e582d62a4&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  }),\n  await mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  })\n])\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(241063),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d2…5771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73e30e81-0186-4e43-839c-9b2e1ac3ab6b&quot;,&quot;parentUUID&quot;:&quot;7d0bf663-d598-41a5-a6ca-9e1da0e64052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;23deff72-40a6-4b0c-8057-8f3e7f2e60b0&quot;,&quot;1b5d832b-9f28-41b0-8e04-7fbb30edd865&quot;,&quot;aa0ae9e0-63d6-4f14-be42-710fa9ab0971&quot;,&quot;0cac3d73-3bbf-4e84-8346-775395f68747&quot;,&quot;cf56f43c-e93a-44b1-8d15-84f65a74cc85&quot;,&quot;f4969216-284f-4dac-b8f5-a39e582d62a4&quot;,&quot;73e30e81-0186-4e43-839c-9b2e1ac3ab6b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:427,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;cd734774-3fdb-4dd3-8391-8ddb12efbe1c&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key).update(challenge).digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;46722a3c-3330-494b-96ce-637b123e7d6c&quot;,&quot;parentUUID&quot;:&quot;cd734774-3fdb-4dd3-8391-8ddb12efbe1c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:73,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.hmacsha1()])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(\n  setup.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response1 = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(\n  derive1.policy.factors[0].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response2 = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d77d4d2-6eea-4eed-97f5-99a79f47cd4f&quot;,&quot;parentUUID&quot;:&quot;cd734774-3fdb-4dd3-8391-8ddb12efbe1c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:27,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(\n  JSON.parse(setup),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nderive.key\n  .toString(&#x27;hex&#x27;)\n  .should.equal(\n    &#x27;2747ebf65219aee6630a758e40fd05ccbb39ab465745ea1c9a6c5adb6673d2d3&#x27;\n  )&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;371ca793-c0a8-48d2-897c-8c7413de216e&quot;,&quot;parentUUID&quot;:&quot;cd734774-3fdb-4dd3-8391-8ddb12efbe1c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;wrong-salt&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 wrong-salt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PlS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(\n  JSON.parse(setup),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nconst setup2 =\n  &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v2.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;key\&quot;:\&quot;LPJNul+wow4m6DsqxbninhsWHlwfp0JecwQzYpOLmCQ=\&quot;,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;salt\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\&quot;}}]}&#x27;\nconst derive2 = await mfkdf.derive.key(\n  JSON.parse(setup2),\n  {\n    hmacsha1: mfkdf.derive.factors.hmacsha1(\n      Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;)\n    )\n  },\n  false\n)\nderive.key\n  .toString(&#x27;hex&#x27;)\n  .should.not.equal(\n    &#x27;64393334663330303639356134323533393937376561636234363262373662316562616564393838663531393337303563666432633265373130636663666230&#x27;\n  )\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bc184a87-7e5c-4aad-b424-6d36fd78937f&quot;,&quot;parentUUID&quot;:&quot;cd734774-3fdb-4dd3-8391-8ddb12efbe1c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4a7cb35e-fa4e-452a-a48a-064ad933782d&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;accab878-cc9b-4e67-b0a8-c95e850603bd&quot;,&quot;parentUUID&quot;:&quot;4a7cb35e-fa4e-452a-a48a-064ad933782d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;614b80c9-1f57-47e1-9493-3dd747b35b8d&quot;,&quot;parentUUID&quot;:&quot;4a7cb35e-fa4e-452a-a48a-064ad933782d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ secret: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db197e18-5aad-45b2-9b78-174187f91bbf&quot;,&quot;parentUUID&quot;:&quot;4a7cb35e-fa4e-452a-a48a-064ad933782d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f24158d8-ba0c-4a3c-8946-31b3ce99903b&quot;,&quot;parentUUID&quot;:&quot;4a7cb35e-fa4e-452a-a48a-064ad933782d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f45244f-5081-4d26-8cfc-56c1f3cdaf86&quot;,&quot;parentUUID&quot;:&quot;4a7cb35e-fa4e-452a-a48a-064ad933782d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;accab878-cc9b-4e67-b0a8-c95e850603bd&quot;,&quot;614b80c9-1f57-47e1-9493-3dd747b35b8d&quot;,&quot;db197e18-5aad-45b2-9b78-174187f91bbf&quot;,&quot;f24158d8-ba0c-4a3c-8946-31b3ce99903b&quot;,&quot;8f45244f-5081-4d26-8cfc-56c1f3cdaf86&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;46722a3c-3330-494b-96ce-637b123e7d6c&quot;,&quot;7d77d4d2-6eea-4eed-97f5-99a79f47cd4f&quot;,&quot;371ca793-c0a8-48d2-897c-8c7413de216e&quot;,&quot;bc184a87-7e5c-4aad-b424-6d36fd78937f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:150,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;53dffe4b-ee78-4464-a22e-4e9110495575&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;size&quot;,&quot;fullTitle&quot;:&quot;factors/hotp size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d201daf1-e96a-4632-927b-ed49b765e937&quot;,&quot;parentUUID&quot;:&quot;53dffe4b-ee78-4464-a22e-4e9110495575&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:95,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(361687)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(979122)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c731230-c2f7-418d-ab92-2ce46689ab38&quot;,&quot;parentUUID&quot;:&quot;53dffe4b-ee78-4464-a22e-4e9110495575&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([await mfkdf.setup.factors.hotp()])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;38fdbdf4-2f4f-46e3-986c-506fb20cdcce&quot;,&quot;parentUUID&quot;:&quot;53dffe4b-ee78-4464-a22e-4e9110495575&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd742655-507e-4e14-8388-02e0654e56c5&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f99a9416-4bed-40f0-b423-859e3a05fa65&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c932cbb7-b510-4da8-915f-5c84f07518c5&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8c311057-66d6-432e-b920-dde2be1fc78d&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 4\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77853dfe-ac9a-406f-9cde-072bd1806b6b&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 9\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;322b6ac2-b1d1-4a41-bc28-e1e5437ca12a&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await await mfkdf.setup.factors\n  .hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    hash: &#x27;sha123&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0cf42a2-0fc9-4036-96da-17bddc041e7f&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .hotp({\n    secret: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b8271ba-0a69-48bf-aa91-f9dce9b0dbcf&quot;,&quot;parentUUID&quot;:&quot;f6af205f-6f3e-4d14-9edb-2409f37c58d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cd742655-507e-4e14-8388-02e0654e56c5&quot;,&quot;f99a9416-4bed-40f0-b423-859e3a05fa65&quot;,&quot;c932cbb7-b510-4da8-915f-5c84f07518c5&quot;,&quot;8c311057-66d6-432e-b920-dde2be1fc78d&quot;,&quot;77853dfe-ac9a-406f-9cde-072bd1806b6b&quot;,&quot;322b6ac2-b1d1-4a41-bc28-e1e5437ca12a&quot;,&quot;c0cf42a2-0fc9-4036-96da-17bddc041e7f&quot;,&quot;7b8271ba-0a69-48bf-aa91-f9dce9b0dbcf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;d201daf1-e96a-4632-927b-ed49b765e937&quot;,&quot;1c731230-c2f7-418d-ab92-2ce46689ab38&quot;,&quot;38fdbdf4-2f4f-46e3-986c-506fb20cdcce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:116,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0faa6ad9-75f5-4276-b002-3a3b5aee58ec&quot;,&quot;title&quot;:&quot;factors/ooba&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;factors/ooba full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:158,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: {\n      email: &#x27;test@mfkdf.com&#x27;\n    }\n  })\n])\nlet next = setup.policy.factors[0].params.next\nlet decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nlet json = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\nlet code = json.code\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nnext = derive1.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toLowerCase())\n})\nnext = derive2.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toUpperCase())\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fea34613-02ec-488f-9cc6-1f9f04dbe227&quot;,&quot;parentUUID&quot;:&quot;0faa6ad9-75f5-4276-b002-3a3b5aee58ec&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;af9d803b-bfd6-4fdb-a4f6-cdd85d2f78e5&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.ooba(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;778b1ad5-003b-487b-885e-6e1ad6b1e597&quot;,&quot;parentUUID&quot;:&quot;af9d803b-bfd6-4fdb-a4f6-cdd85d2f78e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:53,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nawait mfkdf.setup.factors\n  .ooba({\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: &#x27;foo&#x27;\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: 0\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    length: 100\n  })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .ooba({\n    key: &#x27;12345&#x27;\n  })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .ooba({\n    key: keyPair.publicKey,\n    params: &#x27;12345&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4255bf6-6c91-4188-887b-78192f745be1&quot;,&quot;parentUUID&quot;:&quot;af9d803b-bfd6-4fdb-a4f6-cdd85d2f78e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;778b1ad5-003b-487b-885e-6e1ad6b1e597&quot;,&quot;a4255bf6-6c91-4188-887b-78192f745be1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:53,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;fea34613-02ec-488f-9cc6-1f9f04dbe227&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:158,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7d9205da-a324-4167-babd-826eb0cae961&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:47,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ffb910d7-48eb-4fa7-bedd-3dace3e7bf0b&quot;,&quot;parentUUID&quot;:&quot;7d9205da-a324-4167-babd-826eb0cae961&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b4db57fb-2062-4e01-ba0b-f9c46c3b016c&quot;,&quot;parentUUID&quot;:&quot;7d9205da-a324-4167-babd-826eb0cae961&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ffb910d7-48eb-4fa7-bedd-3dace3e7bf0b&quot;,&quot;b4db57fb-2062-4e01-ba0b-f9c46c3b016c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:47,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;27bb74c2-29ff-49e1-a6b2-1bbb42877463&quot;,&quot;title&quot;:&quot;factors/question&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/question valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27; Fido-&#x27;, {\n    question: &#x27;What is the name of your first pet?&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;-f_i%d#o ? &#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;87e0fd79-75c9-4b74-b1b5-61fa68f78f1b&quot;,&quot;parentUUID&quot;:&quot;27bb74c2-29ff-49e1-a6b2-1bbb42877463&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/question invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:46,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;, {\n    question: &#x27;What is the name of your first pet?&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    question: mfkdf.derive.factors.question(&#x27;Rex&#x27;)\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf4eee23-b8c0-40bc-920a-97b70c92d754&quot;,&quot;parentUUID&quot;:&quot;27bb74c2-29ff-49e1-a6b2-1bbb42877463&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e3805789-e2c3-4370-99bb-21143f9f6d89&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/question errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.question(123)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.question(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;30237617-2edb-4b90-8ba6-fb33abf7ea0a&quot;,&quot;parentUUID&quot;:&quot;e3805789-e2c3-4370-99bb-21143f9f6d89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/question errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .question(12345)\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors.question(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { id: 12345 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .question(&#x27;hello&#x27;, { question: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8955e0a2-e681-4c28-9772-72dfbdfdf6ee&quot;,&quot;parentUUID&quot;:&quot;e3805789-e2c3-4370-99bb-21143f9f6d89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;30237617-2edb-4b90-8ba6-fb33abf7ea0a&quot;,&quot;8955e0a2-e681-4c28-9772-72dfbdfdf6ee&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;87e0fd79-75c9-4b74-b1b5-61fa68f78f1b&quot;,&quot;cf4eee23-b8c0-40bc-920a-97b70c92d754&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:91,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;878da211-265f-48ae-bbb9-6d20f00d38fc&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors\n  .stack(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ],\n    { id: 12345 }\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92ea446c-0522-4d80-9049-b4f46a418d14&quot;,&quot;parentUUID&quot;:&quot;878da211-265f-48ae-bbb9-6d20f00d38fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors\n  .stack(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ],\n    { id: &#x27;&#x27; }\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;383151e4-a2ee-44f6-807b-ad37349da3d7&quot;,&quot;parentUUID&quot;:&quot;878da211-265f-48ae-bbb9-6d20f00d38fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.stack(\n      [\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ],\n      { id: &#x27;stack1&#x27; }\n    ),\n    await mfkdf.setup.factors.stack(\n      [\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        })\n      ],\n      { id: &#x27;stack2&#x27; }\n    )\n  ],\n  { threshold: 1 }\n)\nsetup.policy.factors[0].params.should.not.have.property(&#x27;hmac&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ad16f63-5684-44e7-a24a-8bcd4cf9155d&quot;,&quot;parentUUID&quot;:&quot;878da211-265f-48ae-bbb9-6d20f00d38fc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;92ea446c-0522-4d80-9049-b4f46a418d14&quot;,&quot;383151e4-a2ee-44f6-807b-ad37349da3d7&quot;,&quot;4ad16f63-5684-44e7-a24a-8bcd4cf9155d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:77,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ec00c28f-fed2-4774-b371-9ec9bca134e3&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;size&quot;,&quot;fullTitle&quot;:&quot;factors/totp size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32bed26c-c963-4c32-a699-748f4b862940&quot;,&quot;parentUUID&quot;:&quot;ec00c28f-fed2-4774-b371-9ec9bca134e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:457,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.totp()])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f683b47-3c1d-4023-9f3c-3105400d198d&quot;,&quot;parentUUID&quot;:&quot;ec00c28f-fed2-4774-b371-9ec9bca134e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:453,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, { time: 30001 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, { time: 60001 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9b0f88f9-d131-4889-801e-c4a19536d07f&quot;,&quot;parentUUID&quot;:&quot;ec00c28f-fed2-4774-b371-9ec9bca134e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:367,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([await mfkdf.setup.factors.totp()])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;106e3c18-0baa-4aae-b05a-790871ef9391&quot;,&quot;parentUUID&quot;:&quot;ec00c28f-fed2-4774-b371-9ec9bca134e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c1fd374-f07e-4ef4-832b-1b24d67dd8d5&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:375,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597\n  })\n])\nawait mfkdf.derive\n  .key(setup.policy, {\n    totp: mfkdf.derive.factors.totp(953265, { time: 1750430943604 })\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c93b1dd3-f6d5-449c-bd31-528dae808acb&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1fd785a-6d83-4f6c-a07b-15c5905513ad&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;94700249-69ea-43a6-bf81-02ce540150d5&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: 12345\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d5572022-7948-4d9a-81b8-6cb3906a5ff0&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    id: &#x27;&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6da0e706-ff68-4937-b24a-a44c25512844&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89c36118-f18d-4276-a3e7-4eb441dd96cc&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 4\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0fbd5e86-e2e3-429b-91db-74ab505f199e&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    digits: 9\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bef9a180-0607-4781-80f2-9b4a703a1042&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    hash: &#x27;sha123&#x27;\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d76d4e16-d808-4968-91dc-ddc8b1230e46&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    secret: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e3b1873-aaa6-4683-a835-3b998b63897f&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    time: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f04e9503-d205-4d46-bd8a-5cc5e9199bac&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    time: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2215ce6c-908f-4842-9d0d-97c0b050206b&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    step: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d066797f-7b99-4753-b962-351b2388e7ad&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    step: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5a669cd-4f1d-4931-a949-b60fa3f589bb&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    window: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90cbbf73-8acd-4119-88c5-01700409d9c4&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .totp({\n    window: -1\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c021339-8c72-424c-ab4d-b9c5c50ec6ae&quot;,&quot;parentUUID&quot;:&quot;d03e695f-c46c-494e-b0d9-a02453ac19e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5c1fd374-f07e-4ef4-832b-1b24d67dd8d5&quot;,&quot;c93b1dd3-f6d5-449c-bd31-528dae808acb&quot;,&quot;f1fd785a-6d83-4f6c-a07b-15c5905513ad&quot;,&quot;94700249-69ea-43a6-bf81-02ce540150d5&quot;,&quot;d5572022-7948-4d9a-81b8-6cb3906a5ff0&quot;,&quot;6da0e706-ff68-4937-b24a-a44c25512844&quot;,&quot;89c36118-f18d-4276-a3e7-4eb441dd96cc&quot;,&quot;0fbd5e86-e2e3-429b-91db-74ab505f199e&quot;,&quot;bef9a180-0607-4781-80f2-9b4a703a1042&quot;,&quot;d76d4e16-d808-4968-91dc-ddc8b1230e46&quot;,&quot;7e3b1873-aaa6-4683-a835-3b998b63897f&quot;,&quot;f04e9503-d205-4d46-bd8a-5cc5e9199bac&quot;,&quot;2215ce6c-908f-4842-9d0d-97c0b050206b&quot;,&quot;d066797f-7b99-4753-b962-351b2388e7ad&quot;,&quot;b5a669cd-4f1d-4931-a949-b60fa3f589bb&quot;,&quot;90cbbf73-8acd-4119-88c5-01700409d9c4&quot;,&quot;0c021339-8c72-424c-ab4d-b9c5c50ec6ae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:376,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;32bed26c-c963-4c32-a699-748f4b862940&quot;,&quot;0f683b47-3c1d-4023-9f3c-3105400d198d&quot;,&quot;9b0f88f9-d131-4889-801e-c4a19536d07f&quot;,&quot;106e3c18-0baa-4aae-b05a-790871ef9391&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1277,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;32e7ae51-c06f-4eef-a312-6f1cca388174&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:134,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a1a8645f-073f-4c0d-b7ee-9a6f32c4b43d&quot;,&quot;parentUUID&quot;:&quot;32e7ae51-c06f-4eef-a312-6f1cca388174&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:126,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid1&#x27;,\n      uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid2&#x27;,\n      uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    }),\n    await mfkdf.setup.factors.uuid({\n      id: &#x27;uuid3&#x27;,\n      uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    })\n  ],\n  { threshold: 2 }\n)\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    )\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;\n    )\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;\n    )\n  },\n  false\n)\nconst derive4 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    uuid1: mfkdf.derive.factors.uuid(\n      &#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;\n    ),\n    uuid2: mfkdf.derive.factors.uuid(\n      &#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;\n    ),\n    uuid3: mfkdf.derive.factors.uuid(\n      &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n    )\n  },\n  false\n)\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e71f52ec-eccc-49db-9c22-a9a9facde12a&quot;,&quot;parentUUID&quot;:&quot;32e7ae51-c06f-4eef-a312-6f1cca388174&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a1a8645f-073f-4c0d-b7ee-9a6f32c4b43d&quot;,&quot;e71f52ec-eccc-49db-9c22-a9a9facde12a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:260,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec62b1b6-39a3-4cf3-9004-589b992e7d4c&quot;,&quot;parentUUID&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23e2d7cc-b018-419a-b504-5047fcb79720&quot;,&quot;parentUUID&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9504f54a-f202-4dbc-ba96-b8f268d1e03d&quot;,&quot;parentUUID&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfd3a15f-4363-440b-8694-5f69e721eeb8&quot;,&quot;parentUUID&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:383,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7baa0be4-e81c-4d9e-a644-3a557b66e370&quot;,&quot;parentUUID&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:386,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df947c55-4fe9-425c-bcf9-e0d939f89bfc&quot;,&quot;parentUUID&quot;:&quot;4b62b1c4-a68a-4ea4-ab60-312cf6d4325d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ec62b1b6-39a3-4cf3-9004-589b992e7d4c&quot;,&quot;23e2d7cc-b018-419a-b504-5047fcb79720&quot;,&quot;9504f54a-f202-4dbc-ba96-b8f268d1e03d&quot;,&quot;dfd3a15f-4363-440b-8694-5f69e721eeb8&quot;,&quot;7baa0be4-e81c-4d9e-a644-3a557b66e370&quot;,&quot;df947c55-4fe9-425c-bcf9-e0d939f89bfc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:856,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;title&quot;:&quot;integrity&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\integrity.js&quot;,&quot;file&quot;:&quot;\\test\\features\\integrity.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;disabled&quot;,&quot;fullTitle&quot;:&quot;integrity disabled&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:62,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  false\n)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1315542c-5ebb-423c-acfa-530584d80f7b&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;safety&quot;,&quot;fullTitle&quot;:&quot;integrity safety&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:96,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n      password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n      password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aadb8034-4541-44c7-a5c3-6e65774c2b30&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;liveness&quot;,&quot;fullTitle&quot;:&quot;integrity liveness&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:93,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  true\n)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae856068-3e6d-4d1e-8b81-46575929d529&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;$id&quot;,&quot;fullTitle&quot;:&quot;integrity $id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.$id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;560c451c-284a-4ee3-8c54-1973a1114a8f&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold&quot;,&quot;fullTitle&quot;:&quot;integrity threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.threshold += 1\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e66431fd-6b30-455e-b931-6f0aad029cc0&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;salt&quot;,&quot;fullTitle&quot;:&quot;integrity salt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.salt = &#x27;Ny9+L9LQHOKh1x3Acqy7pMb9JaEIfNfxU/TsDON+Ht4=&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;715c5af4-becb-4532-9036-20354be1068f&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id&quot;,&quot;fullTitle&quot;:&quot;integrity factor/id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:65,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  { integrity: true }\n)\n// Tamper with policy\nsetup.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23a7ead5-409c-488e-96d8-956e25f3c4e6&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;integrity derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:97,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ]),\n  { integrity: true }\n)\nconst derive = await mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  },\n  true\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\n// Tamper with policy\nderive.policy.factors[0].id = &#x27;tampered&#x27;\nawait mfkdf.policy\n  .derive(\n    derive.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n      password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n      password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n    },\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;efde567a-e577-4c1a-962a-25913cdb7ed2&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullTitle&quot;:&quot;integrity reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:61,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2, integrity: true }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  })\n)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n  },\n  true\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86c9e802-a319-483d-b9ce-06dd9a32a2da&quot;,&quot;parentUUID&quot;:&quot;2b860966-d66d-4c0c-b428-03cbafa2f088&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1315542c-5ebb-423c-acfa-530584d80f7b&quot;,&quot;aadb8034-4541-44c7-a5c3-6e65774c2b30&quot;,&quot;ae856068-3e6d-4d1e-8b81-46575929d529&quot;,&quot;560c451c-284a-4ee3-8c54-1973a1114a8f&quot;,&quot;e66431fd-6b30-455e-b931-6f0aad029cc0&quot;,&quot;715c5af4-becb-4532-9036-20354be1068f&quot;,&quot;23a7ead5-409c-488e-96d8-956e25f3c4e6&quot;,&quot;efde567a-e577-4c1a-962a-25913cdb7ed2&quot;,&quot;86c9e802-a319-483d-b9ce-06dd9a32a2da&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:609,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d594c0fc-e36a-47c8-9fa3-9a7edd4a6280&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a4903546-29d1-4b3f-8c3c-722ce00bcd45&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:35,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;71ca8d14-2623-4279-9107-587975ddf35d&quot;,&quot;parentUUID&quot;:&quot;a4903546-29d1-4b3f-8c3c-722ce00bcd45&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.policy\n  .setup(\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      )\n    )\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cefb865e-0c9d-4bbd-9780-4fe22dc6de38&quot;,&quot;parentUUID&quot;:&quot;a4903546-29d1-4b3f-8c3c-722ce00bcd45&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;71ca8d14-2623-4279-9107-587975ddf35d&quot;,&quot;cefb865e-0c9d-4bbd-9780-4fe22dc6de38&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:64,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7ac326cf-3bda-4f40-83fc-816731bcd788&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be\n  .true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;529e2a9b-352e-434c-995a-f508dc934c16&quot;,&quot;parentUUID&quot;:&quot;7ac326cf-3bda-4f40-83fc-816731bcd788&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be\n  .true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be\n  .false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be\n  .false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e887a805-0cbf-429b-90b2-9eb90936c245&quot;,&quot;parentUUID&quot;:&quot;7ac326cf-3bda-4f40-83fc-816731bcd788&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;529e2a9b-352e-434c-995a-f508dc934c16&quot;,&quot;e887a805-0cbf-429b-90b2-9eb90936c245&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:60,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09c07ab6-33e4-4b93-b165-47311e807a83&quot;,&quot;parentUUID&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:70,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a398c4f-aa7f-4007-89a7-002e52a36f07&quot;,&quot;parentUUID&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:62,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4f23d34-b9d0-4056-98af-285106c12dc2&quot;,&quot;parentUUID&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:196,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22da347b-aad1-4c96-8a0e-3811ddb3091e&quot;,&quot;parentUUID&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n        id: &#x27;password3&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0aa3687-6369-4737-b29b-0d7269a5b827&quot;,&quot;parentUUID&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e3cc33e-077a-4af5-abd7-f2dba2209611&quot;,&quot;parentUUID&quot;:&quot;45bd594f-787e-447c-8233-e87c7402aadb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;09c07ab6-33e4-4b93-b165-47311e807a83&quot;,&quot;7a398c4f-aa7f-4007-89a7-002e52a36f07&quot;,&quot;e4f23d34-b9d0-4056-98af-285106c12dc2&quot;,&quot;22da347b-aad1-4c96-8a0e-3811ddb3091e&quot;,&quot;c0aa3687-6369-4737-b29b-0d7269a5b827&quot;,&quot;7e3cc33e-077a-4af5-abd7-f2dba2209611&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:600,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;eed5efa2-a919-4616-a68b-97b3e988f826&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:33,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n          id: &#x27;password1&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n])\nawait mfkdf.policy\n  .derive(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n    password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f9517e7-21cb-4560-b1b0-3e538483fff5&quot;,&quot;parentUUID&quot;:&quot;eed5efa2-a919-4616-a68b-97b3e988f826&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:35,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n          id: &#x27;password2&#x27;\n        }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, {\n          id: &#x27;password3&#x27;\n        })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, {\n          id: &#x27;password4&#x27;\n        }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, {\n            id: &#x27;password5&#x27;\n          }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, {\n            id: &#x27;password6&#x27;\n          })\n        )\n      )\n    )\n  )\n)\nawait mfkdf.policy\n  .derive(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef592867-9d6f-4584-b54b-c6d337371e4e&quot;,&quot;parentUUID&quot;:&quot;eed5efa2-a919-4616-a68b-97b3e988f826&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8f9517e7-21cb-4560-b1b0-3e538483fff5&quot;,&quot;ef592867-9d6f-4584-b54b-c6d337371e4e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:68,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:65,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ],\n  { threshold: 3, integrity: false }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    false\n  )\n  .should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2f679ca9-ae06-4513-81c5-a3cc9087bc38&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:145,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)\nawait derive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait mfkdf.derive\n  .key(derive2.policy, {\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a3c65fe-1534-41e4-a3d6-cc7029023dbe&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:133,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nawait mfkdf.derive\n  .key(setup.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n  .should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1306a06-bdaa-47ac-8922-5b4ba9753238&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:66,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa636753-4ca4-4f0d-9aed-6a9b85efbc70&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:71,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e34a77fc-8fee-4e42-862b-4674eb138f87&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:63,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  })\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75c8adc9-41c0-40b1-b3e5-bfb446549939&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:71,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, {\n    id: &#x27;password3&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92f7303a-5fab-441e-b20d-edffc0ba7344&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:73,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute(\n  [&#x27;password1&#x27;],\n  [\n    await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n      id: &#x27;password2&#x27;\n    })\n  ],\n  2\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cbdf15f6-dfd8-418e-9c83-9bc188b8fb4a&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2c14e11-5e68-4bbc-9d01-1e06aae31c65&quot;,&quot;parentUUID&quot;:&quot;3e01bd18-35c2-46db-b945-3018a1ed2792&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [12345],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0bc9af78-bd89-4df8-9c4a-5729a0492238&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:41,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [&#x27;password4&#x27;],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;877ad74b-da3e-4323-b63b-e008be8eb348&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 2 }\n)\nawait setup\n  .reconstitute(\n    [&#x27;password3&#x27;],\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      }),\n      await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1813884d-151d-46bb-9f07-863cf20f5bbd&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    &#x27;hello&#x27;,\n    [\n      await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, {\n        id: &#x27;password2&#x27;\n      })\n    ],\n    2\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;30568428-de1f-46da-a736-d8bae4328954&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute([], &#x27;12345&#x27;, 2)\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8582b6ec-dda9-4af1-8418-02fb37172813&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute([], [], &#x27;12345&#x27;)\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2926e275-7bbd-4c03-ba92-c07da857e51b&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a022eee3-1e18-4898-90dd-6f89c310d2ac&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: 12345,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e738ac0b-73e0-4342-9320-ded345a4f918&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23bb5584-0056-44ab-a8e7-aeca26e1623e&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:34,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: 12345,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;821913d0-7255-4459-bbfb-ec9d402839ac&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:26,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2f261874-ce58-4f5a-a72d-859fd160af7a&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:37,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: 12345,\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b9d56999-e9e0-4051-860d-6cddfb4debf5&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:30,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1ae0822d-0c04-45f9-8c33-abdf5a205a46&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;),\n        params: 12345,\n        output: async () =&gt; {\n          return {}\n        }\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1abec2e5-3159-44ce-a6de-c9cdfc9da3a6&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup\n  .reconstitute(\n    [],\n    [\n      {\n        type: &#x27;password&#x27;,\n        id: &#x27;password4&#x27;,\n        data: Buffer.from(&#x27;password4&#x27;),\n        params: async () =&gt; {\n          return {}\n        },\n        output: 12345\n      }\n    ],\n    3\n  )\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa93c987-1976-4cd6-ba9c-25a2d1d04b50&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n  ],\n  { threshold: 3 }\n)\nawait setup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d966bc5e-dc82-4033-8c57-801cf0645b03&quot;,&quot;parentUUID&quot;:&quot;af98be4f-6e47-4dde-b1bb-58b6a5d3b8fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0bc9af78-bd89-4df8-9c4a-5729a0492238&quot;,&quot;877ad74b-da3e-4323-b63b-e008be8eb348&quot;,&quot;1813884d-151d-46bb-9f07-863cf20f5bbd&quot;,&quot;30568428-de1f-46da-a736-d8bae4328954&quot;,&quot;8582b6ec-dda9-4af1-8418-02fb37172813&quot;,&quot;2926e275-7bbd-4c03-ba92-c07da857e51b&quot;,&quot;a022eee3-1e18-4898-90dd-6f89c310d2ac&quot;,&quot;e738ac0b-73e0-4342-9320-ded345a4f918&quot;,&quot;23bb5584-0056-44ab-a8e7-aeca26e1623e&quot;,&quot;821913d0-7255-4459-bbfb-ec9d402839ac&quot;,&quot;2f261874-ce58-4f5a-a72d-859fd160af7a&quot;,&quot;b9d56999-e9e0-4051-860d-6cddfb4debf5&quot;,&quot;1ae0822d-0c04-45f9-8c33-abdf5a205a46&quot;,&quot;1abec2e5-3159-44ce-a6de-c9cdfc9da3a6&quot;,&quot;aa93c987-1976-4cd6-ba9c-25a2d1d04b50&quot;,&quot;d966bc5e-dc82-4033-8c57-801cf0645b03&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:459,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2f679ca9-ae06-4513-81c5-a3cc9087bc38&quot;,&quot;8a3c65fe-1534-41e4-a3d6-cc7029023dbe&quot;,&quot;c1306a06-bdaa-47ac-8922-5b4ba9753238&quot;,&quot;aa636753-4ca4-4f0d-9aed-6a9b85efbc70&quot;,&quot;e34a77fc-8fee-4e42-862b-4674eb138f87&quot;,&quot;75c8adc9-41c0-40b1-b3e5-bfb446549939&quot;,&quot;92f7303a-5fab-441e-b20d-edffc0ba7344&quot;,&quot;cbdf15f6-dfd8-418e-9c83-9bc188b8fb4a&quot;,&quot;f2c14e11-5e68-4bbc-9d01-1e06aae31c65&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:766,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;71a89306-4017-4e94-b324-99797a281869&quot;,&quot;title&quot;:&quot;stage&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\features\\stage.js&quot;,&quot;file&quot;:&quot;\\test\\features\\stage.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic&quot;,&quot;fullTitle&quot;:&quot;stage basic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const passwordSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.password(&#x27;password&#x27;)\n)\nconst setup = await mfkdf.setup.key([passwordSetup])\nconst passwordDerive = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.password(&#x27;password&#x27;),\n  setup.policy.factors[0].params\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: passwordDerive\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;06d015c7-1cd9-4177-96af-e2250bdf068c&quot;,&quot;parentUUID&quot;:&quot;71a89306-4017-4e94-b324-99797a281869&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;stage full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:714,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  {\n    hash: &#x27;SHA-256&#x27;,\n    modulusLength: 2048,\n    name: &#x27;RSA-OAEP&#x27;,\n    publicExponent: new Uint8Array([1, 0, 1])\n  },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst init = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst passwordSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.password(&#x27;password&#x27;),\n  init.key\n)\nconst hmacsha1Setup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.hmacsha1(),\n  init.key\n)\nconst hotpSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;) }),\n  init.key\n)\nconst oobaSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.ooba({ key: keyPair.publicKey, params: {} }),\n  init.key\n)\nconst questionSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.question(&#x27;fido&#x27;),\n  init.key\n)\nconst totpSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  }),\n  init.key\n)\nconst uuidSetup = await mfkdf.stage.factor.setup(\n  mfkdf.setup.factors.uuid({\n    uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;\n  }),\n  init.key\n)\nconst setup = await mfkdf.setup.key([\n  passwordSetup,\n  hmacsha1Setup,\n  hotpSetup,\n  oobaSetup,\n  questionSetup,\n  totpSetup,\n  uuidSetup\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(\n  setup.policy.factors[1].params.challenge,\n  &#x27;hex&#x27;\n)\nconst response = crypto\n  .createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge)\n  .digest()\nconst next = setup.policy.factors[3].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt(\n  { name: &#x27;RSA-OAEP&#x27; },\n  keyPair.privateKey,\n  Buffer.from(next, &#x27;hex&#x27;)\n)\nconst json = JSON.parse(Buffer.from(decrypted).toString())\nconst code = json.code\nconst password = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.password(&#x27;password&#x27;),\n  setup.policy.factors[0].params,\n  setup.key\n)\nconst hmacsha1 = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.hmacsha1(response),\n  setup.policy.factors[1].params,\n  setup.key\n)\nconst hotp = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.hotp(241063),\n  setup.policy.factors[2].params,\n  setup.key\n)\nconst ooba = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.ooba(code),\n  setup.policy.factors[3].params,\n  setup.key\n)\nconst question = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.question(&#x27;fido&#x27;),\n  setup.policy.factors[4].params,\n  setup.key\n)\nconst totp = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.totp(953265, { time: 1 }),\n  setup.policy.factors[5].params,\n  setup.key\n)\nconst uuid = await mfkdf.stage.factor.derive(\n  mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  setup.policy.factors[6].params,\n  setup.key\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password,\n  hmacsha1,\n  hotp,\n  ooba,\n  question,\n  totp,\n  uuid\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b63db2d-7079-45a9-ad7a-3974fba5d336&quot;,&quot;parentUUID&quot;:&quot;71a89306-4017-4e94-b324-99797a281869&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;06d015c7-1cd9-4177-96af-e2250bdf068c&quot;,&quot;5b63db2d-7079-45a9-ad7a-3974fba5d336&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:765,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7106d2b0-8f44-46c7-b44e-85f7c31ca692&quot;,&quot;title&quot;:&quot;mfkdf2/changes&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;99de324e-2486-4d51-bec4-77c4435dc432&quot;,&quot;title&quot;:&quot;key-size-256&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes key-size-256 default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2ccfdf9c-38c1-4ad8-8427-990e5feb50b0&quot;,&quot;parentUUID&quot;:&quot;99de324e-2486-4d51-bec4-77c4435dc432&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes key-size-256 override&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:61,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52bca136-4515-4203-8ee5-5a516bf0f480&quot;,&quot;parentUUID&quot;:&quot;99de324e-2486-4d51-bec4-77c4435dc432&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2ccfdf9c-38c1-4ad8-8427-990e5feb50b0&quot;,&quot;52bca136-4515-4203-8ee5-5a516bf0f480&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:140,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;90d4b4e8-fc3b-4be6-9e2f-faed6c6d6381&quot;,&quot;title&quot;:&quot;kdf-argon2id&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { kdf: &#x27;hkdf&#x27; }\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsetup.key.length.should.equal(32)\nderive.key.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;856405b8-eef0-45c6-9b2a-60355e556280&quot;,&quot;parentUUID&quot;:&quot;90d4b4e8-fc3b-4be6-9e2f-faed6c6d6381&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/mismatch/time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/mismatch/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:186,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 3 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nsetup.policy.time = 4\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ddb28eb-b02e-413c-91af-fabb7478c31c&quot;,&quot;parentUUID&quot;:&quot;90d4b4e8-fc3b-4be6-9e2f-faed6c6d6381&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/mismatch/memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/mismatch/memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 1024 }\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nsetup.policy.memory = 2048\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;755aeb7e-bd64-46eb-9754-74853673a443&quot;,&quot;parentUUID&quot;:&quot;90d4b4e8-fc3b-4be6-9e2f-faed6c6d6381&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;override/matching&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes kdf-argon2id override/matching&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:684,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 65536, time: 3 }\n)\nsetup.policy.memory.should.equal(65536)\nsetup.policy.time.should.equal(3)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3f8ccb81-b9d7-42ed-859e-53459d87cb07&quot;,&quot;parentUUID&quot;:&quot;90d4b4e8-fc3b-4be6-9e2f-faed6c6d6381&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;856405b8-eef0-45c6-9b2a-60355e556280&quot;,&quot;8ddb28eb-b02e-413c-91af-fabb7478c31c&quot;,&quot;755aeb7e-bd64-46eb-9754-74853673a443&quot;,&quot;3f8ccb81-b9d7-42ed-859e-53459d87cb07&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1059,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;cad7c9b5-27c6-46ca-b766-56d427133854&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\changes.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\changes.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;aes-256-ecb&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/changes encryption aes-256-ecb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const stretched = await crypto.randomBytes(32)\nconst share = await crypto.randomBytes(32)\nconst cipher = crypto.createCipheriv(&#x27;AES-256-ECB&#x27;, stretched, null)\ncipher.setAutoPadding(false)\nconst pad = Buffer.concat([cipher.update(share), cipher.final()])\nconst decipher = crypto.createDecipheriv(&#x27;AES-256-ECB&#x27;, stretched, null)\ndecipher.setAutoPadding(false)\nconst share2 = Buffer.concat([decipher.update(pad), decipher.final()])\nshare2.toString(&#x27;hex&#x27;).should.equal(share.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8247fe1-0718-429f-91d6-35fa7bd15e94&quot;,&quot;parentUUID&quot;:&quot;cad7c9b5-27c6-46ca-b766-56d427133854&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f8247fe1-0718-429f-91d6-35fa7bd15e94&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d621567a-2868-482c-ba3f-f8c86f938738&quot;,&quot;title&quot;:&quot;mfkdf2/hints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\hints.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\hints.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getHint&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints getHint&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:98,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst hint = setup.getHint(&#x27;password1&#x27;, 7)\nhint.should.be.a(&#x27;string&#x27;)\nhint.length.should.equal(7)\nconst hinta = setup.getHint(&#x27;password1&#x27;, 24)\nhinta.should.be.a(&#x27;string&#x27;)\nhinta.length.should.equal(24)\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst hint2 = derived.getHint(&#x27;password1&#x27;, 7)\nhint2.should.equal(hint)\nconst hinta2 = derived.getHint(&#x27;password1&#x27;, 24)\nhinta2.should.equal(hinta)\nconst derived2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;wrongpassword&#x27;)\n  },\n  false\n)\nconst hinta3 = derived2.getHint(&#x27;password1&#x27;, 24)\nhinta3.should.not.equal(hinta)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b734c173-074f-4337-9236-3a0ab6772e77&quot;,&quot;parentUUID&quot;:&quot;d621567a-2868-482c-ba3f-f8c86f938738&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addHint&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints addHint&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:58,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  {\n    integrity: false\n  }\n)\nsetup.addHint(&#x27;password1&#x27;)\nsetup.policy.factors[0].hint.should.be.a(&#x27;string&#x27;)\nsetup.policy.factors[0].hint.length.should.equal(7)\nsetup.addHint(&#x27;password1&#x27;, 24)\nsetup.policy.factors[0].hint.should.be.a(&#x27;string&#x27;)\nsetup.policy.factors[0].hint.length.should.equal(24)\nawait mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    false\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79aafe3c-8b9c-42fa-906e-9d2e4b5b5159&quot;,&quot;parentUUID&quot;:&quot;d621567a-2868-482c-ba3f-f8c86f938738&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;coverage&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/hints coverage&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:32,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  {\n    integrity: false\n  }\n);\n(() =&gt; setup.getHint()).should.throw(TypeError);\n(() =&gt; setup.getHint(123)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;unknown&#x27;)).should.throw(RangeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, &#x27;string&#x27;)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, 0)).should.throw(TypeError);\n(() =&gt; setup.getHint(&#x27;password1&#x27;, 300)).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b3176d3-dc1b-4e4c-a700-0d4564422967&quot;,&quot;parentUUID&quot;:&quot;d621567a-2868-482c-ba3f-f8c86f938738&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b734c173-074f-4337-9236-3a0ab6772e77&quot;,&quot;79aafe3c-8b9c-42fa-906e-9d2e4b5b5159&quot;,&quot;5b3176d3-dc1b-4e4c-a700-0d4564422967&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:188,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fdf8770b-c6c9-4d69-b8b7-1fe893e71886&quot;,&quot;title&quot;:&quot;mfkdf2/mfdpg2&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5729e302-8c1c-4060-8d81-858782b3866f&quot;,&quot;title&quot;:&quot;basics&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;portability&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 basics portability&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:68,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password = setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.length.should.be.above(5)\npassword.length.should.be.below(11);\n/[a-zA-Z]{6,10}/.test(password).should.be.true\nconst password2 = setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.should.equal(password2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst password3 = derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.should.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;45009913-876b-4472-b571-3b82ab829712&quot;,&quot;parentUUID&quot;:&quot;5729e302-8c1c-4060-8d81-858782b3866f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-example&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 basics full-example&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst policy = /([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*/\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  policy\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password3 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  policy\n)\npassword1.should.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25b102ce-6133-439e-a1c6-6d067e115f93&quot;,&quot;parentUUID&quot;:&quot;5729e302-8c1c-4060-8d81-858782b3866f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;45009913-876b-4472-b571-3b82ab829712&quot;,&quot;25b102ce-6133-439e-a1c6-6d067e115f93&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:125,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;dcaee1fc-f52d-4ad0-8f5b-81a7e2908c7a&quot;,&quot;title&quot;:&quot;correctness&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 correctness basic-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst password2 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a162dcf-b33f-487b-9fc3-7a0bb94bcc78&quot;,&quot;parentUUID&quot;:&quot;dcaee1fc-f52d-4ad0-8f5b-81a7e2908c7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 correctness full-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password2 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e398dbc-eaab-4816-b2da-a490326c8864&quot;,&quot;parentUUID&quot;:&quot;dcaee1fc-f52d-4ad0-8f5b-81a7e2908c7a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7a162dcf-b33f-487b-9fc3-7a0bb94bcc78&quot;,&quot;8e398dbc-eaab-4816-b2da-a490326c8864&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:70,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4143624e-6935-43c6-b5e4-1f70cc41b16b&quot;,&quot;title&quot;:&quot;safety&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 safety basic-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:42,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst setup2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup1.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst password2 = await setup2.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.not.equal(password2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;077f9013-e74e-48de-8cb9-506fcf83aebb&quot;,&quot;parentUUID&quot;:&quot;4143624e-6935-43c6-b5e4-1f70cc41b16b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full-test&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 safety full-test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:90,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password1 = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nconst password2 = await derive.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.equal(password2)\nconst derive2 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nconst password3 = await derive2.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword1.should.not.equal(password3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b4c1e16-7804-45be-bea5-530b67a76850&quot;,&quot;parentUUID&quot;:&quot;4143624e-6935-43c6-b5e4-1f70cc41b16b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;077f9013-e74e-48de-8cb9-506fcf83aebb&quot;,&quot;3b4c1e16-7804-45be-bea5-530b67a76850&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:132,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0063169d-86e9-4c18-85e7-527770edc207&quot;,&quot;title&quot;:&quot;compatibility&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\mfdpg.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\mfdpg.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic-policy&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 compatibility basic-policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst password = await setup.derivePassword(\n  &#x27;example.com&#x27;,\n  &#x27;salt&#x27;,\n  /[a-zA-Z]{6,10}/\n)\npassword.length.should.be.above(5)\npassword.length.should.be.below(11)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;56b1249a-cf96-48fb-8374-d96c10d8e9a6&quot;,&quot;parentUUID&quot;:&quot;0063169d-86e9-4c18-85e7-527770edc207&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;custom-policy&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/mfdpg2 compatibility custom-policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst regex = /([A-Za-z]+[0-9]|[0-9]+[A-Za-z])[A-Za-z0-9]*/\nconst password = await setup.derivePassword(&#x27;example.com&#x27;, &#x27;salt&#x27;, regex)\nregex.test(password).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62131ff1-33a0-4786-b427-7dee0c9a317e&quot;,&quot;parentUUID&quot;:&quot;0063169d-86e9-4c18-85e7-527770edc207&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;56b1249a-cf96-48fb-8374-d96c10d8e9a6&quot;,&quot;62131ff1-33a0-4786-b427-7dee0c9a317e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:44,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d01aa463-dfe1-429b-b4a3-9395f8611fe4&quot;,&quot;title&quot;:&quot;mfkdf2/passkeys&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\passkeys.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\passkeys.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;liveness&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys liveness&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:49,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const prf = await crypto.randomBytes(32)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.passkey(prf)\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  passkey: mfkdf.derive.factors.passkey(prf)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a923ddbb-4614-4c7a-b00e-8484e12c3272&quot;,&quot;parentUUID&quot;:&quot;d01aa463-dfe1-429b-b4a3-9395f8611fe4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;safety&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys safety&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const prf = await crypto.randomBytes(32)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.passkey(prf)\n])\nconst prf2 = await crypto.randomBytes(32)\nconst derive = await mfkdf.derive.key(\n  setup.policy,\n  {\n    passkey: mfkdf.derive.factors.passkey(prf2)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d446472-9a96-4847-a507-e7f2d8793ba9&quot;,&quot;parentUUID&quot;:&quot;d01aa463-dfe1-429b-b4a3-9395f8611fe4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;coverage&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/passkeys coverage&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .passkey(&#x27;hello&#x27;)\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .passkey(crypto.randomBytes(32), { id: 123 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .passkey(crypto.randomBytes(32), { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .passkey(Buffer.from(&#x27;hello&#x27;))\n  .should.be.rejectedWith(RangeError);\n(() =&gt; {\n  mfkdf.derive.factors.passkey(&#x27;hello&#x27;)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.passkey(Buffer.from(&#x27;hello&#x27;))\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d94cfe59-756d-4335-bfdb-58beefa0475a&quot;,&quot;parentUUID&quot;:&quot;d01aa463-dfe1-429b-b4a3-9395f8611fe4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a923ddbb-4614-4c7a-b00e-8484e12c3272&quot;,&quot;6d446472-9a96-4847-a507-e7f2d8793ba9&quot;,&quot;d94cfe59-756d-4335-bfdb-58beefa0475a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:94,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9896d9d4-b0ae-43b7-a931-47b0784b2c40&quot;,&quot;title&quot;:&quot;mfkdf2/security&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:467,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst recover = xor(\n  Buffer.from(setup.policy.factors[0].params.pad, &#x27;base64&#x27;),\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n).toString(&#x27;hex&#x27;)\nconst key = setup.key.toString(&#x27;hex&#x27;).slice(0, recover.length)\nrecover.should.not.equal(key)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;480bc404-2021-463b-914b-6305e71c8f51&quot;,&quot;parentUUID&quot;:&quot;9896d9d4-b0ae-43b7-a931-47b0784b2c40&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;65354d55-1159-469e-a5b7-c5a76ad2ee8f&quot;,&quot;title&quot;:&quot;factor-fungibility&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-fungibility correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:73,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;18264388-2bff-4813-bc14-1a98ac73e6ae&quot;,&quot;parentUUID&quot;:&quot;65354d55-1159-469e-a5b7-c5a76ad2ee8f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-fungibility incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:65,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  )\n)\nconst derive = await mfkdf.policy.derive(\n  setup.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  },\n  false\n)\nderive.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9200eaa2-3b82-4bb3-b07d-dad779827192&quot;,&quot;parentUUID&quot;:&quot;65354d55-1159-469e-a5b7-c5a76ad2ee8f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;18264388-2bff-4813-bc14-1a98ac73e6ae&quot;,&quot;9200eaa2-3b82-4bb3-b07d-dad779827192&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:138,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5a59fa98-552e-44f6-826a-c08050f6aae3&quot;,&quot;title&quot;:&quot;share-indistinguishability&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;share-size&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security share-indistinguishability share-size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const secret = crypto.randomBytes(32)\nconst shares1 = mfkdf.secrets.share(secret, 1, 3)\nshares1.should.have.length(3)\nfor (const share of shares1) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares1.slice(0, 1).concat([null, null]), 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nmfkdf.secrets\n  .combine([null, null].concat(shares1.slice(2, 3)), 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nconst shares2 = mfkdf.secrets.share(secret, 2, 3)\nshares2.should.have.length(3)\nfor (const share of shares2) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares2.slice(0, 2).concat([null]), 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nmfkdf.secrets\n  .combine([null].concat(shares2.slice(1, 3)), 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nconst shares3 = mfkdf.secrets.share(secret, 3, 3)\nshares3.should.have.length(3)\nfor (const share of shares3) {\n  share.should.have.length(32)\n}\nmfkdf.secrets\n  .combine(shares3.slice(0, 3), 3, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e3eca62-c4dd-4721-afd9-dbbb0a0760f0&quot;,&quot;parentUUID&quot;:&quot;5a59fa98-552e-44f6-826a-c08050f6aae3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9e3eca62-c4dd-4721-afd9-dbbb0a0760f0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9a67207f-f808-4f1d-b9c5-619e5f8806b7&quot;,&quot;title&quot;:&quot;share-encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security share-encryption correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:152,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst materialp1 = await mfkdf.derive.factors.password(&#x27;password1&#x27;)(\n  setup.policy.factors[0].params\n)\nconst padp1 = Buffer.from(setup.policy.factors[0].pad, &#x27;base64&#x27;)\nconst stretchedp1 = Buffer.from(\n  hkdfSync(\n    &#x27;sha256&#x27;,\n    materialp1.data,\n    setup.policy.factors[0].salt,\n    &#x27;&#x27;,\n    32\n  )\n)\nconst sharep1 = xor(padp1, stretchedp1)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword1&#x27;, { id: &#x27;password1&#x27; })\n)\nconst derive2f = await mfkdf.policy.derive(\n  derive.policy,\n  {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  },\n  false\n)\nderive2f.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;newPassword1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst materialp3 = await mfkdf.derive.factors.password(&#x27;newPassword1&#x27;)(\n  derive.policy.factors[0].params\n)\nconst padp3 = Buffer.from(derive.policy.factors[0].pad, &#x27;base64&#x27;)\nconst stretchedp3 = Buffer.from(\n  hkdfSync(\n    &#x27;sha256&#x27;,\n    materialp3.data,\n    derive.policy.factors[0].salt,\n    &#x27;&#x27;,\n    32\n  )\n)\nconst sharep3 = xor(padp3, stretchedp3)\nawait derive2.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password1&#x27; })\n)\nconst derive3 = await mfkdf.policy.derive(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nsharep1.should.not.equal(sharep3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4634cfb8-b435-489e-81d0-50ae61b1ae1b&quot;,&quot;parentUUID&quot;:&quot;9a67207f-f808-4f1d-b9c5-619e5f8806b7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4634cfb8-b435-489e-81d0-50ae61b1ae1b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:152,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6e935f78-75c7-4e92-b140-f7c4c7908f9c&quot;,&quot;title&quot;:&quot;factor-secret-encryption&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security factor-secret-encryption hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:70,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n  })\n])\nconst recover = xor(\n  Buffer.from(setup.policy.factors[0].params.pad, &#x27;base64&#x27;),\n  Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;)\n).toString(&#x27;hex&#x27;)\nconst key = setup.key.toString(&#x27;hex&#x27;).slice(0, recover.length)\nrecover.should.not.equal(key)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(241063)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9bc29f58-9dc4-4554-a0f4-5ffd6f7bcd8c&quot;,&quot;parentUUID&quot;:&quot;6e935f78-75c7-4e92-b140-f7c4c7908f9c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9bc29f58-9dc4-4554-a0f4-5ffd6f7bcd8c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:70,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d723704a-2b09-494d-bcc9-21821b349b77&quot;,&quot;title&quot;:&quot;timing-oracle&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;77e3bcef-0591-466c-8fa0-c22072b40d27&quot;,&quot;title&quot;:&quot;totp/dynamic&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;no-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic no-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:510,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([await mfkdf.setup.factors.totp()])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;750c1ef6-f8c9-43d3-81c1-5bbf74556056&quot;,&quot;parentUUID&quot;:&quot;77e3bcef-0591-466c-8fa0-c22072b40d27&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic valid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:624,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90b75d0c-2a4e-49e1-af25-f7c603244d6a&quot;,&quot;parentUUID&quot;:&quot;77e3bcef-0591-466c-8fa0-c22072b40d27&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic invalid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:579,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst oracle2 = {}\ndate = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive2.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2fcfe544-1234-45dd-b15f-fd3e995c508d&quot;,&quot;parentUUID&quot;:&quot;77e3bcef-0591-466c-8fa0-c22072b40d27&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic valid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:548,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code, { oracle })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa7775e0-ac15-4ad3-bdb9-bb2f8c19a752&quot;,&quot;parentUUID&quot;:&quot;77e3bcef-0591-466c-8fa0-c22072b40d27&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/dynamic invalid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:579,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ oracle })\n])\nconst code = parseInt(\n  speakeasy.totp({\n    secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n    encoding: &#x27;hex&#x27;,\n    step: setup.outputs.totp.period,\n    algorithm: setup.outputs.totp.algorithm,\n    digits: setup.outputs.totp.digits\n  })\n)\nconst oracle2 = {}\ndate = Date.now()\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive2.policy,\n  {\n    totp: mfkdf.derive.factors.totp(code, { oracle2 })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77cb95bc-5d2c-4d7a-98a5-4effeb79a231&quot;,&quot;parentUUID&quot;:&quot;77e3bcef-0591-466c-8fa0-c22072b40d27&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;750c1ef6-f8c9-43d3-81c1-5bbf74556056&quot;,&quot;90b75d0c-2a4e-49e1-af25-f7c603244d6a&quot;,&quot;2fcfe544-1234-45dd-b15f-fd3e995c508d&quot;,&quot;fa7775e0-ac15-4ad3-bdb9-bb2f8c19a752&quot;,&quot;77cb95bc-5d2c-4d7a-98a5-4effeb79a231&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2840,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3f24f94c-fd59-4682-9d6a-f304147ddcae&quot;,&quot;title&quot;:&quot;totp/static&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;no-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static no-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:473,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, { time: 1 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, { time: 30001 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, { time: 60001 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75c54cb7-9c57-41b4-a97e-43563f6b7de0&quot;,&quot;parentUUID&quot;:&quot;3f24f94c-fd59-4682-9d6a-f304147ddcae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static valid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:488,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, {\n    time: 1,\n    oracle\n  })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, {\n    time: 30001,\n    oracle\n  })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, {\n    time: 60001,\n    oracle\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6c27d3f-bddc-4331-a5d2-399d64010f23&quot;,&quot;parentUUID&quot;:&quot;3f24f94c-fd59-4682-9d6a-f304147ddcae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-fixed-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static invalid-fixed-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:570,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 123456\n  date += 30 * 1000 // 30 seconds\n}\nconst oracle2 = {}\ndate = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(528258, {\n      time: 1650430943604,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(99922, {\n      time: 1650430991083,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(398884, {\n      time: 1650431018392,\n      oracle: oracle2\n    })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f22beefb-f06b-4c4c-9e03-629a45caf002&quot;,&quot;parentUUID&quot;:&quot;3f24f94c-fd59-4682-9d6a-f304147ddcae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static valid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:487,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(953265, {\n    time: 1,\n    oracle\n  })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(241063, {\n    time: 30001,\n    oracle\n  })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(361687, {\n    time: 60001,\n    oracle\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee689533-2b50-4d95-9924-c2055b9eac4a&quot;,&quot;parentUUID&quot;:&quot;3f24f94c-fd59-4682-9d6a-f304147ddcae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid-dynamic-oracle&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security timing-oracle totp/static invalid-dynamic-oracle&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:567,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const oracle = {}\nlet date = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle[date] = 100000 + i // unique code for each time\n  date += 30 * 1000 // 30 seconds\n}\nconst oracle2 = {}\ndate = 1650430806597\ndate -= date % (30 * 1000) // round to the nearest 30 seconds\nfor (let i = 0; i &lt; 87600; i++) {\n  oracle2[date] = 654321\n  date += 30 * 1000 // 30 seconds\n}\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;abcdefghijklmnopqrst&#x27;),\n    time: 1650430806597,\n    oracle\n  })\n])\nconst derive1 = await mfkdf.derive.key(\n  setup.policy,\n  {\n    totp: mfkdf.derive.factors.totp(528258, {\n      time: 1650430943604,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive2 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(99922, {\n      time: 1650430991083,\n      oracle: oracle2\n    })\n  },\n  false\n)\nconst derive3 = await mfkdf.derive.key(\n  derive1.policy,\n  {\n    totp: mfkdf.derive.factors.totp(398884, {\n      time: 1650431018392,\n      oracle: oracle2\n    })\n  },\n  false\n)\nderive1.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.not.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d495a86-b7ce-458a-a0a8-bbf94e38454d&quot;,&quot;parentUUID&quot;:&quot;3f24f94c-fd59-4682-9d6a-f304147ddcae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;75c54cb7-9c57-41b4-a97e-43563f6b7de0&quot;,&quot;b6c27d3f-bddc-4331-a5d2-399d64010f23&quot;,&quot;f22beefb-f06b-4c4c-9e03-629a45caf002&quot;,&quot;ee689533-2b50-4d95-9924-c2055b9eac4a&quot;,&quot;5d495a86-b7ce-458a-a0a8-bbf94e38454d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2585,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3e9765be-9414-4f10-a531-09561807eab6&quot;,&quot;title&quot;:&quot;policy-integrity&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\security.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\security.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security policy-integrity correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:58,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e379ee4e-24f8-4562-86fe-ce16eee7e726&quot;,&quot;parentUUID&quot;:&quot;3e9765be-9414-4f10-a531-09561807eab6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/$id&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/security policy-integrity invalid/$id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:31,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nsetup.policy.$id = &#x27;invalid-id&#x27;\nawait mfkdf.derive\n  .key(\n    setup.policy,\n    {\n      password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n      password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n    },\n    {},\n    true\n  )\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ff39060-4174-424f-a5a2-911202430d3a&quot;,&quot;parentUUID&quot;:&quot;3e9765be-9414-4f10-a531-09561807eab6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e379ee4e-24f8-4562-86fe-ce16eee7e726&quot;,&quot;8ff39060-4174-424f-a5a2-911202430d3a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:89,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;480bc404-2021-463b-914b-6305e71c8f51&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:467,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;439b579e-dda4-4087-8215-745a0e66ff7b&quot;,&quot;title&quot;:&quot;mfkdf2/strengthening&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;strengthening-throws&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-throws&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:48,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nawait derive\n  .strenthen(-1, 0)\n  .should.be.rejectedWith(TypeError, &#x27;time must be a non-negative integer&#x27;)\nawait derive\n  .strenthen(1.5, 0)\n  .should.be.rejectedWith(TypeError, &#x27;time must be a non-negative integer&#x27;)\nawait derive\n  .strenthen(0, -1)\n  .should.be.rejectedWith(\n    TypeError,\n    &#x27;memory must be a non-negative integer&#x27;\n  )\nawait derive\n  .strenthen(0, 1.5)\n  .should.be.rejectedWith(\n    TypeError,\n    &#x27;memory must be a non-negative integer&#x27;\n  )&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f717d2bf-2f1e-4d6b-b110-4fa5d8a0933a&quot;,&quot;parentUUID&quot;:&quot;439b579e-dda4-4087-8215-745a0e66ff7b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-works-multiple-times&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-works-multiple-times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:388,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive.policy.time = 0\nderive.policy.memory = 0\nawait mfkdf.derive\n  .key(derive.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(Error)\nawait derive2.strenthen(3, 16384)\nderive2.policy.time.should.equal(3)\nderive2.policy.memory.should.equal(16384)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive3.policy.time.should.equal(3)\nderive3.policy.memory.should.equal(16384)\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.policy.time = 0\nderive2.policy.memory = 0\nawait mfkdf.derive\n  .key(derive2.policy, {\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n  })\n  .should.be.rejectedWith(Error)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;130d63c4-74f1-4aa8-bb0e-5e1baa502e8b&quot;,&quot;parentUUID&quot;:&quot;439b579e-dda4-4087-8215-745a0e66ff7b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-with-other-factors&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-with-other-factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:207,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n    id: &#x27;password2&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive2.strenthen()\nderive2.policy.time.should.equal(0)\nderive2.policy.memory.should.equal(0)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive3.policy.time.should.equal(0)\nderive3.policy.memory.should.equal(0)\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df2ae1fb-e12e-482c-ad78-9f571a323199&quot;,&quot;parentUUID&quot;:&quot;439b579e-dda4-4087-8215-745a0e66ff7b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;strengthening-with-reconstitution&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening-with-reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:162,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, {\n    id: &#x27;password2&#x27;\n  })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(2, 8192)\nderive.policy.time.should.equal(2)\nderive.policy.memory.should.equal(8192)\nawait derive.setThreshold(1)\nawait derive.removeFactor(&#x27;password2&#x27;)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f91d228f-1a70-4af5-a1e8-4d26456a9594&quot;,&quot;parentUUID&quot;:&quot;439b579e-dda4-4087-8215-745a0e66ff7b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;937e50f8-b27d-4c9d-8222-43473dfd17f2&quot;,&quot;title&quot;:&quot;setup&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:127,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 5 }\n)\nsetup.policy.time.should.equal(5)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(5)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa78a2a9-6594-4273-914f-3f02e324ea26&quot;,&quot;parentUUID&quot;:&quot;937e50f8-b27d-4c9d-8222-43473dfd17f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:125,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { memory: 32768 }\n)\nsetup.policy.memory.should.equal(32768)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.memory.should.equal(32768)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cbb74038-51af-4ecd-a8e9-e3c7ac7f0cf0&quot;,&quot;parentUUID&quot;:&quot;937e50f8-b27d-4c9d-8222-43473dfd17f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time-and-memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup time-and-memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:184,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n      id: &#x27;password1&#x27;\n    })\n  ],\n  { time: 3, memory: 16384 }\n)\nsetup.policy.time.should.equal(3)\nsetup.policy.memory.should.equal(16384)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(3)\nderive.policy.memory.should.equal(16384)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7a41570-103a-4560-a4c3-55ee7602648f&quot;,&quot;parentUUID&quot;:&quot;937e50f8-b27d-4c9d-8222-43473dfd17f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;throws&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening setup throws&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { time: -1 }\n  )\n  .should.be.rejectedWith(RangeError, &#x27;time must be non-negative&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { time: 1.5 }\n  )\n  .should.be.rejectedWith(TypeError, &#x27;time must be an integer&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { memory: -1 }\n  )\n  .should.be.rejectedWith(RangeError, &#x27;memory must be non-negative&#x27;)\nawait mfkdf.setup\n  .key(\n    [\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n        id: &#x27;password1&#x27;\n      })\n    ],\n    { memory: 1.5 }\n  )\n  .should.be.rejectedWith(TypeError, &#x27;memory must be an integer&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42a687c1-f2eb-4781-897b-e8294974c352&quot;,&quot;parentUUID&quot;:&quot;937e50f8-b27d-4c9d-8222-43473dfd17f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fa78a2a9-6594-4273-914f-3f02e324ea26&quot;,&quot;cbb74038-51af-4ecd-a8e9-e3c7ac7f0cf0&quot;,&quot;b7a41570-103a-4560-a4c3-55ee7602648f&quot;,&quot;42a687c1-f2eb-4781-897b-e8294974c352&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:438,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;42ef39c2-ee4c-4d3d-93d8-7a621ebe13dc&quot;,&quot;title&quot;:&quot;strengthening&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\mfkdf2\\strengthening.js&quot;,&quot;file&quot;:&quot;\\test\\mfkdf2\\strengthening.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;time&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:173,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.time.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(5, 0)\nderive.policy.time.should.equal(5)\nderive.policy.memory.should.equal(0)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(5)\nderive2.policy.memory.should.equal(0)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c5f688bd-90b1-4877-82ea-d2119e8e8bf0&quot;,&quot;parentUUID&quot;:&quot;42ef39c2-ee4c-4d3d-93d8-7a621ebe13dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:175,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.memory.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.memory.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(0, 32768)\nderive.policy.time.should.equal(0)\nderive.policy.memory.should.equal(32768)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(0)\nderive2.policy.memory.should.equal(32768)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6851ba70-4f8c-4e5d-a626-af049c96cfd3&quot;,&quot;parentUUID&quot;:&quot;42ef39c2-ee4c-4d3d-93d8-7a621ebe13dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time-and-memory&quot;,&quot;fullTitle&quot;:&quot;mfkdf2/strengthening strengthening time-and-memory&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:260,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, {\n    id: &#x27;password1&#x27;\n  })\n])\nsetup.policy.time.should.equal(0)\nsetup.policy.memory.should.equal(0)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.policy.time.should.equal(0)\nderive.policy.memory.should.equal(0)\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nawait derive.strenthen(3, 16384)\nderive.policy.time.should.equal(3)\nderive.policy.memory.should.equal(16384)\nconst derive2 = await mfkdf.derive.key(derive.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive2.policy.time.should.equal(3)\nderive2.policy.memory.should.equal(16384)\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32bb148b-353f-416a-aaf5-114509b49db7&quot;,&quot;parentUUID&quot;:&quot;42ef39c2-ee4c-4d3d-93d8-7a621ebe13dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c5f688bd-90b1-4877-82ea-d2119e8e8bf0&quot;,&quot;6851ba70-4f8c-4e5d-a626-af049c96cfd3&quot;,&quot;32bb148b-353f-416a-aaf5-114509b49db7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:608,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;f717d2bf-2f1e-4d6b-b110-4fa5d8a0933a&quot;,&quot;130d63c4-74f1-4aa8-bb0e-5e1baa502e8b&quot;,&quot;df2ae1fb-e12e-482c-ad78-9f571a323199&quot;,&quot;f91d228f-1a70-4af5-a1e8-4d26456a9594&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:805,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;20b90834-0c13-4a86-a009-ef70e8675002&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9eb1f8d4-5e1b-4284-afad-5c97e80a0272&quot;,&quot;parentUUID&quot;:&quot;20b90834-0c13-4a86-a009-ef70e8675002&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2e8e134-de9a-4357-9eef-3a8790ae66f6&quot;,&quot;parentUUID&quot;:&quot;20b90834-0c13-4a86-a009-ef70e8675002&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;178af92d-fadc-4121-9827-78a13a6863b7&quot;,&quot;parentUUID&quot;:&quot;20b90834-0c13-4a86-a009-ef70e8675002&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9eb1f8d4-5e1b-4284-afad-5c97e80a0272&quot;,&quot;a2e8e134-de9a-4357-9eef-3a8790ae66f6&quot;,&quot;178af92d-fadc-4121-9827-78a13a6863b7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a447827-aa71-4715-a046-14ad400ec127&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine(\n  [shares[0], shares[1], shares[2]],\n  1,\n  5\n)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e48107ef-1351-4fa4-b365-4923233b21ea&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine(\n  [shares[0], shares[1], shares[2]],\n  2,\n  3\n)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b64ef809-b8cb-474d-afc4-dc3d74f673f4&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;),\n  5,\n  255\n)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec82224d-70f9-43af-82e7-081927e7c4c0&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(\n  Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;),\n  5,\n  255\n)\nshares.should.be.an(&#x27;array&#x27;).of.length(255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 250; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 255)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[251] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7e253ba-0a9b-4c03-84aa-252a2ed1911b&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4134c494-538c-4c36-ba5c-0ee60b6bc8ff&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0678685b-d71a-490e-a827-c760c1bbe55a&quot;,&quot;parentUUID&quot;:&quot;fc3d5142-f430-4f3e-92e3-ca450d6a15da&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9a447827-aa71-4715-a046-14ad400ec127&quot;,&quot;e48107ef-1351-4fa4-b365-4923233b21ea&quot;,&quot;b64ef809-b8cb-474d-afc4-dc3d74f673f4&quot;,&quot;ec82224d-70f9-43af-82e7-081927e7c4c0&quot;,&quot;a7e253ba-0a9b-4c03-84aa-252a2ed1911b&quot;,&quot;4134c494-538c-4c36-ba5c-0ee60b6bc8ff&quot;,&quot;0678685b-d71a-490e-a827-c760c1bbe55a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b410ab1b-aaae-4e52-b78a-8b87968d13e5&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\new.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\new.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;share-size&quot;,&quot;fullTitle&quot;:&quot;secrets share-size&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let secret = crypto.randomBytes(32)\nlet shares = mfkdf.secrets.share(secret, 1, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[0].should.equal(secret)\nshares[1].length.should.equal(32)\nshares[1].should.equal(secret)\nshares[2].length.should.equal(32)\nshares[2].should.equal(secret)\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[1] = null\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[2] = null\nmfkdf.secrets\n  .combine(shares, 1, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nsecret = crypto.randomBytes(32)\nshares = mfkdf.secrets.share(secret, 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[1].length.should.equal(32)\nshares[2].length.should.equal(32)\nmfkdf.secrets\n  .combine(shares, 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nshares[1] = null\nmfkdf.secrets\n  .combine(shares, 2, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))\nsecret = crypto.randomBytes(32)\nshares = mfkdf.secrets.share(secret, 3, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nshares[0].length.should.equal(32)\nshares[1].length.should.equal(32)\nshares[2].length.should.equal(32)\nmfkdf.secrets\n  .combine(shares, 3, 3)\n  .toString(&#x27;hex&#x27;)\n  .should.equal(secret.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2e837771-5134-4982-b8e9-ee92bd5a3a33&quot;,&quot;parentUUID&quot;:&quot;b410ab1b-aaae-4e52-b78a-8b87968d13e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2e837771-5134-4982-b8e9-ee92bd5a3a33&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ab98a3b-81af-4857-8d17-95ed45989032&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bf914fe8-82e3-4d41-98d0-fc17ebe54dcb&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dba5865f-e653-49e4-b361-5bdff24ce012&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e05f924-daab-42d2-bf8a-e65087eec1e0&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8c34523b-3852-4074-9a2b-8173dc6f83ed&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a38a0692-bab5-49fb-9471-0a6b59f891f2&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63762777-ad2f-42da-aee4-8d05b2674744&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa6e8d5d-f0cd-41a3-9c1c-9cb44dafb647&quot;,&quot;parentUUID&quot;:&quot;42486b9a-c9ce-4a6f-a54b-e78703054d71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6ab98a3b-81af-4857-8d17-95ed45989032&quot;,&quot;bf914fe8-82e3-4d41-98d0-fc17ebe54dcb&quot;,&quot;dba5865f-e653-49e4-b361-5bdff24ce012&quot;,&quot;7e05f924-daab-42d2-bf8a-e65087eec1e0&quot;,&quot;8c34523b-3852-4074-9a2b-8173dc6f83ed&quot;,&quot;a38a0692-bab5-49fb-9471-0a6b59f891f2&quot;,&quot;63762777-ad2f-42da-aee4-8d05b2674744&quot;,&quot;fa6e8d5d-f0cd-41a3-9c1c-9cb44dafb647&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;072a86ca-a1e8-4358-a5f5-f1733f80f40f&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;778d3a0e-7b6a-4a4a-a924-1c2a20eb46ed&quot;,&quot;parentUUID&quot;:&quot;072a86ca-a1e8-4358-a5f5-f1733f80f40f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2a07d03-edc7-49b9-8668-d54799a22927&quot;,&quot;parentUUID&quot;:&quot;072a86ca-a1e8-4358-a5f5-f1733f80f40f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e78b4f0d-8bb8-4425-b6be-1b54c94039f7&quot;,&quot;parentUUID&quot;:&quot;072a86ca-a1e8-4358-a5f5-f1733f80f40f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;778d3a0e-7b6a-4a4a-a924-1c2a20eb46ed&quot;,&quot;d2a07d03-edc7-49b9-8668-d54799a22927&quot;,&quot;e78b4f0d-8bb8-4425-b6be-1b54c94039f7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;85e05e9d-2e07-4da5-9ab9-4c9f390f169b&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .password(&#x27;password&#x27;, { id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2d8bfc1-fb1b-4ff2-a767-4d7ca3caeed3&quot;,&quot;parentUUID&quot;:&quot;85e05e9d-2e07-4da5-9ab9-4c9f390f169b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nawait mfkdf.setup.factors\n  .password(&#x27;password&#x27;, { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;322eaf62-fabc-48b8-80f0-6f40bfb390bc&quot;,&quot;parentUUID&quot;:&quot;85e05e9d-2e07-4da5-9ab9-4c9f390f169b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f4e5b42-85cb-4586-b5ff-c792c450dae5&quot;,&quot;parentUUID&quot;:&quot;85e05e9d-2e07-4da5-9ab9-4c9f390f169b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e2d8bfc1-fb1b-4ff2-a767-4d7ca3caeed3&quot;,&quot;322eaf62-fabc-48b8-80f0-6f40bfb390bc&quot;,&quot;8f4e5b42-85cb-4586-b5ff-c792c450dae5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6176227a-93ff-4144-98e9-2bef56afac5d&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .uuid({ uuid: 12345 })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .uuid({ uuid: &#x27;hello&#x27; })\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup.factors\n  .uuid({ id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a32e5cd8-b24f-45b8-85a5-af4326ae2f7f&quot;,&quot;parentUUID&quot;:&quot;6176227a-93ff-4144-98e9-2bef56afac5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors\n  .uuid({ id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;939b3e50-fe06-4d24-813b-395e6d274824&quot;,&quot;parentUUID&quot;:&quot;6176227a-93ff-4144-98e9-2bef56afac5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({\n  uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;\n})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data\n  .toString(&#x27;hex&#x27;)\n  .should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;453bc496-29f0-455b-8303-65981770f726&quot;,&quot;parentUUID&quot;:&quot;6176227a-93ff-4144-98e9-2bef56afac5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae9be846-e3f2-4c0b-aa54-5fea5de4ac7b&quot;,&quot;parentUUID&quot;:&quot;6176227a-93ff-4144-98e9-2bef56afac5d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a32e5cd8-b24f-45b8-85a5-af4326ae2f7f&quot;,&quot;939b3e50-fe06-4d24-813b-395e6d274824&quot;,&quot;453bc496-29f0-455b-8303-65981770f726&quot;,&quot;ae9be846-e3f2-4c0b-aa54-5fea5de4ac7b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b6692ce9-6e1b-4019-8eb5-b803c5e057fa&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2716d68c-48c4-4f59-9122-da174d667f0f&quot;,&quot;parentUUID&quot;:&quot;b6692ce9-6e1b-4019-8eb5-b803c5e057fa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;60023f97-ac91-48ed-9622-4f3c5b371328&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ff16146-236f-4392-8223-25bde3107b68&quot;,&quot;parentUUID&quot;:&quot;60023f97-ac91-48ed-9622-4f3c5b371328&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [await mfkdf.setup.factors.password(&#x27;hello&#x27;)],\n  { id: &#x27;hello-world&#x27; }\n)\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9b00f065-8f46-4958-a7ca-2ee244310fc4&quot;,&quot;parentUUID&quot;:&quot;60023f97-ac91-48ed-9622-4f3c5b371328&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { id: 12345 })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22fa918a-35ef-4b87-9f68-dab91c499b9b&quot;,&quot;parentUUID&quot;:&quot;60023f97-ac91-48ed-9622-4f3c5b371328&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { id: &#x27;&#x27; })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;83550a5e-297b-489e-88d0-a26c35dce401&quot;,&quot;parentUUID&quot;:&quot;60023f97-ac91-48ed-9622-4f3c5b371328&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7ff16146-236f-4392-8223-25bde3107b68&quot;,&quot;9b00f065-8f46-4958-a7ca-2ee244310fc4&quot;,&quot;22fa918a-35ef-4b87-9f68-dab91c499b9b&quot;,&quot;83550a5e-297b-489e-88d0-a26c35dce401&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:43,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ad1e581d-e15d-4ba6-9031-79d826a4fa3f&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7978af7f-14b1-4980-823e-19de81f35757&quot;,&quot;parentUUID&quot;:&quot;ad1e581d-e15d-4ba6-9031-79d826a4fa3f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n  ],\n  { threshold: 1 }\n)\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c51a144-c4ed-4316-8bf7-68b2b9b7d348&quot;,&quot;parentUUID&quot;:&quot;ad1e581d-e15d-4ba6-9031-79d826a4fa3f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], {\n    threshold: &#x27;hello&#x27;\n  })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5cdc45c2-950b-4eb6-89e8-e3d48614d05f&quot;,&quot;parentUUID&quot;:&quot;ad1e581d-e15d-4ba6-9031-79d826a4fa3f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { threshold: 0 })\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { threshold: 2 })\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b04cd1e4-81dc-4a4e-9ba2-115a5d08920a&quot;,&quot;parentUUID&quot;:&quot;ad1e581d-e15d-4ba6-9031-79d826a4fa3f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7978af7f-14b1-4980-823e-19de81f35757&quot;,&quot;0c51a144-c4ed-4316-8bf7-68b2b9b7d348&quot;,&quot;5cdc45c2-950b-4eb6-89e8-e3d48614d05f&quot;,&quot;b04cd1e4-81dc-4a4e-9ba2-115a5d08920a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:42,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;05f7dfc4-c57c-4313-9ae5-24872c55dd17&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:25,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d97a1a79-1c66-4062-989b-8b8e6ed103ca&quot;,&quot;parentUUID&quot;:&quot;05f7dfc4-c57c-4313-9ae5-24872c55dd17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key(\n  [await mfkdf.setup.factors.password(&#x27;hello&#x27;)],\n  { salt: Buffer.from(&#x27;1234567812345678&#x27;, &#x27;base64&#x27;) }\n)\npolicy.salt.should.equal(&#x27;1234567812345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3e88cafb-b4ce-44d5-97b5-0f1cdd3fbd31&quot;,&quot;parentUUID&quot;:&quot;05f7dfc4-c57c-4313-9ae5-24872c55dd17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([await mfkdf.setup.factors.password(&#x27;hello&#x27;)], { salt: &#x27;hello&#x27; })\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;994e8f29-ab3e-4060-b084-2e184aa6574d&quot;,&quot;parentUUID&quot;:&quot;05f7dfc4-c57c-4313-9ae5-24872c55dd17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d97a1a79-1c66-4062-989b-8b8e6ed103ca&quot;,&quot;3e88cafb-b4ce-44d5-97b5-0f1cdd3fbd31&quot;,&quot;994e8f29-ab3e-4060-b084-2e184aa6574d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:45,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f83ba936-333c-44f2-bf2a-ae748d521d67&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;253ad095-9610-4879-ba63-40b2de929a4d&quot;,&quot;parentUUID&quot;:&quot;f83ba936-333c-44f2-bf2a-ae748d521d67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup\n  .key([\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n  ])\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;357de9db-6ac8-444e-a75e-6e67d9d09059&quot;,&quot;parentUUID&quot;:&quot;f83ba936-333c-44f2-bf2a-ae748d521d67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: 12345,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: 12345,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: 12345,\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(TypeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: 12345\n    }\n  ])\n  .should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e82aea3-b7a2-4322-a4b1-24d96a9d52df&quot;,&quot;parentUUID&quot;:&quot;f83ba936-333c-44f2-bf2a-ae748d521d67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([]).should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;&#x27;,\n      data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)\nawait mfkdf.setup\n  .key([\n    {\n      type: &#x27;password&#x27;,\n      id: &#x27;password&#x27;,\n      data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n      params: async () =&gt; {\n        return {}\n      }\n    }\n  ])\n  .should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50555c7c-1c01-4a62-b55c-ff5af4c2e94f&quot;,&quot;parentUUID&quot;:&quot;f83ba936-333c-44f2-bf2a-ae748d521d67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;253ad095-9610-4879-ba63-40b2de929a4d&quot;,&quot;357de9db-6ac8-444e-a75e-6e67d9d09059&quot;,&quot;4e82aea3-b7a2-4322-a4b1-24d96a9d52df&quot;,&quot;50555c7c-1c01-4a62-b55c-ff5af4c2e94f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:23,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2716d68c-48c4-4f59-9122-da174d667f0f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:23,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mochawesome&quot;,&quot;reportTitle&quot;:&quot;mfkdf&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\site\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\Users\\Vivek\\Projects\\mfkdf\\site\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>