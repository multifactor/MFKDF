<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:80,&quot;tests&quot;:321,&quot;passes&quot;:321,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2022-06-10T20:41:59.623Z&quot;,&quot;end&quot;:&quot;2022-06-10T20:43:12.845Z&quot;,&quot;duration&quot;:73222,&quot;testsRegistered&quot;:321,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;3fc571ed-9df2-4670-8f60-dc2826e5f10d&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e88e60f8-5bcf-4adf-b67c-c2531d17378a&quot;,&quot;title&quot;:&quot;asymmetric&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4aed46cb-4832-4a46-9520-6750751a6e8a&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:342,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa1024&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;88bf4185-16ec-4114-9af8-ea73acf8d3d3&quot;,&quot;parentUUID&quot;:&quot;4aed46cb-4832-4a46-9520-6750751a6e8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:652,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa2048&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a747330c-ac41-4efa-9ccd-74968b5e24b2&quot;,&quot;parentUUID&quot;:&quot;4aed46cb-4832-4a46-9520-6750751a6e8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;88bf4185-16ec-4114-9af8-ea73acf8d3d3&quot;,&quot;a747330c-ac41-4efa-9ccd-74968b5e24b2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:994,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;title&quot;:&quot;signatures&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:581,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a0df590-b3b2-421f-af18-4528d5c79efa&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4665,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa2048&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20ff59a3-c870-4aeb-b168-e10db84b272f&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa3072&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa3072&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9049,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa3072&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa3072&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5fcd8e6a-9ae0-4499-a018-b6244c7f74e2&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6766,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature)\nvalidity.should.be.true\nawait setup.getAsymmetricKeyPair()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e670ab5c-6ccd-4610-bbab-266cc06275f5&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ed25519&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures ed25519&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:121,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nawait setup.getAsymmetricKeyPair(&#x27;ed25519&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;921753c8-fdcd-494a-95a9-ce98f21bc213&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;unknown&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures unknown&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.getAsymmetricKeyPair(&#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2bda811e-ade3-4e77-9c74-6d93bd918d63&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2721,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.sign(12345, &#x27;rsa1024&#x27;).should.be.rejectedWith(TypeError)\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nsetup.verify(12345, signature).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76adbd59-c4e3-44fd-9a47-ea2a787a2fb9&quot;,&quot;parentUUID&quot;:&quot;8dc87fca-0abf-4541-ad0e-8601aaa39572&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1a0df590-b3b2-421f-af18-4528d5c79efa&quot;,&quot;20ff59a3-c870-4aeb-b168-e10db84b272f&quot;,&quot;5fcd8e6a-9ae0-4499-a018-b6244c7f74e2&quot;,&quot;e670ab5c-6ccd-4610-bbab-266cc06275f5&quot;,&quot;921753c8-fdcd-494a-95a9-ce98f21bc213&quot;,&quot;2bda811e-ade3-4e77-9c74-6d93bd918d63&quot;,&quot;76adbd59-c4e3-44fd-9a47-ea2a787a2fb9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:24013,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;encrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:241,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77645a52-d393-4ea0-9192-19ff713c5dbb&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;68bb857c-8b58-4a45-a2ea-5a4573d9f6d8&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cc01b00c-0ff9-436b-8bdf-9b22c3ce0eba&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c42a7ae7-cd8e-481a-a1f6-8f55d414657a&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23bebd54-45b9-4e95-8dea-1f340ed523ad&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f11eef3-ff55-4706-afbb-c667f259af8b&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42722668-b99c-4ef5-99c7-4f2da26a1da4&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b1cc4ec-f3ac-4e9c-9bcc-db432c17ee68&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e8843e92-62e9-4db7-a457-eda60f6a5067&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b97cd21b-18c4-41b3-882f-d31be6456106&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd24b60d-aa8e-41f8-a8ee-4ce0f57b5039&quot;,&quot;parentUUID&quot;:&quot;81faae3f-9f40-4d30-93aa-b9e03c4a1d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ee1876cc-3a95-40b4-a25c-d1459c5313cf&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSubkey(32, &#x27;AES256&#x27;, &#x27;sha256&#x27;)\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey(32, &#x27;&#x27;, &#x27;sha512&#x27;)\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1efa79c4-ab22-4f23-ad6b-f77f7c67c982&quot;,&quot;parentUUID&quot;:&quot;ee1876cc-3a95-40b4-a25c-d1459c5313cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;symmetric key&quot;,&quot;fullTitle&quot;:&quot;encrypt utils symmetric key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSymmetricKey()\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;175b6d81-8c76-45f8-b571-20198fa63b86&quot;,&quot;parentUUID&quot;:&quot;ee1876cc-3a95-40b4-a25c-d1459c5313cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1efa79c4-ab22-4f23-ad6b-f77f7c67c982&quot;,&quot;175b6d81-8c76-45f8-b571-20198fa63b86&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:208,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fdd91b58-71cb-4c5d-8bcc-8896020f58ac&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid key&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(&#x27;hello world&#x27;, &#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;416f2cb5-c9e6-4557-a6fa-81a1f0ab2e86&quot;,&quot;parentUUID&quot;:&quot;fdd91b58-71cb-4c5d-8bcc-8896020f58ac&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid message&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f047c51-2f6b-4f99-9821-ad14e03e14c5&quot;,&quot;parentUUID&quot;:&quot;fdd91b58-71cb-4c5d-8bcc-8896020f58ac&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid ciphertext&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid ciphertext&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.decrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a390f74b-49f9-4f14-adad-7de034a97a84&quot;,&quot;parentUUID&quot;:&quot;fdd91b58-71cb-4c5d-8bcc-8896020f58ac&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;416f2cb5-c9e6-4557-a6fa-81a1f0ab2e86&quot;,&quot;6f047c51-2f6b-4f99-9821-ad14e03e14c5&quot;,&quot;a390f74b-49f9-4f14-adad-7de034a97a84&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:313,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;77645a52-d393-4ea0-9192-19ff713c5dbb&quot;,&quot;68bb857c-8b58-4a45-a2ea-5a4573d9f6d8&quot;,&quot;cc01b00c-0ff9-436b-8bdf-9b22c3ce0eba&quot;,&quot;c42a7ae7-cd8e-481a-a1f6-8f55d414657a&quot;,&quot;23bebd54-45b9-4e95-8dea-1f340ed523ad&quot;,&quot;0f11eef3-ff55-4706-afbb-c667f259af8b&quot;,&quot;42722668-b99c-4ef5-99c7-4f2da26a1da4&quot;,&quot;4b1cc4ec-f3ac-4e9c-9bcc-db432c17ee68&quot;,&quot;e8843e92-62e9-4db7-a457-eda60f6a5067&quot;,&quot;b97cd21b-18c4-41b3-882f-d31be6456106&quot;,&quot;dd24b60d-aa8e-41f8-a8ee-4ce0f57b5039&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2461,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8037a39f-c2c7-4ac0-8a38-d08577fd1b9b&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26f0c322-cabb-4349-a4e7-35cc6cf94954&quot;,&quot;parentUUID&quot;:&quot;8037a39f-c2c7-4ac0-8a38-d08577fd1b9b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b595776-eb49-452a-9882-78b6da26b639&quot;,&quot;parentUUID&quot;:&quot;8037a39f-c2c7-4ac0-8a38-d08577fd1b9b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;26f0c322-cabb-4349-a4e7-35cc6cf94954&quot;,&quot;1b595776-eb49-452a-9882-78b6da26b639&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;aebf510c-0644-4df1-bff8-5d87752ca972&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f445d40f-9cff-4895-a6a9-2974d9583fbd&quot;,&quot;parentUUID&quot;:&quot;aebf510c-0644-4df1-bff8-5d87752ca972&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4106d0a-9256-4bd8-848e-06e034fc1e2a&quot;,&quot;parentUUID&quot;:&quot;aebf510c-0644-4df1-bff8-5d87752ca972&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f445d40f-9cff-4895-a6a9-2974d9583fbd&quot;,&quot;f4106d0a-9256-4bd8-848e-06e034fc1e2a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;35c74f7d-5c6c-4d08-bd8f-483b028d38ae&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:580,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;605a2c45-d049-4385-ab25-893899363b17&quot;,&quot;parentUUID&quot;:&quot;35c74f7d-5c6c-4d08-bd8f-483b028d38ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:575,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f49ca9ff-b7c7-43be-8d0b-593089a50d00&quot;,&quot;parentUUID&quot;:&quot;35c74f7d-5c6c-4d08-bd8f-483b028d38ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nmfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;15f7facd-9b2c-4eac-9b63-b004ffd908e6&quot;,&quot;parentUUID&quot;:&quot;35c74f7d-5c6c-4d08-bd8f-483b028d38ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;52340d6c-9861-4d53-9fc1-17f247c528e8&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:444,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c4278ee-fd3e-4801-aa2f-66179a8c95f1&quot;,&quot;parentUUID&quot;:&quot;52340d6c-9861-4d53-9fc1-17f247c528e8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9c4278ee-fd3e-4801-aa2f-66179a8c95f1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:444,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;631c0c57-95c1-4ca0-81ba-854f70eded46&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a264c94e-79d6-4910-b9cd-a6dea333d6c7&quot;,&quot;parentUUID&quot;:&quot;631c0c57-95c1-4ca0-81ba-854f70eded46&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:118,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a17056b-d480-49bd-8fe7-9de8c7d35665&quot;,&quot;parentUUID&quot;:&quot;631c0c57-95c1-4ca0-81ba-854f70eded46&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a264c94e-79d6-4910-b9cd-a6dea333d6c7&quot;,&quot;8a17056b-d480-49bd-8fe7-9de8c7d35665&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:234,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;605a2c45-d049-4385-ab25-893899363b17&quot;,&quot;f49ca9ff-b7c7-43be-8d0b-593089a50d00&quot;,&quot;15f7facd-9b2c-4eac-9b63-b004ffd908e6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1268,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;cb94333e-0c38-49d6-8935-4a538c58f837&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;kdf&quot;,&quot;fullTitle&quot;:&quot;examples kdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:20,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup kdf configuration\nconst config = await mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000,\n  pbkdf2digest: &#x27;sha256&#x27;\n}) // -&gt; { type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } }\n// derive key\nconst key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 8, config)\nkey.toString(&#x27;hex&#x27;) // -&gt; 0394a2ede332c9a1\nconfig.should.deep.equal({ type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } })\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;0394a2ede332c9a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc8226b1-3189-4f58-bcae-f0f5d326aa98&quot;,&quot;parentUUID&quot;:&quot;cb94333e-0c38-49d6-8935-4a538c58f837&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive fast&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2179c68c-1718-4328-b67d-7aff289d58a7&quot;,&quot;parentUUID&quot;:&quot;cb94333e-0c38-49d6-8935-4a538c58f837&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df29828b-3ae7-4c0f-9cf0-71c61a7f6eb1&quot;,&quot;parentUUID&quot;:&quot;cb94333e-0c38-49d6-8935-4a538c58f837&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff8514ba-493f-4b6d-83a5-d8f8b66f3681&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n], { size: 8 })\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response = crypto.createHmac(&#x27;sha1&#x27;, secret).update(challenge).digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0dffdca-9f38-432f-acf4-06e926f575b6&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1132,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n], { size: 8 })\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d890a77-1038-45da-a6e1-f7af392fb9b6&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) })\n], { size: 8 })\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;935a038d-9a73-40bb-a79d-72cd7a8c8ad6&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 8 })\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5acec085-0535-4ceb-b701-1bb46b71e0d9&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;examples factors question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with security question factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n], { size: 8 })\n// derive key with security question factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9bbaa26f-1936-4187-952a-ab9d5910d84a&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;examples factors ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:250,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup RSA key pair (on out-of-band server)\nconst keyPair = await crypto.webcrypto.subtle.generateKey({ hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) }, true, [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;])\n// setup key with out-of-band authentication factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey, params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\n// decrypt and send code (on out-of-band server)\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\n// derive key with out-of-band factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3110c830-57b1-4640-8539-bec874bdb0d2&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n], { size: 8 })\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73e9c04b-23ce-4121-9a95-d8742edb5304&quot;,&quot;parentUUID&quot;:&quot;0b63dfb4-55ec-4fd7-81e0-526c7204c4e3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ff8514ba-493f-4b6d-83a5-d8f8b66f3681&quot;,&quot;e0dffdca-9f38-432f-acf4-06e926f575b6&quot;,&quot;7d890a77-1038-45da-a6e1-f7af392fb9b6&quot;,&quot;935a038d-9a73-40bb-a79d-72cd7a8c8ad6&quot;,&quot;5acec085-0535-4ceb-b701-1bb46b71e0d9&quot;,&quot;9bbaa26f-1936-4187-952a-ab9d5910d84a&quot;,&quot;3110c830-57b1-4640-8539-bec874bdb0d2&quot;,&quot;73e9c04b-23ce-4121-9a95-d8742edb5304&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2679,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7e641eea-8282-45c6-bcaf-5ea04db9cb85&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(Buffer.from(&#x27;hello world&#x27;), 2, 3) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6c158944-6442-419a-959c-db73899cceee&quot;,&quot;parentUUID&quot;:&quot;7e641eea-8282-45c6-bcaf-5ea04db9cb85&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6c158944-6442-419a-959c-db73899cceee&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bb22c87-815b-4b1b-baa8-c0aa0d568890&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bac6c180-0b69-4504-87fe-1dcfc176d850&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordA&#x27;, &#x27;passwordC&#x27;]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordB&#x27;, &#x27;passwordC&#x27;]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2263d9bd-eba4-48f5-811f-eb543137484a&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:231,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  ), { size: 8 }\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a97464dd-ec6f-4807-8fa9-71f48e4ab5ac&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40720d37-97e6-41aa-84e6-2e1d3c0cc021&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0faf0126-e550-4579-95e3-da03dbab4726&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44a9b39f-f7d9-47b3-aeca-c0e02ef926a9&quot;,&quot;parentUUID&quot;:&quot;01d8f505-767b-487c-b9c5-2ee29ee38bd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5bb22c87-815b-4b1b-baa8-c0aa0d568890&quot;,&quot;bac6c180-0b69-4504-87fe-1dcfc176d850&quot;,&quot;2263d9bd-eba4-48f5-811f-eb543137484a&quot;,&quot;a97464dd-ec6f-4807-8fa9-71f48e4ab5ac&quot;,&quot;40720d37-97e6-41aa-84e6-2e1d3c0cc021&quot;,&quot;0faf0126-e550-4579-95e3-da03dbab4726&quot;,&quot;44a9b39f-f7d9-47b3-aeca-c0e02ef926a9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1228,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;faf10ef3-1e77-4c89-b82a-667586fcef0a&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4796fda2-aea3-423d-8afb-5425e6d37630&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;efb340d8-1539-4637-a9bc-bc14edc5fab4&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a440987-912a-44f6-98ec-7305b19e9c52&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9051b58-f64f-4114-8caa-6af11f4e9915&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c298588-df6d-42a3-a864-a4ab864f479b&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;378e14f8-5c63-4754-ada8-ee7ad5295b21&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:244,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76ed0f48-fced-4854-a340-b54b65c1707d&quot;,&quot;parentUUID&quot;:&quot;d711857f-5f43-455c-9747-1f6d9a151872&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;faf10ef3-1e77-4c89-b82a-667586fcef0a&quot;,&quot;4796fda2-aea3-423d-8afb-5425e6d37630&quot;,&quot;efb340d8-1539-4637-a9bc-bc14edc5fab4&quot;,&quot;5a440987-912a-44f6-98ec-7305b19e9c52&quot;,&quot;d9051b58-f64f-4114-8caa-6af11f4e9915&quot;,&quot;2c298588-df6d-42a3-a864-a4ab864f479b&quot;,&quot;378e14f8-5c63-4754-ada8-ee7ad5295b21&quot;,&quot;76ed0f48-fced-4854-a340-b54b65c1707d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1772,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a83d823d-b4fd-4f3d-be5a-748c22e17685&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:237,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6aa3ed9b-bd81-4890-b5c2-5057e9f584d2&quot;,&quot;parentUUID&quot;:&quot;a83d823d-b4fd-4f3d-be5a-748c22e17685&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6aa3ed9b-bd81-4890-b5c2-5057e9f584d2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:237,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e3c2eb51-99be-4b35-ba97-6a08345e8268&quot;,&quot;title&quot;:&quot;envelope&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;add/get secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:257,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;87d3a4e6-f3ba-4ba2-a65e-13643ea477d4&quot;,&quot;parentUUID&quot;:&quot;e3c2eb51-99be-4b35-ba97-6a08345e8268&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/check/remove secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/check/remove secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// check secret\nconst check1 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; true\n// remove secret\nderived.removeEnvelopedSecret(&#x27;mySecret&#x27;)\n// check secret\nconst check2 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; false\ncheck1.should.be.true\ncheck2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a545e44-ec85-46e5-9538-db12792cc7ee&quot;,&quot;parentUUID&quot;:&quot;e3c2eb51-99be-4b35-ba97-6a08345e8268&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/get key&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;15e78ee4-20de-47b3-83e9-581ac4fcd99f&quot;,&quot;parentUUID&quot;:&quot;e3c2eb51-99be-4b35-ba97-6a08345e8268&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;87d3a4e6-f3ba-4ba2-a65e-13643ea477d4&quot;,&quot;3a545e44-ec85-46e5-9538-db12792cc7ee&quot;,&quot;15e78ee4-20de-47b3-83e9-581ac4fcd99f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:703,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;757732f7-0c61-4f09-bd74-25bf3147f65c&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte sub-key for \&quot;eth\&quot; using hkdf/sha256\nconst subkey = await key.getSubkey(16, &#x27;eth&#x27;, &#x27;sha256&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 54ad9e5acbc1c33b08a15dd79126e9c9&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31079d0b-65c6-47d2-8b7e-642d2ad013ee&quot;,&quot;parentUUID&quot;:&quot;757732f7-0c61-4f09-bd74-25bf3147f65c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getSymmetricKey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSymmetricKey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte AES128 sub-key\nconst subkey = await key.getSymmetricKey(&#x27;aes128&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; c985454e008e5ecc695e865d339cb2be&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2b8623f-2faa-406b-a408-ec4c47df1d46&quot;,&quot;parentUUID&quot;:&quot;757732f7-0c61-4f09-bd74-25bf3147f65c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getAsymmetricKeyPair&quot;,&quot;fullTitle&quot;:&quot;examples crypto getAsymmetricKeyPair&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:200,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte RSA1024 sub-key\nconst subkey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;) // -&gt; { privateKey: Uint8Array, publicKey: Uint8Array }\nsubkey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0791b8a9-a76a-4a4b-82b6-4f3f4bd21237&quot;,&quot;parentUUID&quot;:&quot;757732f7-0c61-4f09-bd74-25bf3147f65c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;sign/verify&quot;,&quot;fullTitle&quot;:&quot;examples crypto sign/verify&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:447,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// sign message using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature using RSA-1024\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;268f298f-fc14-4c23-bdbe-e8faefafe1bc&quot;,&quot;parentUUID&quot;:&quot;757732f7-0c61-4f09-bd74-25bf3147f65c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypt/decrypt&quot;,&quot;fullTitle&quot;:&quot;examples crypto encrypt/decrypt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// encrypt message using 3DES\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\n// decrypt message using 3DES\nconst decrypted = await key.decrypt(encrypted, &#x27;3des&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;18b3f0a9-f5e8-45e8-8e84-e57ed76bbf09&quot;,&quot;parentUUID&quot;:&quot;757732f7-0c61-4f09-bd74-25bf3147f65c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;31079d0b-65c6-47d2-8b7e-642d2ad013ee&quot;,&quot;e2b8623f-2faa-406b-a408-ec4c47df1d46&quot;,&quot;0791b8a9-a76a-4a4b-82b6-4f3f4bd21237&quot;,&quot;268f298f-fc14-4c23-bdbe-e8faefafe1bc&quot;,&quot;18b3f0a9-f5e8-45e8-8e84-e57ed76bbf09&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:959,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;title&quot;:&quot;auth&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ef24338-23c9-467b-b274-55b7d147c2a2&quot;,&quot;parentUUID&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:303,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1c8fbf6-8be3-41dd-acfc-7f3cc3b65fd2&quot;,&quot;parentUUID&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9dd7c9e2-3536-4206-b0bb-af3f4ed1b7c4&quot;,&quot;parentUUID&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d5eb47e3-8bf2-478d-aa61-291a23aa68b5&quot;,&quot;parentUUID&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ee68246-4f51-4112-b982-a4a139fe8c6d&quot;,&quot;parentUUID&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed456f94-0225-490f-9c75-8727a8f7f6ab&quot;,&quot;parentUUID&quot;:&quot;a5609421-38e5-402d-a3c2-20ec868ce32f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3ef24338-23c9-467b-b274-55b7d147c2a2&quot;,&quot;f1c8fbf6-8be3-41dd-acfc-7f3cc3b65fd2&quot;,&quot;9dd7c9e2-3536-4206-b0bb-af3f4ed1b7c4&quot;,&quot;d5eb47e3-8bf2-478d-aa61-291a23aa68b5&quot;,&quot;0ee68246-4f51-4112-b982-a4a139fe8c6d&quot;,&quot;ed456f94-0225-490f-9c75-8727a8f7f6ab&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:938,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;dc8226b1-3189-4f58-bcae-f0f5d326aa98&quot;,&quot;2179c68c-1718-4328-b67d-7aff289d58a7&quot;,&quot;df29828b-3ae7-4c0f-9cf0-71c61a7f6eb1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:255,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9d409ff4-70d1-4789-a73c-3a1b99012f9e&quot;,&quot;title&quot;:&quot;site&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\site.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\site.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Go beyond passwords&quot;,&quot;fullTitle&quot;:&quot;site Go beyond passwords&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify((\n  await mfkdf.setup.key([\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n  ], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n).policy)\nconst derivedKey = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  password: mfkdf.derive.factors.password(&#x27;Tr0ub4dour&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  recovery: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderivedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f3e71bc3-6019-4e8a-bd5b-00dab4d31402&quot;,&quot;parentUUID&quot;:&quot;9d409ff4-70d1-4789-a73c-3a1b99012f9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Increased key entropy&quot;,&quot;fullTitle&quot;:&quot;site Increased key entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:209,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;Math.floor((await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n])).entropyBits.real).should.equal(16)\nMath.floor((await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.hmacsha1()\n])).entropyBits.real).should.equal(196)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99a9fbec-acbf-4eb5-9728-bc2710aaac4b&quot;,&quot;parentUUID&quot;:&quot;9d409ff4-70d1-4789-a73c-3a1b99012f9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enforce advanced policies&quot;,&quot;fullTitle&quot;:&quot;site Enforce advanced policies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:771,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policyBasedKey = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.totp()\n    )\n  )\n)\npolicyBasedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29281ae8-313a-42f8-9572-06f684f54f53&quot;,&quot;parentUUID&quot;:&quot;9d409ff4-70d1-4789-a73c-3a1b99012f9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Self-service factor recovery&quot;,&quot;fullTitle&quot;:&quot;site Self-service factor recovery&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify((\n  await mfkdf.setup.key([\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n  ], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n).policy)\nconst key = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  recoveryCode: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nawait key.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;myNewPassword&#x27;, { id: &#x27;password&#x27; })\n) // modify key to use new password factor&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd92fb85-2088-48e4-861e-02d313003c76&quot;,&quot;parentUUID&quot;:&quot;9d409ff4-70d1-4789-a73c-3a1b99012f9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f3e71bc3-6019-4e8a-bd5b-00dab4d31402&quot;,&quot;99a9fbec-acbf-4eb5-9728-bc2710aaac4b&quot;,&quot;29281ae8-313a-42f8-9572-06f684f54f53&quot;,&quot;bd92fb85-2088-48e4-861e-02d313003c76&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1005,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Auth&quot;,&quot;fullTitle&quot;:&quot;tutorials Auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76f2468f-f58b-40f9-a8be-4935a8a847b4&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloepd Key&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloepd Key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;391494c2-8ba7-4885-a6d6-285fe475e4a3&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloped Secret&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloped Secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b557d32-0e8b-4dda-b23d-59cac1be2567&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12283f49-c206-4658-ba5b-63775a6d3a38&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Signing &amp; Verification&quot;,&quot;fullTitle&quot;:&quot;tutorials Signing &amp; Verification&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:246,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// sign message with derived key using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f455afae-d017-41c0-bb5a-ce258e08895d&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Encryption &amp; Decryption&quot;,&quot;fullTitle&quot;:&quot;tutorials Encryption &amp; Decryption&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// encrypt secret with derived key using AES-256\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;aes256&#x27;)\n// ... later, decrypt secret with derived key\nconst decrypted = await key.decrypt(encrypted, &#x27;aes256&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cc9df6ae-c0e3-4037-876b-6c1bbe46f611&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// reconstitute key to change password\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;newPassword&#x27;))\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae81c820-3d95-45f4-bd00-52ed8d2c3b5c&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abe27895-88aa-4deb-b900-c02c5d33b6a4&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:239,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f5c6f0c-3e49-4223-be66-0285e4fa1d2a&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16, threshold: 2 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e445c75b-6298-487d-92da-8f634b403266&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:628,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n], { size: 32 })\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n], { size: 32 })\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n], { size: 32 })\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32 })\nconst threshold = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32, threshold: 2 })\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9c9d8dd-70ba-4930-b3b4-a16a4c344bd1&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:211,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;082a1597-76e0-4d29-9c08-61b66346f6ed&quot;,&quot;parentUUID&quot;:&quot;0e839d3f-da7d-43bf-babe-c098a679232e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;76f2468f-f58b-40f9-a8be-4935a8a847b4&quot;,&quot;391494c2-8ba7-4885-a6d6-285fe475e4a3&quot;,&quot;4b557d32-0e8b-4dda-b23d-59cac1be2567&quot;,&quot;12283f49-c206-4658-ba5b-63775a6d3a38&quot;,&quot;f455afae-d017-41c0-bb5a-ce258e08895d&quot;,&quot;cc9df6ae-c0e3-4037-876b-6c1bbe46f611&quot;,&quot;ae81c820-3d95-45f4-bd00-52ed8d2c3b5c&quot;,&quot;abe27895-88aa-4deb-b900-c02c5d33b6a4&quot;,&quot;5f5c6f0c-3e49-4223-be66-0285e4fa1d2a&quot;,&quot;e445c75b-6298-487d-92da-8f634b403266&quot;,&quot;a9c9d8dd-70ba-4930-b3b4-a16a4c344bd1&quot;,&quot;082a1597-76e0-4d29-9c08-61b66346f6ed&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2721,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;00422152-6a54-4f3a-9f5b-64ccec29ab84&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key)\n  .update(challenge)\n  .digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f34cabf7-9023-4792-a582-f4054af6e5e7&quot;,&quot;parentUUID&quot;:&quot;00422152-6a54-4f3a-9f5b-64ccec29ab84&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:322,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response1 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(derive1.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response2 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b14b93b1-e1dc-48aa-a6a6-4dc25a017a2b&quot;,&quot;parentUUID&quot;:&quot;00422152-6a54-4f3a-9f5b-64ccec29ab84&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v1.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;kdf\&quot;:{\&quot;type\&quot;:\&quot;argon2id\&quot;,\&quot;params\&quot;:{\&quot;rounds\&quot;:2,\&quot;memory\&quot;:24576,\&quot;parallelism\&quot;:1}},\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;f8d33204be0436f2629d5173e9bd3fc1953cf982\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(JSON.parse(setup), {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;))\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(&#x27;ca76d2b456be4e40ba6ef65a68fbfc71bf27a0ca3e0fa4481a2ddf29fb6b65d9&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4fee411e-0eba-4cab-a8ad-00161067f014&quot;,&quot;parentUUID&quot;:&quot;00422152-6a54-4f3a-9f5b-64ccec29ab84&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;58e558b3-8ae0-4ca0-bed5-3e5930eb4480&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9160dc06-6670-4efb-98f3-8e4a523d7bcd&quot;,&quot;parentUUID&quot;:&quot;58e558b3-8ae0-4ca0-bed5-3e5930eb4480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e071fc6-c968-411f-9e0d-064256531d9b&quot;,&quot;parentUUID&quot;:&quot;58e558b3-8ae0-4ca0-bed5-3e5930eb4480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba772151-c83e-4ec9-805a-e1cc313eda06&quot;,&quot;parentUUID&quot;:&quot;58e558b3-8ae0-4ca0-bed5-3e5930eb4480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dec005d8-0db1-4a1d-a2a5-18a3abc36576&quot;,&quot;parentUUID&quot;:&quot;58e558b3-8ae0-4ca0-bed5-3e5930eb4480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bcdd8710-1db7-4992-b866-2cfb4db3b90e&quot;,&quot;parentUUID&quot;:&quot;58e558b3-8ae0-4ca0-bed5-3e5930eb4480&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9160dc06-6670-4efb-98f3-8e4a523d7bcd&quot;,&quot;8e071fc6-c968-411f-9e0d-064256531d9b&quot;,&quot;ba772151-c83e-4ec9-805a-e1cc313eda06&quot;,&quot;dec005d8-0db1-4a1d-a2a5-18a3abc36576&quot;,&quot;bcdd8710-1db7-4992-b866-2cfb4db3b90e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;f34cabf7-9023-4792-a582-f4054af6e5e7&quot;,&quot;b14b93b1-e1dc-48aa-a6a6-4dc25a017a2b&quot;,&quot;4fee411e-0eba-4cab-a8ad-00161067f014&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:433,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;dcb54bb6-6636-460a-bdf7-88988708a8ea&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:434,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(891649)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(795484)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c31fdc6a-5b47-450f-ba73-2fdf5b14990f&quot;,&quot;parentUUID&quot;:&quot;dcb54bb6-6636-460a-bdf7-88988708a8ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f761dae5-5d5e-4227-a510-e10cf3428161&quot;,&quot;parentUUID&quot;:&quot;dcb54bb6-6636-460a-bdf7-88988708a8ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a743d2c-077b-4c15-b520-bea6e3478e05&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;265d3535-a78f-4556-ae05-333a866f94a0&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92027fd6-0dce-4300-9de3-62e86d0580f2&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0211bcd4-00bf-41ef-a740-2a651b04d76b&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;615dbc5e-ea64-4b34-b71e-8b52e1724490&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a0f4591-e740-4020-952b-99dd88fd94b1&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe44c4f5-42a2-4c3f-b490-451abe655b60&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6950421f-d4a9-40c1-ad6c-6910978d7fb3&quot;,&quot;parentUUID&quot;:&quot;0815db12-6557-4140-9b7e-f8eee88cecb0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8a743d2c-077b-4c15-b520-bea6e3478e05&quot;,&quot;265d3535-a78f-4556-ae05-333a866f94a0&quot;,&quot;92027fd6-0dce-4300-9de3-62e86d0580f2&quot;,&quot;0211bcd4-00bf-41ef-a740-2a651b04d76b&quot;,&quot;615dbc5e-ea64-4b34-b71e-8b52e1724490&quot;,&quot;4a0f4591-e740-4020-952b-99dd88fd94b1&quot;,&quot;fe44c4f5-42a2-4c3f-b490-451abe655b60&quot;,&quot;6950421f-d4a9-40c1-ad6c-6910978d7fb3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;c31fdc6a-5b47-450f-ba73-2fdf5b14990f&quot;,&quot;f761dae5-5d5e-4227-a510-e10cf3428161&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:538,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a80888e3-855b-4477-bce1-75ddfee3b522&quot;,&quot;title&quot;:&quot;factors/ooba&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;factors/ooba full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:483,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  { hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: {\n      email: &#x27;test@mfkdf.com&#x27;\n    }\n  })\n])\nlet next = setup.policy.factors[0].params.next\nlet decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nlet json = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\nlet code = json.code\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nnext = derive1.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toLowerCase())\n})\nnext = derive2.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toUpperCase())\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca1d918f-bad3-4e83-9f81-14de1e8988de&quot;,&quot;parentUUID&quot;:&quot;a80888e3-855b-4477-bce1-75ddfee3b522&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ca1d918f-bad3-4e83-9f81-14de1e8988de&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:483,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0552cc0f-96ed-4c9e-8568-49788bfb315c&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6242840-fb3f-45c4-a081-bd566a07caea&quot;,&quot;parentUUID&quot;:&quot;0552cc0f-96ed-4c9e-8568-49788bfb315c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e0a6ad3-9fb1-45ec-b9aa-3476f2a1e4b1&quot;,&quot;parentUUID&quot;:&quot;0552cc0f-96ed-4c9e-8568-49788bfb315c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b6242840-fb3f-45c4-a081-bd566a07caea&quot;,&quot;5e0a6ad3-9fb1-45ec-b9aa-3476f2a1e4b1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:217,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a70a7303-1d72-4369-9f35-ae3b926f35be&quot;,&quot;title&quot;:&quot;factors/question&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/question valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27; Fido-&#x27;, { question: &#x27;What is the name of your first pet?&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;-f_i%d#o ? &#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff303efd-d6da-4f5e-9c83-3b59b73ad521&quot;,&quot;parentUUID&quot;:&quot;a70a7303-1d72-4369-9f35-ae3b926f35be&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/question invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;, { question: &#x27;What is the name of your first pet?&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Rex&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96784e5a-e761-49bc-ac36-4657cf420c23&quot;,&quot;parentUUID&quot;:&quot;a70a7303-1d72-4369-9f35-ae3b926f35be&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8f091f86-0bfc-4eb6-9805-43bf2df6e093&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/question errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.question(123)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.question(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee84a78a-e002-413a-a7ef-ef08eebaee5d&quot;,&quot;parentUUID&quot;:&quot;8f091f86-0bfc-4eb6-9805-43bf2df6e093&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/question errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.question(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.question(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { question: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;88eb9253-2a54-4acf-824a-859c7b3a1bcc&quot;,&quot;parentUUID&quot;:&quot;8f091f86-0bfc-4eb6-9805-43bf2df6e093&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ee84a78a-e002-413a-a7ef-ef08eebaee5d&quot;,&quot;88eb9253-2a54-4acf-824a-859c7b3a1bcc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;ff303efd-d6da-4f5e-9c83-3b59b73ad521&quot;,&quot;96784e5a-e761-49bc-ac36-4657cf420c23&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:434,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f7cef1ff-1f55-401f-87d3-ae5bd78535c6&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;508a7973-b34e-4e92-af65-0e0a1d8f074e&quot;,&quot;parentUUID&quot;:&quot;f7cef1ff-1f55-401f-87d3-ae5bd78535c6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;56024d4e-fb75-4f89-9a99-c2120e9d720c&quot;,&quot;parentUUID&quot;:&quot;f7cef1ff-1f55-401f-87d3-ae5bd78535c6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:340,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ], { id: &#x27;stack1&#x27; }),\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ], { id: &#x27;stack2&#x27; })\n], { threshold: 1 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a04a618-5c5f-4a30-b79a-d4b71457e7e6&quot;,&quot;parentUUID&quot;:&quot;f7cef1ff-1f55-401f-87d3-ae5bd78535c6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;508a7973-b34e-4e92-af65-0e0a1d8f074e&quot;,&quot;56024d4e-fb75-4f89-9a99-c2120e9d720c&quot;,&quot;1a04a618-5c5f-4a30-b79a-d4b71457e7e6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:341,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;44191a84-2af7-4ea9-9d0f-6c04c63ba4f5&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1094,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])\nconst code = parseInt(speakeasy.totp({\n  secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n  encoding: &#x27;hex&#x27;,\n  step: setup.outputs.totp.period,\n  algorithm: setup.outputs.totp.algorithm,\n  digits: setup.outputs.totp.digits\n}))\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3bda7942-011b-4951-83b0-b26ac7b28dae&quot;,&quot;parentUUID&quot;:&quot;44191a84-2af7-4ea9-9d0f-6c04c63ba4f5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1071,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(99922, { time: 1650430991083 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(398884, { time: 1650431018392 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e5cda4c-29a4-4d55-be5e-acd886beca0a&quot;,&quot;parentUUID&quot;:&quot;44191a84-2af7-4ea9-9d0f-6c04c63ba4f5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:749,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f66fd785-88ba-4b06-b527-0ce2921c7225&quot;,&quot;parentUUID&quot;:&quot;44191a84-2af7-4ea9-9d0f-6c04c63ba4f5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9344d3b9-54fa-453b-8b0c-ad00c11b4126&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:733,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nmfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1750430943604 })\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;868cb406-fdd2-4439-b4e6-aed0c2c670a2&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b3f008ba-2274-4bb7-8a09-344f515f3352&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b106a70c-e463-4322-96c1-c46ee53626c2&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;16de7a48-d84c-4883-8f85-431dfda45e5a&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;15cc306e-305e-4ce2-ba8c-ad5c9e864e5d&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4eb7c14d-8891-4478-806f-4282840e7ab6&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90c43bf8-58b2-4a5a-adbd-2495e6daa786&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;153c534c-f617-4272-b055-7272ff5f222c&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36d29770-ef6b-4785-a314-3eb3ea592da8&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c5df518-8ad7-442c-85cf-80ad5bffc97c&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abdd55c4-5b44-4b07-8f21-f1e31c643a5b&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;171e79aa-3a0e-4e7f-a59c-49010f186027&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c862ae41-a939-4cc2-8402-bcadaddf7fab&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3052316e-9875-4b39-ada6-0f4e2b5e7802&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc892ef4-f127-4f15-870f-7621a1d5c532&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db1767c4-5ca1-4b45-a901-615b1c8e09ea&quot;,&quot;parentUUID&quot;:&quot;732e3826-cd04-4cad-99a5-eb9e2bbcb1bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9344d3b9-54fa-453b-8b0c-ad00c11b4126&quot;,&quot;868cb406-fdd2-4439-b4e6-aed0c2c670a2&quot;,&quot;b3f008ba-2274-4bb7-8a09-344f515f3352&quot;,&quot;b106a70c-e463-4322-96c1-c46ee53626c2&quot;,&quot;16de7a48-d84c-4883-8f85-431dfda45e5a&quot;,&quot;15cc306e-305e-4ce2-ba8c-ad5c9e864e5d&quot;,&quot;4eb7c14d-8891-4478-806f-4282840e7ab6&quot;,&quot;90c43bf8-58b2-4a5a-adbd-2495e6daa786&quot;,&quot;153c534c-f617-4272-b055-7272ff5f222c&quot;,&quot;36d29770-ef6b-4785-a314-3eb3ea592da8&quot;,&quot;0c5df518-8ad7-442c-85cf-80ad5bffc97c&quot;,&quot;abdd55c4-5b44-4b07-8f21-f1e31c643a5b&quot;,&quot;171e79aa-3a0e-4e7f-a59c-49010f186027&quot;,&quot;c862ae41-a939-4cc2-8402-bcadaddf7fab&quot;,&quot;3052316e-9875-4b39-ada6-0f4e2b5e7802&quot;,&quot;fc892ef4-f127-4f15-870f-7621a1d5c532&quot;,&quot;db1767c4-5ca1-4b45-a901-615b1c8e09ea&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:735,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;3bda7942-011b-4951-83b0-b26ac7b28dae&quot;,&quot;4e5cda4c-29a4-4d55-be5e-acd886beca0a&quot;,&quot;f66fd785-88ba-4b06-b527-0ce2921c7225&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2914,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0a6e2222-fcad-4df7-b8c7-880f9a37a1c1&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:544,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81f36cc4-114a-4526-a0b4-16f0bdb3e882&quot;,&quot;parentUUID&quot;:&quot;0a6e2222-fcad-4df7-b8c7-880f9a37a1c1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:553,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98a3f5df-7627-4414-9362-20c3eafd4002&quot;,&quot;parentUUID&quot;:&quot;0a6e2222-fcad-4df7-b8c7-880f9a37a1c1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;81f36cc4-114a-4526-a0b4-16f0bdb3e882&quot;,&quot;98a3f5df-7627-4414-9362-20c3eafd4002&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1097,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1a70e75d-e51f-4062-b0f2-382ea8ed2c33&quot;,&quot;title&quot;:&quot;authentication&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getKey/auth&quot;,&quot;fullTitle&quot;:&quot;authentication getKey/auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6810,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nlet authKey\nlet encKey\nauthKey = await key.getSymmetricKey(&#x27;des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;3des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;3des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes128&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes128&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes192&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes192&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes256&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes256&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96bddfc6-0111-4ef4-975f-9cf23d0981d7&quot;,&quot;parentUUID&quot;:&quot;1a70e75d-e51f-4062-b0f2-382ea8ed2c33&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;title&quot;:&quot;valid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;808fb09c-78f0-4652-a110-0fd1fec5fab5&quot;,&quot;parentUUID&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:269,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a1e767c-5b73-4c81-b1ad-8087d23fdf8c&quot;,&quot;parentUUID&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2e5b226-c3b5-494d-8f99-38be7e2ead1f&quot;,&quot;parentUUID&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ddf68c0a-758c-410b-857b-22b77d3b654f&quot;,&quot;parentUUID&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:183,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4a51568-a066-4bf1-afa6-78076aa28f95&quot;,&quot;parentUUID&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e7c3788-899e-4949-bdc9-fca9b73f379a&quot;,&quot;parentUUID&quot;:&quot;496bec7a-f6a5-43ee-aada-dacf8631156e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;808fb09c-78f0-4652-a110-0fd1fec5fab5&quot;,&quot;4a1e767c-5b73-4c81-b1ad-8087d23fdf8c&quot;,&quot;d2e5b226-c3b5-494d-8f99-38be7e2ead1f&quot;,&quot;ddf68c0a-758c-410b-857b-22b77d3b654f&quot;,&quot;e4a51568-a066-4bf1-afa6-78076aa28f95&quot;,&quot;1e7c3788-899e-4949-bdc9-fca9b73f379a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:868,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a7c80c42-f192-4284-932f-6e341d9e5e36&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:336,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35c6abce-8456-4170-aa72-4a48ab07625e&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:207,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5eee4d00-b40e-409d-bc6c-158e884314eb&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c54d766e-aeda-462b-994e-e945b123a33e&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:364,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a5331746-8291-496a-9157-27686133ed89&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:208,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;04e841d5-063c-4a70-b268-486be5aa8699&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5cfd2d1f-1d39-4d14-8087-0ab1f9d57376&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:134,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;40b4a076-51d0-436b-be7d-f6a3e3bd85d2&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;82f86cfe-e433-46ce-83a1-178ed2220c90&quot;,&quot;parentUUID&quot;:&quot;495f5f58-411a-495b-9ce4-21f84945e052&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a7c80c42-f192-4284-932f-6e341d9e5e36&quot;,&quot;35c6abce-8456-4170-aa72-4a48ab07625e&quot;,&quot;5eee4d00-b40e-409d-bc6c-158e884314eb&quot;,&quot;c54d766e-aeda-462b-994e-e945b123a33e&quot;,&quot;a5331746-8291-496a-9157-27686133ed89&quot;,&quot;04e841d5-063c-4a70-b268-486be5aa8699&quot;,&quot;5cfd2d1f-1d39-4d14-8087-0ab1f9d57376&quot;,&quot;40b4a076-51d0-436b-be7d-f6a3e3bd85d2&quot;,&quot;82f86cfe-e433-46ce-83a1-178ed2220c90&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1883,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;96bddfc6-0111-4ef4-975f-9cf23d0981d7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6810,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98f4d4f6-9634-4abb-86fb-a907696393ec&quot;,&quot;parentUUID&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e03c14aa-c9e9-4a7f-a341-9690b7b81cc5&quot;,&quot;parentUUID&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;729cb3de-d4f4-4a18-9147-38dddb860f80&quot;,&quot;parentUUID&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2cf36568-5d08-41c9-891e-f7d4d67e33e5&quot;,&quot;parentUUID&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:752,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de6f3492-0234-453d-889a-6306b4b114e8&quot;,&quot;parentUUID&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:734,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84539b71-d914-47f6-81ff-fb61c1a68c41&quot;,&quot;parentUUID&quot;:&quot;57023c52-356a-4d1a-8d10-c1692684f7f6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;98f4d4f6-9634-4abb-86fb-a907696393ec&quot;,&quot;e03c14aa-c9e9-4a7f-a341-9690b7b81cc5&quot;,&quot;729cb3de-d4f4-4a18-9147-38dddb860f80&quot;,&quot;2cf36568-5d08-41c9-891e-f7d4d67e33e5&quot;,&quot;de6f3492-0234-453d-889a-6306b4b114e8&quot;,&quot;84539b71-d914-47f6-81ff-fb61c1a68c41&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1919,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;56db9571-dfb4-44d2-9a5a-b44d6902b817&quot;,&quot;title&quot;:&quot;enveloping&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;secrets&quot;,&quot;fullTitle&quot;:&quot;enveloping secrets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key2&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key3&#x27;, input)\nawait setup.removeEnvelopedSecret(&#x27;key2&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst output = await derive.getEnvelopedSecret(&#x27;key&#x27;)\noutput.toString(&#x27;hex&#x27;).should.equal(input.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ec98209-1fcb-4425-8061-3633cf931c0c&quot;,&quot;parentUUID&quot;:&quot;56db9571-dfb4-44d2-9a5a-b44d6902b817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;keys&quot;,&quot;fullTitle&quot;:&quot;enveloping keys&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:250,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nawait setup.addEnvelopedKey(&#x27;key1&#x27;)\nawait setup.addEnvelopedKey(&#x27;key2&#x27;, &#x27;rsa1024&#x27;)\nawait setup.addEnvelopedKey(&#x27;key3&#x27;, &#x27;rsa2048&#x27;)\nawait setup.addEnvelopedKey(&#x27;key4&#x27;, &#x27;ed25519&#x27;)\nconst key11 = await setup.getEnvelopedKey(&#x27;key1&#x27;)\nconst key12 = await setup.getEnvelopedKey(&#x27;key2&#x27;)\nconst key13 = await setup.getEnvelopedKey(&#x27;key3&#x27;)\nconst key14 = await setup.getEnvelopedKey(&#x27;key4&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst key21 = await derive.getEnvelopedKey(&#x27;key1&#x27;)\nconst key22 = await derive.getEnvelopedKey(&#x27;key2&#x27;)\nconst key23 = await derive.getEnvelopedKey(&#x27;key3&#x27;)\nconst key24 = await derive.getEnvelopedKey(&#x27;key4&#x27;)\nkey11.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key21.export({ format: &#x27;jwk&#x27; }))\nkey12.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key22.export({ format: &#x27;jwk&#x27; }))\nkey13.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key23.export({ format: &#x27;jwk&#x27; }))\nkey14.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key24.export({ format: &#x27;jwk&#x27; }))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd68664c-9689-4a67-97ae-3a7b745db208&quot;,&quot;parentUUID&quot;:&quot;56db9571-dfb4-44d2-9a5a-b44d6902b817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3e634a41-ad59-44b5-a039-6a95b810e556&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;918ec383-70f1-4f03-97b0-e33edcecae01&quot;,&quot;title&quot;:&quot;addEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(12345, input).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6633c8d1-6f7e-4e8f-b230-86e9add50c66&quot;,&quot;parentUUID&quot;:&quot;918ec383-70f1-4f03-97b0-e33edcecae01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;value/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret value/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedSecret(&#x27;id&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8a5204d-35cb-4e5b-928a-4cc0389c9cf0&quot;,&quot;parentUUID&quot;:&quot;918ec383-70f1-4f03-97b0-e33edcecae01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(&#x27;id&#x27;, input, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f01ba69-1d88-432f-85a1-e5f7165f2873&quot;,&quot;parentUUID&quot;:&quot;918ec383-70f1-4f03-97b0-e33edcecae01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/unique&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nsetup.addEnvelopedSecret(&#x27;key&#x27;, input).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4b3cb0d-2bd6-467b-ad30-21a0e34b5aeb&quot;,&quot;parentUUID&quot;:&quot;918ec383-70f1-4f03-97b0-e33edcecae01&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6633c8d1-6f7e-4e8f-b230-86e9add50c66&quot;,&quot;a8a5204d-35cb-4e5b-928a-4cc0389c9cf0&quot;,&quot;9f01ba69-1d88-432f-85a1-e5f7165f2873&quot;,&quot;e4b3cb0d-2bd6-467b-ad30-21a0e34b5aeb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:424,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1b417bb0-4673-4f7c-8fe9-639ee9fd0884&quot;,&quot;title&quot;:&quot;removeEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df08b5f0-f6d0-4482-bec7-561c228b507b&quot;,&quot;parentUUID&quot;:&quot;1b417bb0-4673-4f7c-8fe9-639ee9fd0884&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(&#x27;12345&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a5c587f3-0c94-409d-ad27-8db774a596bb&quot;,&quot;parentUUID&quot;:&quot;1b417bb0-4673-4f7c-8fe9-639ee9fd0884&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;df08b5f0-f6d0-4482-bec7-561c228b507b&quot;,&quot;a5c587f3-0c94-409d-ad27-8db774a596bb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:212,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f480de73-779c-4fa3-9358-8963997cd1d9&quot;,&quot;title&quot;:&quot;addEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0be2ea66-faba-4b24-8b3b-5d45628a1a37&quot;,&quot;parentUUID&quot;:&quot;f480de73-779c-4fa3-9358-8963997cd1d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a62deb3-e6dc-4a82-b09c-273cc8d81cd5&quot;,&quot;parentUUID&quot;:&quot;f480de73-779c-4fa3-9358-8963997cd1d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, &#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2ba85d81-49d4-4f87-8fe2-d336274f42bc&quot;,&quot;parentUUID&quot;:&quot;f480de73-779c-4fa3-9358-8963997cd1d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0be2ea66-faba-4b24-8b3b-5d45628a1a37&quot;,&quot;4a62deb3-e6dc-4a82-b09c-273cc8d81cd5&quot;,&quot;2ba85d81-49d4-4f87-8fe2-d336274f42bc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:315,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;27671f09-1691-4535-bb7f-4c7735c86cae&quot;,&quot;title&quot;:&quot;getEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6cd6e6f-b9ce-47d9-82cf-bfdaa7ffb2e5&quot;,&quot;parentUUID&quot;:&quot;27671f09-1691-4535-bb7f-4c7735c86cae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(&#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;121c2b9e-a6e0-45a8-9019-56711f14f429&quot;,&quot;parentUUID&quot;:&quot;27671f09-1691-4535-bb7f-4c7735c86cae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b6cd6e6f-b9ce-47d9-82cf-bfdaa7ffb2e5&quot;,&quot;121c2b9e-a6e0-45a8-9019-56711f14f429&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:217,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e54614b5-7dc8-42e8-b742-d4b0c403b4bb&quot;,&quot;title&quot;:&quot;getEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:118,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df0afec8-9d75-43fb-8d61-b8d94f247f88&quot;,&quot;parentUUID&quot;:&quot;e54614b5-7dc8-42e8-b742-d4b0c403b4bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;df0afec8-9d75-43fb-8d61-b8d94f247f88&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:118,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3981c6ef-c2fe-4fc7-9ef4-68f29405140c&quot;,&quot;title&quot;:&quot;hasEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors hasEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.hasEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69bb478c-f317-4b44-a455-c34384e529df&quot;,&quot;parentUUID&quot;:&quot;3981c6ef-c2fe-4fc7-9ef4-68f29405140c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;69bb478c-f317-4b44-a455-c34384e529df&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:108,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;4ec98209-1fcb-4425-8061-3633cf931c0c&quot;,&quot;cd68664c-9689-4a67-97ae-3a7b745db208&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:475,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;title&quot;:&quot;kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\features\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;types&quot;,&quot;fullTitle&quot;:&quot;kdf types&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:438,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const pbkdf2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst bcrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst scrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nconst argon2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nBuffer.isBuffer(pbkdf2).should.be.true\nBuffer.isBuffer(bcrypt).should.be.true\nBuffer.isBuffer(scrypt).should.be.true\nBuffer.isBuffer(argon2).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;72dc66bc-c087-4487-8518-48773ebb64c7&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha1&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 25555,\n    digest: &#x27;sha1&#x27;\n  }\n})\nBuffer.isBuffer(key).should.be.true\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;8ee4a527b20aa8feeb78d70447d84e20&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01307fb9-42d6-420b-ac6a-836ccb49ff5d&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha512&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha512&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secret&#x27;, &#x27;salt&#x27;, 64, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha512&#x27;\n  }\n})\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;3745e482c6e0ade35da10139e797157f4a5da669dad7d5da88ef87e47471cc47ed941c7ad618e827304f083f8707f12b7cfdd5f489b782f10cc269e3c08d59ae&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89ccf21f-1053-4508-a1c6-e13ed9e9f9a3&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/default&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:120,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6cac359e-30d5-48ee-bf65-849fbf6f517f&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/same&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/same&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c104c502-b714-4034-ba70-b6075ceb5150&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/inputdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/inputdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:115,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password2&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd070fc2-7b98-449d-b432-64d0bf565c3f&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/saltdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/saltdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f1c2a74-2164-43d9-8237-f0569bad04c0&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/rounddiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/rounddiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:173,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 10 } })\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 11 } })\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1f03cdb-ce9c-4313-a483-4e3b9d490eef&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/length&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:172,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key16 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key16).should.equal(16)\nconst key32 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key32).should.equal(32)\nconst key64 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key64).should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24eeb346-8156-439c-88fc-2eb614c97b1a&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/known&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/known&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;cb36d3d02d502acdf10dfc2d022bf3c024f16a368ba2df4456fbf97291f64334&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;284b413b-ddac-4151-9064-c26bc770e4dc&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/fast&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:186,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 16384, scryptblocksize: 8, scryptparallelism: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;745731af4484f323968969eda289aeee005b5903ac561e64a5aca121797bf7734ef9fd58422e2e22183bcacba9ec87ba0c83b7a2e788f03ce0da06463433cda6&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d989f368-a00c-4d8d-bd78-be15e91efb74&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/defaults&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:182,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;9009fca57ef2b8c342bdad6b9247e4a1b5bd85628152116513ad44e93cf1b0e2&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd0e1e6a-d879-4121-9ae1-f47533b0b998&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/N&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/N&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ceb6a6bf4f4afeb3d1806714474d4f00ca97c2ad76a641269192d11444e13a6b&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;205ebec1-5c69-4c9e-91a8-e23ccc9b6d28&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/R&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/R&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptblocksize: 16 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;a63de1de715f95bebd9f6d58d78ff11028a8412c1fcf71673544373c67095836&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3173c4a7-aabf-4b38-a3e4-f29f709db201&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/P&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/P&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptparallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ef224277727457992dc05983b1fd1208bae35b100c853ba4bb11f1ba7ca4c436&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;443452fa-d834-4662-b416-8486edd64848&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2i&quot;,&quot;fullTitle&quot;:&quot;kdf argon2i&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2i&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;7357892df510f136a0688ceab37bbaf7ba695de590065072717fa6728961c92a&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4ceaec5-ff30-4b5c-8f6e-b53d5657e4f9&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2d&quot;,&quot;fullTitle&quot;:&quot;kdf argon2d&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2d&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;423b0dcc7bbfe16fa8ee7a2e2ebd8891873d726f9dfe70890a7197a5503a2848&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2b9bfa9-9070-4998-8df4-0e6a5631a5d9&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;105e55df-4c68-4e93-b2cf-6a3a2f3bd414&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/mem&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/mem&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:69,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2mem: 16384 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;e043f979311b14ff8378b785469974e899a08f05509323a04b2ca29ef63ff3af&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69d15732-ec34-4b87-a1f3-f4d15699695e&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/time&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2time: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;bf6b1773bdae362ecea04b889079b6628d1f35d96a2be9f2a5481c2d1236e8d7&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63bb269d-2e70-49c4-8ca5-49e290a9d352&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/parallelism&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/parallelism&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2parallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5c12c6873b938cd8467b677d23e525389e3ff7ed62b4ad9e285e1191244f40ca&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a88193a-94a6-43b0-b827-5d3b6f7c0d69&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;kdf default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({}))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60d90a05-e2e3-4fc6-ae80-c682a9e63494&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;kdf invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;invalid&#x27;, params: { } }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd2500a3-4174-4a66-8e18-20687f43883f&quot;,&quot;parentUUID&quot;:&quot;bd28af6c-12f4-4025-a5da-92d81a803586&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;72dc66bc-c087-4487-8518-48773ebb64c7&quot;,&quot;01307fb9-42d6-420b-ac6a-836ccb49ff5d&quot;,&quot;89ccf21f-1053-4508-a1c6-e13ed9e9f9a3&quot;,&quot;6cac359e-30d5-48ee-bf65-849fbf6f517f&quot;,&quot;c104c502-b714-4034-ba70-b6075ceb5150&quot;,&quot;bd070fc2-7b98-449d-b432-64d0bf565c3f&quot;,&quot;6f1c2a74-2164-43d9-8237-f0569bad04c0&quot;,&quot;b1f03cdb-ce9c-4313-a483-4e3b9d490eef&quot;,&quot;24eeb346-8156-439c-88fc-2eb614c97b1a&quot;,&quot;284b413b-ddac-4151-9064-c26bc770e4dc&quot;,&quot;d989f368-a00c-4d8d-bd78-be15e91efb74&quot;,&quot;dd0e1e6a-d879-4121-9ae1-f47533b0b998&quot;,&quot;205ebec1-5c69-4c9e-91a8-e23ccc9b6d28&quot;,&quot;3173c4a7-aabf-4b38-a3e4-f29f709db201&quot;,&quot;443452fa-d834-4662-b416-8486edd64848&quot;,&quot;f4ceaec5-ff30-4b5c-8f6e-b53d5657e4f9&quot;,&quot;d2b9bfa9-9070-4998-8df4-0e6a5631a5d9&quot;,&quot;105e55df-4c68-4e93-b2cf-6a3a2f3bd414&quot;,&quot;69d15732-ec34-4b87-a1f3-f4d15699695e&quot;,&quot;63bb269d-2e70-49c4-8ca5-49e290a9d352&quot;,&quot;5a88193a-94a6-43b0-b827-5d3b6f7c0d69&quot;,&quot;60d90a05-e2e3-4fc6-ae80-c682a9e63494&quot;,&quot;dd2500a3-4174-4a66-8e18-20687f43883f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2420,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f49591e2-1325-492a-aee4-d81fb87d3a41&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;48beeb2a-f9c1-4f95-9722-b280b80f5e34&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96c6eace-0d89-4fd3-81bf-3bbd012d5053&quot;,&quot;parentUUID&quot;:&quot;48beeb2a-f9c1-4f95-9722-b280b80f5e34&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password2&#x27; })\n    )\n  )\n).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14702fe3-056f-4d68-b3f3-cd254080039b&quot;,&quot;parentUUID&quot;:&quot;48beeb2a-f9c1-4f95-9722-b280b80f5e34&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;96c6eace-0d89-4fd3-81bf-3bbd012d5053&quot;,&quot;14702fe3-056f-4d68-b3f3-cd254080039b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:210,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f044ed5a-8234-4136-8467-cebd7e3bf03e&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;489c5761-3365-48bb-80b6-bd738f8c46d7&quot;,&quot;parentUUID&quot;:&quot;f044ed5a-8234-4136-8467-cebd7e3bf03e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c55eb7a2-eaa3-455a-bc7f-8dd73f35746f&quot;,&quot;parentUUID&quot;:&quot;f044ed5a-8234-4136-8467-cebd7e3bf03e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;489c5761-3365-48bb-80b6-bd738f8c46d7&quot;,&quot;c55eb7a2-eaa3-455a-bc7f-8dd73f35746f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:213,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4aa12536-db02-481e-a527-d03f98f0637a&quot;,&quot;parentUUID&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6cef8db5-1f5b-4753-b697-d6e523212e8f&quot;,&quot;parentUUID&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b254923-4ce5-4bed-a35f-c67cae18c855&quot;,&quot;parentUUID&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:619,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;482174ea-c880-43d8-a16a-5da4df077560&quot;,&quot;parentUUID&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:350,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;782ab77a-3c47-47fd-9928-eb78e25e6bab&quot;,&quot;parentUUID&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:242,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;318b454d-b428-4d9d-ac58-144c9da7c636&quot;,&quot;parentUUID&quot;:&quot;2184a995-c24a-4e3f-9819-39e69d279807&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4aa12536-db02-481e-a527-d03f98f0637a&quot;,&quot;6cef8db5-1f5b-4753-b697-d6e523212e8f&quot;,&quot;0b254923-4ce5-4bed-a35f-c67cae18c855&quot;,&quot;482174ea-c880-43d8-a16a-5da4df077560&quot;,&quot;782ab77a-3c47-47fd-9928-eb78e25e6bab&quot;,&quot;318b454d-b428-4d9d-ac58-144c9da7c636&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1886,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;095a1b90-6701-42f0-8fce-041c39184de7&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n])\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;064456cd-811a-4a93-a122-90b8a068f856&quot;,&quot;parentUUID&quot;:&quot;095a1b90-6701-42f0-8fce-041c39184de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa385196-6d45-4651-a2fb-47456195f84d&quot;,&quot;parentUUID&quot;:&quot;095a1b90-6701-42f0-8fce-041c39184de7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;064456cd-811a-4a93-a122-90b8a068f856&quot;,&quot;fa385196-6d45-4651-a2fb-47456195f84d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:214,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5651ea69-9984-4b4c-885b-8b0e71af0203&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:448,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nderive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(derive2.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4707345-524f-4e74-bb17-a93d6258fb3d&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:442,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e5560db-d193-438d-a5b7-f3f5f5f09357&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52a59b9c-cd85-4b79-8fbe-2489b541ea8c&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90f68f19-f88b-4274-9896-242967ac2a01&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24853196-d7b5-407c-be95-893f4bef0e95&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abfcfc5c-2bd7-4a38-bf3a-9e532ec12c99&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute([&#x27;password1&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00cfeb2e-5e7c-49b8-969c-3eb75e9ca68a&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9239986-9413-4c53-a868-4c6d762df7e7&quot;,&quot;parentUUID&quot;:&quot;2684db32-8f24-4547-a53d-4b98e7f6d430&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([12345], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74c16110-efa3-420b-8598-4e3849b12931&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([&#x27;password4&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a206e79b-5811-4fca-ad35-b3dbc915cca9&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.reconstitute([&#x27;password3&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cac4e268-89b1-4b62-b2c1-0654d523765c&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute(&#x27;hello&#x27;, [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;355a0322-1777-4b87-8584-efb9ba19fcef&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], &#x27;12345&#x27;, 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75d5e428-857f-44fb-84c5-c7e973011dd7&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], &#x27;12345&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd8964fa-a037-4229-a81f-904cb42f7815&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89fc4b67-a5e2-42e0-93a8-b5133c4808b2&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: 12345,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84de02df-0ae0-44be-9974-3af46622c7f8&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;264aff9b-8fc9-46c7-bda7-e992ccb47476&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76de73ea-3d34-42d4-b350-651f6c932818&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b16350db-f548-4181-bad9-82189241071c&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bfa6642a-8afb-4e1d-a854-be6138aa6088&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8124e32-32cc-42b5-b78d-eab08109893a&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: 12345,\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98b90f0f-7153-4cb8-bed1-de53c21a63fc&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: 12345\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4834c197-e6a9-4d0f-a8fe-8683ea98047e&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35a711bb-0036-46f6-a7be-ad21cd5a860e&quot;,&quot;parentUUID&quot;:&quot;6a8d628b-b6d1-4239-8127-099535617282&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;74c16110-efa3-420b-8598-4e3849b12931&quot;,&quot;a206e79b-5811-4fca-ad35-b3dbc915cca9&quot;,&quot;cac4e268-89b1-4b62-b2c1-0654d523765c&quot;,&quot;355a0322-1777-4b87-8584-efb9ba19fcef&quot;,&quot;75d5e428-857f-44fb-84c5-c7e973011dd7&quot;,&quot;bd8964fa-a037-4229-a81f-904cb42f7815&quot;,&quot;89fc4b67-a5e2-42e0-93a8-b5133c4808b2&quot;,&quot;84de02df-0ae0-44be-9974-3af46622c7f8&quot;,&quot;264aff9b-8fc9-46c7-bda7-e992ccb47476&quot;,&quot;76de73ea-3d34-42d4-b350-651f6c932818&quot;,&quot;b16350db-f548-4181-bad9-82189241071c&quot;,&quot;bfa6642a-8afb-4e1d-a854-be6138aa6088&quot;,&quot;c8124e32-32cc-42b5-b78d-eab08109893a&quot;,&quot;98b90f0f-7153-4cb8-bed1-de53c21a63fc&quot;,&quot;4834c197-e6a9-4d0f-a8fe-8683ea98047e&quot;,&quot;35a711bb-0036-46f6-a7be-ad21cd5a860e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1677,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;5651ea69-9984-4b4c-885b-8b0e71af0203&quot;,&quot;a4707345-524f-4e74-bb17-a93d6258fb3d&quot;,&quot;0e5560db-d193-438d-a5b7-f3f5f5f09357&quot;,&quot;52a59b9c-cd85-4b79-8fbe-2489b541ea8c&quot;,&quot;90f68f19-f88b-4274-9896-242967ac2a01&quot;,&quot;24853196-d7b5-407c-be95-893f4bef0e95&quot;,&quot;abfcfc5c-2bd7-4a38-bf3a-9e532ec12c99&quot;,&quot;00cfeb2e-5e7c-49b8-969c-3eb75e9ca68a&quot;,&quot;f9239986-9413-4c53-a868-4c6d762df7e7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2419,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8b627d18-0404-4d7a-bd67-76c21a469305&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;457fb7bd-5aa2-4812-8eef-e393eb076021&quot;,&quot;parentUUID&quot;:&quot;8b627d18-0404-4d7a-bd67-76c21a469305&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;107c32ac-96e7-4c9e-870c-2bd659beb570&quot;,&quot;parentUUID&quot;:&quot;8b627d18-0404-4d7a-bd67-76c21a469305&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d66ee76e-5a83-484f-a1ec-55f72f67a0b0&quot;,&quot;parentUUID&quot;:&quot;8b627d18-0404-4d7a-bd67-76c21a469305&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;457fb7bd-5aa2-4812-8eef-e393eb076021&quot;,&quot;107c32ac-96e7-4c9e-870c-2bd659beb570&quot;,&quot;d66ee76e-5a83-484f-a1ec-55f72f67a0b0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69c6e9a7-dfe0-4001-ab9f-44b47afc0df2&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 1, 5)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d2c612f-f167-4fa0-9714-929e838c3291&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 2, 3)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0bc18062-7aa8-45b2-840c-cf0347db4c05&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b110a0ed-f3cc-4806-97eb-23b8c0554a31&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:67,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 1024)\nshares.should.be.an(&#x27;array&#x27;).of.length(1024)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 1020; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[1023] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd7f3962-45d9-433a-8c86-3162cb9f4dfa&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)\nxor(shares[0], shares[1]).toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bf6dd355-8524-4933-b211-d96f9d239127&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3f7b18aa-4bdb-4cfe-937d-ea0aee992288&quot;,&quot;parentUUID&quot;:&quot;bd718cae-7226-44b2-8d07-907bb830665e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;69c6e9a7-dfe0-4001-ab9f-44b47afc0df2&quot;,&quot;6d2c612f-f167-4fa0-9714-929e838c3291&quot;,&quot;0bc18062-7aa8-45b2-840c-cf0347db4c05&quot;,&quot;b110a0ed-f3cc-4806-97eb-23b8c0554a31&quot;,&quot;cd7f3962-45d9-433a-8c86-3162cb9f4dfa&quot;,&quot;bf6dd355-8524-4933-b211-d96f9d239127&quot;,&quot;3f7b18aa-4bdb-4cfe-937d-ea0aee992288&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:78,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1436b2d0-e901-460b-9883-5cbb5f1f2af5&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7350f0ee-fca5-4e6d-943d-3e578f62ac1a&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;194f9a70-0aaf-40e8-8cb5-934d79ed334c&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90f94946-bc0a-4417-aaf3-bfc82163b494&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1342819f-ab28-4d30-a49b-c81f5b3478f5&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4af82187-6ebe-4df8-8ce5-13b9a1cd0c79&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3373a96e-f6cf-4957-a062-dde38e85758d&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;709ee4be-9c69-427f-a645-820892bcf743&quot;,&quot;parentUUID&quot;:&quot;d09d69a4-3b82-458c-bc86-69d3900a7764&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1436b2d0-e901-460b-9883-5cbb5f1f2af5&quot;,&quot;7350f0ee-fca5-4e6d-943d-3e578f62ac1a&quot;,&quot;194f9a70-0aaf-40e8-8cb5-934d79ed334c&quot;,&quot;90f94946-bc0a-4417-aaf3-bfc82163b494&quot;,&quot;1342819f-ab28-4d30-a49b-c81f5b3478f5&quot;,&quot;4af82187-6ebe-4df8-8ce5-13b9a1cd0c79&quot;,&quot;3373a96e-f6cf-4957-a062-dde38e85758d&quot;,&quot;709ee4be-9c69-427f-a645-820892bcf743&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;261ae56e-7117-4526-9893-25b4010e3068&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d46b855-817d-4f48-ba97-9d1dd8e40e57&quot;,&quot;parentUUID&quot;:&quot;261ae56e-7117-4526-9893-25b4010e3068&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cff87dbf-34e0-4d58-ae6c-3551ce9d93f9&quot;,&quot;parentUUID&quot;:&quot;261ae56e-7117-4526-9893-25b4010e3068&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;220eabb0-759a-4e15-b528-627e9c49c30c&quot;,&quot;parentUUID&quot;:&quot;261ae56e-7117-4526-9893-25b4010e3068&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8d46b855-817d-4f48-ba97-9d1dd8e40e57&quot;,&quot;cff87dbf-34e0-4d58-ae6c-3551ce9d93f9&quot;,&quot;220eabb0-759a-4e15-b528-627e9c49c30c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a451c5f6-e4eb-4e65-bf8b-605b0b46be6a&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7da88c5-53cc-4969-a26b-960af2d323bb&quot;,&quot;parentUUID&quot;:&quot;a451c5f6-e4eb-4e65-bf8b-605b0b46be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c9ed153-2185-408f-bf0c-ef32dcc198e1&quot;,&quot;parentUUID&quot;:&quot;a451c5f6-e4eb-4e65-bf8b-605b0b46be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;266e554e-46e6-4be1-a0eb-317ad1b116cd&quot;,&quot;parentUUID&quot;:&quot;a451c5f6-e4eb-4e65-bf8b-605b0b46be6a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b7da88c5-53cc-4969-a26b-960af2d323bb&quot;,&quot;9c9ed153-2185-408f-bf0c-ef32dcc198e1&quot;,&quot;266e554e-46e6-4be1-a0eb-317ad1b116cd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;90a3e6fc-7b2f-4be1-ab48-b0f4d75427d1&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ uuid: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ uuid: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb989883-e55c-447a-9e4e-6698722354e7&quot;,&quot;parentUUID&quot;:&quot;90a3e6fc-7b2f-4be1-ab48-b0f4d75427d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b2ae6a6c-d398-4909-8bb0-3275189eccc1&quot;,&quot;parentUUID&quot;:&quot;90a3e6fc-7b2f-4be1-ab48-b0f4d75427d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({ uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f836f2be-8a17-480b-97dc-f90cb7c560b0&quot;,&quot;parentUUID&quot;:&quot;90a3e6fc-7b2f-4be1-ab48-b0f4d75427d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;548f3532-2bcf-4094-822c-3e469bf77243&quot;,&quot;parentUUID&quot;:&quot;90a3e6fc-7b2f-4be1-ab48-b0f4d75427d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;eb989883-e55c-447a-9e4e-6698722354e7&quot;,&quot;b2ae6a6c-d398-4909-8bb0-3275189eccc1&quot;,&quot;f836f2be-8a17-480b-97dc-f90cb7c560b0&quot;,&quot;548f3532-2bcf-4094-822c-3e469bf77243&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f96d20be-7aef-4bb5-a439-8f47e4d918a2&quot;,&quot;title&quot;:&quot;setup/kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f3373c34-906b-403f-9a72-54de4cc4ad8d&quot;,&quot;title&quot;:&quot;pbkdf2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2fd87dcc-3039-47af-a2a9-6ed8d2d65975&quot;,&quot;parentUUID&quot;:&quot;f3373c34-906b-403f-9a72-54de4cc4ad8d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;376ad073-8f53-4b62-9f8c-286abc244085&quot;,&quot;title&quot;:&quot;pbkdf2rounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;51049904-2202-45af-a6d7-1b50d5a3f6b6&quot;,&quot;parentUUID&quot;:&quot;376ad073-8f53-4b62-9f8c-286abc244085&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb8d0284-c9c3-45e8-8cf0-bf25da25374c&quot;,&quot;parentUUID&quot;:&quot;376ad073-8f53-4b62-9f8c-286abc244085&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90b3811d-e830-45e2-b39c-6c68057ae76a&quot;,&quot;parentUUID&quot;:&quot;376ad073-8f53-4b62-9f8c-286abc244085&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;51049904-2202-45af-a6d7-1b50d5a3f6b6&quot;,&quot;eb8d0284-c9c3-45e8-8cf0-bf25da25374c&quot;,&quot;90b3811d-e830-45e2-b39c-6c68057ae76a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1a7e8533-f2d7-4e79-896c-356611c9c9fe&quot;,&quot;title&quot;:&quot;pbkdf2digest&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: 0\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;406a1d10-7e83-4358-9a94-deac726f54e4&quot;,&quot;parentUUID&quot;:&quot;1a7e8533-f2d7-4e79-896c-356611c9c9fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;225081ba-04d1-4349-bf94-4be2d47158f1&quot;,&quot;parentUUID&quot;:&quot;1a7e8533-f2d7-4e79-896c-356611c9c9fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2digest: &#x27;sha512&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha512&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c350e049-fd1a-4e32-942b-c6c2f2a9b2b3&quot;,&quot;parentUUID&quot;:&quot;1a7e8533-f2d7-4e79-896c-356611c9c9fe&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;406a1d10-7e83-4358-9a94-deac726f54e4&quot;,&quot;225081ba-04d1-4349-bf94-4be2d47158f1&quot;,&quot;c350e049-fd1a-4e32-942b-c6c2f2a9b2b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2fd87dcc-3039-47af-a2a9-6ed8d2d65975&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;03872d70-3003-4653-9210-8e558a8e3894&quot;,&quot;title&quot;:&quot;bcrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 10\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2ef9554d-924e-4c42-8d46-0c864b1d2cb4&quot;,&quot;parentUUID&quot;:&quot;03872d70-3003-4653-9210-8e558a8e3894&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;15c342cc-946c-4ef2-86ae-ab1bf90d90cb&quot;,&quot;title&quot;:&quot;bcryptrounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;16ac99cf-aa6e-494b-804d-45e3415f9420&quot;,&quot;parentUUID&quot;:&quot;15c342cc-946c-4ef2-86ae-ab1bf90d90cb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd661479-cf1b-4122-8d7f-e3c6303a7a82&quot;,&quot;parentUUID&quot;:&quot;15c342cc-946c-4ef2-86ae-ab1bf90d90cb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;,\n  bcryptrounds: 25\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 25\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;556b799b-fd37-4084-871f-fe4c8ba796ef&quot;,&quot;parentUUID&quot;:&quot;15c342cc-946c-4ef2-86ae-ab1bf90d90cb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;16ac99cf-aa6e-494b-804d-45e3415f9420&quot;,&quot;fd661479-cf1b-4122-8d7f-e3c6303a7a82&quot;,&quot;556b799b-fd37-4084-871f-fe4c8ba796ef&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2ef9554d-924e-4c42-8d46-0c864b1d2cb4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3d94ec00-e32e-4e60-b973-51224f897ea1&quot;,&quot;title&quot;:&quot;scrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2223edf0-6d44-408e-be2d-db0b5e43ce79&quot;,&quot;parentUUID&quot;:&quot;3d94ec00-e32e-4e60-b973-51224f897ea1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;cdf9b978-1301-4d8a-b2c5-2e66fabddc60&quot;,&quot;title&quot;:&quot;scryptcost&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b97a65b-4ebe-450c-b389-541a50e09975&quot;,&quot;parentUUID&quot;:&quot;cdf9b978-1301-4d8a-b2c5-2e66fabddc60&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df7fb3a6-fed7-4b29-b3b9-5f7438dac550&quot;,&quot;parentUUID&quot;:&quot;cdf9b978-1301-4d8a-b2c5-2e66fabddc60&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptcost: 12345\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 12345,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf9f910f-6b74-4031-bd35-ba85e26d050f&quot;,&quot;parentUUID&quot;:&quot;cdf9b978-1301-4d8a-b2c5-2e66fabddc60&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0b97a65b-4ebe-450c-b389-541a50e09975&quot;,&quot;df7fb3a6-fed7-4b29-b3b9-5f7438dac550&quot;,&quot;cf9f910f-6b74-4031-bd35-ba85e26d050f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9bba3528-0ce6-42ff-b088-81a0d12894f0&quot;,&quot;title&quot;:&quot;scryptblocksize&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;454092c1-6f3e-4dd0-9199-fd663f92c4f0&quot;,&quot;parentUUID&quot;:&quot;9bba3528-0ce6-42ff-b088-81a0d12894f0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5d79a6a9-f872-48ae-89a8-3333306c7f64&quot;,&quot;parentUUID&quot;:&quot;9bba3528-0ce6-42ff-b088-81a0d12894f0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptblocksize: 24\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 24,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d26e02f7-8438-48f6-b227-3d374faa1b73&quot;,&quot;parentUUID&quot;:&quot;9bba3528-0ce6-42ff-b088-81a0d12894f0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;454092c1-6f3e-4dd0-9199-fd663f92c4f0&quot;,&quot;5d79a6a9-f872-48ae-89a8-3333306c7f64&quot;,&quot;d26e02f7-8438-48f6-b227-3d374faa1b73&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b0981fba-d0a4-45d3-8577-f6542e1d3c90&quot;,&quot;title&quot;:&quot;scryptparallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d1e25fa4-d34a-4615-b0c0-16b3c18355a2&quot;,&quot;parentUUID&quot;:&quot;b0981fba-d0a4-45d3-8577-f6542e1d3c90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eeb2cd76-9e0c-4f82-acbf-ef7d90381236&quot;,&quot;parentUUID&quot;:&quot;b0981fba-d0a4-45d3-8577-f6542e1d3c90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptparallelism: 2\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d1ba3157-3d3f-4248-a4f7-f9e67a101cc5&quot;,&quot;parentUUID&quot;:&quot;b0981fba-d0a4-45d3-8577-f6542e1d3c90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d1e25fa4-d34a-4615-b0c0-16b3c18355a2&quot;,&quot;eeb2cd76-9e0c-4f82-acbf-ef7d90381236&quot;,&quot;d1ba3157-3d3f-4248-a4f7-f9e67a101cc5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2223edf0-6d44-408e-be2d-db0b5e43ce79&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;3f1af19a-4c44-4920-a891-42522280c799&quot;,&quot;title&quot;:&quot;argon2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cdd34ca5-9090-4a46-ab4e-35928f9a31cf&quot;,&quot;parentUUID&quot;:&quot;3f1af19a-4c44-4920-a891-42522280c799&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: 123\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d1625714-f182-41b0-8e68-fc33967c597c&quot;,&quot;parentUUID&quot;:&quot;3f1af19a-4c44-4920-a891-42522280c799&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;627568d4-175a-4c40-8d92-46389560f161&quot;,&quot;parentUUID&quot;:&quot;3f1af19a-4c44-4920-a891-42522280c799&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8e9847c5-f340-4f92-a4cb-511a7e099577&quot;,&quot;title&quot;:&quot;argon2time&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ea2501ac-d52f-4317-95d0-eb05988aa898&quot;,&quot;parentUUID&quot;:&quot;8e9847c5-f340-4f92-a4cb-511a7e099577&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2990ffac-960e-4698-bdee-66f60cc940ee&quot;,&quot;parentUUID&quot;:&quot;8e9847c5-f340-4f92-a4cb-511a7e099577&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2d&#x27;,\n  argon2time: 10\n}).should.deep.equal({\n  type: &#x27;argon2d&#x27;,\n  params: {\n    rounds: 10,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c25203e-ba35-4be6-885f-26a9eed3b82d&quot;,&quot;parentUUID&quot;:&quot;8e9847c5-f340-4f92-a4cb-511a7e099577&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ea2501ac-d52f-4317-95d0-eb05988aa898&quot;,&quot;2990ffac-960e-4698-bdee-66f60cc940ee&quot;,&quot;9c25203e-ba35-4be6-885f-26a9eed3b82d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bc6f74e6-574a-44e5-89b1-0ad7777921e2&quot;,&quot;title&quot;:&quot;argon2mem&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;18684516-0e23-4f54-8a01-9b9cfb70d4ff&quot;,&quot;parentUUID&quot;:&quot;bc6f74e6-574a-44e5-89b1-0ad7777921e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52b7143f-8830-44c1-886e-d30f5d2ec0db&quot;,&quot;parentUUID&quot;:&quot;bc6f74e6-574a-44e5-89b1-0ad7777921e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2i&#x27;,\n  argon2mem: 12345\n}).should.deep.equal({\n  type: &#x27;argon2i&#x27;,\n  params: {\n    rounds: 2,\n    memory: 12345,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63ec4b02-c401-4d3f-a270-fe5e9d4f728a&quot;,&quot;parentUUID&quot;:&quot;bc6f74e6-574a-44e5-89b1-0ad7777921e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;18684516-0e23-4f54-8a01-9b9cfb70d4ff&quot;,&quot;52b7143f-8830-44c1-886e-d30f5d2ec0db&quot;,&quot;63ec4b02-c401-4d3f-a270-fe5e9d4f728a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;29e66d76-0c4f-441f-8fc1-702e5d9c8068&quot;,&quot;title&quot;:&quot;argon2parallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81d33124-c6b9-4c48-b9ae-09f0cef7ec26&quot;,&quot;parentUUID&quot;:&quot;29e66d76-0c4f-441f-8fc1-702e5d9c8068&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;def1b2aa-8c76-4546-b0da-abb101b6f128&quot;,&quot;parentUUID&quot;:&quot;29e66d76-0c4f-441f-8fc1-702e5d9c8068&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2id&#x27;,\n  argon2parallelism: 2\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7f8571a-a952-40e8-a156-e68e9bd112cc&quot;,&quot;parentUUID&quot;:&quot;29e66d76-0c4f-441f-8fc1-702e5d9c8068&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;81d33124-c6b9-4c48-b9ae-09f0cef7ec26&quot;,&quot;def1b2aa-8c76-4546-b0da-abb101b6f128&quot;,&quot;e7f8571a-a952-40e8-a156-e68e9bd112cc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;cdd34ca5-9090-4a46-ab4e-35928f9a31cf&quot;,&quot;d1625714-f182-41b0-8e68-fc33967c597c&quot;,&quot;627568d4-175a-4c40-8d92-46389560f161&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2982f27d-e5f9-4adb-b3bc-9dbe7579c3d5&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2577722-93e2-4716-8cd9-51abe5d7757c&quot;,&quot;parentUUID&quot;:&quot;2982f27d-e5f9-4adb-b3bc-9dbe7579c3d5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c548f52f-c846-4fd1-9d7d-de1cea59f269&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4df8786-e583-4930-b5e6-26ff38bab09b&quot;,&quot;parentUUID&quot;:&quot;c548f52f-c846-4fd1-9d7d-de1cea59f269&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;hello-world&#x27; })\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b09e22d-430e-4c67-bcdc-b7810a055dda&quot;,&quot;parentUUID&quot;:&quot;c548f52f-c846-4fd1-9d7d-de1cea59f269&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ac0fb3f-177c-4967-8a9b-7a5aa8889e7b&quot;,&quot;parentUUID&quot;:&quot;c548f52f-c846-4fd1-9d7d-de1cea59f269&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1539a48-4e84-469e-b8ea-fde07958f778&quot;,&quot;parentUUID&quot;:&quot;c548f52f-c846-4fd1-9d7d-de1cea59f269&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a4df8786-e583-4930-b5e6-26ff38bab09b&quot;,&quot;7b09e22d-430e-4c67-bcdc-b7810a055dda&quot;,&quot;4ac0fb3f-177c-4967-8a9b-7a5aa8889e7b&quot;,&quot;b1539a48-4e84-469e-b8ea-fde07958f778&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:208,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e2997efd-f7cf-4483-8318-2ac7b54d3dce&quot;,&quot;title&quot;:&quot;size&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key size default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.size.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a13a23c-f3d7-42ca-897c-50339c25a0e5&quot;,&quot;parentUUID&quot;:&quot;e2997efd-f7cf-4483-8318-2ac7b54d3dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key size valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 64 })\npolicy.size.should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;387f57c7-9a2b-4868-9bd5-b8ebf2c410a4&quot;,&quot;parentUUID&quot;:&quot;e2997efd-f7cf-4483-8318-2ac7b54d3dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9becd58f-7d8c-4fbe-9d4b-82f2a6f5872a&quot;,&quot;parentUUID&quot;:&quot;e2997efd-f7cf-4483-8318-2ac7b54d3dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 0 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7675f674-9003-4c42-8697-9511ad598705&quot;,&quot;parentUUID&quot;:&quot;e2997efd-f7cf-4483-8318-2ac7b54d3dce&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6a13a23c-f3d7-42ca-897c-50339c25a0e5&quot;,&quot;387f57c7-9a2b-4868-9bd5-b8ebf2c410a4&quot;,&quot;9becd58f-7d8c-4fbe-9d4b-82f2a6f5872a&quot;,&quot;7675f674-9003-4c42-8697-9511ad598705&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:207,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d069bb45-ff34-4b41-accd-2b201d1c7126&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;88f08683-3a27-4cbb-be11-02a262f002d6&quot;,&quot;parentUUID&quot;:&quot;d069bb45-ff34-4b41-accd-2b201d1c7126&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 1 })\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;18111267-8207-47fd-8bdb-e996f4b4686b&quot;,&quot;parentUUID&quot;:&quot;d069bb45-ff34-4b41-accd-2b201d1c7126&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c81126f3-5cd1-469f-b32b-e648062499e8&quot;,&quot;parentUUID&quot;:&quot;d069bb45-ff34-4b41-accd-2b201d1c7126&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 0 }).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 2 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2233efd-12d2-496d-a5e3-02b0cddfc6ed&quot;,&quot;parentUUID&quot;:&quot;d069bb45-ff34-4b41-accd-2b201d1c7126&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;88f08683-3a27-4cbb-be11-02a262f002d6&quot;,&quot;18111267-8207-47fd-8bdb-e996f4b4686b&quot;,&quot;c81126f3-5cd1-469f-b32b-e648062499e8&quot;,&quot;c2233efd-12d2-496d-a5e3-02b0cddfc6ed&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:209,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;711fa05c-c907-4302-afb8-7a002c3d5d5b&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 48 })\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(48)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6186f824-3e0b-443b-989b-4fa0a92a6547&quot;,&quot;parentUUID&quot;:&quot;711fa05c-c907-4302-afb8-7a002c3d5d5b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: Buffer.from(&#x27;12345678&#x27;, &#x27;base64&#x27;) })\npolicy.salt.should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00bcee41-06f9-4ba7-95ed-26edbf876ce1&quot;,&quot;parentUUID&quot;:&quot;711fa05c-c907-4302-afb8-7a002c3d5d5b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cabf48ab-d602-48e1-9081-19a51147268b&quot;,&quot;parentUUID&quot;:&quot;711fa05c-c907-4302-afb8-7a002c3d5d5b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6186f824-3e0b-443b-989b-4fa0a92a6547&quot;,&quot;00bcee41-06f9-4ba7-95ed-26edbf876ce1&quot;,&quot;cabf48ab-d602-48e1-9081-19a51147268b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:206,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d5be0c77-3e34-449a-aa78-be6402c6222a&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e80e47fc-cd71-4ff4-8d36-538ff0c999fd&quot;,&quot;parentUUID&quot;:&quot;d5be0c77-3e34-449a-aa78-be6402c6222a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ac9ee55-7fd9-4073-9c41-fd486df6be46&quot;,&quot;parentUUID&quot;:&quot;d5be0c77-3e34-449a-aa78-be6402c6222a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: 12345,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: 12345\n  }\n]).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d18bb75c-9078-4915-acd2-4fe9dc48a143&quot;,&quot;parentUUID&quot;:&quot;d5be0c77-3e34-449a-aa78-be6402c6222a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;671e8966-0e0d-4ce1-a03d-635a1346d9d0&quot;,&quot;parentUUID&quot;:&quot;d5be0c77-3e34-449a-aa78-be6402c6222a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e80e47fc-cd71-4ff4-8d36-538ff0c999fd&quot;,&quot;5ac9ee55-7fd9-4073-9c41-fd486df6be46&quot;,&quot;d18bb75c-9078-4915-acd2-4fe9dc48a143&quot;,&quot;671e8966-0e0d-4ce1-a03d-635a1346d9d0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:106,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e2577722-93e2-4716-8cd9-51abe5d7757c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:108,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;9.2.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mochawesome&quot;,&quot;reportTitle&quot;:&quot;MFKDF&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>