<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:76,&quot;tests&quot;:309,&quot;passes&quot;:309,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2022-04-28T18:14:42.108Z&quot;,&quot;end&quot;:&quot;2022-04-28T18:16:01.898Z&quot;,&quot;duration&quot;:79790,&quot;testsRegistered&quot;:309,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;c8220841-2232-475b-9775-3ebbecde5e78&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a8f09e30-4d3b-44af-bd62-e1c2365767e7&quot;,&quot;title&quot;:&quot;asymmetric&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;67f89333-1497-4255-adab-af19f77fdee0&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:335,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa1024&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8b4e4626-52fa-41fe-925b-374bac5c0b75&quot;,&quot;parentUUID&quot;:&quot;67f89333-1497-4255-adab-af19f77fdee0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2193,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa2048&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f06665b5-2f79-403d-9e0e-0a596e8346bf&quot;,&quot;parentUUID&quot;:&quot;67f89333-1497-4255-adab-af19f77fdee0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8b4e4626-52fa-41fe-925b-374bac5c0b75&quot;,&quot;f06665b5-2f79-403d-9e0e-0a596e8346bf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2528,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;title&quot;:&quot;signatures&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:495,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c1760f3-b821-4636-8b17-2cf8064891b4&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1757,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa2048&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c06deaf-703a-4574-9e9b-d9df2912a1a8&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa3072&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa3072&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11596,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa3072&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa3072&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d43d900-3f25-431b-88e8-7b1f54a3948e&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature)\nvalidity.should.be.true\nawait setup.getAsymmetricKeyPair()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6da9810-086a-4dad-ae06-50b8c7d73830&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ed25519&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures ed25519&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:122,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nawait setup.getAsymmetricKeyPair(&#x27;ed25519&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ab1d633f-6c3f-4f4e-a295-8d349757982b&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;unknown&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures unknown&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.getAsymmetricKeyPair(&#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7dd25051-f569-4187-8f18-e8a0e341b4d1&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7578,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.sign(12345, &#x27;rsa1024&#x27;).should.be.rejectedWith(TypeError)\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nsetup.verify(12345, signature).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;46b4f7e5-230f-4dd3-b36e-70818162039b&quot;,&quot;parentUUID&quot;:&quot;f792f008-0f28-4db2-b373-de123baac7ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5c1760f3-b821-4636-8b17-2cf8064891b4&quot;,&quot;5c06deaf-703a-4574-9e9b-d9df2912a1a8&quot;,&quot;0d43d900-3f25-431b-88e8-7b1f54a3948e&quot;,&quot;b6da9810-086a-4dad-ae06-50b8c7d73830&quot;,&quot;ab1d633f-6c3f-4f4e-a295-8d349757982b&quot;,&quot;7dd25051-f569-4187-8f18-e8a0e341b4d1&quot;,&quot;46b4f7e5-230f-4dd3-b36e-70818162039b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:29767,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;encrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:240,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9ebda0e-8f66-4cd6-b61f-922738bd2192&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;819a0280-7280-4728-be23-c5094c905191&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96d86698-e672-4c1d-a675-e8ad228bbd87&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b530ed1-9ec4-4179-b866-259b54c0b19a&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f7dc0649-5b9c-41b2-a337-9b4f5f6d2f3a&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8b05ef9e-0318-4757-bcf1-c311468f1509&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0bc69e0a-ac58-46ac-97b4-c2de35e0c88c&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8024973-7f3a-48ef-882f-31efb16805f3&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:237,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c0373a2-d30b-4476-958b-f31968cf010e&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;299a2e79-a08d-46e0-b3b8-59c465abd97a&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df503e06-6de0-4995-9f39-8f761bf09c4d&quot;,&quot;parentUUID&quot;:&quot;f03b9231-653a-4453-8e14-cf49615d527a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c9507bb0-d76b-4e1b-a78a-fd662ecf33e5&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSubkey(32, &#x27;AES256&#x27;, &#x27;sha256&#x27;)\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey(32, &#x27;&#x27;, &#x27;sha512&#x27;)\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d263fb21-1008-4e85-a938-ad8d63f80695&quot;,&quot;parentUUID&quot;:&quot;c9507bb0-d76b-4e1b-a78a-fd662ecf33e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;symmetric key&quot;,&quot;fullTitle&quot;:&quot;encrypt utils symmetric key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSymmetricKey()\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99b02017-f5cf-4d44-9ea2-3922df0632d8&quot;,&quot;parentUUID&quot;:&quot;c9507bb0-d76b-4e1b-a78a-fd662ecf33e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d263fb21-1008-4e85-a938-ad8d63f80695&quot;,&quot;99b02017-f5cf-4d44-9ea2-3922df0632d8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:208,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e773ad9b-92c6-4e9c-9703-bd50ffd9d488&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid key&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(&#x27;hello world&#x27;, &#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d06b133e-5288-4ebb-8741-fccb0a0f7dd8&quot;,&quot;parentUUID&quot;:&quot;e773ad9b-92c6-4e9c-9703-bd50ffd9d488&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid message&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db394e02-c647-4683-953a-55e0dde7efdf&quot;,&quot;parentUUID&quot;:&quot;e773ad9b-92c6-4e9c-9703-bd50ffd9d488&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid ciphertext&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid ciphertext&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.decrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;750af0aa-0e56-4765-a318-792cd924d660&quot;,&quot;parentUUID&quot;:&quot;e773ad9b-92c6-4e9c-9703-bd50ffd9d488&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d06b133e-5288-4ebb-8741-fccb0a0f7dd8&quot;,&quot;db394e02-c647-4683-953a-55e0dde7efdf&quot;,&quot;750af0aa-0e56-4765-a318-792cd924d660&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:320,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;a9ebda0e-8f66-4cd6-b61f-922738bd2192&quot;,&quot;819a0280-7280-4728-be23-c5094c905191&quot;,&quot;96d86698-e672-4c1d-a675-e8ad228bbd87&quot;,&quot;1b530ed1-9ec4-4179-b866-259b54c0b19a&quot;,&quot;f7dc0649-5b9c-41b2-a337-9b4f5f6d2f3a&quot;,&quot;8b05ef9e-0318-4757-bcf1-c311468f1509&quot;,&quot;0bc69e0a-ac58-46ac-97b4-c2de35e0c88c&quot;,&quot;a8024973-7f3a-48ef-882f-31efb16805f3&quot;,&quot;1c0373a2-d30b-4476-958b-f31968cf010e&quot;,&quot;299a2e79-a08d-46e0-b3b8-59c465abd97a&quot;,&quot;df503e06-6de0-4995-9f39-8f761bf09c4d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2471,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;93afa967-8e3b-4556-af90-da9232c0aa59&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ad5bf83-e67b-4543-8232-de935b0c7735&quot;,&quot;parentUUID&quot;:&quot;93afa967-8e3b-4556-af90-da9232c0aa59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e62dbe2c-af8e-4295-bb4e-02f0a25fb1d7&quot;,&quot;parentUUID&quot;:&quot;93afa967-8e3b-4556-af90-da9232c0aa59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7ad5bf83-e67b-4543-8232-de935b0c7735&quot;,&quot;e62dbe2c-af8e-4295-bb4e-02f0a25fb1d7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8239ddc8-4f96-4a5c-96c4-9b887f4f3fd5&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0417c55-322f-456d-8149-1a88450ed109&quot;,&quot;parentUUID&quot;:&quot;8239ddc8-4f96-4a5c-96c4-9b887f4f3fd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;18006c23-0d9a-4cf4-bc45-918f108ed7a1&quot;,&quot;parentUUID&quot;:&quot;8239ddc8-4f96-4a5c-96c4-9b887f4f3fd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d0417c55-322f-456d-8149-1a88450ed109&quot;,&quot;18006c23-0d9a-4cf4-bc45-918f108ed7a1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9032ab32-ccb2-4b49-a69f-66ec4550bbf6&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:566,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a126d159-8cd9-4dd2-8489-9d9c86115f24&quot;,&quot;parentUUID&quot;:&quot;9032ab32-ccb2-4b49-a69f-66ec4550bbf6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:567,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7fb7c9f7-3978-4667-84a0-c54a03d38be3&quot;,&quot;parentUUID&quot;:&quot;9032ab32-ccb2-4b49-a69f-66ec4550bbf6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nmfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73fbf12c-8013-456c-ac2d-41fc38d66bac&quot;,&quot;parentUUID&quot;:&quot;9032ab32-ccb2-4b49-a69f-66ec4550bbf6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3766a88b-2cec-469e-8b16-ec6d8f0b0c19&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:439,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b090712-29ae-4197-ae65-a929ae185977&quot;,&quot;parentUUID&quot;:&quot;3766a88b-2cec-469e-8b16-ec6d8f0b0c19&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3b090712-29ae-4197-ae65-a929ae185977&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:439,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;4c306d51-2aa6-4ecc-b14b-a3b0bdfe12d2&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f78196b4-4608-4e79-a684-a8e5b5e57cee&quot;,&quot;parentUUID&quot;:&quot;4c306d51-2aa6-4ecc-b14b-a3b0bdfe12d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:117,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e6eb4bf3-4493-489e-ab84-b9723c065a2f&quot;,&quot;parentUUID&quot;:&quot;4c306d51-2aa6-4ecc-b14b-a3b0bdfe12d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f78196b4-4608-4e79-a684-a8e5b5e57cee&quot;,&quot;e6eb4bf3-4493-489e-ab84-b9723c065a2f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:231,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;a126d159-8cd9-4dd2-8489-9d9c86115f24&quot;,&quot;7fb7c9f7-3978-4667-84a0-c54a03d38be3&quot;,&quot;73fbf12c-8013-456c-ac2d-41fc38d66bac&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1245,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e48926f1-b12f-4a67-91ea-1897018e3a63&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;kdf&quot;,&quot;fullTitle&quot;:&quot;examples kdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup kdf configuration\nconst config = await mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000,\n  pbkdf2digest: &#x27;sha256&#x27;\n}) // -&gt; { type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } }\n// derive key\nconst key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 8, config)\nkey.toString(&#x27;hex&#x27;) // -&gt; 0394a2ede332c9a1\nconfig.should.deep.equal({ type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } })\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;0394a2ede332c9a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;513db132-e06f-44c0-8a36-999ff633120a&quot;,&quot;parentUUID&quot;:&quot;e48926f1-b12f-4a67-91ea-1897018e3a63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ac2a5ad-08d0-4b36-aef3-f2a68ff7d3f0&quot;,&quot;parentUUID&quot;:&quot;e48926f1-b12f-4a67-91ea-1897018e3a63&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d37b157-27bd-4a3d-953f-7be9c2af84f3&quot;,&quot;parentUUID&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n], { size: 8 })\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response = crypto.createHmac(&#x27;sha1&#x27;, secret).update(challenge).digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1bb00fb6-3c86-4881-9edb-4c90ad8301be&quot;,&quot;parentUUID&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1152,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n], { size: 8 })\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96ff2351-fb19-4905-8a81-65425dad580e&quot;,&quot;parentUUID&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:236,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) })\n], { size: 8 })\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b3e5eafe-6fd9-4ef9-8ca3-991e0964b810&quot;,&quot;parentUUID&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 8 })\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e8d679b1-57d0-402a-924b-62e5d68bfb5b&quot;,&quot;parentUUID&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n], { size: 8 })\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed60c4a1-a9a4-4b85-ae04-d17f51819b1c&quot;,&quot;parentUUID&quot;:&quot;6ac631ba-807f-4fd1-82cd-30235ea1411f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8d37b157-27bd-4a3d-953f-7be9c2af84f3&quot;,&quot;1bb00fb6-3c86-4881-9edb-4c90ad8301be&quot;,&quot;96ff2351-fb19-4905-8a81-65425dad580e&quot;,&quot;b3e5eafe-6fd9-4ef9-8ca3-991e0964b810&quot;,&quot;e8d679b1-57d0-402a-924b-62e5d68bfb5b&quot;,&quot;ed60c4a1-a9a4-4b85-ae04-d17f51819b1c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2256,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a075092c-1c96-4783-8ad4-9173039587d9&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(Buffer.from(&#x27;hello world&#x27;), 2, 3) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79b1f2fd-400c-44b8-b275-9dceccc58cb2&quot;,&quot;parentUUID&quot;:&quot;a075092c-1c96-4783-8ad4-9173039587d9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;79b1f2fd-400c-44b8-b275-9dceccc58cb2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b4fc73a2-9310-4a8a-8924-f28559ef9ca6&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;15196ae7-e244-4f7e-81f7-cd7bee21cca0&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordA&#x27;, &#x27;passwordC&#x27;]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordB&#x27;, &#x27;passwordC&#x27;]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;360b3382-12e0-4ff9-8680-44fd2a3a5d41&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:231,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  ), { size: 8 }\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c3286080-a642-4ba7-bf50-d0b34106ac63&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6291c28b-379e-40a6-ac24-dae0bdd09972&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a782fc4a-1387-430f-bb96-0cc73f843a0d&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01a5d884-a5b8-4c7b-8f35-c34ad82bac9f&quot;,&quot;parentUUID&quot;:&quot;a2a99eee-ab16-4ff4-b770-741f8fe1d6af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b4fc73a2-9310-4a8a-8924-f28559ef9ca6&quot;,&quot;15196ae7-e244-4f7e-81f7-cd7bee21cca0&quot;,&quot;360b3382-12e0-4ff9-8680-44fd2a3a5d41&quot;,&quot;c3286080-a642-4ba7-bf50-d0b34106ac63&quot;,&quot;6291c28b-379e-40a6-ac24-dae0bdd09972&quot;,&quot;a782fc4a-1387-430f-bb96-0cc73f843a0d&quot;,&quot;01a5d884-a5b8-4c7b-8f35-c34ad82bac9f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1219,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9f8ea32-65e2-4186-aef3-b57263ca697d&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b199351-e52f-4af5-a550-ce7de55ab7ac&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d05089cb-6df6-4db8-b457-31cab1265d99&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9bb7b190-9b53-4f45-b4f1-b03eba41f949&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a20eb55c-c600-40bd-a1c7-da02dc817051&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c16f4cf-7d88-488a-9541-0167c2bfadf8&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:214,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10c22537-a605-4231-b198-b5475eead5cc&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ce0209f-fddd-42cc-b17d-db0362933324&quot;,&quot;parentUUID&quot;:&quot;c0288bfd-531e-4478-8218-238209f61966&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d9f8ea32-65e2-4186-aef3-b57263ca697d&quot;,&quot;6b199351-e52f-4af5-a550-ce7de55ab7ac&quot;,&quot;d05089cb-6df6-4db8-b457-31cab1265d99&quot;,&quot;9bb7b190-9b53-4f45-b4f1-b03eba41f949&quot;,&quot;a20eb55c-c600-40bd-a1c7-da02dc817051&quot;,&quot;3c16f4cf-7d88-488a-9541-0167c2bfadf8&quot;,&quot;10c22537-a605-4231-b198-b5475eead5cc&quot;,&quot;7ce0209f-fddd-42cc-b17d-db0362933324&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1730,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9042ef56-4167-408b-9990-9f199a39bbe1&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b1d55f01-9b02-4122-a63a-850f39cb6c0c&quot;,&quot;parentUUID&quot;:&quot;9042ef56-4167-408b-9990-9f199a39bbe1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b1d55f01-9b02-4122-a63a-850f39cb6c0c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:217,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ee3d0b74-ea99-484e-8f49-f6f35dcfe5df&quot;,&quot;title&quot;:&quot;envelope&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;add/get secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:213,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0b09510-d303-40d4-be9b-e02e53919bfa&quot;,&quot;parentUUID&quot;:&quot;ee3d0b74-ea99-484e-8f49-f6f35dcfe5df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/check/remove secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/check/remove secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// check secret\nconst check1 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; true\n// remove secret\nderived.removeEnvelopedSecret(&#x27;mySecret&#x27;)\n// check secret\nconst check2 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; false\ncheck1.should.be.true\ncheck2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2cc8d1a-b640-4cb4-af00-f454c5882658&quot;,&quot;parentUUID&quot;:&quot;ee3d0b74-ea99-484e-8f49-f6f35dcfe5df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/get key&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:236,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c940f712-aba5-41de-ad30-a5f5d1ca1c83&quot;,&quot;parentUUID&quot;:&quot;ee3d0b74-ea99-484e-8f49-f6f35dcfe5df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f0b09510-d303-40d4-be9b-e02e53919bfa&quot;,&quot;f2cc8d1a-b640-4cb4-af00-f454c5882658&quot;,&quot;c940f712-aba5-41de-ad30-a5f5d1ca1c83&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:667,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;56f654b7-732a-4f82-9ae7-6c2fab5c699a&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte sub-key for \&quot;eth\&quot; using hkdf/sha256\nconst subkey = await key.getSubkey(16, &#x27;eth&#x27;, &#x27;sha256&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 54ad9e5acbc1c33b08a15dd79126e9c9&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9864b85-8539-49b7-bb69-7bb573572b2e&quot;,&quot;parentUUID&quot;:&quot;56f654b7-732a-4f82-9ae7-6c2fab5c699a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getSymmetricKey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSymmetricKey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte AES128 sub-key\nconst subkey = await key.getSymmetricKey(&#x27;aes128&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; c985454e008e5ecc695e865d339cb2be&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;721e6b1d-8644-4bdf-bae2-6458ba995fff&quot;,&quot;parentUUID&quot;:&quot;56f654b7-732a-4f82-9ae7-6c2fab5c699a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getAsymmetricKeyPair&quot;,&quot;fullTitle&quot;:&quot;examples crypto getAsymmetricKeyPair&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:151,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte RSA1024 sub-key\nconst subkey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;) // -&gt; { privateKey: Uint8Array, publicKey: Uint8Array }\nsubkey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;644b458d-95da-4351-8202-932ee65d97e3&quot;,&quot;parentUUID&quot;:&quot;56f654b7-732a-4f82-9ae7-6c2fab5c699a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;sign/verify&quot;,&quot;fullTitle&quot;:&quot;examples crypto sign/verify&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:845,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// sign message using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature using RSA-1024\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6b47133-bdf3-4d32-9963-5e71a8b013d6&quot;,&quot;parentUUID&quot;:&quot;56f654b7-732a-4f82-9ae7-6c2fab5c699a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypt/decrypt&quot;,&quot;fullTitle&quot;:&quot;examples crypto encrypt/decrypt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// encrypt message using 3DES\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\n// decrypt message using 3DES\nconst decrypted = await key.decrypt(encrypted, &#x27;3des&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c3c42a50-5f3e-4670-b947-6a656dfcfe37&quot;,&quot;parentUUID&quot;:&quot;56f654b7-732a-4f82-9ae7-6c2fab5c699a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c9864b85-8539-49b7-bb69-7bb573572b2e&quot;,&quot;721e6b1d-8644-4bdf-bae2-6458ba995fff&quot;,&quot;644b458d-95da-4351-8202-932ee65d97e3&quot;,&quot;b6b47133-bdf3-4d32-9963-5e71a8b013d6&quot;,&quot;c3c42a50-5f3e-4670-b947-6a656dfcfe37&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1324,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;title&quot;:&quot;auth&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ecf41cca-5f17-4f4d-afe4-39ff3a6490be&quot;,&quot;parentUUID&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:318,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3bf41be3-c0c6-43c6-a76c-7d5c325359d6&quot;,&quot;parentUUID&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96ee6289-da1d-4ba3-8b3a-77dbc5da33fe&quot;,&quot;parentUUID&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9d15bbdf-0b69-487c-be83-6caf15ed0ca3&quot;,&quot;parentUUID&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:264,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cc951134-6dee-49c6-b9c4-440541c82af3&quot;,&quot;parentUUID&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;37790055-31ab-4e11-b8b3-6da888610a8b&quot;,&quot;parentUUID&quot;:&quot;75b5a1bc-db03-4f8f-98ee-e20c4aa5092f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ecf41cca-5f17-4f4d-afe4-39ff3a6490be&quot;,&quot;3bf41be3-c0c6-43c6-a76c-7d5c325359d6&quot;,&quot;96ee6289-da1d-4ba3-8b3a-77dbc5da33fe&quot;,&quot;9d15bbdf-0b69-487c-be83-6caf15ed0ca3&quot;,&quot;cc951134-6dee-49c6-b9c4-440541c82af3&quot;,&quot;37790055-31ab-4e11-b8b3-6da888610a8b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1009,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;513db132-e06f-44c0-8a36-999ff633120a&quot;,&quot;4ac2a5ad-08d0-4b36-aef3-f2a68ff7d3f0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:239,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Auth&quot;,&quot;fullTitle&quot;:&quot;tutorials Auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e6452430-a1ae-4e43-81ec-7bac08995747&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloepd Key&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloepd Key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d97e5cad-bf3e-433a-a489-596cffde617f&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloped Secret&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloped Secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;54c8229e-0702-4be1-b70a-1437193765a7&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4aa3e977-6c26-4154-b86c-dfeea787b17d&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Signing &amp; Verification&quot;,&quot;fullTitle&quot;:&quot;tutorials Signing &amp; Verification&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:193,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// sign message with derived key using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d1db6c2-6215-45f0-9675-a5576df50e22&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Encryption &amp; Decryption&quot;,&quot;fullTitle&quot;:&quot;tutorials Encryption &amp; Decryption&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// encrypt secret with derived key using AES-256\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;aes256&#x27;)\n// ... later, decrypt secret with derived key\nconst decrypted = await key.decrypt(encrypted, &#x27;aes256&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;93f4d55f-a46d-4c64-a75c-b7d40a876e86&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// reconstitute key to change password\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;newPassword&#x27;))\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d18d295-a93b-4e63-85ee-d20572348d8d&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5a5c1b5a-8ab5-47ee-9e2c-dc60c9113a77&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:232,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6805ba50-9972-4304-81c5-889ad8253372&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16, threshold: 2 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a37a8e53-7c69-4a41-8e90-7f0e4ea5a63a&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:641,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n], { size: 32 })\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n], { size: 32 })\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n], { size: 32 })\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32 })\nconst threshold = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32, threshold: 2 })\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a15a97a5-2855-409a-a82e-6c6c7dedf080&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31ccd246-0bb4-4239-9859-24feb207402f&quot;,&quot;parentUUID&quot;:&quot;b51698ff-c5bf-466b-9d4e-5f81250015c9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e6452430-a1ae-4e43-81ec-7bac08995747&quot;,&quot;d97e5cad-bf3e-433a-a489-596cffde617f&quot;,&quot;54c8229e-0702-4be1-b70a-1437193765a7&quot;,&quot;4aa3e977-6c26-4154-b86c-dfeea787b17d&quot;,&quot;7d1db6c2-6215-45f0-9675-a5576df50e22&quot;,&quot;93f4d55f-a46d-4c64-a75c-b7d40a876e86&quot;,&quot;8d18d295-a93b-4e63-85ee-d20572348d8d&quot;,&quot;5a5c1b5a-8ab5-47ee-9e2c-dc60c9113a77&quot;,&quot;6805ba50-9972-4304-81c5-889ad8253372&quot;,&quot;a37a8e53-7c69-4a41-8e90-7f0e4ea5a63a&quot;,&quot;a15a97a5-2855-409a-a82e-6c6c7dedf080&quot;,&quot;31ccd246-0bb4-4239-9859-24feb207402f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2682,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d8974410-9335-4547-8f6d-9e821cf68fd5&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key)\n  .update(challenge)\n  .digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2af3023-2ddf-41bf-b3f3-4513431ad48c&quot;,&quot;parentUUID&quot;:&quot;d8974410-9335-4547-8f6d-9e821cf68fd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:321,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response1 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(derive1.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response2 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d239073e-a757-400b-9445-2ca4828bca44&quot;,&quot;parentUUID&quot;:&quot;d8974410-9335-4547-8f6d-9e821cf68fd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v1.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;kdf\&quot;:{\&quot;type\&quot;:\&quot;argon2id\&quot;,\&quot;params\&quot;:{\&quot;rounds\&quot;:2,\&quot;memory\&quot;:24576,\&quot;parallelism\&quot;:1}},\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;f8d33204be0436f2629d5173e9bd3fc1953cf982\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(JSON.parse(setup), {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;))\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(&#x27;ca76d2b456be4e40ba6ef65a68fbfc71bf27a0ca3e0fa4481a2ddf29fb6b65d9&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e8356f1e-ea42-4fce-9e6b-1d1433f80110&quot;,&quot;parentUUID&quot;:&quot;d8974410-9335-4547-8f6d-9e821cf68fd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;55111d74-efdd-4dc5-8560-37032c6c5dc3&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8220bf7-1b3f-4fe5-8d9a-ada5c2519a19&quot;,&quot;parentUUID&quot;:&quot;55111d74-efdd-4dc5-8560-37032c6c5dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1308a85a-f34a-4e91-be15-f9a4a74a4a9c&quot;,&quot;parentUUID&quot;:&quot;55111d74-efdd-4dc5-8560-37032c6c5dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ec505ea-3f27-45c2-81be-2fb8b1e175fe&quot;,&quot;parentUUID&quot;:&quot;55111d74-efdd-4dc5-8560-37032c6c5dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2bf99c2e-3391-4b10-b6f0-f4de88a0c5ee&quot;,&quot;parentUUID&quot;:&quot;55111d74-efdd-4dc5-8560-37032c6c5dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1ea6e84b-42b7-44c1-80f5-4ad2976b1e5b&quot;,&quot;parentUUID&quot;:&quot;55111d74-efdd-4dc5-8560-37032c6c5dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f8220bf7-1b3f-4fe5-8d9a-ada5c2519a19&quot;,&quot;1308a85a-f34a-4e91-be15-f9a4a74a4a9c&quot;,&quot;0ec505ea-3f27-45c2-81be-2fb8b1e175fe&quot;,&quot;2bf99c2e-3391-4b10-b6f0-f4de88a0c5ee&quot;,&quot;1ea6e84b-42b7-44c1-80f5-4ad2976b1e5b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e2af3023-2ddf-41bf-b3f3-4513431ad48c&quot;,&quot;d239073e-a757-400b-9445-2ca4828bca44&quot;,&quot;e8356f1e-ea42-4fce-9e6b-1d1433f80110&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:429,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1bc6ca3c-9c63-458d-8b19-67d3f22a4525&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:433,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(891649)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(795484)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19a30eed-1e99-4564-beae-2479df1d4640&quot;,&quot;parentUUID&quot;:&quot;1bc6ca3c-9c63-458d-8b19-67d3f22a4525&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d5b7faf-3157-475c-87ea-7254cf0c97c5&quot;,&quot;parentUUID&quot;:&quot;1bc6ca3c-9c63-458d-8b19-67d3f22a4525&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6adc45f6-fc19-423f-aa31-b31edd3c9c61&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ef5bb10-824f-495e-a063-3c29001d1515&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3e25c03f-b26f-4e44-99a4-4a70cf4ac532&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee29fff1-507a-439e-b51a-e9f928e22592&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de9593d2-3f43-409c-adca-390c46e6f1bb&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;323f55fd-5018-4363-98e2-dd4b0f4d4e42&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b31505ad-0d33-4d45-9420-a9f9510668bd&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae10f472-7ae9-45d6-87a3-1e745dc393e2&quot;,&quot;parentUUID&quot;:&quot;2f974021-88b0-4c72-92bb-5fb6ea15c45b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6adc45f6-fc19-423f-aa31-b31edd3c9c61&quot;,&quot;8ef5bb10-824f-495e-a063-3c29001d1515&quot;,&quot;3e25c03f-b26f-4e44-99a4-4a70cf4ac532&quot;,&quot;ee29fff1-507a-439e-b51a-e9f928e22592&quot;,&quot;de9593d2-3f43-409c-adca-390c46e6f1bb&quot;,&quot;323f55fd-5018-4363-98e2-dd4b0f4d4e42&quot;,&quot;b31505ad-0d33-4d45-9420-a9f9510668bd&quot;,&quot;ae10f472-7ae9-45d6-87a3-1e745dc393e2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;19a30eed-1e99-4564-beae-2479df1d4640&quot;,&quot;6d5b7faf-3157-475c-87ea-7254cf0c97c5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:538,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;76c58069-6a2e-442b-8872-a100fd8b5633&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;97784cc5-e640-424b-87c5-b80d6090aec7&quot;,&quot;parentUUID&quot;:&quot;76c58069-6a2e-442b-8872-a100fd8b5633&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa267fc3-a1eb-4baa-a5e6-c29a46697dfe&quot;,&quot;parentUUID&quot;:&quot;76c58069-6a2e-442b-8872-a100fd8b5633&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;97784cc5-e640-424b-87c5-b80d6090aec7&quot;,&quot;fa267fc3-a1eb-4baa-a5e6-c29a46697dfe&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:218,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7c7f7417-276c-4b05-9ab0-d34e90be5ac0&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7b6d111-6b3b-464a-a8a7-138250d31011&quot;,&quot;parentUUID&quot;:&quot;7c7f7417-276c-4b05-9ab0-d34e90be5ac0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d7726351-0c5b-4257-8e4a-0e78a601645e&quot;,&quot;parentUUID&quot;:&quot;7c7f7417-276c-4b05-9ab0-d34e90be5ac0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:340,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ], { id: &#x27;stack1&#x27; }),\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ], { id: &#x27;stack2&#x27; })\n], { threshold: 1 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a8919d0-7a6d-4940-8a91-0464dc1fd080&quot;,&quot;parentUUID&quot;:&quot;7c7f7417-276c-4b05-9ab0-d34e90be5ac0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b7b6d111-6b3b-464a-a8a7-138250d31011&quot;,&quot;d7726351-0c5b-4257-8e4a-0e78a601645e&quot;,&quot;1a8919d0-7a6d-4940-8a91-0464dc1fd080&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:342,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1e1f4228-551f-4230-abb0-e306d9a4f7a4&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])\nconst code = parseInt(speakeasy.totp({\n  secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n  encoding: &#x27;hex&#x27;,\n  step: setup.outputs.totp.period,\n  algorithm: setup.outputs.totp.algorithm,\n  digits: setup.outputs.totp.digits\n}))\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e466134-47da-49e5-97e7-c6c2079c6a5d&quot;,&quot;parentUUID&quot;:&quot;1e1f4228-551f-4230-abb0-e306d9a4f7a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1130,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(99922, { time: 1650430991083 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(398884, { time: 1650431018392 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c2675c4-41a7-4dcf-93ad-fe229405bad8&quot;,&quot;parentUUID&quot;:&quot;1e1f4228-551f-4230-abb0-e306d9a4f7a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:728,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dbd1d183-26d2-4169-a1f0-55eeda1d7ac8&quot;,&quot;parentUUID&quot;:&quot;1e1f4228-551f-4230-abb0-e306d9a4f7a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2690e80-8eea-458a-a320-8cf3fbd72ae3&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:751,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nmfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1750430943604 })\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e31f74f-685e-4a06-838e-a67ac96475d9&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c48a716a-0796-44fb-9290-68b8a6eeecd7&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f53a8793-984f-4c6c-8be0-9332ee93e438&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09af7cfb-a74e-4436-9050-75b82a96e1be&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f7f1b51-be7b-4156-9a65-ead3171a7631&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c679bddf-abfc-4a6e-8414-beebcc6f2829&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2565a08-e6e6-41aa-b204-deea833ad1aa&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;323c07e7-9df0-4e52-bbd2-705d80d59c5c&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e5b7df5c-4a65-4a5b-ba93-322f9d0f0fce&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2cfc7327-437a-46e7-8bcd-f24f37d3d53d&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b9b3a38-4703-45f7-af02-abc82d6a3b90&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9ba4515-7d95-4e70-823f-07d8efc1a1af&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21e28b48-ebb3-48f6-8892-b2f43c7564da&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1ef25c13-538c-426a-9de5-2cab06adf717&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a3fe602e-d8dc-4bcf-a146-334a242a58d2&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c854daf7-8121-42a9-9974-eff88b3b74aa&quot;,&quot;parentUUID&quot;:&quot;8ff7df3c-ec61-437b-aa95-931be0edb1af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e2690e80-8eea-458a-a320-8cf3fbd72ae3&quot;,&quot;7e31f74f-685e-4a06-838e-a67ac96475d9&quot;,&quot;c48a716a-0796-44fb-9290-68b8a6eeecd7&quot;,&quot;f53a8793-984f-4c6c-8be0-9332ee93e438&quot;,&quot;09af7cfb-a74e-4436-9050-75b82a96e1be&quot;,&quot;6f7f1b51-be7b-4156-9a65-ead3171a7631&quot;,&quot;c679bddf-abfc-4a6e-8414-beebcc6f2829&quot;,&quot;f2565a08-e6e6-41aa-b204-deea833ad1aa&quot;,&quot;323c07e7-9df0-4e52-bbd2-705d80d59c5c&quot;,&quot;e5b7df5c-4a65-4a5b-ba93-322f9d0f0fce&quot;,&quot;2cfc7327-437a-46e7-8bcd-f24f37d3d53d&quot;,&quot;1b9b3a38-4703-45f7-af02-abc82d6a3b90&quot;,&quot;a9ba4515-7d95-4e70-823f-07d8efc1a1af&quot;,&quot;21e28b48-ebb3-48f6-8892-b2f43c7564da&quot;,&quot;1ef25c13-538c-426a-9de5-2cab06adf717&quot;,&quot;a3fe602e-d8dc-4bcf-a146-334a242a58d2&quot;,&quot;c854daf7-8121-42a9-9974-eff88b3b74aa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:753,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;7e466134-47da-49e5-97e7-c6c2079c6a5d&quot;,&quot;1c2675c4-41a7-4dcf-93ad-fe229405bad8&quot;,&quot;dbd1d183-26d2-4169-a1f0-55eeda1d7ac8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2965,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;990e9cb0-51a9-4646-976e-2c3ef2033dd0&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:547,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d8c09d8-68c0-4b79-82a3-a47fd2ee3979&quot;,&quot;parentUUID&quot;:&quot;990e9cb0-51a9-4646-976e-2c3ef2033dd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:544,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23cac35d-c3a4-41af-b495-6b59434b3f46&quot;,&quot;parentUUID&quot;:&quot;990e9cb0-51a9-4646-976e-2c3ef2033dd0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1d8c09d8-68c0-4b79-82a3-a47fd2ee3979&quot;,&quot;23cac35d-c3a4-41af-b495-6b59434b3f46&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1091,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ffd34032-2666-465b-996f-266f73d4c9c3&quot;,&quot;title&quot;:&quot;authentication&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getKey/auth&quot;,&quot;fullTitle&quot;:&quot;authentication getKey/auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7854,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nlet authKey\nlet encKey\nauthKey = await key.getSymmetricKey(&#x27;des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;3des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;3des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes128&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes128&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes192&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes192&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes256&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes256&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17d4f601-eeb4-4969-8157-b4d4c1301aa2&quot;,&quot;parentUUID&quot;:&quot;ffd34032-2666-465b-996f-266f73d4c9c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;title&quot;:&quot;valid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c3c50260-8d46-4bc5-89ca-0e4cc506fb4f&quot;,&quot;parentUUID&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f082077-c13c-4503-afc9-849850e5cd63&quot;,&quot;parentUUID&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0764f6f9-b45f-4007-8ce7-c8eae59c342e&quot;,&quot;parentUUID&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c52cdd40-385f-4412-9d36-4e8c2ce1a330&quot;,&quot;parentUUID&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:189,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d643fd7-62c7-4be5-a75e-0ad5ec9ad163&quot;,&quot;parentUUID&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90f68aa0-aad5-46fe-b15f-caa5bca88d66&quot;,&quot;parentUUID&quot;:&quot;e2f21c82-35f1-4828-919c-5d157f7d22b5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c3c50260-8d46-4bc5-89ca-0e4cc506fb4f&quot;,&quot;4f082077-c13c-4503-afc9-849850e5cd63&quot;,&quot;0764f6f9-b45f-4007-8ce7-c8eae59c342e&quot;,&quot;c52cdd40-385f-4412-9d36-4e8c2ce1a330&quot;,&quot;4d643fd7-62c7-4be5-a75e-0ad5ec9ad163&quot;,&quot;90f68aa0-aad5-46fe-b15f-caa5bca88d66&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:820,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:210,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;809a7fc0-0dda-40fe-8aa5-b02b5918da69&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:460,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b6fb0f8-f1ea-4335-ba8e-c3ba3d853eb8&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:208,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;889ddb9c-7603-4c2d-a65d-daaefc834a79&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:210,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a17a0c55-4c0d-41d8-ad6f-84f9efb73509&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:373,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98dca8f3-7e82-4c52-b94e-fe45b25235a9&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:212,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59fc6c1f-dbaf-4e56-958f-bb26ef4a0361&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e1613207-bdcc-4068-b175-cf584947f070&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:253,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13b1f4cd-fc53-422e-a078-1490fcfb6ccf&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2022583e-8f51-4f1e-818b-6a52734922c4&quot;,&quot;parentUUID&quot;:&quot;d2d559c7-8b7c-4be2-9f8f-86085e951a54&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;809a7fc0-0dda-40fe-8aa5-b02b5918da69&quot;,&quot;7b6fb0f8-f1ea-4335-ba8e-c3ba3d853eb8&quot;,&quot;889ddb9c-7603-4c2d-a65d-daaefc834a79&quot;,&quot;a17a0c55-4c0d-41d8-ad6f-84f9efb73509&quot;,&quot;98dca8f3-7e82-4c52-b94e-fe45b25235a9&quot;,&quot;59fc6c1f-dbaf-4e56-958f-bb26ef4a0361&quot;,&quot;e1613207-bdcc-4068-b175-cf584947f070&quot;,&quot;13b1f4cd-fc53-422e-a078-1490fcfb6ccf&quot;,&quot;2022583e-8f51-4f1e-818b-6a52734922c4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2137,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;17d4f601-eeb4-4969-8157-b4d4c1301aa2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7854,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9e53e42-8e21-4ffb-b536-5ab88f85afdc&quot;,&quot;parentUUID&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a54ec3f-6901-41d2-9252-fc9b3139cbe3&quot;,&quot;parentUUID&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3958dc47-0a70-4f07-b91a-f25fd8dfca50&quot;,&quot;parentUUID&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9797bd3a-27e1-4ed6-be1c-67843ef8f447&quot;,&quot;parentUUID&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:811,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4bafa866-f0b4-4dec-9912-24cb1368cc43&quot;,&quot;parentUUID&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:733,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fff9bfcc-b50e-4ff5-8c4a-515b35bc0705&quot;,&quot;parentUUID&quot;:&quot;b46b5758-d8bf-47b7-9907-a36c64179f1b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f9e53e42-8e21-4ffb-b536-5ab88f85afdc&quot;,&quot;3a54ec3f-6901-41d2-9252-fc9b3139cbe3&quot;,&quot;3958dc47-0a70-4f07-b91a-f25fd8dfca50&quot;,&quot;9797bd3a-27e1-4ed6-be1c-67843ef8f447&quot;,&quot;4bafa866-f0b4-4dec-9912-24cb1368cc43&quot;,&quot;fff9bfcc-b50e-4ff5-8c4a-515b35bc0705&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1978,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;dd8d3343-d237-4580-872e-6b531b1770d5&quot;,&quot;title&quot;:&quot;enveloping&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;secrets&quot;,&quot;fullTitle&quot;:&quot;enveloping secrets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key2&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key3&#x27;, input)\nawait setup.removeEnvelopedSecret(&#x27;key2&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst output = await derive.getEnvelopedSecret(&#x27;key&#x27;)\noutput.toString(&#x27;hex&#x27;).should.equal(input.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e613c146-9afb-452e-9a01-7069885ca419&quot;,&quot;parentUUID&quot;:&quot;dd8d3343-d237-4580-872e-6b531b1770d5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;keys&quot;,&quot;fullTitle&quot;:&quot;enveloping keys&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:254,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nawait setup.addEnvelopedKey(&#x27;key1&#x27;)\nawait setup.addEnvelopedKey(&#x27;key2&#x27;, &#x27;rsa1024&#x27;)\nawait setup.addEnvelopedKey(&#x27;key3&#x27;, &#x27;rsa2048&#x27;)\nawait setup.addEnvelopedKey(&#x27;key4&#x27;, &#x27;ed25519&#x27;)\nconst key11 = await setup.getEnvelopedKey(&#x27;key1&#x27;)\nconst key12 = await setup.getEnvelopedKey(&#x27;key2&#x27;)\nconst key13 = await setup.getEnvelopedKey(&#x27;key3&#x27;)\nconst key14 = await setup.getEnvelopedKey(&#x27;key4&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst key21 = await derive.getEnvelopedKey(&#x27;key1&#x27;)\nconst key22 = await derive.getEnvelopedKey(&#x27;key2&#x27;)\nconst key23 = await derive.getEnvelopedKey(&#x27;key3&#x27;)\nconst key24 = await derive.getEnvelopedKey(&#x27;key4&#x27;)\nkey11.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key21.export({ format: &#x27;jwk&#x27; }))\nkey12.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key22.export({ format: &#x27;jwk&#x27; }))\nkey13.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key23.export({ format: &#x27;jwk&#x27; }))\nkey14.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key24.export({ format: &#x27;jwk&#x27; }))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9d0f9026-c5ce-4a04-9da7-affae4b20ab5&quot;,&quot;parentUUID&quot;:&quot;dd8d3343-d237-4580-872e-6b531b1770d5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;50a013cd-467e-4b5f-9101-7329b3c4ad16&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b9abdd17-a716-49ed-b0f7-78b0c4b39dc1&quot;,&quot;title&quot;:&quot;addEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(12345, input).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e158df41-0658-44c3-a422-f2b724b115af&quot;,&quot;parentUUID&quot;:&quot;b9abdd17-a716-49ed-b0f7-78b0c4b39dc1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;value/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret value/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedSecret(&#x27;id&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19fc1875-7543-4c96-81b6-f077e78ddcdd&quot;,&quot;parentUUID&quot;:&quot;b9abdd17-a716-49ed-b0f7-78b0c4b39dc1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(&#x27;id&#x27;, input, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c971686c-b02a-411d-91e9-9073525a358e&quot;,&quot;parentUUID&quot;:&quot;b9abdd17-a716-49ed-b0f7-78b0c4b39dc1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/unique&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nsetup.addEnvelopedSecret(&#x27;key&#x27;, input).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9e877d1-2b20-41a4-897d-5e706285cb65&quot;,&quot;parentUUID&quot;:&quot;b9abdd17-a716-49ed-b0f7-78b0c4b39dc1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e158df41-0658-44c3-a422-f2b724b115af&quot;,&quot;19fc1875-7543-4c96-81b6-f077e78ddcdd&quot;,&quot;c971686c-b02a-411d-91e9-9073525a358e&quot;,&quot;c9e877d1-2b20-41a4-897d-5e706285cb65&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:427,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bf45a1d4-169e-4235-94b0-4908987a14a1&quot;,&quot;title&quot;:&quot;removeEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e168285-fb66-4ab4-8f6f-7872d3c552a7&quot;,&quot;parentUUID&quot;:&quot;bf45a1d4-169e-4235-94b0-4908987a14a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(&#x27;12345&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e9807d64-1ee5-4144-86cb-00d9e11fae05&quot;,&quot;parentUUID&quot;:&quot;bf45a1d4-169e-4235-94b0-4908987a14a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7e168285-fb66-4ab4-8f6f-7872d3c552a7&quot;,&quot;e9807d64-1ee5-4144-86cb-00d9e11fae05&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:211,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;58336f8d-c2eb-4262-867c-980ab9816bd6&quot;,&quot;title&quot;:&quot;addEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b74a570-b564-4c7b-b1e1-5f34716da9a0&quot;,&quot;parentUUID&quot;:&quot;58336f8d-c2eb-4262-867c-980ab9816bd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6699715d-f543-4102-b62a-72e3f7136926&quot;,&quot;parentUUID&quot;:&quot;58336f8d-c2eb-4262-867c-980ab9816bd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, &#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a998fd3-6ce2-4b60-96e9-3d48d1d371b3&quot;,&quot;parentUUID&quot;:&quot;58336f8d-c2eb-4262-867c-980ab9816bd6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7b74a570-b564-4c7b-b1e1-5f34716da9a0&quot;,&quot;6699715d-f543-4102-b62a-72e3f7136926&quot;,&quot;4a998fd3-6ce2-4b60-96e9-3d48d1d371b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:316,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8118a1bb-3eb6-4386-b259-6e63307e5e4f&quot;,&quot;title&quot;:&quot;getEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e79a8486-fe07-408f-bad5-9db7d285bbf7&quot;,&quot;parentUUID&quot;:&quot;8118a1bb-3eb6-4386-b259-6e63307e5e4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(&#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f99fd5ec-ff26-44c8-8eaa-6588819db456&quot;,&quot;parentUUID&quot;:&quot;8118a1bb-3eb6-4386-b259-6e63307e5e4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e79a8486-fe07-408f-bad5-9db7d285bbf7&quot;,&quot;f99fd5ec-ff26-44c8-8eaa-6588819db456&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:215,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9ca77477-c301-4e58-b51b-f63944d02cd5&quot;,&quot;title&quot;:&quot;getEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;253b1d64-49b2-4d88-85e7-facde4878a67&quot;,&quot;parentUUID&quot;:&quot;9ca77477-c301-4e58-b51b-f63944d02cd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;253b1d64-49b2-4d88-85e7-facde4878a67&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:107,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c7ef00a2-ea3c-4927-a515-eef486347bdb&quot;,&quot;title&quot;:&quot;hasEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors hasEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.hasEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5f421a9d-f60d-499a-b2df-403831ade34f&quot;,&quot;parentUUID&quot;:&quot;c7ef00a2-ea3c-4927-a515-eef486347bdb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5f421a9d-f60d-499a-b2df-403831ade34f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:108,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e613c146-9afb-452e-9a01-7069885ca419&quot;,&quot;9d0f9026-c5ce-4a04-9da7-affae4b20ab5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:478,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;title&quot;:&quot;kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\features\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;types&quot;,&quot;fullTitle&quot;:&quot;kdf types&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:432,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const pbkdf2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst bcrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst scrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nconst argon2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nBuffer.isBuffer(pbkdf2).should.be.true\nBuffer.isBuffer(bcrypt).should.be.true\nBuffer.isBuffer(scrypt).should.be.true\nBuffer.isBuffer(argon2).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e41983c-4e69-4b94-822b-2fea2637b986&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha1&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 25555,\n    digest: &#x27;sha1&#x27;\n  }\n})\nBuffer.isBuffer(key).should.be.true\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;8ee4a527b20aa8feeb78d70447d84e20&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79552724-d36a-4c2c-95f7-1ba3b9465c0f&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha512&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha512&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:41,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secret&#x27;, &#x27;salt&#x27;, 64, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha512&#x27;\n  }\n})\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;3745e482c6e0ade35da10139e797157f4a5da669dad7d5da88ef87e47471cc47ed941c7ad618e827304f083f8707f12b7cfdd5f489b782f10cc269e3c08d59ae&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ecd1f387-0ab8-4375-8e45-a4bb7999481e&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/default&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;686d741c-7403-48f1-9fd6-3dcb013edf6f&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/same&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/same&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:115,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63c96b86-9e4c-4298-8331-4316bcc27ea7&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/inputdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/inputdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password2&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d30d6195-df4c-450a-a3c9-8c421613cbde&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/saltdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/saltdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2d4de624-6d90-46df-b7bf-ebb97317aa1c&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/rounddiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/rounddiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:174,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 10 } })\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 11 } })\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cfe425bd-0b50-406e-a2c4-74128aa8d196&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/length&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:172,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key16 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key16).should.equal(16)\nconst key32 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key32).should.equal(32)\nconst key64 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key64).should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ffde4e03-78b1-45ed-969a-4b730e7a2e02&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/known&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/known&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;cb36d3d02d502acdf10dfc2d022bf3c024f16a368ba2df4456fbf97291f64334&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b9714aa-f847-4f31-adce-55519deacd85&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/fast&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:189,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 16384, scryptblocksize: 8, scryptparallelism: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;745731af4484f323968969eda289aeee005b5903ac561e64a5aca121797bf7734ef9fd58422e2e22183bcacba9ec87ba0c83b7a2e788f03ce0da06463433cda6&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b33d05d6-ed39-48b7-a6f1-f3111e077b6a&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/defaults&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:188,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;9009fca57ef2b8c342bdad6b9247e4a1b5bd85628152116513ad44e93cf1b0e2&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12015217-a847-46f8-ba11-5c5aa8d409b2&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/N&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/N&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ceb6a6bf4f4afeb3d1806714474d4f00ca97c2ad76a641269192d11444e13a6b&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c4ccc46a-99dc-4481-8e44-72e2fc384772&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/R&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/R&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptblocksize: 16 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;a63de1de715f95bebd9f6d58d78ff11028a8412c1fcf71673544373c67095836&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;27dc412c-e73f-467c-aced-8556382d0403&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/P&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/P&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptparallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ef224277727457992dc05983b1fd1208bae35b100c853ba4bb11f1ba7ca4c436&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb6acdf0-d21e-4035-9fd8-c6f7eb99fd6b&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2i&quot;,&quot;fullTitle&quot;:&quot;kdf argon2i&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2i&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;7357892df510f136a0688ceab37bbaf7ba695de590065072717fa6728961c92a&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9fc5cd9b-518f-4a6a-bd88-8c778f7045f5&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2d&quot;,&quot;fullTitle&quot;:&quot;kdf argon2d&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2d&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;423b0dcc7bbfe16fa8ee7a2e2ebd8891873d726f9dfe70890a7197a5503a2848&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;988d28ef-b85f-4c05-a430-1596ba3dd0c0&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:102,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84e12066-9267-426f-84b9-66b7e5f4d325&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/mem&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/mem&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:68,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2mem: 16384 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;e043f979311b14ff8378b785469974e899a08f05509323a04b2ca29ef63ff3af&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8194c0b8-1a99-47dc-bb54-7f4196313149&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/time&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2time: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;bf6b1773bdae362ecea04b889079b6628d1f35d96a2be9f2a5481c2d1236e8d7&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d0dea3c-47ce-4d3a-995d-00bba2a05156&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/parallelism&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/parallelism&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2parallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5c12c6873b938cd8467b677d23e525389e3ff7ed62b4ad9e285e1191244f40ca&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dedc4897-3462-439c-9856-05b5f7bb7fd4&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;kdf default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({}))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;354bc5a8-b745-4b25-846a-779a6490e2f3&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;kdf invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;invalid&#x27;, params: { } }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a8bcad1-83c6-4751-917c-7799eb4af101&quot;,&quot;parentUUID&quot;:&quot;27a3f407-dd3f-44e9-a0fb-c83bfb4dc92e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4e41983c-4e69-4b94-822b-2fea2637b986&quot;,&quot;79552724-d36a-4c2c-95f7-1ba3b9465c0f&quot;,&quot;ecd1f387-0ab8-4375-8e45-a4bb7999481e&quot;,&quot;686d741c-7403-48f1-9fd6-3dcb013edf6f&quot;,&quot;63c96b86-9e4c-4298-8331-4316bcc27ea7&quot;,&quot;d30d6195-df4c-450a-a3c9-8c421613cbde&quot;,&quot;2d4de624-6d90-46df-b7bf-ebb97317aa1c&quot;,&quot;cfe425bd-0b50-406e-a2c4-74128aa8d196&quot;,&quot;ffde4e03-78b1-45ed-969a-4b730e7a2e02&quot;,&quot;7b9714aa-f847-4f31-adce-55519deacd85&quot;,&quot;b33d05d6-ed39-48b7-a6f1-f3111e077b6a&quot;,&quot;12015217-a847-46f8-ba11-5c5aa8d409b2&quot;,&quot;c4ccc46a-99dc-4481-8e44-72e2fc384772&quot;,&quot;27dc412c-e73f-467c-aced-8556382d0403&quot;,&quot;fb6acdf0-d21e-4035-9fd8-c6f7eb99fd6b&quot;,&quot;9fc5cd9b-518f-4a6a-bd88-8c778f7045f5&quot;,&quot;988d28ef-b85f-4c05-a430-1596ba3dd0c0&quot;,&quot;84e12066-9267-426f-84b9-66b7e5f4d325&quot;,&quot;8194c0b8-1a99-47dc-bb54-7f4196313149&quot;,&quot;6d0dea3c-47ce-4d3a-995d-00bba2a05156&quot;,&quot;dedc4897-3462-439c-9856-05b5f7bb7fd4&quot;,&quot;354bc5a8-b745-4b25-846a-779a6490e2f3&quot;,&quot;0a8bcad1-83c6-4751-917c-7799eb4af101&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2410,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5c218019-5b39-4999-9e2b-17f29cfeec0d&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;4a22ac04-bdf6-4f9e-8db7-b65234533dc3&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:121,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d0740a9d-f0d3-41c5-adbd-6aeafa8b772a&quot;,&quot;parentUUID&quot;:&quot;4a22ac04-bdf6-4f9e-8db7-b65234533dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password2&#x27; })\n    )\n  )\n).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7551069-5242-4c3d-9e33-89413ec2a5ef&quot;,&quot;parentUUID&quot;:&quot;4a22ac04-bdf6-4f9e-8db7-b65234533dc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d0740a9d-f0d3-41c5-adbd-6aeafa8b772a&quot;,&quot;b7551069-5242-4c3d-9e33-89413ec2a5ef&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:230,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;767850cd-a810-4140-af9f-069185540d98&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;797757b8-65d3-4a24-8e77-a57ac7217c39&quot;,&quot;parentUUID&quot;:&quot;767850cd-a810-4140-af9f-069185540d98&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ddc07f1a-3cc8-4a6b-9510-e2d6af906608&quot;,&quot;parentUUID&quot;:&quot;767850cd-a810-4140-af9f-069185540d98&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;797757b8-65d3-4a24-8e77-a57ac7217c39&quot;,&quot;ddc07f1a-3cc8-4a6b-9510-e2d6af906608&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:211,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;38298755-f575-4da0-9f73-3f8fc3f8704e&quot;,&quot;parentUUID&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26302120-7350-4e5e-b0f7-e8482aa6e8d5&quot;,&quot;parentUUID&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4de1ead-b3dd-4554-995d-d57f475499da&quot;,&quot;parentUUID&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:612,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d7738041-51de-47a8-8906-ba008ff29ce7&quot;,&quot;parentUUID&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:346,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e18bc35-185a-4eec-a201-dce27a5a68ae&quot;,&quot;parentUUID&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:243,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;feb099f4-6e78-4823-b9af-85c97e4d1ba0&quot;,&quot;parentUUID&quot;:&quot;73ee6e89-50d1-4283-89a0-6c35d0c36877&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;38298755-f575-4da0-9f73-3f8fc3f8704e&quot;,&quot;26302120-7350-4e5e-b0f7-e8482aa6e8d5&quot;,&quot;d4de1ead-b3dd-4554-995d-d57f475499da&quot;,&quot;d7738041-51de-47a8-8906-ba008ff29ce7&quot;,&quot;1e18bc35-185a-4eec-a201-dce27a5a68ae&quot;,&quot;feb099f4-6e78-4823-b9af-85c97e4d1ba0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1867,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;91d2c693-e3a8-48cb-a3c4-c68774f06aaf&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n])\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;91f21577-ba63-4c56-a2d2-2e25dda698e9&quot;,&quot;parentUUID&quot;:&quot;91d2c693-e3a8-48cb-a3c4-c68774f06aaf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0071fec2-10aa-44c1-9ed2-76336a5e52c6&quot;,&quot;parentUUID&quot;:&quot;91d2c693-e3a8-48cb-a3c4-c68774f06aaf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;91f21577-ba63-4c56-a2d2-2e25dda698e9&quot;,&quot;0071fec2-10aa-44c1-9ed2-76336a5e52c6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:213,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3762a206-8935-4c0a-82d8-5acd8def33da&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:443,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nderive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(derive2.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;373579a5-12ca-421a-a025-4529fd2c4a42&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:436,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;134c9c98-1440-471b-a550-285723f144d5&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f98a0a5f-bd38-41eb-9411-81226967a0c6&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f6eee2b-90e1-433e-a9da-33a66d0b7d04&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba86ddd5-98c1-4702-b704-f9172bccdba6&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3489f721-6447-4ece-ad7e-7918a4c01641&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:213,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute([&#x27;password1&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50dccfcc-22d0-4604-b3b8-54aeb5abd9a9&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:217,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a74896c8-7133-47d8-8747-1470e7e979f4&quot;,&quot;parentUUID&quot;:&quot;53d3b28f-7d66-4a6f-bf9f-8c9dcdf4c5c3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([12345], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3d13d9d8-7035-48fd-9d08-ee0e77638c11&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([&#x27;password4&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;431fb47d-23f9-4c67-8874-72fb7f78e327&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.reconstitute([&#x27;password3&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09522a5f-9138-43a5-a118-82d071440fd9&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute(&#x27;hello&#x27;, [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3113640a-3903-4853-afc0-f5878ef9b35f&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], &#x27;12345&#x27;, 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2872c7c5-058b-4b58-82cc-9fda09e8dc87&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], &#x27;12345&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ede73ed5-2f1a-4916-8efe-4e8f10566542&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f3b0d0f-7104-46c2-89f3-218dafa6683e&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: 12345,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb2ac2fb-e3a2-4e2e-b3e1-5f8733dd53cf&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;767b7c4e-6fa2-4cb8-839d-e354db9248d7&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d28446d-8666-4ec6-8355-d7352b8a28e2&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;054d0e7d-bfcb-4437-abbd-fd33843ea9f2&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0157aff-011b-48f2-aad0-0ba8d363df68&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9bd86d21-56b4-4cc2-af25-fd4c64832793&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: 12345,\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0509388b-5320-484c-a38b-21fbbf9e81ea&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: 12345\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f77443f9-bb2d-40ba-89d2-59e5843e2587&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc0e3cf0-ba42-4fbf-bdf7-966a4f95f50c&quot;,&quot;parentUUID&quot;:&quot;cebc47b6-f153-40f1-9a36-cc2b5745d0e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3d13d9d8-7035-48fd-9d08-ee0e77638c11&quot;,&quot;431fb47d-23f9-4c67-8874-72fb7f78e327&quot;,&quot;09522a5f-9138-43a5-a118-82d071440fd9&quot;,&quot;3113640a-3903-4853-afc0-f5878ef9b35f&quot;,&quot;2872c7c5-058b-4b58-82cc-9fda09e8dc87&quot;,&quot;ede73ed5-2f1a-4916-8efe-4e8f10566542&quot;,&quot;9f3b0d0f-7104-46c2-89f3-218dafa6683e&quot;,&quot;fb2ac2fb-e3a2-4e2e-b3e1-5f8733dd53cf&quot;,&quot;767b7c4e-6fa2-4cb8-839d-e354db9248d7&quot;,&quot;6d28446d-8666-4ec6-8355-d7352b8a28e2&quot;,&quot;054d0e7d-bfcb-4437-abbd-fd33843ea9f2&quot;,&quot;c0157aff-011b-48f2-aad0-0ba8d363df68&quot;,&quot;9bd86d21-56b4-4cc2-af25-fd4c64832793&quot;,&quot;0509388b-5320-484c-a38b-21fbbf9e81ea&quot;,&quot;f77443f9-bb2d-40ba-89d2-59e5843e2587&quot;,&quot;fc0e3cf0-ba42-4fbf-bdf7-966a4f95f50c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1687,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;3762a206-8935-4c0a-82d8-5acd8def33da&quot;,&quot;373579a5-12ca-421a-a025-4529fd2c4a42&quot;,&quot;134c9c98-1440-471b-a550-285723f144d5&quot;,&quot;f98a0a5f-bd38-41eb-9411-81226967a0c6&quot;,&quot;8f6eee2b-90e1-433e-a9da-33a66d0b7d04&quot;,&quot;ba86ddd5-98c1-4702-b704-f9172bccdba6&quot;,&quot;3489f721-6447-4ece-ad7e-7918a4c01641&quot;,&quot;50dccfcc-22d0-4604-b3b8-54aeb5abd9a9&quot;,&quot;a74896c8-7133-47d8-8747-1470e7e979f4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2407,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;6b5cb81b-1549-462d-8cc1-d91a3461e289&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;85de1e22-b34c-4bb6-b400-db597bb277c1&quot;,&quot;parentUUID&quot;:&quot;6b5cb81b-1549-462d-8cc1-d91a3461e289&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26bebeab-9e6e-4a9e-ab88-5e8d2d4de903&quot;,&quot;parentUUID&quot;:&quot;6b5cb81b-1549-462d-8cc1-d91a3461e289&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a42e2087-b194-448c-9932-7d13fe5fb14c&quot;,&quot;parentUUID&quot;:&quot;6b5cb81b-1549-462d-8cc1-d91a3461e289&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;85de1e22-b34c-4bb6-b400-db597bb277c1&quot;,&quot;26bebeab-9e6e-4a9e-ab88-5e8d2d4de903&quot;,&quot;a42e2087-b194-448c-9932-7d13fe5fb14c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c52d3b4e-ae00-41f8-b7a9-9a88974ba1bc&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 1, 5)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc37a449-8d7b-47fb-8492-5846551f63c0&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 2, 3)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da3a19ad-e13f-4dd7-9bb8-343fdc476a13&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d5a4031-5ffc-403b-a0f3-264c71e51421&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:65,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 1024)\nshares.should.be.an(&#x27;array&#x27;).of.length(1024)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 1020; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[1023] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;054df9e4-b074-4c3d-8632-13da5db6a9e5&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)\nxor(shares[0], shares[1]).toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9071a88-f84c-451b-b273-0a2870fbee59&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;56c30543-ae61-4fbb-b098-302c8f38a100&quot;,&quot;parentUUID&quot;:&quot;7f0a76d9-9bc4-4dbf-a0b5-1345e34671ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c52d3b4e-ae00-41f8-b7a9-9a88974ba1bc&quot;,&quot;fc37a449-8d7b-47fb-8492-5846551f63c0&quot;,&quot;da3a19ad-e13f-4dd7-9bb8-343fdc476a13&quot;,&quot;7d5a4031-5ffc-403b-a0f3-264c71e51421&quot;,&quot;054df9e4-b074-4c3d-8632-13da5db6a9e5&quot;,&quot;c9071a88-f84c-451b-b273-0a2870fbee59&quot;,&quot;56c30543-ae61-4fbb-b098-302c8f38a100&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:77,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5d9b1fe-b621-4973-8e90-329b96d770e6&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0c786f16-b8e2-4f9f-8f0e-d94dae1c82c8&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10c823aa-a6e8-43e4-b06b-56fa1283fcfd&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b30f29be-df58-45b6-8c90-46662c5a0425&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4a2eb9d-3ffb-4e74-b2fd-5b5790230e91&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e48c6a8-1324-4cf5-8c6a-805c4b45eb9c&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b68ccb82-2538-4581-9364-171a877ff2df&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b78823bf-6069-4a4a-b019-8e48e4cdf2e5&quot;,&quot;parentUUID&quot;:&quot;94bfef87-40aa-449d-a293-dbb9e337de16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f5d9b1fe-b621-4973-8e90-329b96d770e6&quot;,&quot;0c786f16-b8e2-4f9f-8f0e-d94dae1c82c8&quot;,&quot;10c823aa-a6e8-43e4-b06b-56fa1283fcfd&quot;,&quot;b30f29be-df58-45b6-8c90-46662c5a0425&quot;,&quot;d4a2eb9d-3ffb-4e74-b2fd-5b5790230e91&quot;,&quot;8e48c6a8-1324-4cf5-8c6a-805c4b45eb9c&quot;,&quot;b68ccb82-2538-4581-9364-171a877ff2df&quot;,&quot;b78823bf-6069-4a4a-b019-8e48e4cdf2e5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;35745b12-86a7-446b-ad07-bc6b518dae4d&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4783caa8-c0c6-41a8-b96b-2ce451cae544&quot;,&quot;parentUUID&quot;:&quot;35745b12-86a7-446b-ad07-bc6b518dae4d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52614596-d080-471a-8646-f702acc9dbd6&quot;,&quot;parentUUID&quot;:&quot;35745b12-86a7-446b-ad07-bc6b518dae4d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa4084cb-9a3f-4052-b415-df92c18bf35d&quot;,&quot;parentUUID&quot;:&quot;35745b12-86a7-446b-ad07-bc6b518dae4d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4783caa8-c0c6-41a8-b96b-2ce451cae544&quot;,&quot;52614596-d080-471a-8646-f702acc9dbd6&quot;,&quot;fa4084cb-9a3f-4052-b415-df92c18bf35d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;20b5d495-038b-4ba2-b0c0-5ef69c33cf5c&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df8ab28d-996d-4dcd-964a-ccb6bc7b3e0b&quot;,&quot;parentUUID&quot;:&quot;20b5d495-038b-4ba2-b0c0-5ef69c33cf5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e2fb070-8e4c-4ab2-99de-40ea1e01851a&quot;,&quot;parentUUID&quot;:&quot;20b5d495-038b-4ba2-b0c0-5ef69c33cf5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41e0f33f-2a75-4048-9453-3551fc09df2a&quot;,&quot;parentUUID&quot;:&quot;20b5d495-038b-4ba2-b0c0-5ef69c33cf5c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;df8ab28d-996d-4dcd-964a-ccb6bc7b3e0b&quot;,&quot;5e2fb070-8e4c-4ab2-99de-40ea1e01851a&quot;,&quot;41e0f33f-2a75-4048-9453-3551fc09df2a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;299c4565-2e51-4127-b09e-c38726827e5a&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ uuid: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ uuid: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c4012929-28d6-4920-b058-584b74b1e990&quot;,&quot;parentUUID&quot;:&quot;299c4565-2e51-4127-b09e-c38726827e5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b833fbe-4d96-4c6b-a1ff-41808aa78e1c&quot;,&quot;parentUUID&quot;:&quot;299c4565-2e51-4127-b09e-c38726827e5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({ uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73ab54a3-0b7f-4a0b-89d7-2fbf6723d532&quot;,&quot;parentUUID&quot;:&quot;299c4565-2e51-4127-b09e-c38726827e5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5da29d7b-4a3a-474f-87da-b1ab2ce3d33e&quot;,&quot;parentUUID&quot;:&quot;299c4565-2e51-4127-b09e-c38726827e5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c4012929-28d6-4920-b058-584b74b1e990&quot;,&quot;0b833fbe-4d96-4c6b-a1ff-41808aa78e1c&quot;,&quot;73ab54a3-0b7f-4a0b-89d7-2fbf6723d532&quot;,&quot;5da29d7b-4a3a-474f-87da-b1ab2ce3d33e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a59b3390-6134-4365-b182-5ca37a897241&quot;,&quot;title&quot;:&quot;setup/kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;9cc46854-9c18-4be1-9b8a-634b5078b674&quot;,&quot;title&quot;:&quot;pbkdf2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e8fefe9-7688-456d-ab30-7ffc7222b277&quot;,&quot;parentUUID&quot;:&quot;9cc46854-9c18-4be1-9b8a-634b5078b674&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;87abf78d-7caf-481b-9d0f-5e5b7b0aa06a&quot;,&quot;title&quot;:&quot;pbkdf2rounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;754ca02c-448a-4e19-a6de-161ab73443c4&quot;,&quot;parentUUID&quot;:&quot;87abf78d-7caf-481b-9d0f-5e5b7b0aa06a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8af48533-53ec-489d-8ee8-16b55ffaee3e&quot;,&quot;parentUUID&quot;:&quot;87abf78d-7caf-481b-9d0f-5e5b7b0aa06a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f385f8f9-b9a0-4fab-899f-43905a8764ee&quot;,&quot;parentUUID&quot;:&quot;87abf78d-7caf-481b-9d0f-5e5b7b0aa06a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;754ca02c-448a-4e19-a6de-161ab73443c4&quot;,&quot;8af48533-53ec-489d-8ee8-16b55ffaee3e&quot;,&quot;f385f8f9-b9a0-4fab-899f-43905a8764ee&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;307b1fbc-32ae-445d-9457-4a24e3a1ea35&quot;,&quot;title&quot;:&quot;pbkdf2digest&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: 0\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db24f118-0919-40dd-a842-9def049de181&quot;,&quot;parentUUID&quot;:&quot;307b1fbc-32ae-445d-9457-4a24e3a1ea35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1acd02d3-bae7-4c42-99de-eb7fdce0b2a8&quot;,&quot;parentUUID&quot;:&quot;307b1fbc-32ae-445d-9457-4a24e3a1ea35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2digest: &#x27;sha512&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha512&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ffbe9611-b3a5-475a-9347-5f9e68e7327d&quot;,&quot;parentUUID&quot;:&quot;307b1fbc-32ae-445d-9457-4a24e3a1ea35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;db24f118-0919-40dd-a842-9def049de181&quot;,&quot;1acd02d3-bae7-4c42-99de-eb7fdce0b2a8&quot;,&quot;ffbe9611-b3a5-475a-9347-5f9e68e7327d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;6e8fefe9-7688-456d-ab30-7ffc7222b277&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b64d601d-0391-4ac9-b30a-a8d890b83898&quot;,&quot;title&quot;:&quot;bcrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 10\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3613f82-a5a8-41c9-a0e5-c7fe939f9925&quot;,&quot;parentUUID&quot;:&quot;b64d601d-0391-4ac9-b30a-a8d890b83898&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1e22bd54-299a-4be1-a730-898ceba57a04&quot;,&quot;title&quot;:&quot;bcryptrounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fcbec1e8-0f4a-40cd-a06e-bff6fc77eda6&quot;,&quot;parentUUID&quot;:&quot;1e22bd54-299a-4be1-a730-898ceba57a04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4c5057f-6270-4cef-9184-b8646929f527&quot;,&quot;parentUUID&quot;:&quot;1e22bd54-299a-4be1-a730-898ceba57a04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;,\n  bcryptrounds: 25\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 25\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5032bcb3-6bff-4fbc-9176-794d48a84e71&quot;,&quot;parentUUID&quot;:&quot;1e22bd54-299a-4be1-a730-898ceba57a04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fcbec1e8-0f4a-40cd-a06e-bff6fc77eda6&quot;,&quot;f4c5057f-6270-4cef-9184-b8646929f527&quot;,&quot;5032bcb3-6bff-4fbc-9176-794d48a84e71&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e3613f82-a5a8-41c9-a0e5-c7fe939f9925&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;181f60e0-44c4-41e5-aecf-7150687a9d09&quot;,&quot;title&quot;:&quot;scrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f0aca8a-2fcf-4c06-942b-70f56ea6ff79&quot;,&quot;parentUUID&quot;:&quot;181f60e0-44c4-41e5-aecf-7150687a9d09&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;af51c1d9-768c-4a54-a1a9-424484880cba&quot;,&quot;title&quot;:&quot;scryptcost&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00d0e612-adb0-43a0-8ca3-af3f8b90b53c&quot;,&quot;parentUUID&quot;:&quot;af51c1d9-768c-4a54-a1a9-424484880cba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4a02555b-10bd-450e-8a09-54602cefe3e1&quot;,&quot;parentUUID&quot;:&quot;af51c1d9-768c-4a54-a1a9-424484880cba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptcost: 12345\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 12345,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3d2c1b23-fb88-4615-9f6f-22c17518830f&quot;,&quot;parentUUID&quot;:&quot;af51c1d9-768c-4a54-a1a9-424484880cba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;00d0e612-adb0-43a0-8ca3-af3f8b90b53c&quot;,&quot;4a02555b-10bd-450e-8a09-54602cefe3e1&quot;,&quot;3d2c1b23-fb88-4615-9f6f-22c17518830f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9a44464d-5e01-4bad-a080-9e644210b8e9&quot;,&quot;title&quot;:&quot;scryptblocksize&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7430c87-a158-43af-b3a9-0fa4ab78a4c2&quot;,&quot;parentUUID&quot;:&quot;9a44464d-5e01-4bad-a080-9e644210b8e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a0bc4aa-16e4-4782-ad32-66b0d0d6cc1e&quot;,&quot;parentUUID&quot;:&quot;9a44464d-5e01-4bad-a080-9e644210b8e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptblocksize: 24\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 24,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e2ccb93-cf88-49a9-bd4e-8a7355ef0548&quot;,&quot;parentUUID&quot;:&quot;9a44464d-5e01-4bad-a080-9e644210b8e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b7430c87-a158-43af-b3a9-0fa4ab78a4c2&quot;,&quot;3a0bc4aa-16e4-4782-ad32-66b0d0d6cc1e&quot;,&quot;6e2ccb93-cf88-49a9-bd4e-8a7355ef0548&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e3cc964e-9401-40bb-8963-65ba4a6c5100&quot;,&quot;title&quot;:&quot;scryptparallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f08c5b92-fef3-4498-8978-80dd503ae4d5&quot;,&quot;parentUUID&quot;:&quot;e3cc964e-9401-40bb-8963-65ba4a6c5100&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c495676-c466-483d-aeb9-c232aee95e3d&quot;,&quot;parentUUID&quot;:&quot;e3cc964e-9401-40bb-8963-65ba4a6c5100&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptparallelism: 2\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19a00928-803e-49a4-85c9-52c48c7e88f0&quot;,&quot;parentUUID&quot;:&quot;e3cc964e-9401-40bb-8963-65ba4a6c5100&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f08c5b92-fef3-4498-8978-80dd503ae4d5&quot;,&quot;3c495676-c466-483d-aeb9-c232aee95e3d&quot;,&quot;19a00928-803e-49a4-85c9-52c48c7e88f0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;7f0aca8a-2fcf-4c06-942b-70f56ea6ff79&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d0c12927-2d57-4b50-be58-58a804b3bfe9&quot;,&quot;title&quot;:&quot;argon2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc78a497-b90d-45b6-b157-757291695b1e&quot;,&quot;parentUUID&quot;:&quot;d0c12927-2d57-4b50-be58-58a804b3bfe9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: 123\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0763b3e3-e4dc-436b-ac88-0e10eabf4d17&quot;,&quot;parentUUID&quot;:&quot;d0c12927-2d57-4b50-be58-58a804b3bfe9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f9652e4-4cab-4d5f-ad20-77835fbf20d9&quot;,&quot;parentUUID&quot;:&quot;d0c12927-2d57-4b50-be58-58a804b3bfe9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;539e4dc5-7b4f-4ac6-9af1-9ba8ec5fd496&quot;,&quot;title&quot;:&quot;argon2time&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf82cf4b-a6e8-4108-bb2f-9c4a51c1dab0&quot;,&quot;parentUUID&quot;:&quot;539e4dc5-7b4f-4ac6-9af1-9ba8ec5fd496&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2349294-0d04-4ecd-8df7-221fa2a23c1f&quot;,&quot;parentUUID&quot;:&quot;539e4dc5-7b4f-4ac6-9af1-9ba8ec5fd496&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2d&#x27;,\n  argon2time: 10\n}).should.deep.equal({\n  type: &#x27;argon2d&#x27;,\n  params: {\n    rounds: 10,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76865ae6-0c4f-4bee-afcb-f213b496623b&quot;,&quot;parentUUID&quot;:&quot;539e4dc5-7b4f-4ac6-9af1-9ba8ec5fd496&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cf82cf4b-a6e8-4108-bb2f-9c4a51c1dab0&quot;,&quot;d2349294-0d04-4ecd-8df7-221fa2a23c1f&quot;,&quot;76865ae6-0c4f-4bee-afcb-f213b496623b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b5404ea4-5cc2-497f-ba43-53f2063c69e1&quot;,&quot;title&quot;:&quot;argon2mem&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09f6b18e-b1ab-4cc0-8384-1012fa396a37&quot;,&quot;parentUUID&quot;:&quot;b5404ea4-5cc2-497f-ba43-53f2063c69e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;700c4985-66a9-4e93-9423-34f75b4f0424&quot;,&quot;parentUUID&quot;:&quot;b5404ea4-5cc2-497f-ba43-53f2063c69e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2i&#x27;,\n  argon2mem: 12345\n}).should.deep.equal({\n  type: &#x27;argon2i&#x27;,\n  params: {\n    rounds: 2,\n    memory: 12345,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1fdfedc6-a50e-4e08-9c1d-cbdc608407b7&quot;,&quot;parentUUID&quot;:&quot;b5404ea4-5cc2-497f-ba43-53f2063c69e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;09f6b18e-b1ab-4cc0-8384-1012fa396a37&quot;,&quot;700c4985-66a9-4e93-9423-34f75b4f0424&quot;,&quot;1fdfedc6-a50e-4e08-9c1d-cbdc608407b7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f8677801-6198-4915-a4c5-6dc8b84bf3a4&quot;,&quot;title&quot;:&quot;argon2parallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f91a10a-23d4-4bd0-9555-ec51cddda39a&quot;,&quot;parentUUID&quot;:&quot;f8677801-6198-4915-a4c5-6dc8b84bf3a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ece5b39a-d973-4f7e-a27b-b1b63de901e4&quot;,&quot;parentUUID&quot;:&quot;f8677801-6198-4915-a4c5-6dc8b84bf3a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2id&#x27;,\n  argon2parallelism: 2\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75d906b7-b5b7-4634-ba66-f92e03137f48&quot;,&quot;parentUUID&quot;:&quot;f8677801-6198-4915-a4c5-6dc8b84bf3a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9f91a10a-23d4-4bd0-9555-ec51cddda39a&quot;,&quot;ece5b39a-d973-4f7e-a27b-b1b63de901e4&quot;,&quot;75d906b7-b5b7-4634-ba66-f92e03137f48&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;dc78a497-b90d-45b6-b157-757291695b1e&quot;,&quot;0763b3e3-e4dc-436b-ac88-0e10eabf4d17&quot;,&quot;4f9652e4-4cab-4d5f-ad20-77835fbf20d9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c3aafbc3-1564-4b64-9c1a-fdd2821be777&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4fd87f1e-3059-4e68-aeab-61109f78f55f&quot;,&quot;parentUUID&quot;:&quot;c3aafbc3-1564-4b64-9c1a-fdd2821be777&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;7231e548-4096-4607-8aff-057d4307e7a2&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f05373ca-db1a-47a0-b3c6-f8908b60bee3&quot;,&quot;parentUUID&quot;:&quot;7231e548-4096-4607-8aff-057d4307e7a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;hello-world&#x27; })\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6199b583-0052-430c-a2b1-6e4126218ef7&quot;,&quot;parentUUID&quot;:&quot;7231e548-4096-4607-8aff-057d4307e7a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84337afb-29cc-4b10-a30b-216d14869620&quot;,&quot;parentUUID&quot;:&quot;7231e548-4096-4607-8aff-057d4307e7a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e230f963-be8b-4534-bb25-6d1300416c37&quot;,&quot;parentUUID&quot;:&quot;7231e548-4096-4607-8aff-057d4307e7a2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f05373ca-db1a-47a0-b3c6-f8908b60bee3&quot;,&quot;6199b583-0052-430c-a2b1-6e4126218ef7&quot;,&quot;84337afb-29cc-4b10-a30b-216d14869620&quot;,&quot;e230f963-be8b-4534-bb25-6d1300416c37&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:209,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5ed20862-c5e6-4553-9e83-f213ef4f4947&quot;,&quot;title&quot;:&quot;size&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key size default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.size.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;37056b31-c947-4080-b367-55910c3c26ec&quot;,&quot;parentUUID&quot;:&quot;5ed20862-c5e6-4553-9e83-f213ef4f4947&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key size valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 64 })\npolicy.size.should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a088ac2-1d0f-4752-b0f2-d32e1c91b692&quot;,&quot;parentUUID&quot;:&quot;5ed20862-c5e6-4553-9e83-f213ef4f4947&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d98e328-1c52-45b1-9d78-392c9c01aa19&quot;,&quot;parentUUID&quot;:&quot;5ed20862-c5e6-4553-9e83-f213ef4f4947&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 0 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e76abbdf-1228-4c5f-9bcd-ca96dd396af5&quot;,&quot;parentUUID&quot;:&quot;5ed20862-c5e6-4553-9e83-f213ef4f4947&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;37056b31-c947-4080-b367-55910c3c26ec&quot;,&quot;9a088ac2-1d0f-4752-b0f2-d32e1c91b692&quot;,&quot;0d98e328-1c52-45b1-9d78-392c9c01aa19&quot;,&quot;e76abbdf-1228-4c5f-9bcd-ca96dd396af5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:210,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;74bcf66b-b955-40b0-bbc1-19f79f18a64e&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36227816-210a-4303-a3c1-0e2026637957&quot;,&quot;parentUUID&quot;:&quot;74bcf66b-b955-40b0-bbc1-19f79f18a64e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 1 })\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c435582b-6938-4d18-a859-15243a74f2a2&quot;,&quot;parentUUID&quot;:&quot;74bcf66b-b955-40b0-bbc1-19f79f18a64e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84d9d233-eed7-42f1-8027-e58e12e36207&quot;,&quot;parentUUID&quot;:&quot;74bcf66b-b955-40b0-bbc1-19f79f18a64e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 0 }).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 2 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20bf678a-59ce-44af-a30f-ba1d49337de7&quot;,&quot;parentUUID&quot;:&quot;74bcf66b-b955-40b0-bbc1-19f79f18a64e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;36227816-210a-4303-a3c1-0e2026637957&quot;,&quot;c435582b-6938-4d18-a859-15243a74f2a2&quot;,&quot;84d9d233-eed7-42f1-8027-e58e12e36207&quot;,&quot;20bf678a-59ce-44af-a30f-ba1d49337de7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:209,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f9d19e2a-a092-470d-9bf0-c3f582fa05dc&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 48 })\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(48)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f941bd56-02f7-44f8-a273-ebb9fe9dfb81&quot;,&quot;parentUUID&quot;:&quot;f9d19e2a-a092-470d-9bf0-c3f582fa05dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: Buffer.from(&#x27;12345678&#x27;, &#x27;base64&#x27;) })\npolicy.salt.should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2900c633-2415-4720-8803-658d38046e83&quot;,&quot;parentUUID&quot;:&quot;f9d19e2a-a092-470d-9bf0-c3f582fa05dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;94f51abf-591e-41b1-96a9-0bbe1cde6465&quot;,&quot;parentUUID&quot;:&quot;f9d19e2a-a092-470d-9bf0-c3f582fa05dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f941bd56-02f7-44f8-a273-ebb9fe9dfb81&quot;,&quot;2900c633-2415-4720-8803-658d38046e83&quot;,&quot;94f51abf-591e-41b1-96a9-0bbe1cde6465&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:206,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;9e8779b2-4e06-468d-b19b-1e9bd0d989c8&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;16942b46-9a55-4573-8e82-71d948c05dfb&quot;,&quot;parentUUID&quot;:&quot;9e8779b2-4e06-468d-b19b-1e9bd0d989c8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;28d28f13-e5c8-42bf-9a52-f7b5679b9be4&quot;,&quot;parentUUID&quot;:&quot;9e8779b2-4e06-468d-b19b-1e9bd0d989c8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: 12345,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: 12345\n  }\n]).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;898a76e0-f178-49d2-a60b-2be449f9e238&quot;,&quot;parentUUID&quot;:&quot;9e8779b2-4e06-468d-b19b-1e9bd0d989c8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ea905843-4f4a-426b-b66a-f8402422af52&quot;,&quot;parentUUID&quot;:&quot;9e8779b2-4e06-468d-b19b-1e9bd0d989c8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;16942b46-9a55-4573-8e82-71d948c05dfb&quot;,&quot;28d28f13-e5c8-42bf-9a52-f7b5679b9be4&quot;,&quot;898a76e0-f178-49d2-a60b-2be449f9e238&quot;,&quot;ea905843-4f4a-426b-b66a-f8402422af52&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:104,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;4fd87f1e-3059-4e68-aeab-61109f78f55f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:109,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;9.2.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mochawesome&quot;,&quot;reportTitle&quot;:&quot;MFKDF&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>