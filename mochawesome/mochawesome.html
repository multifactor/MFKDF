<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:85,&quot;tests&quot;:337,&quot;passes&quot;:337,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2022-08-10T18:09:36.999Z&quot;,&quot;end&quot;:&quot;2022-08-10T18:11:21.088Z&quot;,&quot;duration&quot;:104089,&quot;testsRegistered&quot;:337,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;15b654b8-e155-454c-94c9-5616c95fda5a&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;eb94f23f-6de7-4761-982e-e3aa8f3d3842&quot;,&quot;title&quot;:&quot;asymmetric&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f734fdb3-2d5e-4741-9a62-2eb3683e0f57&quot;,&quot;title&quot;:&quot;encryption&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:379,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa1024&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7da25948-95fb-4f98-bfaf-ecfc9586ab20&quot;,&quot;parentUUID&quot;:&quot;f734fdb3-2d5e-4741-9a62-2eb3683e0f57&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric encryption rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2704,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ct = await setup.encrypt(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst pt = await setup.decrypt(ct, &#x27;rsa2048&#x27;)\npt.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;28aa1b9f-5a0f-431c-a764-821bbce36386&quot;,&quot;parentUUID&quot;:&quot;f734fdb3-2d5e-4741-9a62-2eb3683e0f57&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7da25948-95fb-4f98-bfaf-ecfc9586ab20&quot;,&quot;28aa1b9f-5a0f-431c-a764-821bbce36386&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3083,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;title&quot;:&quot;signatures&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\asymmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\asymmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;rsa1024&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa1024&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;26aa5f2e-dc95-4118-8991-728dd4f202ec&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa2048&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa2048&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1442,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa2048&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa2048&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;70dc3a56-fd94-487e-8bf2-411f72c8881c&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;rsa3072&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures rsa3072&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:18753,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;, &#x27;rsa3072&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature, &#x27;rsa3072&#x27;)\nvalidity.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29908b04-1256-4e04-9f8a-7f44ead5ed71&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16023,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nconst validity = await setup.verify(&#x27;hello world&#x27;, signature)\nvalidity.should.be.true\nawait setup.getAsymmetricKeyPair()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90782c9a-836b-451c-8f3a-d9d30f671d9e&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ed25519&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures ed25519&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:121,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nawait setup.getAsymmetricKeyPair(&#x27;ed25519&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00ac56c9-2fe0-4b46-ab82-5ef0ace96ef0&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;unknown&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures unknown&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.getAsymmetricKeyPair(&#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aeb543dc-b07e-4a42-a60f-2c69289b4a1c&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors&quot;,&quot;fullTitle&quot;:&quot;asymmetric signatures errors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6431,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.sign(12345, &#x27;rsa1024&#x27;).should.be.rejectedWith(TypeError)\nconst signature = await setup.sign(&#x27;hello world&#x27;)\nsetup.verify(12345, signature).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50f973ea-ae9c-4b68-8355-78597e2b080c&quot;,&quot;parentUUID&quot;:&quot;0a8afb68-74c4-4601-81e3-07f5002c2a4c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;26aa5f2e-dc95-4118-8991-728dd4f202ec&quot;,&quot;70dc3a56-fd94-487e-8bf2-411f72c8881c&quot;,&quot;29908b04-1256-4e04-9f8a-7f44ead5ed71&quot;,&quot;90782c9a-836b-451c-8f3a-d9d30f671d9e&quot;,&quot;00ac56c9-2fe0-4b46-ab82-5ef0ace96ef0&quot;,&quot;aeb543dc-b07e-4a42-a60f-2c69289b4a1c&quot;,&quot;50f973ea-ae9c-4b68-8355-78597e2b080c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:43092,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;title&quot;:&quot;encrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;encrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:251,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e6686338-e454-4235-9f3a-e397e02118d5&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:230,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e82b2d55-b1e1-418c-830c-6d36f103ab3f&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8bdff09b-efcc-4c2c-b876-3fc62c6879dd&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:232,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f3a206f-ebfd-47b8-be30-ed7a39081362&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ccff3ae-862f-42e8-9704-aa85e3b14a97&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-CBC&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-CBC&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:232,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a52f9a49-e2d3-4f37-93da-86e4c577ab85&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES256-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES256-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(Buffer.from(&#x27;hello world&#x27;), &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes256&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08982e51-2cc7-4cf6-b818-5063c9113386&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES192-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES192-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes192&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0accce6-cfc7-4365-8b8d-eee9e9fe76f0&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;AES128-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt AES128-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;aes128&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b87aa07-4bc1-4e55-85b6-a3159751d4d6&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;3DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt 3DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;3des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10ef7faf-d1f7-49e6-ac08-013b36f75852&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;DES-ECB&quot;,&quot;fullTitle&quot;:&quot;encrypt DES-ECB&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:230,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst ciphertext = await setup.encrypt(&#x27;hello world&#x27;, &#x27;des&#x27;, &#x27;ECB&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nconst plaintext = await derive.decrypt(ciphertext, &#x27;des&#x27;, &#x27;ECB&#x27;)\nplaintext.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e47603e-8503-41a8-8849-5844f907b245&quot;,&quot;parentUUID&quot;:&quot;5c2dc432-0d76-45bd-93d9-7eb494ba8727&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;459caa56-4ecb-42aa-8c54-5f6d489b7f71&quot;,&quot;title&quot;:&quot;utils&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;subkey&quot;,&quot;fullTitle&quot;:&quot;encrypt utils subkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSubkey(32, &#x27;AES256&#x27;, &#x27;sha256&#x27;)\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))\nconst key3 = await setup.getSubkey()\nconst key4 = await setup.getSubkey(32, &#x27;&#x27;, &#x27;sha512&#x27;)\nkey3.toString(&#x27;hex&#x27;).should.equal(key4.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fba9ede6-a776-44a3-a072-2032ca4b1b28&quot;,&quot;parentUUID&quot;:&quot;459caa56-4ecb-42aa-8c54-5f6d489b7f71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;symmetric key&quot;,&quot;fullTitle&quot;:&quot;encrypt utils symmetric key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nconst key1 = await setup.getSymmetricKey()\nconst key2 = await setup.getSymmetricKey(&#x27;aes256&#x27;)\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8af368e4-e813-44a7-8dae-e3e203283fa3&quot;,&quot;parentUUID&quot;:&quot;459caa56-4ecb-42aa-8c54-5f6d489b7f71&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fba9ede6-a776-44a3-a072-2032ca4b1b28&quot;,&quot;8af368e4-e813-44a7-8dae-e3e203283fa3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:213,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;95b4c8fe-3613-45fb-a4cb-ceac351c32e7&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\crypto\\symmetric.js&quot;,&quot;file&quot;:&quot;\\test\\crypto\\symmetric.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid key&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(&#x27;hello world&#x27;, &#x27;unknown&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aea04199-2284-4648-9732-51ef2c2d8a1d&quot;,&quot;parentUUID&quot;:&quot;95b4c8fe-3613-45fb-a4cb-ceac351c32e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid message&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.encrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ed64c6cc-d45a-4215-99a3-21ff28df0207&quot;,&quot;parentUUID&quot;:&quot;95b4c8fe-3613-45fb-a4cb-ceac351c32e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid ciphertext&quot;,&quot;fullTitle&quot;:&quot;encrypt errors invalid ciphertext&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n])\nsetup.decrypt(12345, &#x27;unknown&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d54b9106-4f47-4f8e-b7cb-ac03a6b5d878&quot;,&quot;parentUUID&quot;:&quot;95b4c8fe-3613-45fb-a4cb-ceac351c32e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;aea04199-2284-4648-9732-51ef2c2d8a1d&quot;,&quot;ed64c6cc-d45a-4215-99a3-21ff28df0207&quot;,&quot;d54b9106-4f47-4f8e-b7cb-ac03a6b5d878&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:320,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e6686338-e454-4235-9f3a-e397e02118d5&quot;,&quot;e82b2d55-b1e1-418c-830c-6d36f103ab3f&quot;,&quot;8bdff09b-efcc-4c2c-b876-3fc62c6879dd&quot;,&quot;9f3a206f-ebfd-47b8-be30-ed7a39081362&quot;,&quot;4ccff3ae-862f-42e8-9704-aa85e3b14a97&quot;,&quot;a52f9a49-e2d3-4f37-93da-86e4c577ab85&quot;,&quot;08982e51-2cc7-4cf6-b818-5063c9113386&quot;,&quot;e0accce6-cfc7-4365-8b8d-eee9e9fe76f0&quot;,&quot;4b87aa07-4bc1-4e55-85b6-a3159751d4d6&quot;,&quot;10ef7faf-d1f7-49e6-ac08-013b36f75852&quot;,&quot;1e47603e-8503-41a8-8849-5844f907b245&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2532,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;95598020-1a0e-420f-a310-14e29d8a2b92&quot;,&quot;title&quot;:&quot;derive/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7800a9c0-6782-4d67-90a9-54da38a437a9&quot;,&quot;parentUUID&quot;:&quot;95598020-1a0e-420f-a310-14e29d8a2b92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.password(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8cd34889-14f5-4254-9118-adffcdc68403&quot;,&quot;parentUUID&quot;:&quot;95598020-1a0e-420f-a310-14e29d8a2b92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7800a9c0-6782-4d67-90a9-54da38a437a9&quot;,&quot;8cd34889-14f5-4254-9118-adffcdc68403&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;be2ebea0-4a2b-4dfc-8746-56a56dd564b9&quot;,&quot;title&quot;:&quot;derive/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b556c859-bc10-48be-90f4-8b151ea0adb8&quot;,&quot;parentUUID&quot;:&quot;be2ebea0-4a2b-4dfc-8746-56a56dd564b9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;derive/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.uuid(&#x27;&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0fc869c2-8e41-476f-bd50-13e7f28012fd&quot;,&quot;parentUUID&quot;:&quot;be2ebea0-4a2b-4dfc-8746-56a56dd564b9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b556c859-bc10-48be-90f4-8b151ea0adb8&quot;,&quot;0fc869c2-8e41-476f-bd50-13e7f28012fd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ece581b8-cdaf-4983-9356-0f20d711d71a&quot;,&quot;title&quot;:&quot;derive/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hkdf&quot;,&quot;fullTitle&quot;:&quot;derive/key hkdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n], { kdf: &#x27;hkdf&#x27; })\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92c6ec63-c737-4d09-a291-183152e54257&quot;,&quot;parentUUID&quot;:&quot;ece581b8-cdaf-4983-9356-0f20d711d71a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;correct&quot;,&quot;fullTitle&quot;:&quot;derive/key correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:590,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b3299a0a-5ef3-462a-893c-800d192952a3&quot;,&quot;parentUUID&quot;:&quot;ece581b8-cdaf-4983-9356-0f20d711d71a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;incorrect&quot;,&quot;fullTitle&quot;:&quot;derive/key incorrect&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:594,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;wrongpassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;wrongpassword3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d714fb17-5ab7-403a-a917-65d916b168d9&quot;,&quot;parentUUID&quot;:&quot;ece581b8-cdaf-4983-9356-0f20d711d71a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;mismatch&quot;,&quot;fullTitle&quot;:&quot;derive/key mismatch&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;password&#x27; })\n])\nmfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec304e48-aacf-45e4-a2d4-b166103c3773&quot;,&quot;parentUUID&quot;:&quot;ece581b8-cdaf-4983-9356-0f20d711d71a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;630d4a9b-f23e-4a7a-a5d9-faa06747acc4&quot;,&quot;title&quot;:&quot;shares&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;derive/key shares valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:468,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.shares.should.deep.equal(setup.shares)\nderive2.shares.should.deep.equal(setup.shares)\nderive3.shares.should.deep.equal(setup.shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;832c7750-cf2a-46d3-9de2-c452ad34ae54&quot;,&quot;parentUUID&quot;:&quot;630d4a9b-f23e-4a7a-a5d9-faa06747acc4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;832c7750-cf2a-46d3-9de2-c452ad34ae54&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:468,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;01556ed4-7728-4607-905a-fd130abb40cf&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\key.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;schema&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid schema&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:115,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\ndelete setup.policy.$id\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4bca39a3-e329-4813-a7a0-31c34f2dc12b&quot;,&quot;parentUUID&quot;:&quot;01556ed4-7728-4607-905a-fd130abb40cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factors&quot;,&quot;fullTitle&quot;:&quot;derive/key invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:117,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e27073bc-a56e-4f1b-9d74-0cee4fc9fa85&quot;,&quot;parentUUID&quot;:&quot;01556ed4-7728-4607-905a-fd130abb40cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4bca39a3-e329-4813-a7a0-31c34f2dc12b&quot;,&quot;e27073bc-a56e-4f1b-9d74-0cee4fc9fa85&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:232,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;92c6ec63-c737-4d09-a291-183152e54257&quot;,&quot;b3299a0a-5ef3-462a-893c-800d192952a3&quot;,&quot;d714fb17-5ab7-403a-a917-65d916b168d9&quot;,&quot;ec304e48-aacf-45e4-a2d4-b166103c3773&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1312,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;title&quot;:&quot;derive/outputs&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\derive\\outputs.js&quot;,&quot;file&quot;:&quot;\\test\\derive\\outputs.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;derive/outputs stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:236,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; })\n  ]),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { size: 8 })\ndelete setup.outputs.stack.entropyBits\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n    uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n  }),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5628b58d-1b01-43b9-92b3-da3a22a0cd17&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;derive/outputs hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n], { size: 8 })\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response = crypto.createHmac(&#x27;sha1&#x27;, secret).update(challenge).digest()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c84c7f4d-31f7-48eb-880b-82938d05ea53&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;derive/outputs uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 8 })\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d912e69d-eeeb-4fb3-9e0c-9701686b5c19&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;derive/outputs question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n], { size: 8 })\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.outputs.question.strength.calc_time = null\nderive.outputs.question.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69acec0d-e617-4815-964b-eaf3a2cbfb4e&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;derive/outputs ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:239,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey({ hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) }, true, [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;])\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey, params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3983bc8e-0c20-4d10-b5d0-7a003d12ef67&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;derive/outputs password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n], { size: 8 })\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.outputs.password.strength.calc_time = null\nderive.outputs.password.strength.calc_time = null\nsetup.outputs.should.deep.equal(derive.outputs)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aba309a5-d345-418c-a953-5ea3fbbbe5b1&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;multiple&quot;,&quot;fullTitle&quot;:&quot;derive/outputs multiple&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nderive.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9b40571f-3ad2-4d6a-8e86-d5edb630b1b3&quot;,&quot;parentUUID&quot;:&quot;1aa8ad19-b25f-4efc-829b-4b0f857c6f42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5628b58d-1b01-43b9-92b3-da3a22a0cd17&quot;,&quot;c84c7f4d-31f7-48eb-880b-82938d05ea53&quot;,&quot;d912e69d-eeeb-4fb3-9e0c-9701686b5c19&quot;,&quot;69acec0d-e617-4815-964b-eaf3a2cbfb4e&quot;,&quot;3983bc8e-0c20-4d10-b5d0-7a003d12ef67&quot;,&quot;aba309a5-d345-418c-a953-5ea3fbbbe5b1&quot;,&quot;9b40571f-3ad2-4d6a-8e86-d5edb630b1b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1582,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7a16034b-dd1b-44bf-a5ad-abe46f9d50e5&quot;,&quot;title&quot;:&quot;examples&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;kdf&quot;,&quot;fullTitle&quot;:&quot;examples kdf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup kdf configuration\nconst config = await mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000,\n  pbkdf2digest: &#x27;sha256&#x27;\n}) // -&gt; { type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } }\n// derive key\nconst key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 8, config)\nkey.toString(&#x27;hex&#x27;) // -&gt; 0394a2ede332c9a1\nconfig.should.deep.equal({ type: &#x27;pbkdf2&#x27;, params: { rounds: 100000, digest: &#x27;sha256&#x27; } })\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;0394a2ede332c9a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22089476-297e-4a47-b14e-0b8d861f2052&quot;,&quot;parentUUID&quot;:&quot;7a16034b-dd1b-44bf-a5ad-abe46f9d50e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive fast&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;169be595-8fc6-4f97-8572-4d2108147e8e&quot;,&quot;parentUUID&quot;:&quot;7a16034b-dd1b-44bf-a5ad-abe46f9d50e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3-factor multi-factor derived key with a password, HOTP code, and UUID recovery code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { threshold: 2, size: 16 })\n// derive key using 2 of the 3 factors\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b8161c1-b9a3-4105-a623-46dcfa8db79a&quot;,&quot;parentUUID&quot;:&quot;7a16034b-dd1b-44bf-a5ad-abe46f9d50e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;stack&quot;,&quot;fullTitle&quot;:&quot;examples factors stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:235,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  }),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64508dbb-a461-4852-beff-03c6f9d2ff62&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;examples factors hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hmacsha1 factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n], { size: 8 })\n// calculate response; could be done using hardware device\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response = crypto.createHmac(&#x27;sha1&#x27;, secret).update(challenge).digest()\n// derive key with hmacsha1 factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9cffd5a1-eac9-443b-8a03-dd574a550713&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp&quot;,&quot;fullTitle&quot;:&quot;examples factors totp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with totp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n], { size: 8 })\n// derive key with totp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5130e5a-2867-43ac-9fdb-a39dddd4e2b4&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hotp&quot;,&quot;fullTitle&quot;:&quot;examples factors hotp&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with hotp factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) })\n], { size: 8 })\n// derive key with hotp factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b33f28bc-f442-4c05-9cb4-d9eafe9f5efa&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;uuid&quot;,&quot;fullTitle&quot;:&quot;examples factors uuid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with uuid factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 8 })\n// derive key with uuid factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a45c12eb-0d7a-4c87-b6a8-92c932c48082&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;question&quot;,&quot;fullTitle&quot;:&quot;examples factors question&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with security question factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;)\n], { size: 8 })\n// derive key with security question factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Fido&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47b067bb-49e3-46ae-a351-75abc180f83e&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ooba&quot;,&quot;fullTitle&quot;:&quot;examples factors ooba&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:284,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup RSA key pair (on out-of-band server)\nconst keyPair = await crypto.webcrypto.subtle.generateKey({ hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) }, true, [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;])\n// setup key with out-of-band authentication factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey, params: { email: &#x27;test@mfkdf.com&#x27; }\n  })\n])\n// decrypt and send code (on out-of-band server)\nconst next = setup.policy.factors[0].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nconst code = JSON.parse(Buffer.from(decrypted).toString()).code\n// derive key with out-of-band factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;997c3c0b-c4a2-4639-b922-1757c311feaf&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;password&quot;,&quot;fullTitle&quot;:&quot;examples factors password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with password factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n], { size: 8 })\n// derive key with password factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c1d3cf04-0fd8-435b-bb12-428e91835f18&quot;,&quot;parentUUID&quot;:&quot;a388d4f2-a634-4da0-900d-e1d9b42ed0e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;64508dbb-a461-4852-beff-03c6f9d2ff62&quot;,&quot;9cffd5a1-eac9-443b-8a03-dd574a550713&quot;,&quot;f5130e5a-2867-43ac-9fdb-a39dddd4e2b4&quot;,&quot;b33f28bc-f442-4c05-9cb4-d9eafe9f5efa&quot;,&quot;a45c12eb-0d7a-4c87-b6a8-92c932c48082&quot;,&quot;47b067bb-49e3-46ae-a351-75abc180f83e&quot;,&quot;997c3c0b-c4a2-4639-b922-1757c311feaf&quot;,&quot;c1d3cf04-0fd8-435b-bb12-428e91835f18&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2735,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;30d22c82-bbb0-4208-a0f9-08df662120d1&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;examples secrets full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// share secret using 2-of-3 shares\nconst shares = mfkdf.secrets.share(Buffer.from(&#x27;hello world&#x27;), 2, 3) // -&gt; [Buffer, Buffer, Buffer]\n// recover secret using 2 shares\nconst secret = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret.toString() // -&gt; hello world\n// recover original 3 shares\nconst recover = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3) // -&gt; [Buffer, Buffer, Buffer]\nrecover.should.be.a(&#x27;array&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6aba0cb7-d4bb-4b3b-854c-43f281d67631&quot;,&quot;parentUUID&quot;:&quot;30d22c82-bbb0-4208-a0f9-08df662120d1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6aba0cb7-d4bb-4b3b-854c-43f281d67631&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;validate&quot;,&quot;fullTitle&quot;:&quot;examples policy validate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// validate policy\nconst valid = mfkdf.policy.validate(setup.policy) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;935a8c8d-be45-468d-872d-f5c4d189275e&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ids&quot;,&quot;fullTitle&quot;:&quot;examples policy ids&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// get list of ids\nconst ids = mfkdf.policy.ids(setup.policy) // -&gt; [&#x27;passwordA&#x27;, &#x27;passwordB&#x27;, &#x27;passwordC&#x27;, ...]\nids.includes(&#x27;passwordA&#x27;).should.be.true\nids.includes(&#x27;passwordB&#x27;).should.be.true\nids.includes(&#x27;passwordC&#x27;).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f79cdf29-26ad-485f-a26a-5a1070d02c0c&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;evaluate&quot;,&quot;fullTitle&quot;:&quot;examples policy evaluate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  )\n)\n// check if key can be derived with passwordA and passwordC\nconst valid1 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordA&#x27;, &#x27;passwordC&#x27;]) // -&gt; true\n// check if key can be derived with passwordB and passwordC\nconst valid2 = await mfkdf.policy.evaluate(setup.policy, [&#x27;passwordB&#x27;, &#x27;passwordC&#x27;]) // -&gt; false\nvalid1.should.be.true\nvalid2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4d97e3d-31d4-471f-8dac-c99ffb6fae28&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup/derive&quot;,&quot;fullTitle&quot;:&quot;examples policy setup/derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:237,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND (passwordB OR passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n    )\n  ), { size: 8 }\n)\n// derive key with passwordA and passwordC (or passwordA and passwordB)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;91b72956-2a2f-4aae-81e9-a121ecc04ad9&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;examples policy all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:237,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA AND passwordB AND passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB and passwordC\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;),\n  passwordC: mfkdf.derive.factors.password(&#x27;passwordC&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d422080-ae62-42f2-8629-3807edf6148e&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;examples policy any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from passwordA OR passwordB OR passwordC\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA (or passwordB or passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4cc08ddf-010b-467a-916b-e35faa1b4d7f&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast2&quot;,&quot;fullTitle&quot;:&quot;examples policy atLeast2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:238,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key that can be derived from at least 2 of (passwordA, passwordB, passwordC)\nconst setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;passwordA&#x27;, { id: &#x27;passwordA&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordB&#x27;, { id: &#x27;passwordB&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;passwordC&#x27;, { id: &#x27;passwordC&#x27; })\n  ]), { size: 8 }\n)\n// derive key with passwordA and passwordB (or passwordA and passwordC, or passwordB and passwordC)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  passwordA: mfkdf.derive.factors.password(&#x27;passwordA&#x27;),\n  passwordB: mfkdf.derive.factors.password(&#x27;passwordB&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nderive.key.toString(&#x27;hex&#x27;) // -&gt; e16a227944a65263\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e88f892a-125d-4e92-adf0-d242801d86e1&quot;,&quot;parentUUID&quot;:&quot;d41b8693-d42a-4d29-8633-85590b7a0ee9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;935a8c8d-be45-468d-872d-f5c4d189275e&quot;,&quot;f79cdf29-26ad-485f-a26a-5a1070d02c0c&quot;,&quot;e4d97e3d-31d4-471f-8dac-c99ffb6fae28&quot;,&quot;91b72956-2a2f-4aae-81e9-a121ecc04ad9&quot;,&quot;0d422080-ae62-42f2-8629-3807edf6148e&quot;,&quot;4cc08ddf-010b-467a-916b-e35faa1b4d7f&quot;,&quot;e88f892a-125d-4e92-adf0-d242801d86e1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1278,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change threshold to 2/3\nawait setup.setThreshold(2)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1ddbb3a-8960-4201-8e4d-7085405b0ea2&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove one of the factors\nawait setup.removeFactor(&#x27;password2&#x27;)\n// derive key with remaining 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35e6c849-52a7-47df-89cb-c8eb27f5d9a4&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 1-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\n// remove two factors\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password2&#x27;])\n// derive key with remaining factor\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2174b13-1e97-415f-81e7-e4c33bf379d9&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:225,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add fourth factor\nawait setup.addFactor(\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n)\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ca888ba-97c8-4749-adb0-edc540f91f4d&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// add two more factors\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; })\n])\n// derive key with any 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password5: mfkdf.derive.factors.password(&#x27;password5&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8b506373-5302-487e-aff5-690beeab4f8b&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change the 2nd factor\nawait setup.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; })\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59dc8dce-4863-43de-9900-3c8b90a21d5f&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// change 2 factors\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;newPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;newPassword3&#x27;, { id: &#x27;password3&#x27; })\n])\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;newPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;newPassword3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a3916098-e409-4b4f-b3d3-ec54e7c2f50d&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;examples reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 2-of-3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 2 })\n// remove 1 factor and add 1 new factor\nawait setup.reconstitute(\n  [&#x27;password1&#x27;], // remove\n  [await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })] // add\n)\n// derive key with new factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc769be2-b9b1-4939-b325-be825a536dc8&quot;,&quot;parentUUID&quot;:&quot;bcaea912-959b-45d7-a1de-5d509ecc9d17&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f1ddbb3a-8960-4201-8e4d-7085405b0ea2&quot;,&quot;35e6c849-52a7-47df-89cb-c8eb27f5d9a4&quot;,&quot;c2174b13-1e97-415f-81e7-e4c33bf379d9&quot;,&quot;5ca888ba-97c8-4749-adb0-edc540f91f4d&quot;,&quot;8b506373-5302-487e-aff5-690beeab4f8b&quot;,&quot;59dc8dce-4863-43de-9900-3c8b90a21d5f&quot;,&quot;a3916098-e409-4b4f-b3d3-ec54e7c2f50d&quot;,&quot;fc769be2-b9b1-4939-b325-be825a536dc8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1805,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;46b92243-8192-4ced-adb2-2cb8a5e82376&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;persistence&quot;,&quot;fullTitle&quot;:&quot;examples persistence persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;256b1542-f38b-496b-9d6c-d17da5fc3737&quot;,&quot;parentUUID&quot;:&quot;46b92243-8192-4ced-adb2-2cb8a5e82376&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;256b1542-f38b-496b-9d6c-d17da5fc3737&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:224,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a2cad168-0f63-4bc9-a799-938ec03dde2a&quot;,&quot;title&quot;:&quot;envelope&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;add/get secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b41c92c-75bb-4106-9549-2fe931542b13&quot;,&quot;parentUUID&quot;:&quot;a2cad168-0f63-4bc9-a799-938ec03dde2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/check/remove secret&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/check/remove secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// check secret\nconst check1 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; true\n// remove secret\nderived.removeEnvelopedSecret(&#x27;mySecret&#x27;)\n// check secret\nconst check2 = derived.hasEnvelopedSecret(&#x27;mySecret&#x27;) // -&gt; false\ncheck1.should.be.true\ncheck2.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e9d9a6b-6335-4c6e-ad88-fdedd34a2b20&quot;,&quot;parentUUID&quot;:&quot;a2cad168-0f63-4bc9-a799-938ec03dde2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;add/get key&quot;,&quot;fullTitle&quot;:&quot;examples envelope add/get key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ca977690-44c4-4763-a1d7-723668a2c0e8&quot;,&quot;parentUUID&quot;:&quot;a2cad168-0f63-4bc9-a799-938ec03dde2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7b41c92c-75bb-4106-9549-2fe931542b13&quot;,&quot;9e9d9a6b-6335-4c6e-ad88-fdedd34a2b20&quot;,&quot;ca977690-44c4-4763-a1d7-723668a2c0e8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:671,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;8027692b-e15e-466b-8088-381a2885c111&quot;,&quot;title&quot;:&quot;crypto&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getSubkey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSubkey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte sub-key for \&quot;eth\&quot; using hkdf/sha256\nconst subkey = await key.getSubkey(16, &#x27;eth&#x27;, &#x27;sha256&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; 54ad9e5acbc1c33b08a15dd79126e9c9&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a447f700-f741-440c-a9ca-940968a94242&quot;,&quot;parentUUID&quot;:&quot;8027692b-e15e-466b-8088-381a2885c111&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getSymmetricKey&quot;,&quot;fullTitle&quot;:&quot;examples crypto getSymmetricKey&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte AES128 sub-key\nconst subkey = await key.getSymmetricKey(&#x27;aes128&#x27;)\nsubkey.toString(&#x27;hex&#x27;) // -&gt; c985454e008e5ecc695e865d339cb2be&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e653b946-be26-4673-8d97-6831da7ff7c9&quot;,&quot;parentUUID&quot;:&quot;8027692b-e15e-466b-8088-381a2885c111&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;getAsymmetricKeyPair&quot;,&quot;fullTitle&quot;:&quot;examples crypto getAsymmetricKeyPair&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:137,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// get 16-byte RSA1024 sub-key\nconst subkey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;) // -&gt; { privateKey: Uint8Array, publicKey: Uint8Array }\nsubkey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;161af209-e43f-4d66-be94-3debfbd4709c&quot;,&quot;parentUUID&quot;:&quot;8027692b-e15e-466b-8088-381a2885c111&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;sign/verify&quot;,&quot;fullTitle&quot;:&quot;examples crypto sign/verify&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:164,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// sign message using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature using RSA-1024\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23c17b0f-92c9-4077-b7ba-4d6ad8f867ed&quot;,&quot;parentUUID&quot;:&quot;8027692b-e15e-466b-8088-381a2885c111&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;encrypt/decrypt&quot;,&quot;fullTitle&quot;:&quot;examples crypto encrypt/decrypt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:117,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// encrypt message using 3DES\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;3des&#x27;)\n// decrypt message using 3DES\nconst decrypted = await key.decrypt(encrypted, &#x27;3des&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db86bc05-a4cd-4634-95d6-be386b1291a8&quot;,&quot;parentUUID&quot;:&quot;8027692b-e15e-466b-8088-381a2885c111&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a447f700-f741-440c-a9ca-940968a94242&quot;,&quot;e653b946-be26-4673-8d97-6831da7ff7c9&quot;,&quot;161af209-e43f-4d66-be94-3debfbd4709c&quot;,&quot;23c17b0f-92c9-4077-b7ba-4d6ad8f867ed&quot;,&quot;db86bc05-a4cd-4634-95d6-be386b1291a8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:631,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;title&quot;:&quot;auth&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\examples.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\examples.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5b750c3d-8e37-4243-b409-996ca69a28f1&quot;,&quot;parentUUID&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:230,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ade9511-dbf4-4ce8-a7bf-6a15fd3dedc2&quot;,&quot;parentUUID&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// challenger: create random challenge\nconst challenge = crypto.randomBytes(32)\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad118f2f-0b9c-4267-8db1-c9350ec2b08d&quot;,&quot;parentUUID&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2dcfa38-d4ec-4d42-9bfc-48d3e9b13ca0&quot;,&quot;parentUUID&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:174,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b32019b-4d30-4109-b19e-9e032df85d72&quot;,&quot;parentUUID&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;examples auth ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\nconst identity = Buffer.from(&#x27;Challenger&#x27;)\n// responder: generate response\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\n// verifier: verify response\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22652da3-a3c5-445a-97c6-11025d16d42c&quot;,&quot;parentUUID&quot;:&quot;a68e47f7-6f23-4dae-a255-0eacfd6e6263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5b750c3d-8e37-4243-b409-996ca69a28f1&quot;,&quot;5ade9511-dbf4-4ce8-a7bf-6a15fd3dedc2&quot;,&quot;ad118f2f-0b9c-4267-8db1-c9350ec2b08d&quot;,&quot;f2dcfa38-d4ec-4d42-9bfc-48d3e9b13ca0&quot;,&quot;4b32019b-4d30-4109-b19e-9e032df85d72&quot;,&quot;22652da3-a3c5-445a-97c6-11025d16d42c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:833,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;22089476-297e-4a47-b14e-0b8d861f2052&quot;,&quot;169be595-8fc6-4f97-8572-4d2108147e8e&quot;,&quot;4b8161c1-b9a3-4105-a623-46dcfa8db79a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:258,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;27f807ea-dec5-4406-962a-c1d80f2d5605&quot;,&quot;title&quot;:&quot;site&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\site.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\site.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Go beyond passwords&quot;,&quot;fullTitle&quot;:&quot;site Go beyond passwords&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify((\n  await mfkdf.setup.key([\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;recovery&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n  ], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n).policy)\nconst derivedKey = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  password: mfkdf.derive.factors.password(&#x27;Tr0ub4dour&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  recovery: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderivedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd09f3e7-3b54-4b6e-8c8b-d1fee8a2ffc8&quot;,&quot;parentUUID&quot;:&quot;27f807ea-dec5-4406-962a-c1d80f2d5605&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Increased key entropy&quot;,&quot;fullTitle&quot;:&quot;site Increased key entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;Math.floor((await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n])).entropyBits.real).should.equal(16)\nMath.floor((await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.hmacsha1()\n])).entropyBits.real).should.equal(196)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ebb2266-5372-407c-a5dc-4ed4b5f0599d&quot;,&quot;parentUUID&quot;:&quot;27f807ea-dec5-4406-962a-c1d80f2d5605&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enforce advanced policies&quot;,&quot;fullTitle&quot;:&quot;site Enforce advanced policies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:739,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policyBasedKey = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n      await mfkdf.setup.factors.totp()\n    )\n  )\n)\npolicyBasedKey.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da170c4e-29c5-4721-87d7-b3fbc0036295&quot;,&quot;parentUUID&quot;:&quot;27f807ea-dec5-4406-962a-c1d80f2d5605&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Self-service factor recovery&quot;,&quot;fullTitle&quot;:&quot;site Self-service factor recovery&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPolicy = JSON.stringify((\n  await mfkdf.setup.key([\n    await mfkdf.setup.factors.password(&#x27;password&#x27;),\n    await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n    await mfkdf.setup.factors.uuid({ id: &#x27;recoveryCode&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n  ], { threshold: 2, size: 16, kdf: &#x27;pbkdf2&#x27;, pbkdf2rounds: 1 })\n).policy)\nconst key = await mfkdf.derive.key(JSON.parse(keyPolicy), {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  recoveryCode: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nawait key.recoverFactor(\n  await mfkdf.setup.factors.password(&#x27;myNewPassword&#x27;, { id: &#x27;password&#x27; })\n) // modify key to use new password factor&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c80b8b44-cdec-4e71-9d69-a0b42afdb37e&quot;,&quot;parentUUID&quot;:&quot;27f807ea-dec5-4406-962a-c1d80f2d5605&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dd09f3e7-3b54-4b6e-8c8b-d1fee8a2ffc8&quot;,&quot;4ebb2266-5372-407c-a5dc-4ed4b5f0599d&quot;,&quot;da170c4e-29c5-4721-87d7-b3fbc0036295&quot;,&quot;c80b8b44-cdec-4e71-9d69-a0b42afdb37e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:978,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;title&quot;:&quot;tutorials&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\examples\\tutorials.js&quot;,&quot;file&quot;:&quot;\\test\\examples\\tutorials.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Auth&quot;,&quot;fullTitle&quot;:&quot;tutorials Auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cab9c6b6-26cd-45f1-ab73-cd370ff878e3&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloepd Key&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloepd Key&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped rsa1024 key\nawait key.addEnvelopedKey(&#x27;myKey&#x27;, &#x27;rsa1024&#x27;)\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve enveloped key\nconst enveloped = await derived.getEnvelopedKey(&#x27;myKey&#x27;) // -&gt; PrivateKeyObject\nenveloped.should.be.a(&#x27;object&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cb5cad1f-0cf5-4ac8-b61b-08580d9a0d7f&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Enveloped Secret&quot;,&quot;fullTitle&quot;:&quot;tutorials Enveloped Secret&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup multi-factor derived key\nconst key = await mfkdf.setup.key([await mfkdf.setup.factors.password(&#x27;password&#x27;)])\n// add enveloped secret to key\nawait key.addEnvelopedSecret(&#x27;mySecret&#x27;, Buffer.from(&#x27;hello world&#x27;))\n// later... derive key\nconst derived = await mfkdf.derive.key(key.policy, { password: mfkdf.derive.factors.password(&#x27;password&#x27;) })\n// retrieve secret\nconst secret = await derived.getEnvelopedSecret(&#x27;mySecret&#x27;)\nsecret.toString() // -&gt; hello world\nsecret.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;133e2dcb-9157-4cff-abac-c475f63284af&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Persistence&quot;,&quot;fullTitle&quot;:&quot;tutorials Persistence&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:226,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\n// persist one of the factors\nconst factor2 = setup.persistFactor(&#x27;password2&#x27;)\n// derive key with 2 factors\nconst derived = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.persisted(factor2),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 64587f2a0e65dc3c\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86ffceb9-bd6f-4d40-985a-11a0e2150f89&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Signing &amp; Verification&quot;,&quot;fullTitle&quot;:&quot;tutorials Signing &amp; Verification&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:215,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// sign message with derived key using RSA-1024\nconst signature = await key.sign(&#x27;hello world&#x27;, &#x27;rsa1024&#x27;)\n// verify signature\nconst valid = await key.verify(&#x27;hello world&#x27;, signature, &#x27;rsa1024&#x27;) // -&gt; true\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55e25127-ed7a-4633-8676-0fc231f7e7ee&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Encryption &amp; Decryption&quot;,&quot;fullTitle&quot;:&quot;tutorials Encryption &amp; Decryption&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 3-factor multi-factor derived key\nconst key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.uuid()\n])\n// encrypt secret with derived key using AES-256\nconst encrypted = await key.encrypt(&#x27;hello world&#x27;, &#x27;aes256&#x27;)\n// ... later, decrypt secret with derived key\nconst decrypted = await key.decrypt(encrypted, &#x27;aes256&#x27;)\ndecrypted.toString() // -&gt; hello world\ndecrypted.toString().should.equal(&#x27;hello world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a32ed9f-8b6b-4ded-a293-f9a946dd89b1&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Reconstitution&quot;,&quot;fullTitle&quot;:&quot;tutorials Reconstitution&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:229,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// reconstitute key to change password\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;newPassword&#x27;))\n// derive key using the 3 factors (including the new password)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: mfkdf.derive.factors.password(&#x27;newPassword&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;83b109c0-5bea-45ea-91e6-ed55dc154e14&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Stacking&quot;,&quot;fullTitle&quot;:&quot;tutorials Stacking&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:233,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup key with stack factor\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ]),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { size: 8, threshold: 1 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\n// derive key with stack factor\nconst derive = await mfkdf.derive.key(setup.policy, {\n  stack: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 01d0c7236adf2516\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;43203950-2c6a-4364-94e1-3e637b12b55c&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Policy&quot;,&quot;fullTitle&quot;:&quot;tutorials Policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:247,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Setup policy-based multi-factor derived key\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\npolicy.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// Check which factors can derive key\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]) // -&gt; true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]) // -&gt; false\n// Derive policy-based multi-factor derived key\nconst derived = await mfkdf.policy.derive(policy.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderived.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password3&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\npolicy.key.toString(&#x27;hex&#x27;).should.equal(derived.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff40eaa9-8ddf-47ac-b0d2-726f813317f0&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Threshold&quot;,&quot;fullTitle&quot;:&quot;tutorials Threshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 2-of-3 multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16, threshold: 2 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\nsetup.key.toString(&#x27;hex&#x27;).should.include(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2dc70e1a-7d48-4ae5-9ddd-f5e52e689916&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Entropy&quot;,&quot;fullTitle&quot;:&quot;tutorials Entropy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:662,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// password-only 256-bit key\nconst key1 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;)\n], { size: 32 })\nkey1.entropyBits.real // -&gt; 16.53929514807314\n// password-and-hotp 256-bit key\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;),\n  await mfkdf.setup.factors.hotp()\n], { size: 32 })\nkey2.entropyBits.real // -&gt; 36.470863717397314\nMath.floor(key1.entropyBits.real).should.equal(16)\nMath.floor(key2.entropyBits.real).should.equal(36)\nconst weak = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;)\n], { size: 32 })\n// High theoretical entropy due to long password\nweak.entropyBits.theoretical // -&gt; 64\n// Low real entropy due to weak password\nweak.entropyBits.real // -&gt; 5.044394119358453\nMath.floor(weak.entropyBits.theoretical).should.equal(64)\nMath.floor(weak.entropyBits.real).should.equal(5)\nconst all = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32 })\nconst threshold = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.uuid(),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password2&#x27; })\n], { size: 32, threshold: 2 })\nall.entropyBits.real // -&gt; 143.5836892674316\nthreshold.entropyBits.real // -&gt; 21.583689267431595\nMath.floor(all.entropyBits.real).should.equal(143)\nMath.floor(threshold.entropyBits.real).should.equal(21)\nconst policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\npolicy.entropyBits.real // -&gt; 45.27245744876085\nMath.floor(policy.entropyBits.real).should.equal(45)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f0d1c9d7-6bbc-4dbd-bcd2-4c40714e8fd6&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Multi-Factor Key Derivation&quot;,&quot;fullTitle&quot;:&quot;tutorials Multi-Factor Key Derivation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:222,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// setup 16 byte 3-factor multi-factor derived key with a password, HOTP code, and UUID code\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;),\n  await mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }),\n  await mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; })\n], { size: 16 })\nsetup.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save key policy\nconst policy = JSON.stringify(setup.policy)\n// derive key using the 3 factors\nconst derive = await mfkdf.derive.key(JSON.parse(policy), {\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;),\n  hotp: mfkdf.derive.factors.hotp(365287),\n  uuid: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;) // -&gt; 34d20ced439ec2f871c96ca377f25771\n// save new key policy\nconst newPolicy = JSON.stringify(derive.policy)\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nnewPolicy.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e847bd9-ee1c-4e4c-9fe9-fcc5a6bf6348&quot;,&quot;parentUUID&quot;:&quot;07ff24b6-5188-4a1b-9f5a-b8a2cfbf1809&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cab9c6b6-26cd-45f1-ab73-cd370ff878e3&quot;,&quot;cb5cad1f-0cf5-4ac8-b61b-08580d9a0d7f&quot;,&quot;133e2dcb-9157-4cff-abac-c475f63284af&quot;,&quot;86ffceb9-bd6f-4d40-985a-11a0e2150f89&quot;,&quot;55e25127-ed7a-4633-8676-0fc231f7e7ee&quot;,&quot;8a32ed9f-8b6b-4ded-a293-f9a946dd89b1&quot;,&quot;83b109c0-5bea-45ea-91e6-ed55dc154e14&quot;,&quot;43203950-2c6a-4364-94e1-3e637b12b55c&quot;,&quot;ff40eaa9-8ddf-47ac-b0d2-726f813317f0&quot;,&quot;2dc70e1a-7d48-4ae5-9ddd-f5e52e689916&quot;,&quot;f0d1c9d7-6bbc-4dbd-bcd2-4c40714e8fd6&quot;,&quot;6e847bd9-ee1c-4e4c-9fe9-fcc5a6bf6348&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2825,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;177e2391-91c5-44ae-b1d6-f65a62729484&quot;,&quot;title&quot;:&quot;factors/hmacsha1&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;hmacsha1&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 hmacsha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = Buffer.from(&#x27;e60ab41d81d5494a90593d484d68f676a60a2450&#x27;, &#x27;hex&#x27;)\nconst challenge = Buffer.from(&#x27;hello&#x27;)\nconst res = crypto.createHmac(&#x27;sha1&#x27;, key)\n  .update(challenge)\n  .digest(&#x27;hex&#x27;)\nconst real = &#x27;1292826fd25cdc59e5f83d3e11aa561610562875&#x27;\nres.should.equal(real)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4158fec-8375-4b06-a3b6-93d4dcfae484&quot;,&quot;parentUUID&quot;:&quot;177e2391-91c5-44ae-b1d6-f65a62729484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:330,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hmacsha1()\n])\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge1 = Buffer.from(setup.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response1 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge1)\n  .digest()\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response1)\n})\nconst challenge2 = Buffer.from(derive1.policy.factors[0].params.challenge, &#x27;hex&#x27;)\nconst response2 = crypto.createHmac(&#x27;sha1&#x27;, secret)\n  .update(challenge2)\n  .digest()\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(response2)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;15bf2ad9-442b-434a-8200-9ed703c29060&quot;,&quot;parentUUID&quot;:&quot;177e2391-91c5-44ae-b1d6-f65a62729484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = &#x27;{\&quot;$schema\&quot;:\&quot;https://mfkdf.com/schema/v1.0.0/policy.json\&quot;,\&quot;$id\&quot;:\&quot;8b6874f7-5dbb-4196-bc89-347cd6b02dc6\&quot;,\&quot;size\&quot;:32,\&quot;threshold\&quot;:1,\&quot;salt\&quot;:\&quot;nhh2/3AwOf2r2n7uRONoM697IjEKsHfAeyo8NxF1G94=\&quot;,\&quot;kdf\&quot;:{\&quot;type\&quot;:\&quot;argon2id\&quot;,\&quot;params\&quot;:{\&quot;rounds\&quot;:2,\&quot;memory\&quot;:24576,\&quot;parallelism\&quot;:1}},\&quot;factors\&quot;:[{\&quot;id\&quot;:\&quot;hmacsha1\&quot;,\&quot;type\&quot;:\&quot;hmacsha1\&quot;,\&quot;pad\&quot;:\&quot;PsS1B6fPovsuMfKZinw6hn0kTw1VEpoM8jRFR/8SyT0=\&quot;,\&quot;params\&quot;:{\&quot;challenge\&quot;:\&quot;5a5f71c3a584b797d3c8f7d0f59653a2234781b06f2540df42946aa380f634a3430e6aad294e392543cc4ecd3da039bfa8041b179d14afd360a104e3354f01dd\&quot;,\&quot;pad\&quot;:\&quot;f8d33204be0436f2629d5173e9bd3fc1953cf982\&quot;}}]}&#x27;\nconst derive = await mfkdf.derive.key(JSON.parse(setup), {\n  hmacsha1: mfkdf.derive.factors.hmacsha1(Buffer.from(&#x27;0f09b8c89bfefdbc4909432685358eca79912b6a&#x27;, &#x27;hex&#x27;))\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(&#x27;ca76d2b456be4e40ba6ef65a68fbfc71bf27a0ca3e0fa4481a2ddf29fb6b65d9&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;628b04e6-b41d-464e-9720-2c00735d6951&quot;,&quot;parentUUID&quot;:&quot;177e2391-91c5-44ae-b1d6-f65a62729484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d9c873d9-e84d-43cb-b54d-a5cd14ac1160&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hmacsha1.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hmacsha1.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ea36785-ba62-44e2-bf48-b95b831eabef&quot;,&quot;parentUUID&quot;:&quot;d9c873d9-e84d-43cb-b54d-a5cd14ac1160&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0bf9e699-5112-41b8-bb18-ea9f1c20f7bb&quot;,&quot;parentUUID&quot;:&quot;d9c873d9-e84d-43cb-b54d-a5cd14ac1160&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e499ffbf-87d4-442f-b255-54ec66a521d7&quot;,&quot;parentUUID&quot;:&quot;d9c873d9-e84d-43cb-b54d-a5cd14ac1160&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/range&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors secret/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hmacsha1({ secret: Buffer.from(&#x27;12345&#x27;) }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fac6da66-5fb8-4f2f-89bc-0ae5b4ce7cb6&quot;,&quot;parentUUID&quot;:&quot;d9c873d9-e84d-43cb-b54d-a5cd14ac1160&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;response/type&quot;,&quot;fullTitle&quot;:&quot;factors/hmacsha1 errors response/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hmacsha1(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;504f2170-0381-403b-ab49-a98400ca0112&quot;,&quot;parentUUID&quot;:&quot;d9c873d9-e84d-43cb-b54d-a5cd14ac1160&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ea36785-ba62-44e2-bf48-b95b831eabef&quot;,&quot;0bf9e699-5112-41b8-bb18-ea9f1c20f7bb&quot;,&quot;e499ffbf-87d4-442f-b255-54ec66a521d7&quot;,&quot;fac6da66-5fb8-4f2f-89bc-0ae5b4ce7cb6&quot;,&quot;504f2170-0381-403b-ab49-a98400ca0112&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;e4158fec-8375-4b06-a3b6-93d4dcfae484&quot;,&quot;15bf2ad9-442b-434a-8200-9ed703c29060&quot;,&quot;628b04e6-b41d-464e-9720-2c00735d6951&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:442,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;93db4102-3e3a-4bf4-a53a-4ae8059dd0ef&quot;,&quot;title&quot;:&quot;factors/hotp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/hotp valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:436,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp({\n    secret: Buffer.from(&#x27;hello world&#x27;)\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.hotp(365287)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  hotp: mfkdf.derive.factors.hotp(891649)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  hotp: mfkdf.derive.factors.hotp(795484)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nderive1.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1429384f-2def-4758-8f14-30c9b54eef76&quot;,&quot;parentUUID&quot;:&quot;93db4102-3e3a-4bf4-a53a-4ae8059dd0ef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/hotp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d9234d4b-2b6c-4922-812c-f288a72c738c&quot;,&quot;parentUUID&quot;:&quot;93db4102-3e3a-4bf4-a53a-4ae8059dd0ef&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\hotp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\hotp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.hotp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d81d4564-68c1-4a21-acf0-6375b973eba5&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24910368-27ce-4eeb-b2ae-58107afd9573&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfb8d090-623c-4d0b-8c14-3d791b546b74&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24edc664-6249-42dd-882c-4c3413e641e7&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9c02dac4-ef45-4979-9642-adfcdb12ce24&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7dc5bb3-3b77-4b36-a6ea-a98c1ae1412c&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.hotp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;016f1c49-2af8-486e-b4c0-8b7d0c531dc3&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/hotp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.hotp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5162439-9e14-49ea-a242-712d77a804d7&quot;,&quot;parentUUID&quot;:&quot;65664ce1-2985-4f8f-94e4-c7554f19355a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d81d4564-68c1-4a21-acf0-6375b973eba5&quot;,&quot;24910368-27ce-4eeb-b2ae-58107afd9573&quot;,&quot;dfb8d090-623c-4d0b-8c14-3d791b546b74&quot;,&quot;24edc664-6249-42dd-882c-4c3413e641e7&quot;,&quot;9c02dac4-ef45-4979-9642-adfcdb12ce24&quot;,&quot;b7dc5bb3-3b77-4b36-a6ea-a98c1ae1412c&quot;,&quot;016f1c49-2af8-486e-b4c0-8b7d0c531dc3&quot;,&quot;b5162439-9e14-49ea-a242-712d77a804d7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;1429384f-2def-4758-8f14-30c9b54eef76&quot;,&quot;d9234d4b-2b6c-4922-812c-f288a72c738c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:541,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;791398d6-4682-4004-b5b2-a5d638ddb80a&quot;,&quot;title&quot;:&quot;factors/ooba&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;factors/ooba full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:492,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  { hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.ooba({\n    key: keyPair.publicKey,\n    params: {\n      email: &#x27;test@mfkdf.com&#x27;\n    }\n  })\n])\nlet next = setup.policy.factors[0].params.next\nlet decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nlet json = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\nlet code = json.code\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  ooba: mfkdf.derive.factors.ooba(code)\n})\nnext = derive1.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toLowerCase())\n})\nnext = derive2.policy.factors[0].params.next\ndecrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\njson = JSON.parse(Buffer.from(decrypted).toString())\njson.email.should.equal(&#x27;test@mfkdf.com&#x27;)\ncode = json.code\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  ooba: mfkdf.derive.factors.ooba(code.toUpperCase())\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;396cf7b8-432f-4993-a7b8-220bf62c1d39&quot;,&quot;parentUUID&quot;:&quot;791398d6-4682-4004-b5b2-a5d638ddb80a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;3db5b53a-d7e6-49af-8053-124418ffc59f&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\ooba.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\ooba.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.ooba(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59dbb2fa-b0a4-4b69-9b01-41e5ed396057&quot;,&quot;parentUUID&quot;:&quot;3db5b53a-d7e6-49af-8053-124418ffc59f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/ooba errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  { hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nmfkdf.setup.factors.ooba({\n  id: 12345\n}).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.ooba({\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.ooba({\n  length: &#x27;foo&#x27;\n}).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.ooba({\n  length: 0\n}).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.ooba({\n  length: 100\n}).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.ooba({\n  key: &#x27;12345&#x27;\n}).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.ooba({\n  key: keyPair.publicKey,\n  params: &#x27;12345&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;595b31db-6fcb-4e7b-8bc6-07079eb5e46f&quot;,&quot;parentUUID&quot;:&quot;3db5b53a-d7e6-49af-8053-124418ffc59f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;59dbb2fa-b0a4-4b69-9b01-41e5ed396057&quot;,&quot;595b31db-6fcb-4e7b-8bc6-07079eb5e46f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:19,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;396cf7b8-432f-4993-a7b8-220bf62c1d39&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:492,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;694160f9-5a3c-43a9-806b-edff6e293832&quot;,&quot;title&quot;:&quot;persistence&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\persistence.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\persistence.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;persistence valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.hotp(),\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n])\nconst hotp = setup.persistFactor(&#x27;hotp&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  hotp: mfkdf.derive.factors.persisted(hotp),\n  password: mfkdf.derive.factors.password(&#x27;password&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c42f6e8c-f381-4af9-b0e1-d64d91d04434&quot;,&quot;parentUUID&quot;:&quot;694160f9-5a3c-43a9-806b-edff6e293832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;share/type&quot;,&quot;fullTitle&quot;:&quot;persistence share/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.persisted(&#x27;12345&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;455b7930-af22-47df-8595-43847f2d9f4a&quot;,&quot;parentUUID&quot;:&quot;694160f9-5a3c-43a9-806b-edff6e293832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c42f6e8c-f381-4af9-b0e1-d64d91d04434&quot;,&quot;455b7930-af22-47df-8595-43847f2d9f4a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:220,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;77568b00-59f8-42d0-9e98-f2cf5869dbfc&quot;,&quot;title&quot;:&quot;factors/question&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/question valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27; Fido-&#x27;, { question: &#x27;What is the name of your first pet?&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;-f_i%d#o ? &#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12329fb1-d01c-45b4-9214-2d70100d802f&quot;,&quot;parentUUID&quot;:&quot;77568b00-59f8-42d0-9e98-f2cf5869dbfc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/question invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:221,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.question(&#x27;Fido&#x27;, { question: &#x27;What is the name of your first pet?&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  question: mfkdf.derive.factors.question(&#x27;Rex&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20c517f4-40fd-41bc-af79-409857f8ba1f&quot;,&quot;parentUUID&quot;:&quot;77568b00-59f8-42d0-9e98-f2cf5869dbfc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a511124d-0439-4180-8b88-443265183a8a&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\question.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\question.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;derive&quot;,&quot;fullTitle&quot;:&quot;factors/question errors derive&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.question(123)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.derive.factors.question(&#x27;&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0295e5aa-920c-4286-b93c-4b93a75d2e72&quot;,&quot;parentUUID&quot;:&quot;a511124d-0439-4180-8b88-443265183a8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;setup&quot;,&quot;fullTitle&quot;:&quot;factors/question errors setup&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.question(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.question(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.question(&#x27;hello&#x27;, { question: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eac4ed37-2a9d-4bea-808a-3db21c094ed5&quot;,&quot;parentUUID&quot;:&quot;a511124d-0439-4180-8b88-443265183a8a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0295e5aa-920c-4286-b93c-4b93a75d2e72&quot;,&quot;eac4ed37-2a9d-4bea-808a-3db21c094ed5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;12329fb1-d01c-45b4-9214-2d70100d802f&quot;,&quot;20c517f4-40fd-41bc-af79-409857f8ba1f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:440,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d891406c-a29a-4214-ba00-cd2fd90e48e5&quot;,&quot;title&quot;:&quot;factors/stack&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\stack.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\stack.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;errors/id/type&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a95b5b51-1861-4626-93fb-3a12335c9e2f&quot;,&quot;parentUUID&quot;:&quot;d891406c-a29a-4214-ba00-cd2fd90e48e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;errors/id/range&quot;,&quot;fullTitle&quot;:&quot;factors/stack errors/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.stack([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b385ea1f-b190-4f50-a277-53fb018dc610&quot;,&quot;parentUUID&quot;:&quot;d891406c-a29a-4214-ba00-cd2fd90e48e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/stack valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:360,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n  ], { id: &#x27;stack1&#x27; }),\n  await mfkdf.setup.factors.stack([\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ], { id: &#x27;stack2&#x27; })\n], { threshold: 1 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  stack1: mfkdf.derive.factors.stack({\n    password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n    password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n  })\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  stack2: mfkdf.derive.factors.stack({\n    password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n    password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n  })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3bcd24e3-dfda-409e-9817-a3bfcf5ca467&quot;,&quot;parentUUID&quot;:&quot;d891406c-a29a-4214-ba00-cd2fd90e48e5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a95b5b51-1861-4626-93fb-3a12335c9e2f&quot;,&quot;b385ea1f-b190-4f50-a277-53fb018dc610&quot;,&quot;3bcd24e3-dfda-409e-9817-a3bfcf5ca467&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:362,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;ab3588a9-53ab-4abe-8250-d411376ece69&quot;,&quot;title&quot;:&quot;factors/totp&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;dynamic&quot;,&quot;fullTitle&quot;:&quot;factors/totp dynamic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])\nconst code = parseInt(speakeasy.totp({\n  secret: setup.outputs.totp.secret.toString(&#x27;hex&#x27;),\n  encoding: &#x27;hex&#x27;,\n  step: setup.outputs.totp.period,\n  algorithm: setup.outputs.totp.algorithm,\n  digits: setup.outputs.totp.digits\n}))\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  totp: mfkdf.derive.factors.totp(code)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d6c068b1-147a-44f5-8445-5486e5ab5d6f&quot;,&quot;parentUUID&quot;:&quot;ab3588a9-53ab-4abe-8250-d411376ece69&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;static&quot;,&quot;fullTitle&quot;:&quot;factors/totp static&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1075,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1650430943604 })\n})\nconst derive2 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(99922, { time: 1650430991083 })\n})\nconst derive3 = await mfkdf.derive.key(derive1.policy, {\n  totp: mfkdf.derive.factors.totp(398884, { time: 1650431018392 })\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec8a7926-b9d7-4ca1-b9ea-8e9f7efaa9a6&quot;,&quot;parentUUID&quot;:&quot;ab3588a9-53ab-4abe-8250-d411376ece69&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;factors/totp defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:747,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp()\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5883492e-1ee7-4141-b416-a33f45f87600&quot;,&quot;parentUUID&quot;:&quot;ab3588a9-53ab-4abe-8250-d411376ece69&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\totp.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\totp.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;code/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(&#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c73b40e-46ac-42aa-8e94-190aba6fe2d0&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;code/window&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors code/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:719,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({\n    secret: Buffer.from(&#x27;hello world&#x27;),\n    time: 1650430806597\n  })\n])\nmfkdf.derive.key(setup.policy, {\n  totp: mfkdf.derive.factors.totp(528258, { time: 1750430943604 })\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2fcb96d-bddc-4b4f-aa5a-4e4db3442a42&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: &#x27;hello&#x27; })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8905eedb-9238-4c02-8aa6-fca9b98f0be5&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.derive.factors.totp(12345, { time: -1 })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e31a212f-ec14-4b28-ac38-c9dc42c13eee&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: 12345\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;987a5fba-67e9-4ba2-9a8e-4c5ac4210e65&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  id: &#x27;&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4cf0ea8-e2c0-4991-bb75-8a0592c8d7a5&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ffc91eb8-7973-416f-8a0f-6cb3c346f0d3&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/low&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/low&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 4\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;93ac69b6-cab4-4a77-9c66-fa0d0f0903e7&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;digits/high&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors digits/high&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  digits: 9\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2d7361f7-c355-4525-9675-1b5812a14832&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;hash/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors hash/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.factors.totp({\n  secret: Buffer.from(&#x27;hello world&#x27;),\n  hash: &#x27;sha123&#x27;\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfbdea40-6768-4258-8b6f-f6d024763a83&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;secret/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors secret/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  secret: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;796c662d-1d6e-42ee-9bbc-f7aae197b469&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;775857b0-a866-4d21-8a05-6466b5f7dc06&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;time/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors time/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  time: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55ac6988-5c29-4497-8e1c-c60efdf9c4fb&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4fb2564-8818-4915-ad8b-2cc4786d205e&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;step/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors step/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  step: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b3ed27af-b8aa-4211-9835-2e9ddb32024a&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/type&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: &#x27;hello&#x27;\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;626fa015-533a-416e-9d68-ec3f006438eb&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;window/range&quot;,&quot;fullTitle&quot;:&quot;factors/totp errors window/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.totp({\n  window: -1\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;498e83ac-68f0-476d-8ca0-709ed05c95a4&quot;,&quot;parentUUID&quot;:&quot;58a72b9c-4d0b-4ca6-9378-f9f7027ce2dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2c73b40e-46ac-42aa-8e94-190aba6fe2d0&quot;,&quot;a2fcb96d-bddc-4b4f-aa5a-4e4db3442a42&quot;,&quot;8905eedb-9238-4c02-8aa6-fca9b98f0be5&quot;,&quot;e31a212f-ec14-4b28-ac38-c9dc42c13eee&quot;,&quot;987a5fba-67e9-4ba2-9a8e-4c5ac4210e65&quot;,&quot;d4cf0ea8-e2c0-4991-bb75-8a0592c8d7a5&quot;,&quot;ffc91eb8-7973-416f-8a0f-6cb3c346f0d3&quot;,&quot;93ac69b6-cab4-4a77-9c66-fa0d0f0903e7&quot;,&quot;2d7361f7-c355-4525-9675-1b5812a14832&quot;,&quot;dfbdea40-6768-4258-8b6f-f6d024763a83&quot;,&quot;796c662d-1d6e-42ee-9bbc-f7aae197b469&quot;,&quot;775857b0-a866-4d21-8a05-6466b5f7dc06&quot;,&quot;55ac6988-5c29-4497-8e1c-c60efdf9c4fb&quot;,&quot;f4fb2564-8818-4915-ad8b-2cc4786d205e&quot;,&quot;b3ed27af-b8aa-4211-9835-2e9ddb32024a&quot;,&quot;626fa015-533a-416e-9d68-ec3f006438eb&quot;,&quot;498e83ac-68f0-476d-8ca0-709ed05c95a4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:721,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;d6c068b1-147a-44f5-8445-5486e5ab5d6f&quot;,&quot;ec8a7926-b9d7-4ca1-b9ea-8e9f7efaa9a6&quot;,&quot;5883492e-1ee7-4141-b416-a33f45f87600&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2934,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;d490c09f-0b6f-4fa6-a730-f26c5a8d5062&quot;,&quot;title&quot;:&quot;factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:574,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nsetup.outputs.should.deep.equal({\n  uuid1: { uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; },\n  uuid2: { uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; },\n  uuid3: { uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; }\n})\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.equal(derive4.key.toString(&#x27;hex&#x27;))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive1.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive2.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive3.policy))\nJSON.stringify(setup.policy).should.equal(JSON.stringify(derive4.policy))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;80d623d7-f4dc-4db1-9dec-f10a74c67500&quot;,&quot;parentUUID&quot;:&quot;d490c09f-0b6f-4fa6-a730-f26c5a8d5062&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;factors/uuid invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:574,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid1&#x27;, uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid2&#x27;, uuid: &#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27; }),\n  await mfkdf.setup.factors.uuid({ id: &#x27;uuid3&#x27;, uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\n], { threshold: 2 })\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6e&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;)\n})\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0c&#x27;)\n})\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6b&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0d&#x27;)\n})\nconst derive4 = await mfkdf.derive.key(setup.policy, {\n  uuid1: mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-ab8dfbbd4bed&#x27;),\n  uuid2: mfkdf.derive.factors.uuid(&#x27;1b9d6bcd-bbfd-4b2d-9b5d-2b0d7b3dcb6d&#x27;),\n  uuid3: mfkdf.derive.factors.uuid(&#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27;)\n})\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive1.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive2.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive3.key.toString(&#x27;hex&#x27;))\nsetup.key.toString(&#x27;hex&#x27;).should.not.equal(derive4.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;150421cf-d416-4b72-8940-74379278f813&quot;,&quot;parentUUID&quot;:&quot;d490c09f-0b6f-4fa6-a730-f26c5a8d5062&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;80d623d7-f4dc-4db1-9dec-f10a74c67500&quot;,&quot;150421cf-d416-4b72-8940-74379278f813&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1148,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;acd4c515-1643-4780-8479-8e37a770b776&quot;,&quot;title&quot;:&quot;authentication&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;getKey/auth&quot;,&quot;fullTitle&quot;:&quot;authentication getKey/auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13560,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nlet authKey\nlet encKey\nauthKey = await key.getSymmetricKey(&#x27;des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;3des&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;3des&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes128&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes128&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes192&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes192&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getSymmetricKey(&#x27;aes256&#x27;, true)\nencKey = await key.getSymmetricKey(&#x27;aes256&#x27;, false)\nauthKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;ed25519&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa1024&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa2048&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))\nauthKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, true)\nencKey = await key.getAsymmetricKeyPair(&#x27;rsa3072&#x27;, false)\nauthKey.publicKey.toString(&#x27;hex&#x27;).should.not.equal(encKey.publicKey.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7af8eb5a-af98-42a1-b755-222cf3a40479&quot;,&quot;parentUUID&quot;:&quot;acd4c515-1643-4780-8479-8e37a770b776&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;title&quot;:&quot;valid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a7877a2-9b45-426b-9ffb-4cc0ea504dfe&quot;,&quot;parentUUID&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:165,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0cb28be7-0e44-4011-a0ab-06fd96d2d9a1&quot;,&quot;parentUUID&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64f6b4d1-1ee3-47f7-83af-2ec6756d23ce&quot;,&quot;parentUUID&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;542397fc-0966-41c7-8ee9-5fcdf93e2b90&quot;,&quot;parentUUID&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:439,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36968402-48db-4a02-b22d-0597caaea11a&quot;,&quot;parentUUID&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication valid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d2fef2e-5ca7-4ae6-8175-918e7215b0e7&quot;,&quot;parentUUID&quot;:&quot;644b922f-b621-4723-b057-c4117a2160bd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1a7877a2-9b45-426b-9ffb-4cc0ea504dfe&quot;,&quot;0cb28be7-0e44-4011-a0ab-06fd96d2d9a1&quot;,&quot;64f6b4d1-1ee3-47f7-83af-2ec6756d23ce&quot;,&quot;542397fc-0966-41c7-8ee9-5fcdf93e2b90&quot;,&quot;36968402-48db-4a02-b22d-0597caaea11a&quot;,&quot;4d2fef2e-5ca7-4ae6-8175-918e7215b0e7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1032,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;title&quot;:&quot;invalid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\authentication.js&quot;,&quot;file&quot;:&quot;\\test\\features\\authentication.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:219,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthSymmetric(challenge, identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthSymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21a108b3-f56f-4ffd-a38a-5a557af0ce26&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:381,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthAsymmetric(challenge, identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthAsymmetric(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;595e5b57-7e31-418e-b508-8537a0e29df9&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97982PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97982PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:216,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst challenge = Buffer.from(&#x27;hello world&#x27;)\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97982PassUnilateralAuthCCF(challenge, identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97982PassUnilateralAuthCCF(challenge, identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;851be8f5-6a42-4976-86f7-497d3b7b36b2&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:218,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key2.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0dd432ad-8c98-495f-930c-b0f9d2d5c47c&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:385,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key2.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f21b4bb0-e227-4283-84f8-d53ba3ffd444&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:220,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst key2 = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key2.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9fe9489-df5a-4005-bac9-c5b1d66678f2&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthSymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthSymmetric(identity)\nconst authKey = await key.ISO9798SymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthSymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81d8f01e-1b54-4d54-9fd3-a3530ae431a5&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthAsymmetric/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:175,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthAsymmetric(identity)\nconst authKey = await key.ISO9798AsymmetricKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthAsymmetric(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;04f4e76e-98a9-4948-be34-862743c11383&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;ISO97981PassUnilateralAuthCCF/window&quot;,&quot;fullTitle&quot;:&quot;authentication invalid ISO97981PassUnilateralAuthCCF/window&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst identity = Buffer.from(&#x27;bob&#x27;)\nconst response = await key.ISO97981PassUnilateralAuthCCF(identity)\nconst authKey = await key.ISO9798CCFKey()\nconst valid = await mfkdf.auth.VerifyISO97981PassUnilateralAuthCCF(identity, response, authKey, -1)\nvalid.should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c183dd9e-e9f3-430d-899e-0322f077e810&quot;,&quot;parentUUID&quot;:&quot;7c68551d-143e-4f52-99da-cf2beddbc870&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;21a108b3-f56f-4ffd-a38a-5a557af0ce26&quot;,&quot;595e5b57-7e31-418e-b508-8537a0e29df9&quot;,&quot;851be8f5-6a42-4976-86f7-497d3b7b36b2&quot;,&quot;0dd432ad-8c98-495f-930c-b0f9d2d5c47c&quot;,&quot;f21b4bb0-e227-4283-84f8-d53ba3ffd444&quot;,&quot;f9fe9489-df5a-4005-bac9-c5b1d66678f2&quot;,&quot;81d8f01e-1b54-4d54-9fd3-a3530ae431a5&quot;,&quot;04f4e76e-98a9-4948-be34-862743c11383&quot;,&quot;c183dd9e-e9f3-430d-899e-0322f077e810&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2028,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;7af8eb5a-af98-42a1-b755-222cf3a40479&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13560,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;title&quot;:&quot;entropy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\entropy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\entropy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;3-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 3-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 3)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2730a177-1e20-48f6-9535-dd23fbf29835&quot;,&quot;parentUUID&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 2-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) + Math.log2(33)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ff84ded-84a4-43b5-86bc-31e234491847&quot;,&quot;parentUUID&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-3&quot;,&quot;fullTitle&quot;:&quot;entropy 1-of-3&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;ABCDEFGH&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;abcdefgh&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 1 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4)))\nsetup.entropyBits.theoretical.should.equal(8 * 8 * 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a4406d2-ab1f-4769-a2f8-1298287bb401&quot;,&quot;parentUUID&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;policy&quot;,&quot;fullTitle&quot;:&quot;entropy policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:121,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.any([\n      await mfkdf.setup.factors.password(&#x27;12345678&#x27;, { id: &#x27;password7&#x27; }),\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;Tr0ub4dour&amp;3&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    ])\n  )\n)\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(4) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5516044e-8780-4872-bab4-c1d685f44649&quot;,&quot;parentUUID&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-6&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-6&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:717,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp(),\n  await mfkdf.setup.factors.hotp()\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 6) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d70dd0b1-1d7c-40d2-ae5e-55cb7857a562&quot;,&quot;parentUUID&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;totp/hotp-8&quot;,&quot;fullTitle&quot;:&quot;entropy totp/hotp-8&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:761,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.totp({ digits: 8 }),\n  await mfkdf.setup.factors.hotp({ digits: 8 })\n], { threshold: 2 })\nMath.floor(setup.entropyBits.real).should.equal(Math.floor(Math.log2(10 ** 8) * 2))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc2001a1-62f9-404d-bae4-d43f7766efb5&quot;,&quot;parentUUID&quot;:&quot;f80ff591-c2a6-44c8-b4e3-50f84c658a23&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2730a177-1e20-48f6-9535-dd23fbf29835&quot;,&quot;3ff84ded-84a4-43b5-86bc-31e234491847&quot;,&quot;7a4406d2-ab1f-4769-a2f8-1298287bb401&quot;,&quot;5516044e-8780-4872-bab4-c1d685f44649&quot;,&quot;d70dd0b1-1d7c-40d2-ae5e-55cb7857a562&quot;,&quot;dc2001a1-62f9-404d-bae4-d43f7766efb5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1925,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b44876f1-88f4-42cf-a4b6-e35a0567bcd1&quot;,&quot;title&quot;:&quot;enveloping&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;secrets&quot;,&quot;fullTitle&quot;:&quot;enveloping secrets&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key2&#x27;, input)\nawait setup.addEnvelopedSecret(&#x27;key3&#x27;, input)\nawait setup.removeEnvelopedSecret(&#x27;key2&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst output = await derive.getEnvelopedSecret(&#x27;key&#x27;)\noutput.toString(&#x27;hex&#x27;).should.equal(input.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a94a041d-1823-4157-b78a-f0f611b32c54&quot;,&quot;parentUUID&quot;:&quot;b44876f1-88f4-42cf-a4b6-e35a0567bcd1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;keys&quot;,&quot;fullTitle&quot;:&quot;enveloping keys&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:249,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nawait setup.addEnvelopedKey(&#x27;key1&#x27;)\nawait setup.addEnvelopedKey(&#x27;key2&#x27;, &#x27;rsa1024&#x27;)\nawait setup.addEnvelopedKey(&#x27;key3&#x27;, &#x27;rsa2048&#x27;)\nawait setup.addEnvelopedKey(&#x27;key4&#x27;, &#x27;ed25519&#x27;)\nconst key11 = await setup.getEnvelopedKey(&#x27;key1&#x27;)\nconst key12 = await setup.getEnvelopedKey(&#x27;key2&#x27;)\nconst key13 = await setup.getEnvelopedKey(&#x27;key3&#x27;)\nconst key14 = await setup.getEnvelopedKey(&#x27;key4&#x27;)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nconst key21 = await derive.getEnvelopedKey(&#x27;key1&#x27;)\nconst key22 = await derive.getEnvelopedKey(&#x27;key2&#x27;)\nconst key23 = await derive.getEnvelopedKey(&#x27;key3&#x27;)\nconst key24 = await derive.getEnvelopedKey(&#x27;key4&#x27;)\nkey11.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key21.export({ format: &#x27;jwk&#x27; }))\nkey12.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key22.export({ format: &#x27;jwk&#x27; }))\nkey13.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key23.export({ format: &#x27;jwk&#x27; }))\nkey14.export({ format: &#x27;jwk&#x27; }).should.deep.equal(key24.export({ format: &#x27;jwk&#x27; }))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a9c15d1e-1d35-40ae-b2ac-078a31c1aea2&quot;,&quot;parentUUID&quot;:&quot;b44876f1-88f4-42cf-a4b6-e35a0567bcd1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;31e90faa-cd05-4a04-91f3-939b7f96ee6d&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;50090166-8888-417b-9e7f-59ef1d4e9a92&quot;,&quot;title&quot;:&quot;addEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(12345, input).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d0b5859-3759-4d28-9291-ea7e347db5df&quot;,&quot;parentUUID&quot;:&quot;50090166-8888-417b-9e7f-59ef1d4e9a92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;value/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret value/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedSecret(&#x27;id&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e935d68a-23a3-494f-a908-a04e0486f945&quot;,&quot;parentUUID&quot;:&quot;50090166-8888-417b-9e7f-59ef1d4e9a92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nsetup.addEnvelopedSecret(&#x27;id&#x27;, input, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a114373-a2e1-4fe1-98cb-4602b1b26241&quot;,&quot;parentUUID&quot;:&quot;50090166-8888-417b-9e7f-59ef1d4e9a92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/unique&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedSecret id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst input = Buffer.from(&#x27;12345678&#x27;)\nawait setup.addEnvelopedSecret(&#x27;key&#x27;, input)\nsetup.addEnvelopedSecret(&#x27;key&#x27;, input).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21ed9ded-194b-46c9-9a4a-97b81a9f647f&quot;,&quot;parentUUID&quot;:&quot;50090166-8888-417b-9e7f-59ef1d4e9a92&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1d0b5859-3759-4d28-9291-ea7e347db5df&quot;,&quot;e935d68a-23a3-494f-a908-a04e0486f945&quot;,&quot;2a114373-a2e1-4fe1-98cb-4602b1b26241&quot;,&quot;21ed9ded-194b-46c9-9a4a-97b81a9f647f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:435,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5c6de94e-d42b-4d41-9c1d-dc6ccec86239&quot;,&quot;title&quot;:&quot;removeEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1341683a-6253-49ae-9f7f-081721f70909&quot;,&quot;parentUUID&quot;:&quot;5c6de94e-d42b-4d41-9c1d-dc6ccec86239&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors removeEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.removeEnvelopedSecret(&#x27;12345&#x27;)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;899d9a64-82b1-4237-9b5c-ffc7c102060d&quot;,&quot;parentUUID&quot;:&quot;5c6de94e-d42b-4d41-9c1d-dc6ccec86239&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1341683a-6253-49ae-9f7f-081721f70909&quot;,&quot;899d9a64-82b1-4237-9b5c-ffc7c102060d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:220,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;44cd0f6d-1fd2-44d9-b7f9-e948caaba52a&quot;,&quot;title&quot;:&quot;addEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9db57938-6892-40cd-a7d3-fb2d55c6fd94&quot;,&quot;parentUUID&quot;:&quot;44cd0f6d-1fd2-44d9-b7f9-e948caaba52a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, 12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;438e9247-9fad-4539-b752-1ecc5cbd0822&quot;,&quot;parentUUID&quot;:&quot;44cd0f6d-1fd2-44d9-b7f9-e948caaba52a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;type/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors addEnvelopedKey type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.addEnvelopedKey(&#x27;12345&#x27;, &#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d5c4b890-6feb-4844-87ee-9094d648d8fd&quot;,&quot;parentUUID&quot;:&quot;44cd0f6d-1fd2-44d9-b7f9-e948caaba52a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9db57938-6892-40cd-a7d3-fb2d55c6fd94&quot;,&quot;438e9247-9fad-4539-b752-1ecc5cbd0822&quot;,&quot;d5c4b890-6feb-4844-87ee-9094d648d8fd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:334,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;37e95607-ac34-42c0-af72-7c0367e035b2&quot;,&quot;title&quot;:&quot;getEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e45e4ee6-0724-4875-85ca-fe3b8d915568&quot;,&quot;parentUUID&quot;:&quot;37e95607-ac34-42c0-af72-7c0367e035b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id/range&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedSecret id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedSecret(&#x27;12345&#x27;).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9163f46b-59bb-4aac-9c00-acce3e764303&quot;,&quot;parentUUID&quot;:&quot;37e95607-ac34-42c0-af72-7c0367e035b2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e45e4ee6-0724-4875-85ca-fe3b8d915568&quot;,&quot;9163f46b-59bb-4aac-9c00-acce3e764303&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:216,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;358acc04-1755-4bec-9faf-5323b8452b33&quot;,&quot;title&quot;:&quot;getEnvelopedKey&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors getEnvelopedKey id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.getEnvelopedKey(12345).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9562d52c-1f85-4d8f-8965-e424076f8ccc&quot;,&quot;parentUUID&quot;:&quot;358acc04-1755-4bec-9faf-5323b8452b33&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9562d52c-1f85-4d8f-8965-e424076f8ccc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:107,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;399350bc-e66d-465a-9b4f-83c891d7f122&quot;,&quot;title&quot;:&quot;hasEnvelopedSecret&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\envelope.js&quot;,&quot;file&quot;:&quot;\\test\\features\\envelope.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;id/type&quot;,&quot;fullTitle&quot;:&quot;enveloping errors hasEnvelopedSecret id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 });\n(() =&gt; {\n  setup.hasEnvelopedSecret(12345)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;362add6a-f9f5-4d0e-b113-84e2b19e61ae&quot;,&quot;parentUUID&quot;:&quot;399350bc-e66d-465a-9b4f-83c891d7f122&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;362add6a-f9f5-4d0e-b113-84e2b19e61ae&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:109,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;a94a041d-1823-4157-b78a-f0f611b32c54&quot;,&quot;a9c15d1e-1d35-40ae-b2ac-078a31c1aea2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:476,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;title&quot;:&quot;kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\features\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;types&quot;,&quot;fullTitle&quot;:&quot;kdf types&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:426,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const pbkdf2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst bcrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst scrypt = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nconst argon2 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nBuffer.isBuffer(pbkdf2).should.be.true\nBuffer.isBuffer(bcrypt).should.be.true\nBuffer.isBuffer(scrypt).should.be.true\nBuffer.isBuffer(argon2).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;011c6918-11f0-4206-8c88-f218702f647c&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha1&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 25555,\n    digest: &#x27;sha1&#x27;\n  }\n})\nBuffer.isBuffer(key).should.be.true\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;8ee4a527b20aa8feeb78d70447d84e20&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a1da0aa1-a87b-430e-b538-4f9e74eb4229&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/sha512&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/sha512&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secret&#x27;, &#x27;salt&#x27;, 64, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha512&#x27;\n  }\n})\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;3745e482c6e0ade35da10139e797157f4a5da669dad7d5da88ef87e47471cc47ed941c7ad618e827304f083f8707f12b7cfdd5f489b782f10cc269e3c08d59ae&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ffd1f7b-48da-44ee-be78-af665f384f14&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;pbkdf2/default&quot;,&quot;fullTitle&quot;:&quot;kdf pbkdf2/default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:120,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;pbkdf2&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;test&#x27;, &#x27;&#x27;, 32, {\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7411ccc1-f367-4781-bac1-7333b0e3d693&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/same&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/same&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.toString(&#x27;hex&#x27;).should.equal(key2.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1c3b0e50-2b1b-4d28-856b-110d12b231bf&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/inputdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/inputdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:131,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password2&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;773f0d3d-f5a3-49d5-9d3f-e3e8453510fe&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/saltdiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/saltdiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89e21ea4-bb10-4eee-bcf4-bcdc560a3a3f&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/rounddiff&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/rounddiff&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:173,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key1 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 10 } })\nconst key2 = await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt2&#x27;, 16, { type: &#x27;bcrypt&#x27;, params: { rounds: 11 } })\nkey1.should.not.equal(key2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2936e7c-0331-43db-a3da-0db925e7af30&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/length&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/length&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:170,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key16 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 16, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key16).should.equal(16)\nconst key32 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key32).should.equal(32)\nconst key64 = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nBuffer.byteLength(key64).should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17d1797d-d0fe-444a-a40e-fa53a670eef4&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;bcrypt/known&quot;,&quot;fullTitle&quot;:&quot;kdf bcrypt/known&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:56,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;bcrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;cb36d3d02d502acdf10dfc2d022bf3c024f16a368ba2df4456fbf97291f64334&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0d98e48-fdb4-434c-adb6-e15314cc28c4&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/fast&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/fast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:184,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;salt&#x27;, 64, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 16384, scryptblocksize: 8, scryptparallelism: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;745731af4484f323968969eda289aeee005b5903ac561e64a5aca121797bf7734ef9fd58422e2e22183bcacba9ec87ba0c83b7a2e788f03ce0da06463433cda6&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cdd0d929-76b4-4767-b3c2-54d81ff44987&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/defaults&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:180,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;9009fca57ef2b8c342bdad6b9247e4a1b5bd85628152116513ad44e93cf1b0e2&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1162260a-7fae-48be-9c0a-88f55e42f078&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/N&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/N&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ceb6a6bf4f4afeb3d1806714474d4f00ca97c2ad76a641269192d11444e13a6b&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;630b7476-3aeb-423b-a053-3fc28e44663d&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/R&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/R&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptblocksize: 16 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;a63de1de715f95bebd9f6d58d78ff11028a8412c1fcf71673544373c67095836&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a443b64e-ab2b-4777-9f7d-4a21fc24e9a3&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;scrypt/P&quot;,&quot;fullTitle&quot;:&quot;kdf scrypt/P&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:23,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;secure&#x27;, &#x27;secure&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;scrypt&#x27;, scryptcost: 1024, scryptparallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;ef224277727457992dc05983b1fd1208bae35b100c853ba4bb11f1ba7ca4c436&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19da87ac-2b04-483b-a75d-3ec0be20a837&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2i&quot;,&quot;fullTitle&quot;:&quot;kdf argon2i&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2i&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;7357892df510f136a0688ceab37bbaf7ba695de590065072717fa6728961c92a&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;50c21a42-6942-4c9b-94a2-c47098a7bf15&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2d&quot;,&quot;fullTitle&quot;:&quot;kdf argon2d&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:103,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2d&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;423b0dcc7bbfe16fa8ee7a2e2ebd8891873d726f9dfe70890a7197a5503a2848&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c6386d80-90da-4fe1-ac21-80ce21c6f0f4&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ kdf: &#x27;argon2id&#x27; }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81a0b64f-79f4-4ee3-b808-32a325a341c2&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/mem&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/mem&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:71,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2mem: 16384 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;e043f979311b14ff8378b785469974e899a08f05509323a04b2ca29ef63ff3af&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;41e463d8-3913-464e-a57b-f2db19ab0728&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/time&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/time&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2time: 1 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;bf6b1773bdae362ecea04b889079b6628d1f35d96a2be9f2a5481c2d1236e8d7&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e0df8ca-77b1-4892-8e0e-b6aeb8f33bab&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;argon2id/parallelism&quot;,&quot;fullTitle&quot;:&quot;kdf argon2id/parallelism&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({ type: &#x27;argon2id&#x27;, argon2parallelism: 2 }))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5c12c6873b938cd8467b677d23e525389e3ff7ed62b4ad9e285e1191244f40ca&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a5876491-96cd-42fc-acd5-96c80678d620&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;kdf default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.kdf(&#x27;password&#x27;, &#x27;somesalt&#x27;, 32, mfkdf.setup.kdf({}))\nkey.toString(&#x27;hex&#x27;).should.equal(&#x27;5cddd5b69d1fe5d83bc3e04e9122f05d9b2128a194cb739baf74679875c4b3a1&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;545f7bfe-a1ae-48bb-802f-e62c5b9468cf&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;kdf invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.kdf(&#x27;password1&#x27;, &#x27;salt1&#x27;, 16, { type: &#x27;invalid&#x27;, params: { } }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ccb2032-1dce-4544-b055-8c5e840775a6&quot;,&quot;parentUUID&quot;:&quot;c1b78b42-8098-4336-b96d-3d7a3856df4b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;011c6918-11f0-4206-8c88-f218702f647c&quot;,&quot;a1da0aa1-a87b-430e-b538-4f9e74eb4229&quot;,&quot;4ffd1f7b-48da-44ee-be78-af665f384f14&quot;,&quot;7411ccc1-f367-4781-bac1-7333b0e3d693&quot;,&quot;1c3b0e50-2b1b-4d28-856b-110d12b231bf&quot;,&quot;773f0d3d-f5a3-49d5-9d3f-e3e8453510fe&quot;,&quot;89e21ea4-bb10-4eee-bcf4-bcdc560a3a3f&quot;,&quot;c2936e7c-0331-43db-a3da-0db925e7af30&quot;,&quot;17d1797d-d0fe-444a-a40e-fa53a670eef4&quot;,&quot;e0d98e48-fdb4-434c-adb6-e15314cc28c4&quot;,&quot;cdd0d929-76b4-4767-b3c2-54d81ff44987&quot;,&quot;1162260a-7fae-48be-9c0a-88f55e42f078&quot;,&quot;630b7476-3aeb-423b-a053-3fc28e44663d&quot;,&quot;a443b64e-ab2b-4777-9f7d-4a21fc24e9a3&quot;,&quot;19da87ac-2b04-483b-a75d-3ec0be20a837&quot;,&quot;50c21a42-6942-4c9b-94a2-c47098a7bf15&quot;,&quot;c6386d80-90da-4fe1-ac21-80ce21c6f0f4&quot;,&quot;81a0b64f-79f4-4ee3-b808-32a325a341c2&quot;,&quot;41e463d8-3913-464e-a57b-f2db19ab0728&quot;,&quot;5e0df8ca-77b1-4892-8e0e-b6aeb8f33bab&quot;,&quot;a5876491-96cd-42fc-acd5-96c80678d620&quot;,&quot;545f7bfe-a1ae-48bb-802f-e62c5b9468cf&quot;,&quot;5ccb2032-1dce-4544-b055-8c5e840775a6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2415,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;66b2b4e8-8343-4167-8601-894946ffaf3c&quot;,&quot;title&quot;:&quot;policy&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e7cc403f-7ecf-4816-bdda-1f913b06b582&quot;,&quot;title&quot;:&quot;validate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;policy validate valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.validate(policy.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;001f42ad-8e2a-4ada-b67c-2990f932191e&quot;,&quot;parentUUID&quot;:&quot;e7cc403f-7ecf-4816-bdda-1f913b06b582&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid&quot;,&quot;fullTitle&quot;:&quot;policy validate invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password2&#x27; })\n    )\n  )\n).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f89cf211-9ab6-49f3-b5fa-adc8e2d74795&quot;,&quot;parentUUID&quot;:&quot;e7cc403f-7ecf-4816-bdda-1f913b06b582&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;001f42ad-8e2a-4ada-b67c-2990f932191e&quot;,&quot;f89cf211-9ab6-49f3-b5fa-adc8e2d74795&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:225,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;c519a3b5-e452-4736-bd2b-ad90a1213596&quot;,&quot;title&quot;:&quot;evaluate&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af4f14da-3b83-4ff4-8246-dba6fe78af6a&quot;,&quot;parentUUID&quot;:&quot;c519a3b5-e452-4736-bd2b-ad90a1213596&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy evaluate basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const policy = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password2&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password3&#x27;, &#x27;password4&#x27;]).should.be.true\nmfkdf.policy.evaluate(policy.policy, [&#x27;password1&#x27;, &#x27;password4&#x27;]).should.be.false\nmfkdf.policy.evaluate(policy.policy, [&#x27;password2&#x27;, &#x27;password3&#x27;]).should.be.false&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4582cb10-4920-4d2e-8eec-3c717c1ba241&quot;,&quot;parentUUID&quot;:&quot;c519a3b5-e452-4736-bd2b-ad90a1213596&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;af4f14da-3b83-4ff4-8246-dba6fe78af6a&quot;,&quot;4582cb10-4920-4d2e-8eec-3c717c1ba241&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:225,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;title&quot;:&quot;derive&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;all&quot;,&quot;fullTitle&quot;:&quot;policy derive all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:235,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.all([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;72d051f4-8a35-4e59-8b78-d3b60e2af7fb&quot;,&quot;parentUUID&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;any&quot;,&quot;fullTitle&quot;:&quot;policy derive any&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:233,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.any([\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ebb906ef-6441-4a4e-b4cb-df9135cd5cad&quot;,&quot;parentUUID&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;atLeast&quot;,&quot;fullTitle&quot;:&quot;policy derive atLeast&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:235,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.atLeast(3, [\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n    await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n  ])\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa0ddcb1-54a4-4507-ae30-613a506fc1e1&quot;,&quot;parentUUID&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 1&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:640,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.or(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive3 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive4 = await mfkdf.policy.derive(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive4.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6973bb43-c921-42f4-a124-e9c13c48735a&quot;,&quot;parentUUID&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;basic 2&quot;,&quot;fullTitle&quot;:&quot;policy derive basic 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:363,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.or(\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n    ),\n    await mfkdf.policy.and(\n      await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n      await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n    )\n  )\n)\nconst derive1 = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))\nconst derive2 = await mfkdf.policy.derive(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;48dd6ca4-2b91-4121-a4b6-ef3c364dd99d&quot;,&quot;parentUUID&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;deep&quot;,&quot;fullTitle&quot;:&quot;policy derive deep&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:256,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nconst derive = await mfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;01ce15ea-31b5-4815-af0c-b79222ac71ce&quot;,&quot;parentUUID&quot;:&quot;797f6e4a-dda3-4523-9fc0-acdcdf0b081f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;72d051f4-8a35-4e59-8b78-d3b60e2af7fb&quot;,&quot;ebb906ef-6441-4a4e-b4cb-df9135cd5cad&quot;,&quot;aa0ddcb1-54a4-4507-ae30-613a506fc1e1&quot;,&quot;6973bb43-c921-42f4-a124-e9c13c48735a&quot;,&quot;48dd6ca4-2b91-4121-a4b6-ef3c364dd99d&quot;,&quot;01ce15ea-31b5-4815-af0c-b79222ac71ce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1962,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;0c0c9966-a093-43e2-9211-dbc572169627&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\policy.js&quot;,&quot;file&quot;:&quot;\\test\\features\\policy.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid policy&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid policy&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n])\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;),\n  password6: mfkdf.derive.factors.password(&#x27;password6&#x27;)\n}).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d64a3fdd-651e-4ebc-8995-1cdd579728aa&quot;,&quot;parentUUID&quot;:&quot;0c0c9966-a093-43e2-9211-dbc572169627&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid factors&quot;,&quot;fullTitle&quot;:&quot;policy errors invalid factors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:114,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.policy.setup(\n  await mfkdf.policy.and(\n    await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n    await mfkdf.policy.and(\n      await mfkdf.policy.or(\n        await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n        await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n      ),\n      await mfkdf.policy.and(\n        await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; }),\n        await mfkdf.policy.or(\n          await mfkdf.setup.factors.password(&#x27;password5&#x27;, { id: &#x27;password5&#x27; }),\n          await mfkdf.setup.factors.password(&#x27;password6&#x27;, { id: &#x27;password6&#x27; })\n        )\n      )\n    )\n  )\n)\nmfkdf.policy.derive(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d5c7da27-db08-4818-85c9-e6b73cc84d30&quot;,&quot;parentUUID&quot;:&quot;0c0c9966-a093-43e2-9211-dbc572169627&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d64a3fdd-651e-4ebc-8995-1cdd579728aa&quot;,&quot;d5c7da27-db08-4818-85c9-e6b73cc84d30&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:227,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;title&quot;:&quot;reconstitution&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;setThreshold&quot;,&quot;fullTitle&quot;:&quot;reconstitution setThreshold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:231,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nawait setup.setThreshold(2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a3a0617-8c27-47dc-ae25-7062e494c5d7&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:470,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactor(&#x27;password1&#x27;)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)\nderive2.removeFactor(&#x27;password2&#x27;).should.be.rejectedWith(RangeError)\nawait derive2.setThreshold(1)\nawait derive2.removeFactor(&#x27;password2&#x27;)\nconst derive3 = await mfkdf.derive.key(derive2.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)\nmfkdf.derive.key(derive2.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;)\n}).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0756ba32-4c5f-49b3-bf9b-935fc8486dbc&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution removeFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:459,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nconst derive1 = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive1.key.toString(&#x27;hex&#x27;).should.equal(key)\nconst derive2 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive2.key.toString(&#x27;hex&#x27;).should.equal(key)\nawait setup.removeFactors([&#x27;password1&#x27;, &#x27;password4&#x27;])\nmfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n}).should.be.rejectedWith(RangeError)\nconst derive3 = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive3.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2788dc55-cd68-4705-aacc-5b87378e777e&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactor(await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;010e7ab4-3be1-4fee-8d32-d2e7246ee9f3&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution addFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:223,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.addFactors([\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password4&#x27;, { id: &#x27;password4&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;),\n  password4: mfkdf.derive.factors.password(&#x27;password4&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c91ba181-ea2f-47c3-9207-bd1e3b74ce40&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactor&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactor&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:227,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactor(await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }))\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;password1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;91e83f06-7dac-445f-9dad-b40b777ff360&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;recoverFactors&quot;,&quot;fullTitle&quot;:&quot;reconstitution recoverFactors&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:230,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.recoverFactors([\n  await mfkdf.setup.factors.password(&#x27;differentPassword3&#x27;, { id: &#x27;password3&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;otherPassword1&#x27;, { id: &#x27;password1&#x27; })\n])\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password1: mfkdf.derive.factors.password(&#x27;otherPassword1&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;differentPassword3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a6c0753-b4c0-4846-803b-887073880d4f&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;reconstitute&quot;,&quot;fullTitle&quot;:&quot;reconstitution reconstitute&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:224,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute([&#x27;password1&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;otherPassword2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35388f63-1131-464a-881e-df203af3c78d&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;reconstitution defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:228,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nconst key = setup.key.toString(&#x27;hex&#x27;)\nawait setup.reconstitute()\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password2: mfkdf.derive.factors.password(&#x27;password2&#x27;),\n  password3: mfkdf.derive.factors.password(&#x27;password3&#x27;)\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(key)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ab56505b-6dac-4409-8337-d18bb7d62395&quot;,&quot;parentUUID&quot;:&quot;5f3638ef-61a6-48c9-b0be-8d4355658b41&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;title&quot;:&quot;errors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\reconstitution.js&quot;,&quot;file&quot;:&quot;\\test\\features\\reconstitution.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;removeFactors/factor/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:109,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([12345], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a3054f52-78b8-4e0d-9d88-d62c57275e8f&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([&#x27;password4&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23df92f3-f2e7-433c-a8d4-2fdfa5ce6f72&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/factor/id/unique&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/factor/id/unique&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 2 })\nsetup.reconstitute([&#x27;password3&#x27;], [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;diffPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;46c570f7-b7a5-4dd2-bf37-5685719d194e&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;removeFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors removeFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute(&#x27;hello&#x27;, [\n  await mfkdf.setup.factors.password(&#x27;otherPassword2&#x27;, { id: &#x27;password2&#x27; })\n], 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;36f390af-dbfc-4e47-887a-4280fd5db633&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;addFactors/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors addFactors/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], &#x27;12345&#x27;, 2).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7c5bfa3-0c4a-4bd9-b095-613e288d02a9&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], &#x27;12345&#x27;).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f08ded05-a7b2-4c9f-a62e-b2affdf4f356&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], -1).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d13210b9-0673-4e6f-8385-66a731e61478&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:118,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: 12345,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62a97651-beae-49e2-8664-e0c98be9fd1b&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/type/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/type/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3d0fad2-798a-4da6-95e6-3790e141df0f&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2626130a-ac35-4244-8fde-e5855f44e587&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/id/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/id/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2a70a58-04fe-4400-8429-e313fef8bcca&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:106,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8aa678e1-61c2-453a-bacd-d66dc1f2819f&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/data/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/data/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3783a863-443e-4aad-95ca-b86e851882da&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/params/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/params/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: 12345,\n    output: async () =&gt; {\n      return {}\n    }\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;04cd00c7-f4ff-4919-a58b-50d56b33aec9&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;factor/output/type&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors factor/output/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:116,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password4&#x27;,\n    data: Buffer.from(&#x27;password4&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: 12345\n  }\n], 3).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3608332a-bd47-46b3-9335-17ba30cdad21&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;threshold/range&quot;,&quot;fullTitle&quot;:&quot;reconstitution errors threshold/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const setup = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password1&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password2&#x27;, { id: &#x27;password2&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;password3&#x27;, { id: &#x27;password3&#x27; })\n], { threshold: 3 })\nsetup.reconstitute([], [], 4).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;278e78c2-f819-414e-a345-93382e305d67&quot;,&quot;parentUUID&quot;:&quot;d06e2435-51d0-4fd7-8002-b12b09784f2e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a3054f52-78b8-4e0d-9d88-d62c57275e8f&quot;,&quot;23df92f3-f2e7-433c-a8d4-2fdfa5ce6f72&quot;,&quot;46c570f7-b7a5-4dd2-bf37-5685719d194e&quot;,&quot;36f390af-dbfc-4e47-887a-4280fd5db633&quot;,&quot;e7c5bfa3-0c4a-4bd9-b095-613e288d02a9&quot;,&quot;f08ded05-a7b2-4c9f-a62e-b2affdf4f356&quot;,&quot;d13210b9-0673-4e6f-8385-66a731e61478&quot;,&quot;62a97651-beae-49e2-8664-e0c98be9fd1b&quot;,&quot;e3d0fad2-798a-4da6-95e6-3790e141df0f&quot;,&quot;2626130a-ac35-4244-8fde-e5855f44e587&quot;,&quot;a2a70a58-04fe-4400-8429-e313fef8bcca&quot;,&quot;8aa678e1-61c2-453a-bacd-d66dc1f2819f&quot;,&quot;3783a863-443e-4aad-95ca-b86e851882da&quot;,&quot;04cd00c7-f4ff-4919-a58b-50d56b33aec9&quot;,&quot;3608332a-bd47-46b3-9335-17ba30cdad21&quot;,&quot;278e78c2-f819-414e-a345-93382e305d67&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1740,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;2a3a0617-8c27-47dc-ae25-7062e494c5d7&quot;,&quot;0756ba32-4c5f-49b3-bf9b-935fc8486dbc&quot;,&quot;2788dc55-cd68-4705-aacc-5b87378e777e&quot;,&quot;010e7ab4-3be1-4fee-8d32-d2e7246ee9f3&quot;,&quot;c91ba181-ea2f-47c3-9207-bd1e3b74ce40&quot;,&quot;91e83f06-7dac-445f-9dad-b40b777ff360&quot;,&quot;9a6c0753-b4c0-4846-803b-887073880d4f&quot;,&quot;35388f63-1131-464a-881e-df203af3c78d&quot;,&quot;ab56505b-6dac-4409-8337-d18bb7d62395&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2519,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a4f34a27-511e-4b35-b160-c2a5f9275b59&quot;,&quot;title&quot;:&quot;stage&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\features\\stage.js&quot;,&quot;file&quot;:&quot;\\test\\features\\stage.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;basic&quot;,&quot;fullTitle&quot;:&quot;stage basic&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const passwordSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.password(&#x27;password&#x27;))\nconst setup = await mfkdf.setup.key([\n  passwordSetup\n], { kdf: &#x27;hkdf&#x27; })\nconst passwordDerive = await mfkdf.stage.factor.derive(mfkdf.derive.factors.password(&#x27;password&#x27;), setup.policy.factors[0].params)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password: passwordDerive\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de4a8773-c156-4998-8831-fce2e5fbec7c&quot;,&quot;parentUUID&quot;:&quot;a4f34a27-511e-4b35-b160-c2a5f9275b59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;full&quot;,&quot;fullTitle&quot;:&quot;stage full&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:688,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const keyPair = await crypto.webcrypto.subtle.generateKey(\n  { hash: &#x27;SHA-256&#x27;, modulusLength: 2048, name: &#x27;RSA-OAEP&#x27;, publicExponent: new Uint8Array([1, 0, 1]) },\n  true,\n  [&#x27;encrypt&#x27;, &#x27;decrypt&#x27;]\n)\nconst init = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;password&#x27;)\n], { kdf: &#x27;hkdf&#x27; })\nconst passwordSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.password(&#x27;password&#x27;), init.key)\nconst hmacsha1Setup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.hmacsha1(), init.key)\nconst hotpSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.hotp({ secret: Buffer.from(&#x27;hello world&#x27;) }), init.key)\nconst oobaSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.ooba({ key: keyPair.publicKey, params: {} }), init.key)\nconst questionSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.question(&#x27;fido&#x27;), init.key)\nconst totpSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.totp({ secret: Buffer.from(&#x27;hello world&#x27;), time: 1650430806597 }), init.key)\nconst uuidSetup = await mfkdf.stage.factor.setup(mfkdf.setup.factors.uuid({ uuid: &#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27; }), init.key)\nconst setup = await mfkdf.setup.key([\n  passwordSetup, hmacsha1Setup, hotpSetup, oobaSetup, questionSetup, totpSetup, uuidSetup\n], { kdf: &#x27;hkdf&#x27; })\nconst secret = setup.outputs.hmacsha1.secret\nconst challenge = Buffer.from(setup.policy.factors[1].params.challenge, &#x27;hex&#x27;)\nconst response = crypto.createHmac(&#x27;sha1&#x27;, secret).update(challenge).digest()\nconst next = setup.policy.factors[3].params.next\nconst decrypted = await crypto.webcrypto.subtle.decrypt({ name: &#x27;RSA-OAEP&#x27; }, keyPair.privateKey, Buffer.from(next, &#x27;hex&#x27;))\nconst json = JSON.parse(Buffer.from(decrypted).toString())\nconst code = json.code\nconst password = await mfkdf.stage.factor.derive(mfkdf.derive.factors.password(&#x27;password&#x27;), setup.policy.factors[0].params, setup.key)\nconst hmacsha1 = await mfkdf.stage.factor.derive(mfkdf.derive.factors.hmacsha1(response), setup.policy.factors[1].params, setup.key)\nconst hotp = await mfkdf.stage.factor.derive(mfkdf.derive.factors.hotp(365287), setup.policy.factors[2].params, setup.key)\nconst ooba = await mfkdf.stage.factor.derive(mfkdf.derive.factors.ooba(code), setup.policy.factors[3].params, setup.key)\nconst question = await mfkdf.stage.factor.derive(mfkdf.derive.factors.question(&#x27;fido&#x27;), setup.policy.factors[4].params, setup.key)\nconst totp = await mfkdf.stage.factor.derive(mfkdf.derive.factors.totp(528258, { time: 1650430943604 }), setup.policy.factors[5].params, setup.key)\nconst uuid = await mfkdf.stage.factor.derive(mfkdf.derive.factors.uuid(&#x27;9b1deb4d-3b7d-4bad-9bdd-2b0d7b3dcb6d&#x27;), setup.policy.factors[6].params, setup.key)\nconst derive = await mfkdf.derive.key(setup.policy, {\n  password, hmacsha1, hotp, ooba, question, totp, uuid\n})\nderive.key.toString(&#x27;hex&#x27;).should.equal(setup.key.toString(&#x27;hex&#x27;))&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4791b53-cb58-4a5b-913d-2b42ac18df21&quot;,&quot;parentUUID&quot;:&quot;a4f34a27-511e-4b35-b160-c2a5f9275b59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;de4a8773-c156-4998-8831-fce2e5fbec7c&quot;,&quot;e4791b53-cb58-4a5b-913d-2b42ac18df21&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:696,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e030e951-feee-43cf-a25e-adab189a660c&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\combine.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\combine.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52bffeb9-15df-4bdf-bcec-b1f788e22d21&quot;,&quot;parentUUID&quot;:&quot;e030e951-feee-43cf-a25e-adab189a660c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29868088-2258-4f09-bdc1-b6a36a90171c&quot;,&quot;parentUUID&quot;:&quot;e030e951-feee-43cf-a25e-adab189a660c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.combine([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13d3b590-a6e5-45ea-a734-1c92f4f44e3c&quot;,&quot;parentUUID&quot;:&quot;e030e951-feee-43cf-a25e-adab189a660c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;52bffeb9-15df-4bdf-bcec-b1f788e22d21&quot;,&quot;29868088-2258-4f09-bdc1-b6a36a90171c&quot;,&quot;13d3b590-a6e5-45ea-a734-1c92f4f44e3c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;title&quot;:&quot;secrets&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\index.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\index.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;1-of-1&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 1)\nshares.should.be.an(&#x27;array&#x27;).of.length(1)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret = mfkdf.secrets.combine(shares, 1, 1)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e120fc05-d56b-4c15-ba45-6f45838e64d4&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 1, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nshares[0].toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret1 = mfkdf.secrets.combine(shares, 1, 5)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 1, 5)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0]], 1, 5)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([null, shares[0], null], 1, 5)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([], 1, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d8e60f48-4c14-4964-a7bf-af21728213ab&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 3)\nshares.should.be.an(&#x27;array&#x27;).of.length(3)\nconst secret1 = mfkdf.secrets.combine([shares[0], shares[1], shares[2]], 2, 3)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret2 = mfkdf.secrets.combine([null, shares[1], shares[2]], 2, 3)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret3 = mfkdf.secrets.combine([shares[0], null, shares[2]], 2, 3)\nsecret3.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)\nconst secret4 = mfkdf.secrets.combine([shares[0], shares[1], null], 2, 3)\nsecret4.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e23b8346-f326-4b85-bbd6-0eb41cf4360b&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (medium)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (medium)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 255)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 255)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f3ecc7e7-1c05-4c44-baa5-02165ea78a1e&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;k-of-n (large)&quot;,&quot;fullTitle&quot;:&quot;secrets k-of-n (large)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:66,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;35002a68d437&#x27;, &#x27;hex&#x27;), 5, 1024)\nshares.should.be.an(&#x27;array&#x27;).of.length(1024)\nconst secret1 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret1.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nfor (let i = 1; i &lt; 1020; i++) {\n  shares[i] = null\n}\nconst secret2 = mfkdf.secrets.combine(shares, 5, 1024)\nsecret2.toString(&#x27;hex&#x27;).should.equal(&#x27;35002a68d437&#x27;)\nshares[1023] = null;\n(() =&gt; {\n  mfkdf.secrets.combine(shares, 5, 1024)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;38de01f8-0781-49ac-b289-1f3df4e8ee22&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;2-of-2&quot;,&quot;fullTitle&quot;:&quot;secrets 2-of-2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 2, 2)\nshares.should.be.an(&#x27;array&#x27;).of.length(2)\nxor(shares[0], shares[1]).toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0228d6ce-0fdb-447b-b19d-c8696bdad8fd&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;, &#x27;hex&#x27;), 5, 5)\nshares.should.be.an(&#x27;array&#x27;).of.length(5)\nconst secret = mfkdf.secrets.combine(shares, 5, 5)\nsecret.toString(&#x27;hex&#x27;).should.equal(&#x27;12345678&#x27;);\n(() =&gt; {\n  mfkdf.secrets.combine([shares[0], shares[1], shares[2], shares[3]], 5, 5)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f53bb06-ee63-4b7b-9a1e-fbacc68e2a5e&quot;,&quot;parentUUID&quot;:&quot;dc65459f-c63d-49c2-8268-e5d6fa67df7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e120fc05-d56b-4c15-ba45-6f45838e64d4&quot;,&quot;d8e60f48-4c14-4964-a7bf-af21728213ab&quot;,&quot;e23b8346-f326-4b85-bbd6-0eb41cf4360b&quot;,&quot;f3ecc7e7-1c05-4c44-baa5-02165ea78a1e&quot;,&quot;38de01f8-0781-49ac-b289-1f3df4e8ee22&quot;,&quot;0228d6ce-0fdb-447b-b19d-c8696bdad8fd&quot;,&quot;0f53bb06-ee63-4b7b-9a1e-fbacc68e2a5e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:77,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;title&quot;:&quot;secrets/recover&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\recover.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\recover.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;k-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover k-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], null], 2, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares[0], null, shares[2]], 2, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, shares[1], shares[2]], 2, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([shares2[0], null, shares2[2]], 2, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d4afb777-70c9-4db1-85a1-6087d5717ebc&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;1-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover 1-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], null, null], 1, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([null, shares[1], null], 1, 3)\nshares2.should.deep.equal(shares)\nconst shares3 = mfkdf.secrets.recover([null, null, shares[2]], 1, 3)\nshares3.should.deep.equal(shares)\nconst shares4 = mfkdf.secrets.recover([null, shares2[1], null], 1, 3)\nshares4.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7839aefb-3bab-4850-8eca-7b45c2d04559&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3)\nconst shares1 = mfkdf.secrets.recover([shares[0], shares[1], shares[2]], 3, 3)\nshares1.should.deep.equal(shares)\nconst shares2 = mfkdf.secrets.recover([shares1[0], shares1[1], shares1[2]], 3, 3)\nshares2.should.deep.equal(shares)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17d0dba7-c6bf-4117-9fbf-76cc174b6a5d&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count n-of-n&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count n-of-n&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 3, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 3, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b31c03b0-d74f-4049-a8dc-b5755901ed20&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 1&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 1&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], shares[1]], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;67975e44-68f3-46b6-b38e-7823bfb0eda1&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/count k-of-n 2&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/count k-of-n 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const shares = mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 3);\n(() =&gt; {\n  mfkdf.secrets.recover([shares[0], null, null], 2, 3)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cfbab894-d362-41b7-95b5-e6faf6a5d34f&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f8bad7e-7a65-45bc-bc2b-8350dc5ceaec&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/recover invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.recover([], 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.recover([Buffer.from(&#x27;12345678&#x27;)], 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7bed9ab1-b99b-4213-bc53-b808fddffc5c&quot;,&quot;parentUUID&quot;:&quot;2fb48149-fa6d-401f-a2a3-f1426c6e0b6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d4afb777-70c9-4db1-85a1-6087d5717ebc&quot;,&quot;7839aefb-3bab-4850-8eca-7b45c2d04559&quot;,&quot;17d0dba7-c6bf-4117-9fbf-76cc174b6a5d&quot;,&quot;b31c03b0-d74f-4049-a8dc-b5755901ed20&quot;,&quot;67975e44-68f3-46b6-b38e-7823bfb0eda1&quot;,&quot;cfbab894-d362-41b7-95b5-e6faf6a5d34f&quot;,&quot;7f8bad7e-7a65-45bc-bc2b-8350dc5ceaec&quot;,&quot;7bed9ab1-b99b-4213-bc53-b808fddffc5c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;03573642-4d96-418d-a96f-a8716f1bb920&quot;,&quot;title&quot;:&quot;secrets/share&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\secrets\\share.js&quot;,&quot;file&quot;:&quot;\\test\\secrets\\share.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;secrets/share valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74898cd9-447b-4426-ba4b-fa895e97380c&quot;,&quot;parentUUID&quot;:&quot;03573642-4d96-418d-a96f-a8716f1bb920&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(&#x27;hello&#x27;, 1, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), &#x27;hello&#x27;, 1)\n}).should.throw(TypeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, &#x27;hello&#x27;)\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78190119-2130-4dd2-902c-cf90d72e2e0e&quot;,&quot;parentUUID&quot;:&quot;03573642-4d96-418d-a96f-a8716f1bb920&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;secrets/share invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;&#x27;), 1, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 0, 1)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 1, 0)\n}).should.throw(RangeError);\n(() =&gt; {\n  mfkdf.secrets.share(Buffer.from(&#x27;12345678&#x27;), 2, 1)\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44056581-40bf-4acd-b0d4-dc8ad943ba77&quot;,&quot;parentUUID&quot;:&quot;03573642-4d96-418d-a96f-a8716f1bb920&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;74898cd9-447b-4426-ba4b-fa895e97380c&quot;,&quot;78190119-2130-4dd2-902c-cf90d72e2e0e&quot;,&quot;44056581-40bf-4acd-b0d4-dc8ad943ba77&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;217f6deb-77ef-4c4b-b2a4-e6a277455b35&quot;,&quot;title&quot;:&quot;setup/factors/password&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\password.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\password.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(12345).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21ca7afc-0c3a-4652-922a-d6cf150af3eb&quot;,&quot;parentUUID&quot;:&quot;217f6deb-77ef-4c4b-b2a4-e6a277455b35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.password(&#x27;&#x27;).should.be.rejectedWith(RangeError)\nmfkdf.setup.factors.password(&#x27;password&#x27;, { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74a77870-174b-45ae-b53d-fa890c66d346&quot;,&quot;parentUUID&quot;:&quot;217f6deb-77ef-4c4b-b2a4-e6a277455b35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/password valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.password(&#x27;hello&#x27;)\nfactor.type.should.equal(&#x27;password&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;68656c6c6f&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;08b4f9ef-2428-4672-bad4-ce49106f34af&quot;,&quot;parentUUID&quot;:&quot;217f6deb-77ef-4c4b-b2a4-e6a277455b35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;21ca7afc-0c3a-4652-922a-d6cf150af3eb&quot;,&quot;74a77870-174b-45ae-b53d-fa890c66d346&quot;,&quot;08b4f9ef-2428-4672-bad4-ce49106f34af&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f7e3f047-90b3-4810-81eb-0b870614bef7&quot;,&quot;title&quot;:&quot;setup/factors/uuid&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\factors\\uuid.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\factors\\uuid.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ uuid: 12345 }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ uuid: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)\nmfkdf.setup.factors.uuid({ id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aafa8ef7-d9d8-4a66-afdd-be3e57185e1c&quot;,&quot;parentUUID&quot;:&quot;f7e3f047-90b3-4810-81eb-0b870614bef7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.factors.uuid({ id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe2af63c-c618-4e16-9251-ece4ab7c2ebc&quot;,&quot;parentUUID&quot;:&quot;f7e3f047-90b3-4810-81eb-0b870614bef7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({ uuid: &#x27;6ec0bd7f-11c0-43da-975e-2a8ad9ebae0b&#x27; })\nfactor.type.should.equal(&#x27;uuid&#x27;)\nfactor.data.toString(&#x27;hex&#x27;).should.equal(&#x27;6ec0bd7f11c043da975e2a8ad9ebae0b&#x27;)\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4a629b7-8e5f-43e3-bad0-7e5490f38ea7&quot;,&quot;parentUUID&quot;:&quot;f7e3f047-90b3-4810-81eb-0b870614bef7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;random&quot;,&quot;fullTitle&quot;:&quot;setup/factors/uuid random&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const factor = await mfkdf.setup.factors.uuid({})\nfactor.type.should.equal(&#x27;uuid&#x27;)\nconst output = await factor.output()\nfactor.data.toString(&#x27;hex&#x27;).should.equal(output.uuid.replaceAll(&#x27;-&#x27;, &#x27;&#x27;))\nconst params = await factor.params()\nparams.should.deep.equal({})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db1bc7c7-3faf-4419-bf6f-8df4865f5797&quot;,&quot;parentUUID&quot;:&quot;f7e3f047-90b3-4810-81eb-0b870614bef7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;aafa8ef7-d9d8-4a66-afdd-be3e57185e1c&quot;,&quot;fe2af63c-c618-4e16-9251-ece4ab7c2ebc&quot;,&quot;f4a629b7-8e5f-43e3-bad0-7e5490f38ea7&quot;,&quot;db1bc7c7-3faf-4419-bf6f-8df4865f5797&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;e17c1225-c9b5-4240-b901-645fa6b516ed&quot;,&quot;title&quot;:&quot;setup/kdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;b16d54fd-564b-44b4-b854-dc181b1fb680&quot;,&quot;title&quot;:&quot;hkdf&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf hkdf defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;hkdf&#x27;\n}).should.deep.equal({\n  type: &#x27;hkdf&#x27;,\n  params: {\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f18c3ae-abcb-4da0-9eb2-3677f7637c24&quot;,&quot;parentUUID&quot;:&quot;b16d54fd-564b-44b4-b854-dc181b1fb680&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a667344b-3a62-4631-a081-9a46f0f951d6&quot;,&quot;title&quot;:&quot;hkdfdigest&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf hkdf hkdfdigest invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;hkdf&#x27;,\n    hkdfdigest: 0\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99f2380a-c8a1-41ba-97ca-c4bf84508e4e&quot;,&quot;parentUUID&quot;:&quot;a667344b-3a62-4631-a081-9a46f0f951d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf hkdf hkdfdigest invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;hkdf&#x27;,\n    hkdfdigest: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3f5ea316-8fe2-4c9e-912d-db5b6de427d8&quot;,&quot;parentUUID&quot;:&quot;a667344b-3a62-4631-a081-9a46f0f951d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf hkdf hkdfdigest valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;hkdf&#x27;,\n  hkdfdigest: &#x27;sha512&#x27;\n}).should.deep.equal({\n  type: &#x27;hkdf&#x27;,\n  params: {\n    digest: &#x27;sha512&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c73cf94e-b88e-4184-b61d-821fb31833cf&quot;,&quot;parentUUID&quot;:&quot;a667344b-3a62-4631-a081-9a46f0f951d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99f2380a-c8a1-41ba-97ca-c4bf84508e4e&quot;,&quot;3f5ea316-8fe2-4c9e-912d-db5b6de427d8&quot;,&quot;c73cf94e-b88e-4184-b61d-821fb31833cf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;4f18c3ae-abcb-4da0-9eb2-3677f7637c24&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;087eaf18-b829-4d75-86c2-06b0eb40438e&quot;,&quot;title&quot;:&quot;pbkdf2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21e3b7eb-edd9-4e30-b80b-ee5ad668ea94&quot;,&quot;parentUUID&quot;:&quot;087eaf18-b829-4d75-86c2-06b0eb40438e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;65d2c42c-373a-4057-b8b8-f7cebe035948&quot;,&quot;title&quot;:&quot;pbkdf2rounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;82b0bb4e-50b8-43d5-b258-d12827989d8b&quot;,&quot;parentUUID&quot;:&quot;65d2c42c-373a-4057-b8b8-f7cebe035948&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2rounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60b14b88-daa4-4538-9f2b-331c932ea120&quot;,&quot;parentUUID&quot;:&quot;65d2c42c-373a-4057-b8b8-f7cebe035948&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2rounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2rounds: 100000\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 100000,\n    digest: &#x27;sha256&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31f16617-5c2a-4ba9-838f-fa4ed8ae3159&quot;,&quot;parentUUID&quot;:&quot;65d2c42c-373a-4057-b8b8-f7cebe035948&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;82b0bb4e-50b8-43d5-b258-d12827989d8b&quot;,&quot;60b14b88-daa4-4538-9f2b-331c932ea120&quot;,&quot;31f16617-5c2a-4ba9-838f-fa4ed8ae3159&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;43434550-9cd2-42cc-b82e-2bf93dd28b55&quot;,&quot;title&quot;:&quot;pbkdf2digest&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: 0\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a14a1737-b723-4b96-8d4c-1da46ed20bee&quot;,&quot;parentUUID&quot;:&quot;43434550-9cd2-42cc-b82e-2bf93dd28b55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;pbkdf2&#x27;,\n    pbkdf2digest: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d57e9644-b2b1-40ca-9719-274a35501972&quot;,&quot;parentUUID&quot;:&quot;43434550-9cd2-42cc-b82e-2bf93dd28b55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf pbkdf2 pbkdf2digest valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;pbkdf2&#x27;,\n  pbkdf2digest: &#x27;sha512&#x27;\n}).should.deep.equal({\n  type: &#x27;pbkdf2&#x27;,\n  params: {\n    rounds: 310000,\n    digest: &#x27;sha512&#x27;\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e9285644-ce9b-4cd3-96ed-90bbdf9939f7&quot;,&quot;parentUUID&quot;:&quot;43434550-9cd2-42cc-b82e-2bf93dd28b55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a14a1737-b723-4b96-8d4c-1da46ed20bee&quot;,&quot;d57e9644-b2b1-40ca-9719-274a35501972&quot;,&quot;e9285644-ce9b-4cd3-96ed-90bbdf9939f7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;21e3b7eb-edd9-4e30-b80b-ee5ad668ea94&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;53193211-4e40-408f-9013-a772df6de787&quot;,&quot;title&quot;:&quot;bcrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 10\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;325a5667-a44b-4560-9f75-05e7fe4fbae0&quot;,&quot;parentUUID&quot;:&quot;53193211-4e40-408f-9013-a772df6de787&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;863ba564-d0f5-4952-a24f-135a8a0aa808&quot;,&quot;title&quot;:&quot;bcryptrounds&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b6b23ee-a635-4a62-ab88-b97d918d1aed&quot;,&quot;parentUUID&quot;:&quot;863ba564-d0f5-4952-a24f-135a8a0aa808&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;bcrypt&#x27;,\n    bcryptrounds: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78833e25-8239-422c-9cde-895972e4c7de&quot;,&quot;parentUUID&quot;:&quot;863ba564-d0f5-4952-a24f-135a8a0aa808&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf bcrypt bcryptrounds valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;bcrypt&#x27;,\n  bcryptrounds: 25\n}).should.deep.equal({\n  type: &#x27;bcrypt&#x27;,\n  params: {\n    rounds: 25\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81594242-fad4-4c2b-908e-286ab9ddd4a9&quot;,&quot;parentUUID&quot;:&quot;863ba564-d0f5-4952-a24f-135a8a0aa808&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2b6b23ee-a635-4a62-ab88-b97d918d1aed&quot;,&quot;78833e25-8239-422c-9cde-895972e4c7de&quot;,&quot;81594242-fad4-4c2b-908e-286ab9ddd4a9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;325a5667-a44b-4560-9f75-05e7fe4fbae0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;25e16e29-ae98-448a-8df7-5975bb2c8f49&quot;,&quot;title&quot;:&quot;scrypt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;432e2539-a404-487e-a816-04d276bafdf0&quot;,&quot;parentUUID&quot;:&quot;25e16e29-ae98-448a-8df7-5975bb2c8f49&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8bce848b-a3e8-4367-b3e3-cbd28a6e405f&quot;,&quot;title&quot;:&quot;scryptcost&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a13a9c99-4a83-4751-8e91-6830a2914461&quot;,&quot;parentUUID&quot;:&quot;8bce848b-a3e8-4367-b3e3-cbd28a6e405f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptcost: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09f61b4a-4a1d-4bec-a887-8dc5c29e3809&quot;,&quot;parentUUID&quot;:&quot;8bce848b-a3e8-4367-b3e3-cbd28a6e405f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptcost valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptcost: 12345\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 12345,\n    blocksize: 8,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5be0caa0-a346-4cc8-8947-b3d5abf8bc0e&quot;,&quot;parentUUID&quot;:&quot;8bce848b-a3e8-4367-b3e3-cbd28a6e405f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a13a9c99-4a83-4751-8e91-6830a2914461&quot;,&quot;09f61b4a-4a1d-4bec-a887-8dc5c29e3809&quot;,&quot;5be0caa0-a346-4cc8-8947-b3d5abf8bc0e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;fc3577ec-0cce-465e-9d9d-dded8a70c6ca&quot;,&quot;title&quot;:&quot;scryptblocksize&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59e443d9-9d93-4898-8e96-35eeb91eea05&quot;,&quot;parentUUID&quot;:&quot;fc3577ec-0cce-465e-9d9d-dded8a70c6ca&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptblocksize: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c9f6ff7-98cc-41a3-a44d-42a8f30ae592&quot;,&quot;parentUUID&quot;:&quot;fc3577ec-0cce-465e-9d9d-dded8a70c6ca&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptblocksize valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptblocksize: 24\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 24,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d7334da4-777a-45d3-ad75-fee26f4e48ce&quot;,&quot;parentUUID&quot;:&quot;fc3577ec-0cce-465e-9d9d-dded8a70c6ca&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;59e443d9-9d93-4898-8e96-35eeb91eea05&quot;,&quot;7c9f6ff7-98cc-41a3-a44d-42a8f30ae592&quot;,&quot;d7334da4-777a-45d3-ad75-fee26f4e48ce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;78820479-ad20-4c5b-8e2a-e874c502b12c&quot;,&quot;title&quot;:&quot;scryptparallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3883a815-6c5b-4056-9b75-9a2fde6abab4&quot;,&quot;parentUUID&quot;:&quot;78820479-ad20-4c5b-8e2a-e874c502b12c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;scrypt&#x27;,\n    scryptparallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6768faf3-a1cf-4c27-b93f-13a6570fc796&quot;,&quot;parentUUID&quot;:&quot;78820479-ad20-4c5b-8e2a-e874c502b12c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf scrypt scryptparallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;scrypt&#x27;,\n  scryptparallelism: 2\n}).should.deep.equal({\n  type: &#x27;scrypt&#x27;,\n  params: {\n    rounds: 16384,\n    blocksize: 8,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec0b3967-84a5-44bf-877b-aa521a32cc88&quot;,&quot;parentUUID&quot;:&quot;78820479-ad20-4c5b-8e2a-e874c502b12c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3883a815-6c5b-4056-9b75-9a2fde6abab4&quot;,&quot;6768faf3-a1cf-4c27-b93f-13a6570fc796&quot;,&quot;ec0b3967-84a5-44bf-877b-aa521a32cc88&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;432e2539-a404-487e-a816-04d276bafdf0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;f57cebaf-f8c1-450c-a8d2-4c44f30fbe47&quot;,&quot;title&quot;:&quot;argon2&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;defaults&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 defaults&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3eca1cab-4807-44e9-ae6e-638cf81ce22e&quot;,&quot;parentUUID&quot;:&quot;f57cebaf-f8c1-450c-a8d2-4c44f30fbe47&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: 123\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3633b580-7184-442c-b7af-1ba78b1faf87&quot;,&quot;parentUUID&quot;:&quot;f57cebaf-f8c1-450c-a8d2-4c44f30fbe47&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;kdf/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 kdf/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;foo&#x27;\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf1bfc90-6d23-46a0-9574-bd70a546986e&quot;,&quot;parentUUID&quot;:&quot;f57cebaf-f8c1-450c-a8d2-4c44f30fbe47&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c1973d5f-4c30-4262-9532-a18171ec4536&quot;,&quot;title&quot;:&quot;argon2time&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;54495737-7cf1-4259-83f3-2e8a74468995&quot;,&quot;parentUUID&quot;:&quot;c1973d5f-4c30-4262-9532-a18171ec4536&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2time: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e9c27ba-03fc-476b-9f04-37b0ad7c451b&quot;,&quot;parentUUID&quot;:&quot;c1973d5f-4c30-4262-9532-a18171ec4536&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2time valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2d&#x27;,\n  argon2time: 10\n}).should.deep.equal({\n  type: &#x27;argon2d&#x27;,\n  params: {\n    rounds: 10,\n    memory: 24576,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f464338-2971-45d5-9356-f5c36f3393f1&quot;,&quot;parentUUID&quot;:&quot;c1973d5f-4c30-4262-9532-a18171ec4536&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;54495737-7cf1-4259-83f3-2e8a74468995&quot;,&quot;1e9c27ba-03fc-476b-9f04-37b0ad7c451b&quot;,&quot;6f464338-2971-45d5-9356-f5c36f3393f1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;32e2d355-0821-472e-92f6-3c359f203b3e&quot;,&quot;title&quot;:&quot;argon2mem&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7224659-d870-4400-afe6-5eceea9c30d1&quot;,&quot;parentUUID&quot;:&quot;32e2d355-0821-472e-92f6-3c359f203b3e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2mem: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90d2686b-a340-4d3d-a206-d00cdcb11542&quot;,&quot;parentUUID&quot;:&quot;32e2d355-0821-472e-92f6-3c359f203b3e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2mem valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2i&#x27;,\n  argon2mem: 12345\n}).should.deep.equal({\n  type: &#x27;argon2i&#x27;,\n  params: {\n    rounds: 2,\n    memory: 12345,\n    parallelism: 1\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60428ccb-3c09-4246-bc98-549a9697f2cd&quot;,&quot;parentUUID&quot;:&quot;32e2d355-0821-472e-92f6-3c359f203b3e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e7224659-d870-4400-afe6-5eceea9c30d1&quot;,&quot;90d2686b-a340-4d3d-a206-d00cdcb11542&quot;,&quot;60428ccb-3c09-4246-bc98-549a9697f2cd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;26e8df46-fa30-4d5a-8325-a481b65bd092&quot;,&quot;title&quot;:&quot;argon2parallelism&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\kdf.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\kdf.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: &#x27;foo&#x27;\n  })\n}).should.throw(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59aae02a-f766-44b8-9a2d-1ba2e5839c1c&quot;,&quot;parentUUID&quot;:&quot;26e8df46-fa30-4d5a-8325-a481b65bd092&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;(() =&gt; {\n  mfkdf.setup.kdf({\n    kdf: &#x27;argon2id&#x27;,\n    argon2parallelism: 0\n  })\n}).should.throw(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ca83799-6250-4cd8-ac13-6924c3856819&quot;,&quot;parentUUID&quot;:&quot;26e8df46-fa30-4d5a-8325-a481b65bd092&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/kdf argon2 argon2parallelism valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.kdf({\n  kdf: &#x27;argon2id&#x27;,\n  argon2parallelism: 2\n}).should.deep.equal({\n  type: &#x27;argon2id&#x27;,\n  params: {\n    rounds: 2,\n    memory: 24576,\n    parallelism: 2\n  }\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14852a41-ba86-44e4-91f0-c17c808110a4&quot;,&quot;parentUUID&quot;:&quot;26e8df46-fa30-4d5a-8325-a481b65bd092&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;59aae02a-f766-44b8-9a2d-1ba2e5839c1c&quot;,&quot;5ca83799-6250-4cd8-ac13-6924c3856819&quot;,&quot;14852a41-ba86-44e4-91f0-c17c808110a4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;3eca1cab-4807-44e9-ae6e-638cf81ce22e&quot;,&quot;3633b580-7184-442c-b7af-1ba78b1faf87&quot;,&quot;cf1bfc90-6d23-46a0-9574-bd70a546986e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;04aa4468-9f43-40b9-a74f-99bdbd71cc21&quot;,&quot;title&quot;:&quot;setup/key&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const key = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\najv.validate(policySchema, key.policy).should.be.true&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de94aa0d-c216-43e1-96ac-5a61f33477c0&quot;,&quot;parentUUID&quot;:&quot;04aa4468-9f43-40b9-a74f-99bdbd71cc21&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1753a14c-6144-422d-af2d-ff88a2de509a&quot;,&quot;title&quot;:&quot;id&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key id default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.$id.should.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86a96ee7-3774-412c-b82a-bef26863e7e3&quot;,&quot;parentUUID&quot;:&quot;1753a14c-6144-422d-af2d-ff88a2de509a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key id valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;hello-world&#x27; })\npolicy.$id.should.equal(&#x27;hello-world&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99a7f7dc-b25d-4e52-944a-192bdb477053&quot;,&quot;parentUUID&quot;:&quot;1753a14c-6144-422d-af2d-ff88a2de509a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: 12345 }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d8a8ce5-1181-45df-b14f-d3e8f4b143a1&quot;,&quot;parentUUID&quot;:&quot;1753a14c-6144-422d-af2d-ff88a2de509a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key id invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { id: &#x27;&#x27; }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abdc7f8d-4647-4f30-8c66-02354505a6f6&quot;,&quot;parentUUID&quot;:&quot;1753a14c-6144-422d-af2d-ff88a2de509a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;86a96ee7-3774-412c-b82a-bef26863e7e3&quot;,&quot;99a7f7dc-b25d-4e52-944a-192bdb477053&quot;,&quot;6d8a8ce5-1181-45df-b14f-d3e8f4b143a1&quot;,&quot;abdc7f8d-4647-4f30-8c66-02354505a6f6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:215,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;98307e13-287e-4e02-9df7-e58091fb21ea&quot;,&quot;title&quot;:&quot;size&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key size default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n])\npolicy.size.should.equal(32)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d3a2831-8864-40a5-87f5-f5c5b51218f8&quot;,&quot;parentUUID&quot;:&quot;98307e13-287e-4e02-9df7-e58091fb21ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key size valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 64 })\npolicy.size.should.equal(64)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c7de128-f2da-4c4e-b95e-163a80f28b53&quot;,&quot;parentUUID&quot;:&quot;98307e13-287e-4e02-9df7-e58091fb21ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5cfad5f-4573-458a-ad53-cfac5ad62e5d&quot;,&quot;parentUUID&quot;:&quot;98307e13-287e-4e02-9df7-e58091fb21ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key size invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 0 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c8716e3d-a691-4f4e-a5b8-eee215a4333e&quot;,&quot;parentUUID&quot;:&quot;98307e13-287e-4e02-9df7-e58091fb21ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1d3a2831-8864-40a5-87f5-f5c5b51218f8&quot;,&quot;5c7de128-f2da-4c4e-b95e-163a80f28b53&quot;,&quot;b5cfad5f-4573-458a-ad53-cfac5ad62e5d&quot;,&quot;c8716e3d-a691-4f4e-a5b8-eee215a4333e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:210,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;a0957caa-4f50-4dca-8dfc-b91cc4268db5&quot;,&quot;title&quot;:&quot;threshold&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:108,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n])\npolicy.threshold.should.equal(2)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;940085ea-a8dc-4405-a225-b55455d09049&quot;,&quot;parentUUID&quot;:&quot;a0957caa-4f50-4dca-8dfc-b91cc4268db5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password2&#x27; })\n], { threshold: 1 })\npolicy.threshold.should.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f34ae59f-1bf2-43f5-950f-ecc836aa2af1&quot;,&quot;parentUUID&quot;:&quot;a0957caa-4f50-4dca-8dfc-b91cc4268db5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f11a29d7-9e21-4ea8-94ae-85b3a1c5d549&quot;,&quot;parentUUID&quot;:&quot;a0957caa-4f50-4dca-8dfc-b91cc4268db5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key threshold invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 0 }).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { threshold: 2 }).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ce7fe192-19e1-402a-b948-79b49d513662&quot;,&quot;parentUUID&quot;:&quot;a0957caa-4f50-4dca-8dfc-b91cc4268db5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;940085ea-a8dc-4405-a225-b55455d09049&quot;,&quot;f34ae59f-1bf2-43f5-950f-ecc836aa2af1&quot;,&quot;f11a29d7-9e21-4ea8-94ae-85b3a1c5d549&quot;,&quot;ce7fe192-19e1-402a-b948-79b49d513662&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:214,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;b657038c-3731-4c6e-9261-bb7a73a88455&quot;,&quot;title&quot;:&quot;salt&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;default&quot;,&quot;fullTitle&quot;:&quot;setup/key salt default&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { size: 48 })\nconst salt = Buffer.from(policy.salt, &#x27;base64&#x27;)\nsalt.length.should.equal(48)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ae64bce-1716-492a-9d65-d35314029fd1&quot;,&quot;parentUUID&quot;:&quot;b657038c-3731-4c6e-9261-bb7a73a88455&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key salt valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { policy } = await mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: Buffer.from(&#x27;12345678&#x27;, &#x27;base64&#x27;) })\npolicy.salt.should.equal(&#x27;12345678&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f2dca15-960a-4f4e-bd9a-6d10e549a3f9&quot;,&quot;parentUUID&quot;:&quot;b657038c-3731-4c6e-9261-bb7a73a88455&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key salt invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;)\n], { salt: &#x27;hello&#x27; }).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cb157350-45e5-4e09-a463-141150401559&quot;,&quot;parentUUID&quot;:&quot;b657038c-3731-4c6e-9261-bb7a73a88455&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ae64bce-1716-492a-9d65-d35314029fd1&quot;,&quot;9f2dca15-960a-4f4e-bd9a-6d10e549a3f9&quot;,&quot;cb157350-45e5-4e09-a463-141150401559&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:212,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000},{&quot;uuid&quot;:&quot;86300982-9f50-4bde-895f-f8e87dc085f7&quot;,&quot;title&quot;:&quot;factors&quot;,&quot;fullFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\test\\setup\\key.js&quot;,&quot;file&quot;:&quot;\\test\\setup\\key.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;valid&quot;,&quot;fullTitle&quot;:&quot;setup/key factors valid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:107,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await mfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    },\n    output: async () =&gt; {\n      return {}\n    }\n  }\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ac5dcddc-abb5-40fd-be8a-c164d807a804&quot;,&quot;parentUUID&quot;:&quot;86300982-9f50-4bde-895f-f8e87dc085f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;id&quot;,&quot;fullTitle&quot;:&quot;setup/key factors id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; }),\n  await mfkdf.setup.factors.password(&#x27;hello&#x27;, { id: &#x27;password1&#x27; })\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7ca6dd72-5c05-46ec-9122-5ac24d997200&quot;,&quot;parentUUID&quot;:&quot;86300982-9f50-4bde-895f-f8e87dc085f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/type&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key(&#x27;hello&#x27;).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: 12345,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: 12345,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: 12345,\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(TypeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: 12345\n  }\n]).should.be.rejectedWith(TypeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bd864dad-7ea6-49aa-9e8b-5eb4d2c554eb&quot;,&quot;parentUUID&quot;:&quot;86300982-9f50-4bde-895f-f8e87dc085f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;invalid/range&quot;,&quot;fullTitle&quot;:&quot;setup/key factors invalid/range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;mfkdf.setup.key([\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;&#x27;,\n    data: Buffer.from(&#x27;password&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)\nmfkdf.setup.key([\n  {\n    type: &#x27;password&#x27;,\n    id: &#x27;password&#x27;,\n    data: Buffer.from(&#x27;&#x27;, &#x27;utf-8&#x27;),\n    params: async () =&gt; {\n      return {}\n    }\n  }\n]).should.be.rejectedWith(RangeError)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3122fc1-0b28-4d46-bd8a-1df1d8c377e0&quot;,&quot;parentUUID&quot;:&quot;86300982-9f50-4bde-895f-f8e87dc085f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ac5dcddc-abb5-40fd-be8a-c164d807a804&quot;,&quot;7ca6dd72-5c05-46ec-9122-5ac24d997200&quot;,&quot;bd864dad-7ea6-49aa-9e8b-5eb4d2c554eb&quot;,&quot;d3122fc1-0b28-4d46-bd8a-1df1d8c377e0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:109,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[&quot;de94aa0d-c216-43e1-96ac-5a61f33477c0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:113,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:5000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:5000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;6.2.3&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;./site/mochawesome&quot;},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;./site/mochawesome&quot;,&quot;reportTitle&quot;:&quot;MFKDF&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;site\\mochawesome\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\xampp\\htdocs\\Multifactor\\MFKDF\\site\\mochawesome\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>